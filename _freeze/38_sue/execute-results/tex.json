{
  "hash": "cc5ef3db826de25b3cfebf17fcef0ddd",
  "result": {
    "engine": "jupyter",
    "markdown": "# Standardized Earnings Surprises (SUE)\n\nIn the context of the Ho Chi Minh Stock Exchange (HOSE) and the Hanoi Stock Exchange (HNX), earnings announcements represent critical information events. Investors and quantitative analysts continuously monitor the deviation between reported earnings and market expectations. This deviation is quantified as the Standardized Earnings Surprise (SUE).\n\nThis chapter details the methodology for calculating SUE using three distinct approaches frequently utilized in academic literature and institutional research. We apply these methods to a dataset of Vietnamese large-cap equities to illustrate the mechanics of the calculation. The goal is to isolate the \"surprise\" component of earnings, which is a known predictor of post-earnings announcement drift (PEAD) [@bernard1989post; @livnat2006comparing].\n\n## Methodology\n\nWe define three primary methods for calculating SUE. Each method differs in how it establishes the \"expected\" earnings value.\n\n### Method 1: Seasonal Random Walk\n\nThis method assumes that earnings follow a seasonal pattern. The best predictor for the current quarter's earnings per share (EPS) is the EPS from the same quarter in the previous year. This controls for the seasonality often seen in Vietnamese sectors like retail and agriculture.\n\n$$SUE_{1} = \\frac{EPS_{t} - EPS_{t-4}}{P_{t}}$$\n\nWhere:\n\n-   $EPS_{t}$ is the current quarterly Earnings Per Share.\n\n-   $EPS_{t-4}$ is the Earnings Per Share from the same quarter of the prior fiscal year.\n\n-   $P_{t}$ is the stock price at the end of the quarter (used as a deflator).\n\n### Method 2: Exclusion of Special Items\n\nReported earnings often contain non-recurring items (e.g., asset sales, one-time write-offs) that distort the true operating performance. This method adjusts the reported EPS by removing the after-tax impact of special items.\n\nIn Vietnam, the standard Corporate Income Tax (CIT) rate is generally 20%. We adjust special items to reflect their impact on net income.\n\n$$\nAdjusted \\ EPS = Reported \\ EPS - \\frac{Special \\ Items \\times (1 - CIT)}{Shares \\ Outstanding}\n$$\n\nThe SUE calculation then follows the seasonal logic but uses the adjusted EPS figures: $$SUE_{2} = \\frac{Adj \\ EPS_{t} - Adj \\ EPS_{t-4}}{P_{t}}$$\n\n### Method 3: Analyst Consensus\n\nThis method relies on market consensus rather than historical time series. It compares the actual reported earnings against the median analyst forecast provided prior to the announcement.\n\n$$SUE_{3} = \\frac{Actual \\ EPS - Median \\ Estimate}{P_{t}}$$\n\n## Data Description\n\nFor this analysis, we utilize a dataset covering the fiscal years 2023 through 2025. The data includes quarterly financial statements and analyst consensus estimates for a selection of VN30 index constituents.\n\nThe dataset, `vietnam_fin_data.csv`, contains the following columns:\n\n-   **ticker**: Stock symbol (e.g., VNM, VCB, HPG).\n\n-   **fiscal_year**: The financial year.\n\n-   **fiscal_qtr**: The financial quarter (1-4).\n\n-   **eps_basic**: Basic Earnings Per Share (VND).\n\n-   **price_close**: Closing price at quarter end (VND).\n\n-   **special_items**: Pre-tax special items value (VND millions). (i.e., `is_other_profit` in DataCore).\n\n-   **shares_out**: Shares outstanding (millions).\n\n-   **analyst_med**: Median analyst EPS estimate (VND).\n\n### Visualizing the Core Data\n\nBelow is a tabular representation of the raw data we have ingested for the analysis.\n\n| ticker | fiscal_year | fiscal_qtr | eps_basic | price_close | special_items | shares_out | analyst_med |\n|:--------|:--------|:--------|:--------|:--------|:--------|:--------|:--------|\n| VNM | 2023 | 1 | 1200 | 68000 | 0 | 2090 | 1150 |\n| VNM | 2023 | 2 | 1350 | 71000 | 50000 | 2090 | 1300 |\n| VNM | 2023 | 3 | 1400 | 74000 | 0 | 2090 | 1450 |\n| VNM | 2023 | 4 | 1100 | 69000 | -20000 | 2090 | 1150 |\n| VNM | 2024 | 1 | 1300 | 72000 | 0 | 2090 | 1250 |\n| VNM | 2024 | 2 | 1500 | 75000 | 0 | 2090 | 1400 |\n| VCB | 2023 | 1 | 1800 | 85000 | 10000 | 5500 | 1700 |\n| VCB | 2024 | 1 | 2100 | 92000 | 0 | 5500 | 2000 |\n\n## Implementation\n\n### Python Setup and Data Loading\n\nFirst, we establish our environment and load the dataset. We ensure the data is sorted by ticker and time to allow for accurate lag calculations.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Creating the dataset directly for this chapter's demonstration\ndata = {\n    'ticker': ['VNM']*8 + ['VCB']*8 + ['HPG']*8,\n    'fiscal_year': [2023, 2023, 2023, 2023, 2024, 2024, 2024, 2024] * 3,\n    'fiscal_qtr': [1, 2, 3, 4, 1, 2, 3, 4] * 3,\n    'eps_basic': [\n        1200, 1350, 1400, 1100, 1300, 1500, 1450, 1250, # VNM\n        1800, 1900, 2000, 2200, 2100, 2300, 2400, 2600, # VCB\n        500, 600, 550, 400, 700, 800, 750, 600          # HPG\n    ],\n    'price_close': [\n        68000, 71000, 74000, 69000, 72000, 75000, 73000, 70000, # VNM\n        85000, 88000, 90000, 95000, 92000, 96000, 98000, 102000, # VCB\n        20000, 22000, 21000, 19000, 25000, 28000, 27000, 24000 # HPG\n    ],\n    'special_items': [\n        0, 50000, 0, -20000, 0, 0, 10000, 0, # VNM (VND Millions)\n        10000, 0, 0, 50000, 0, 20000, 0, 0, # VCB\n        0, 0, -50000, 0, 100000, 0, 0, 0 # HPG\n    ],\n    'shares_out': [2090]*8 + [5580]*8 + [5810]*8, # In Millions\n    'analyst_med': [\n        1150, 1300, 1450, 1150, 1250, 1400, 1480, 1200, # VNM\n        1700, 1850, 1950, 2150, 2000, 2250, 2450, 2550, # VCB\n        450, 550, 600, 450, 650, 750, 800, 650 # HPG\n    ]\n}\n\ndf = pd.DataFrame(data)\n\n# Sort strictly to ensure shift operations work on correct temporal sequence\ndf = df.sort_values(by=['ticker', 'fiscal_year', 'fiscal_qtr'])\nprint(df.head())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   ticker  fiscal_year  fiscal_qtr  eps_basic  price_close  special_items  \\\n16    HPG         2023           1        500        20000              0   \n17    HPG         2023           2        600        22000              0   \n18    HPG         2023           3        550        21000         -50000   \n19    HPG         2023           4        400        19000              0   \n20    HPG         2024           1        700        25000         100000   \n\n    shares_out  analyst_med  \n16        5810          450  \n17        5810          550  \n18        5810          600  \n19        5810          450  \n20        5810          650  \n```\n:::\n:::\n\n\n### Calculation Logic\n\nWe now apply the functions to calculate the three variations of SUE.\n\n**Step 1: Handling Seasonality (Lags)**\n\nFor Methods 1 and 2, we require the data from the same quarter of the previous year (lag 4).\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n# Group by ticker to ensure we don't shift data between companies\ndf['eps_lag4'] = df.groupby('ticker')['eps_basic'].shift(4)\n```\n:::\n\n\n**Step 2: Adjusting for Special Items**\n\nFor Method 2, we must strip out non-recurring items. We apply the Vietnamese Corporate Income Tax (CIT) rate of 20%.\n\nThe formula for the adjustment per share is: $$ \\text{Adjustment} = \\frac{\\text{Special Items} \\times (1 - 0.20)}{\\text{Shares Outstanding}} $$\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n# Constants\nCIT_RATE_VN = 0.20\n\n# Calculate impact per share\n# Note: special_items are in millions, shares_out are in millions\n# The units cancel out, leaving the result in VND per share.\ndf['spi_impact_per_share'] = (df['special_items'] * (1 - CIT_RATE_VN)) / df['shares_out']\n\n# Calculate Adjusted EPS\ndf['eps_adjusted'] = df['eps_basic'] - df['spi_impact_per_share']\n\n# Create lag for Adjusted EPS\ndf['eps_adj_lag4'] = df.groupby('ticker')['eps_adjusted'].shift(4)\n```\n:::\n\n\n**Step 3: Computing SUE Variants**\n\nWe finalize the calculation by computing the difference between actual (or adjusted) and expected values, deflated by the stock price.\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n# Method 1: Seasonal Random Walk (Standard EPS)\ndf['sue_1'] = (df['eps_basic'] - df['eps_lag4']) / df['price_close']\n\n# Method 2: Seasonal Random Walk (Excluding Special Items)\ndf['sue_2'] = (df['eps_adjusted'] - df['eps_adj_lag4']) / df['price_close']\n\n# Method 3: Analyst Forecasts (IBES Equivalent)\ndf['sue_3'] = (df['eps_basic'] - df['analyst_med']) / df['price_close']\n\n# Scaling for readability (converting to percentage)\ndf['sue_1_pct'] = df['sue_1'] * 100\ndf['sue_2_pct'] = df['sue_2'] * 100\ndf['sue_3_pct'] = df['sue_3'] * 100\n```\n:::\n\n\n## Results and Analysis\n\nWe present the calculated standardized earnings surprises for the fiscal year 2024. Positive values indicate a positive surprise (beating expectations), while negative values indicate a miss.\n\n### Tabular Results (FY 2024)\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n# Filter for 2024 results where lag data exists\nresults_2024 = df[df['fiscal_year'] == 2024][['ticker', 'fiscal_qtr', 'sue_1_pct', 'sue_2_pct', 'sue_3_pct']]\n\n# Display formatted table\nfrom IPython.display import display, Markdown\nmarkdown_table = results_2024.to_markdown(index=False, floatfmt=\".4f\")\ndisplay(Markdown(markdown_table))\n```\n\n::: {.cell-output .cell-output-display .cell-output-markdown}\n| ticker   |   fiscal_qtr |   sue_1_pct |   sue_2_pct |   sue_3_pct |\n|:---------|-------------:|------------:|------------:|------------:|\n| HPG      |            1 |      0.8000 |      0.7449 |      0.2000 |\n| HPG      |            2 |      0.7143 |      0.7143 |      0.1786 |\n| HPG      |            3 |      0.7407 |      0.7152 |     -0.1852 |\n| HPG      |            4 |      0.8333 |      0.8333 |     -0.2083 |\n| VCB      |            1 |      0.3261 |      0.3276 |      0.1087 |\n| VCB      |            2 |      0.4167 |      0.4137 |      0.0521 |\n| VCB      |            3 |      0.4082 |      0.4082 |     -0.0510 |\n| VCB      |            4 |      0.3922 |      0.3992 |      0.0490 |\n| VNM      |            1 |      0.1389 |      0.1389 |      0.0694 |\n| VNM      |            2 |      0.2000 |      0.2255 |      0.1333 |\n| VNM      |            3 |      0.0685 |      0.0632 |     -0.0411 |\n| VNM      |            4 |      0.2143 |      0.2033 |      0.0714 |\n:::\n:::\n\n\n```{=html}\n<!-- | ticker | fiscal_qtr | sue_1_pct | sue_2_pct | sue_3_pct |\n|--------|------------|-----------|-----------|-----------|\n| HPG    | 1          | 0.8000    | 0.7449    | 0.2000    |\n| HPG    | 2          | 0.7143    | 0.7143    | 0.1786    |\n| HPG    | 3          | 0.7407    | 0.8148    | -0.1852   |\n| HPG    | 4          | 0.8333    | 0.8333    | -0.2083   |\n| VCB    | 1          | 0.3261    | 0.3276    | 0.1087    |\n| VCB    | 2          | 0.4167    | 0.4167    | 0.0521    |\n| VCB    | 3          | 0.4082    | 0.4082    | -0.0510   |\n| VCB    | 4          | 0.3922    | 0.3453    | 0.0490    |\n| VNM    | 1          | 0.1389    | 0.1389    | 0.0694    |\n| VNM    | 2          | 0.2000    | 0.2255    | 0.1333    |\n| VNM    | 3          | 0.0685    | 0.0685    | -0.0411   |\n| VNM    | 4          | 0.2143    | 0.1914    | 0.0714    | -->\n```\n\n```{=html}\n<!-- The analysis of the VNM (Vinamilk), VCB (Vietcombank), and HPG (Hoa Phat Group) data reveals distinct divergences between the three methods.\n\n1.  **Analyst Efficiency (Method 3):** Note that SUE 3 is generally smaller in magnitude than SUE 1 or 2. This is expected, as analysts incorporate recent information into their forecasts, making the \"surprise\" smaller than a simple seasonal model would suggest.\n2.  **Impact of Special Items (Method 2 vs 1):** In the case of HPG in Q1 2024, there was a significant special item adjustment. SUE 1 (0.8000%) differs from SUE 2 (0.7449%), showing that the raw EPS growth was partially driven by one-off events. Using Method 1 alone would have overstated the sustainable earnings surprise.\n3.  **Sector Volatility:** HPG (Steel sector) shows higher volatility in surprises compared to VNM (Consumer Staples), reflecting the cyclical nature of the construction materials market in Vietnam. -->\n```\n\n### Visualization\n\nThe following figure plots the Analyst-based SUE (Method 3) for the selected tickers over the 2024 fiscal year.\n\n::: {.cell fig-width='7' execution_count=7}\n``` {.python .cell-code}\npivot_sue = results_2024.pivot(index='fiscal_qtr', columns='ticker', values='sue_3_pct')\n\nplt.figure(figsize=(10, 6))\nfor column in pivot_sue.columns:\n    plt.plot(pivot_sue.index, pivot_sue[column], marker='o', label=column)\n\nplt.title('Method 3: Analyst Based SUE (FY 2024)')\nplt.xlabel('Fiscal Quarter')\nplt.ylabel('SUE (%)')\nplt.axhline(0, color='black', linestyle='--', linewidth=0.8)\nplt.legend(title='Ticker')\nplt.grid(True, linestyle=':', alpha=0.6)\nplt.xticks([1, 2, 3, 4])\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](38_sue_files/figure-pdf/fig-sue-output-1.pdf){#fig-sue fig-pos='H'}\n:::\n:::\n\n\n## Conclusion\n\nIn this chapter, we have formalized the calculation of Standardized Earnings Surprises for the Vietnamese market. We demonstrated that relying solely on raw EPS growth (Method 1) can be misleading in the presence of non-recurring items. Furthermore, analyst-based surprises (Method 3) often provide a cleaner signal of new information reaching the market.\n\nFor robust quantitative modeling in Vietnam, we recommend using Method 2 when analyst data is sparse (common in small-cap stocks) and Method 3 for VN30 constituents where analyst coverage is deep and liquid.\n\n",
    "supporting": [
      "38_sue_files/figure-pdf"
    ],
    "filters": []
  }
}