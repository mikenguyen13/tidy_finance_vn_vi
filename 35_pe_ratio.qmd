# P/E Ratio

The systematic analysis of equity valuations in frontier and emerging markets requires a robust integration of high-fidelity financial data, rigorous mathematical modeling, and an acute understanding of local regulatory frameworks. In the context of the Vietnamese equity market, the Price-Earnings (P/E) ratio serves as a primary instrument for assessing corporate performance and market sentiment. This chapter provides an exploration of P/E valuation methodologies, ranging from firm-specific trailing and forward metrics to cyclically adjusted and unlevered variations.

<!-- ## The Architecture of Vietnamese Financial Data

The Datacore.vn platform organizes its financial offerings into several specialized products, each serving a distinct role in the valuation pipeline. The "Stock" data product delivers clean, daily trading data for all listed companies, supporting market tracking and strategy development. For fundamental analysis, the "Vietnam Fundamentals" dataset is indispensable, as it provides clean, comparable, and fully reconciled firm-level accounting data for every company listed on HOSE, HNX, and UPCoM from the year 2000 onward.

|  |  |  |
|----|----|----|
| **Dataset Name** | **Scope** | **Key Variables for P/E Analysis** |
| Stock Data | Daily Trading | `close_price`, `adjusted_close`, `volume`, `market_cap` |
| Vietnam Fundamentals | Firm Accounting | `net_income`, `eps`, `shares_outstanding`, `total_debt` |
| Company Data | Legal Entities | `registration_date`, `industry_code`, `legal_status` |
| News Data | Market Events | `sentiment_score`, `article_topic`, `entity_linkage` |
| Bank Data | Financial Sector | `branch_network`, `shareholder_structure`, `regulatory_status` | -->

### Technical Schema and Variable Engineering

The primary identifier for equities is the symbol, typically a three-letter uppercase code, though special indices such as E1VFVN30 (ETF) or market indices like HNX-INDEX and UPCOM-INDEX follow unique naming conventions. Price data is categorized as OHLC type, encompassing 'open', 'high', 'low', and 'close'. For valuation purposes, the 'adjusted close' is preferred to account for corporate actions such as stock splits and dividend payments.

The accounting variables provided in the Vietnam Fundamentals product follow a standardized classification that reconciles different reporting standards across sectors. This reconciliation is vital because Vietnamese firms may have differing interpretations of revenue and net profit under Vietnamese Accounting Standards (VAS).

## Firm-Specific P/E Valuation Metrics

At the individual firm level, the P/E ratio is the most fundamental measure of how much an investor is willing to pay for each unit of current or future profit. However, the calculation of "E" (Earnings) can take several forms, each offering a different insight into the company’s value.

### Trailing P/E and the TTM Methodology

The Trailing P/E ratio is calculated using the reported earnings from the last four quarters, known as Trailing Twelve Months (TTM). In the Vietnamese market, this is often the default metric reported by exchanges and financial news outlets.

The mathematical representation is:

$$
P/E_{Trailing} = \frac{P_t}{\sum_{i=0}^{3} EPS_{q-i}}
$$

Where $P_t$ is the current market price and $EPS_{q-i}$ represents the earnings per share for each of the four most recent quarters.

### Forward P/E and Analyst Forecast Reliability

Forward P/E shifts the focus from historical performance to future expectations by using consensus earnings forecasts for the next fiscal year.

$$
P/E_{Forward} = \frac{P_t}{EPS_{forecasted, t+1}}
$$

In Vietnam, these forecasts are typically generated by research departments within major securities firms such as SSI, VCSC, MBS, and FPTS. These analysts rely on financial statements, projections, models, and subjective evaluations of market sentiment to generate their estimates. However, the accuracy of these forecasts is a significant area of research. However, analysts in Vietnam are often influenced by anchoring and adjustment bias, where they base future predictions heavily on past records and then make insufficient adjustments.

The accuracy of analyst earnings forecasts in Vietnam is significantly impacted by corporate governance characteristics. Specifically, state ownership has been found to have a negative impact on forecast accuracy, while institutional ownership has a positive effect. This implies that for firms with high state-controlled stakes, which are common in Vietnam’s strategic industries, researchers should apply a higher discount or "fudge factor" to forward P/E estimates provided by consensus sources.

### Cyclically Adjusted Price-Earnings (CAPE) Ratio

The Shiller P/E, or CAPE ratio, is designed to smooth out the volatility of the business cycle by using a 10-year average of inflation-adjusted earnings. For a market like Vietnam, which has seen periods of extreme growth followed by stabilization, the CAPE ratio provides a more tempered view of valuation than trailing metrics.

The calculation requires adjusting historical earnings by the Consumer Price Index (CPI). Vietnam's CPI data is updated monthly and is available from January 1996 through early 2026, with an average year-on-year growth rate of approximately 12.2%.

$$
EPS_{real, t} = EPS_{nominal, t} \times \frac{CPI_{current}}{CPI_t}
$$

$$
CAPE = \frac{P_t}{\frac{1}{10} \sum_{i=0}^{9} EPS_{real, t-i}}
$$

Historically, Vietnam’s CPI has reached an all-time high of 28.3% YoY in August 2008 and a record low of -2.6% in July 2000. These extreme swings mean that nominal earnings in the mid-2000s are not comparable to earnings today without the Shiller adjustment. Researchers must be mindful of the different base years used by the National Statistics Office (GSO), such as 2024=100, 2019=100, and 2014=100.

### Unlevered P/E and the Leibowitz Framework

The concept of the "Unlevered P/E" ratio attempts to view a company's valuation independent of its capital structure. This is particularly relevant in the Vietnamese market, where debt loads vary significantly between state-owned enterprises (SOEs) and private firms. Research by @leibowitz2002levered highlights that for the investment analyst, a company is already levered, and the task is to estimate its theoretical value by inferring the underlying structure of returns.

According to Leibowitz, leverage always moves the P/E toward a lower value than what would be obtained from a standard Gordon growth formula. As a company adds debt, the market discount rate for equity increases to compensate for the additional risk, which in turn compresses the P/E multiple. For example, a debt-free company with a theoretical P/E of 30 might see its P/E drop to 23 with a 40% debt ratio, and down to 20 with a 50% debt ratio.

The Unlevered P/E (often proxied by Enterprise Value to EBIT or EBITDA) can be calculated using fundamental variables:

$$
EV = (\text{Shares Outstanding} \times \text{Price}) + \text{Total Debt} - \text{Cash}
$$

$$
P/E_{\text{Unlevered}} \approx \frac{EV}{EBIT \times (1 - \tau)}
$$

Where $\tau$ is the corporate income tax rate. The standard CIT rate in Vietnam is 20%, which has been stable since the mid-2010s but is subject to new revisions under the Law on CIT ratified in June 2025.

## Market-Level Aggregation Techniques

Aggregating firm-specific metrics into a single market-level index P/E is a complex task that requires careful consideration of weighting and the inclusion of loss-making entities. In the Vietnamese market, two primary indices (i.e., the VN-Index and the VN30), provide the benchmarks for performance and valuation.

### The VN-Index: Capitalization-Weighted Aggregation

The VN-Index is a capitalization-weighted index of all companies listed on HOSE. It serves as a broad indicator of market health, where an increase in the index reflects a general rise in the stock prices of listed companies.

The index value is calculated as:

$$
\text{VN-Index} = \frac{\sum (Price_i \times Shares_i)}{\text{Base Factor}} \times \text{Adjustment Factor}
$$

Similarly, the index-level P/E is typically calculated as the sum of all market capitalizations divided by the sum of all net incomes (earnings) of the constituents.

$$
P/E_{Market} = \frac{\sum MarketCap_i}{\sum Earnings_i}
$$

As of early 2026, the total market capitalization for 701 tracked companies was approximately 8,629.8 trillion VND, with total earnings of 588.9 trillion VND, yielding a median P/E of approximately 14.7x.

### The VN30 and Free-Float Adjustments

The VN30 Index represents a basket of the 30 largest and most liquid stocks on HOSE, screened through layers of capitalization, free-float ratio, and transactional volume. Unlike the broad VN-Index, the VN30 applies a free-float adjustment to its capitalization weighting to ensure that only shares available for public trading affect the index movement.

The free-float ratio ($f$) is calculated as:

$f = \frac{N - N_l}{N}$

Where $N$ is the total number of outstanding shares and $N_l$ is the number of limited trading shares (held by founders, state, or strategic partners).

When aggregating P/E for the VN30, researchers must account for this adjustment, as it more accurately reflects the valuation of the investable universe. In the Vietnamese market, a handful of large-cap stocks can significantly skew the broad index. For instance, Vingroup (VIC) and its related companies have at times represented nearly a quarter of the VN-Index's total weighting, creating a "closet indexing" dilemma for fund managers. Removing these high-impact stocks can reveal a much different valuation profile; while the VN-Index might trade at 13x, the market excluding VIC-related stocks could be closer to 11x.

### Median vs. Mean Aggregation

Quantitative researchers often prefer median P/E ratios over mean P/E ratios to mitigate the influence of extreme outliers (i.e., companies with either exceptionally high P/E ratios due to temporarily low earnings or those that are technically "expensive" because of high growth expectations). @tbl-valuation-median-vs-mean-agg shows different aggregation methods.

|  |  |  |
|---------------------|--------------------------|--------------------------|
| **Aggregation Method** | **Mathematical Definition** | **Resilience to Outliers** |
| Simple Mean | $\frac{1}{n} \sum (P/E)_i$ | Low (highly skewed by extreme values) |
| Weighted Mean | $\frac{\sum (Cap_i \times (P/E)_i)}{\sum Cap_i}$ | Medium (skewed by large-cap valuation) |
| Median | $\text{Median}((P/E)_1, \dots, (P/E)_n)$ | High (most robust for market sentiment) |
| Total-to-Total | $\frac{\sum MarketCap_i}{\sum Earnings_i}$ | High (standard for index providers) |

: Median vs. Mean Aggregation {#tbl-valuation-median-vs-mean-agg}

The Vietnamese market currently trades near its 3-year average P/E of 14.8x, suggesting that investors are relatively neutral on current valuations, expecting earnings to grow in line with historical rates.

## Implementation

### Data Ingestion and Processing

```{python} 
#| eval: false
#| include: false
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# Fetching fundamental data from Datacore.vn API
def get_datacore_data(symbol, start_date, end_date):
    # This pseudocode represents a call to the Datacore
    # Returns a DataFrame with columns: ['date', 'close', 'eps', 'debt', 'equity']
    pass

# Calculation of Trailing P/E
df['trailing_pe'] = df['close'] / df['eps_ttm']
```

### Shiller CAPE 

The Shiller CAPE requires a more sophisticated approach, involving the merging of earnings data with monthly CPI series.

```{python}
#| eval: false
#| include: false
# Assuming cpi_df contains GSO monthly CPI data
def calculate_cape(df, cpi_df):
    df = pd.merge(df, cpi_df, on='date', how='left')
    # Inflation adjust earnings
    latest_cpi = cpi_df['cpi'].iloc[-1]
    df['real_eps'] = df['eps'] * (latest_cpi / df['cpi'])
    # 10-year rolling average
    df['avg_eps_10y'] = df['real_eps'].rolling(window=120).mean()
    df['shiller_pe'] = df['close'] / df['avg_eps_10y']
    return df
```

```{python}
#| eval: false
#| include: false
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from datetime import datetime

# Assuming your data is already loaded as dataframes:
# df_pe: contains columns for date/year_quarter and the different P/E metrics
# Expected columns: 'year_quarter', 'shiller_long_term_pe', 'pe_trailing_12m', 
#                   'unlevered_pe_trailing_12m', 'forward_pe'
# For sectors: 'year_quarter', 'median_pe_energy', 'median_pe_financials', 'median_pe_infotech'

# ============================================================================
# PLOT 1: Various types of P/E Ratio for VNI ("P/E>0" method)
# ============================================================================

fig, ax = plt.subplots(figsize=(12, 7))

# Plot each P/E series
ax.plot(df_pe['year_quarter'], df_pe['shiller_long_term_pe'], 
        linewidth=2, color='#0047AB', label='Shiller Long-Term P/E')
ax.plot(df_pe['year_quarter'], df_pe['pe_trailing_12m'], 
        linewidth=2, color='#DC143C', label='P/E, Trailing 12 months')
ax.plot(df_pe['year_quarter'], df_pe['unlevered_pe_trailing_12m'], 
        linewidth=2, color='#20B2AA', label='Unlevered P/E, Trailing 12 month')
ax.plot(df_pe['year_quarter'], df_pe['forward_pe'], 
        linewidth=2, color='#8B7355', label='Forward P/E')

# Formatting
ax.set_xlabel('Year-Quarter', fontsize=11)
ax.set_ylabel('Value of P/E', fontsize=11)
ax.set_title('Various types of P/E Ratio for S&P 500 ("P/E>0" method)', fontsize=12, fontweight='bold')
ax.legend(loc='upper left', fontsize=10, frameon=True)
ax.grid(True, alpha=0.3)
ax.set_ylim(bottom=0, top=50)

# Rotate x-axis labels for readability
plt.xticks(rotation=45, ha='right')
plt.tight_layout()
plt.savefig('pe_ratios_comparison.png', dpi=300, bbox_inches='tight')
plt.show()

# ============================================================================
# PLOT 2: Median Shiller's P/E Ratio for sample sectors
# ============================================================================

fig, ax = plt.subplots(figsize=(12, 7))

# Plot each sector
ax.plot(df_sectors['year_quarter'], df_sectors['median_pe_energy'], 
        linewidth=2, color='#0047AB', label='Median P/E for Energy')
ax.plot(df_sectors['year_quarter'], df_sectors['median_pe_financials'], 
        linewidth=2, color='#DC143C', label='Median P/E for Financials')
ax.plot(df_sectors['year_quarter'], df_sectors['median_pe_infotech'], 
        linewidth=2, color='#20B2AA', label='Median P/E for InformationTech')

# Formatting
ax.set_xlabel('Year-Quarter', fontsize=11)
ax.set_ylabel('P/E Ratio', fontsize=11)
ax.set_title("Median Shiller's P/E Ratio for sample S&P sectors", fontsize=12, fontweight='bold')
ax.legend(loc='upper left', fontsize=10, frameon=True)
ax.grid(True, alpha=0.3)
ax.set_ylim(bottom=0, top=40)

# Rotate x-axis labels for readability
plt.xticks(rotation=45, ha='right')
plt.tight_layout()
plt.savefig('sector_pe_ratios.png', dpi=300, bbox_inches='tight')
plt.show()

# ============================================================================
# OPTIONAL: Helper function to calculate Shiller P/E from raw data
# ============================================================================

def calculate_shiller_pe(df, price_col, earnings_col, window=10):
    """
    Calculate Shiller P/E ratio (CAPE - Cyclically Adjusted P/E)
    
    Parameters:
    -----------
    df : pandas DataFrame
        Input data with price and earnings columns
    price_col : str
        Column name for stock prices
    earnings_col : str
        Column name for earnings
    window : int
        Number of years for averaging earnings (default 10)
    
    Returns:
    --------
    pandas Series
        Shiller P/E ratio
    """
    # Calculate real earnings (inflation-adjusted, if needed)
    rolling_earnings = df[earnings_col].rolling(window=window*4).mean()  # 4 quarters per year
    
    # Calculate Shiller P/E
    shiller_pe = df[price_col] / rolling_earnings
    
    return shiller_pe


def calculate_pe_filtering_negatives(df, price_col, earnings_col, window=4):
    """
    Calculate P/E ratio excluding negative earnings (method 2)
    
    Parameters:
    -----------
    df : pandas DataFrame
        Input data
    price_col : str
        Column name for stock prices
    earnings_col : str
        Column name for earnings
    window : int
        Rolling window for averaging (in quarters)
    
    Returns:
    --------
    pandas Series
        P/E ratio with negative earnings excluded
    """
    # Create a copy to avoid modifying original
    df_calc = df.copy()
    
    # Set negative earnings to NaN
    df_calc.loc[df_calc[earnings_col] <= 0, earnings_col] = np.nan
    
    # Calculate rolling mean (excluding NaNs)
    rolling_earnings = df_calc[earnings_col].rolling(window=window, min_periods=1).mean()
    
    # Calculate P/E
    pe_ratio = df_calc[price_col] / rolling_earnings
    
    return pe_ratio


# ============================================================================
# OPTIONAL: Example data structure and usage
# ============================================================================

# If you need to load data from a CSV file:
# df_pe = pd.read_csv('your_pe_data.csv', parse_dates=['year_quarter'])
# df_sectors = pd.read_csv('your_sector_data.csv', parse_dates=['year_quarter'])

# If you're calculating from raw price and earnings data:
# df_pe['shiller_long_term_pe'] = calculate_shiller_pe(df_pe, 'vni_price', 'vni_earnings_10yr_avg')
# df_pe['pe_trailing_12m'] = calculate_pe_filtering_negatives(df_pe, 'vni_price', 'vni_earnings_12m')
```

## Macroeconomic and Regulatory Factors in Valuation

The P/E ratio does not exist in a vacuum; it is deeply influenced by the macroeconomic environment and the regulatory framework within which companies operate.

### The Role of Corporate Income Tax (CIT)

The earnings component of the P/E ratio is a post-tax metric. In Vietnam, the standard CIT rate is 20%. However, there is a significant shift occurring with the ratification of the new Law on CIT in June 2025, taking effect on October 1, 2025. This law introduces:

-   A 15% rate for enterprises with annual revenue not exceeding 3 billion VND.

-   A 17% rate for enterprises with revenue between 3 and 50 billion VND.

-   The maintenance of higher rates (up to 50%) for the oil, gas, and mineral resource sectors.

Furthermore, Vietnam has adopted the Global Minimum Tax (GMT) rules under Pillar Two, effective January 1, 2024, to protect its tax revenue from inbound and outbound investments. These changes mean that historical P/E ratios may not be directly comparable to future ratios for companies that previously benefited from generous tax incentives, as the effective tax rate is likely to rise for large multinational subsidiaries operating in Vietnam.

### Macroeconomic Determinants: Inflation and Interest Rates

Stock price indices, and by extension P/E ratios, are heavily influenced by fundamental macroeconomic factors such as inflation, exchange rates, and interest rates. The interest rate serves as the cost of capital for enterprises. When interest rates fall, the cost of borrowing drops, increasing corporate profits and potentially raising the P/E that investors are willing to pay.

The Vietnamese dong (VND) exchange rate also plays a crucial role. In early 2025, the VND depreciated by 1.33% YTD, reflecting volatility in the timeline for Federal Reserve rate cuts. Exchange rate depreciation can be inflationary by default, which may prompt the State Bank of Vietnam to tighten monetary policy, thereby putting downward pressure on equity valuations.


## Synthesis of Valuation Dynamics

The Vietnamese equity market is currently in a state of transition. While the market has seen robust growth—the VN-Index rose 38% in the year leading up to early 2026—investors remain neutral on overall valuations, as reflected by the market's alignment with its 3-year average P/E of 14.8x. This neutrality suggests that investors expect earnings growth (forecast at 14% annually) to keep pace with price appreciation.

The reliability of these valuations, however, remains dependent on the quality of non-financial disclosure. While companies are increasingly required by law to provide non-financial information, the level of transparency remains at a medium level (approximately 58.5% of required disclosures). Researchers must therefore balance quantitative P/E analysis with qualitative assessments of corporate governance and sustainability strategies. Companies that effectively integrate ESG principles have been shown to experience fewer negative impacts on abnormal stock returns during uncertain periods, such as the COVID-19 pandemic.



## Conclusions 

The exploration of P/E ratio valuation and aggregation within the Vietnamese equity market reveals a sophisticated landscape where traditional metrics must be adapted to local realities. The reliance on trailing metrics, while common, fails to account for the cyclicality and high inflation history of the Vietnamese economy, a gap that the Shiller CAPE ratio effectively bridges through CPI-adjusted normalization. Furthermore, the sensitivity of P/E to capital structure, as defined in the Leibowitz framework, highlights the necessity of unlevered valuation metrics in a market with diverse corporate funding models.

The aggregation of these metrics into market-level indices like the VN-Index and VN30 requires an awareness of concentration risks and the importance of free-float adjustments. The "Vingroup Effect" demonstrates how a single corporate ecosystem can skew index-wide valuations, necessitating a "closet indexing" awareness for fund managers and researchers.

Looking forward, the evolution of the regulatory environment—specifically the CIT law of 2025 and the Global Minimum Tax—will introduce new variables into the valuation equation. The shift toward higher-quality non-financial disclosures and the increasing accuracy of analyst forecasts in institutionalized firms suggest that the Vietnamese equity market is steadily maturing, offering a more transparent and predictable environment for the application of advanced quantitative valuation techniques.