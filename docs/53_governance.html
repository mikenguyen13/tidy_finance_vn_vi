<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>30&nbsp; Corporate Governance – Applying Tidy Finance with Python to Vietnam</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./54_return_gaps.html" rel="next">
<link href="./52_institutional_trade_flow.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-50a4fa9e9ef121803c2355a2deb1af4d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d8431037eefe704a1e7a103aa5b75ea7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-50a4fa9e9ef121803c2355a2deb1af4d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="30&nbsp; Corporate Governance – Applying Tidy Finance with Python to Vietnam">
<meta property="og:description" content="">
<meta property="og:site_name" content="Applying Tidy Finance with Python to Vietnam">
<meta name="twitter:title" content="30&nbsp; Corporate Governance – Applying Tidy Finance with Python to Vietnam">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./50_institutional_ownership.html">Ownership, Market Frictions, and International Exposure</a></li><li class="breadcrumb-item"><a href="./53_governance.html"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Corporate Governance</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applying Tidy Finance with Python to Vietnam</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/mikenguyen13/tidy_finance_vn" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Vietnam Financial Markets, Institutions, and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_institutional_background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Institutional Background and Market Structure of Vietnam’s Equity Market</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_accessing_and_managing_financial_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Accessing and Managing VN Financial Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_datacore_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Datacore Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_market_microstructure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Market Microstructure in Vietnam</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_risk_free_rate_construction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Risk-Free Rate Construction in Vietnam</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_working_with_stock_returns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Constructing and Analyzing Equity Return Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_compound_return.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Compound Returns</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Portfolio Construction, Risk, and Empirical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_modern_portfolio_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modern Portfolio Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_univariate_portfolio_sort.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Univariate Portfolio Sorts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_size_sorts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Size Sorts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_value_bivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Value and Bivariate Sorts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_portfolio_weighting_and_rebalancing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Portfolio Weighting and Rebalancing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_beta_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Beta Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Asset Pricing Models and Cross-Sectional Tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_capm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">The Capital Asset Pricing Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_fama_french.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fama-French Factors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_momentum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Momentum Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24_fama_macbeth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Fama-MacBeth Regressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Firm Fundamentals, Valuation, and Corporate Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30_financial_statement_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Financial Statement Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31_discounted_cash_flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Discounted Cash Flow Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32_info_earnings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Information Content of Earnings Announcements</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33_accruals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Accruals, Earnings Persistence, and Market Efficiency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34_earning_management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Earnings Management: Detection and Measurement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./35_pe_ratio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">P/E Ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./36_valuation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Firm Valuation, Financial Distress, and Company Maturity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./37_disclosure_quality_and_timing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Disclosure Quality and Timing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./38_sue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Standardized Earnings Surprises (SUE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./39_divop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Measuring Divergence of Investor Opinion</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Ownership, Market Frictions, and International Exposure</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./50_institutional_ownership.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Institutional Ownership Analytics in Vietnam</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./52_institutional_trade_flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Institutional Trades, Flows, and Turnover Ratios</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./53_governance.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Corporate Governance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./54_return_gaps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Return Gap: Measuring Unobserved Actions of Fund Managers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Data, Research Design, and Frontiers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./60_textual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Textual Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./65_event_studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Event Studies in Finance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99_conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#theoretical-background" id="toc-theoretical-background" class="nav-link active" data-scroll-target="#theoretical-background"><span class="header-section-number">30.1</span> Theoretical Background</a>
  <ul class="collapse">
  <li><a href="#the-governance-return-nexus" id="toc-the-governance-return-nexus" class="nav-link" data-scroll-target="#the-governance-return-nexus"><span class="header-section-number">30.1.1</span> The Governance-Return Nexus</a></li>
  <li><a href="#adapting-the-framework-to-vietnam" id="toc-adapting-the-framework-to-vietnam" class="nav-link" data-scroll-target="#adapting-the-framework-to-vietnam"><span class="header-section-number">30.1.2</span> Adapting the Framework to Vietnam</a></li>
  <li><a href="#the-vietnamese-governance-index-vn-gindex" id="toc-the-vietnamese-governance-index-vn-gindex" class="nav-link" data-scroll-target="#the-vietnamese-governance-index-vn-gindex"><span class="header-section-number">30.1.3</span> The Vietnamese Governance Index (VN-GIndex)</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">30.2</span> Data Preparation</a>
  <ul class="collapse">
  <li><a href="#loading-governance-data" id="toc-loading-governance-data" class="nav-link" data-scroll-target="#loading-governance-data"><span class="header-section-number">30.2.1</span> Loading Governance Data</a></li>
  <li><a href="#computing-the-vn-gindex" id="toc-computing-the-vn-gindex" class="nav-link" data-scroll-target="#computing-the-vn-gindex"><span class="header-section-number">30.2.2</span> Computing the VN-GIndex</a></li>
  <li><a href="#distribution-of-the-vn-gindex" id="toc-distribution-of-the-vn-gindex" class="nav-link" data-scroll-target="#distribution-of-the-vn-gindex"><span class="header-section-number">30.2.3</span> Distribution of the VN-GIndex</a></li>
  <li><a href="#classifying-firms-democracy-neutral-and-dictatorship" id="toc-classifying-firms-democracy-neutral-and-dictatorship" class="nav-link" data-scroll-target="#classifying-firms-democracy-neutral-and-dictatorship"><span class="header-section-number">30.2.4</span> Classifying Firms: Democracy, Neutral, and Dictatorship</a></li>
  <li><a href="#loading-stock-market-data" id="toc-loading-stock-market-data" class="nav-link" data-scroll-target="#loading-stock-market-data"><span class="header-section-number">30.2.5</span> Loading Stock Market Data</a></li>
  <li><a href="#linking-governance-and-stock-data" id="toc-linking-governance-and-stock-data" class="nav-link" data-scroll-target="#linking-governance-and-stock-data"><span class="header-section-number">30.2.6</span> Linking Governance and Stock Data</a></li>
  <li><a href="#computing-lagged-market-capitalization-for-weighting" id="toc-computing-lagged-market-capitalization-for-weighting" class="nav-link" data-scroll-target="#computing-lagged-market-capitalization-for-weighting"><span class="header-section-number">30.2.7</span> Computing Lagged Market Capitalization for Weighting</a></li>
  </ul></li>
  <li><a href="#portfolio-construction" id="toc-portfolio-construction" class="nav-link" data-scroll-target="#portfolio-construction"><span class="header-section-number">30.3</span> Portfolio Construction</a>
  <ul class="collapse">
  <li><a href="#value-weighted-portfolio-returns" id="toc-value-weighted-portfolio-returns" class="nav-link" data-scroll-target="#value-weighted-portfolio-returns"><span class="header-section-number">30.3.1</span> Value-Weighted Portfolio Returns</a></li>
  <li><a href="#long-short-portfolio-democracy-minus-dictatorship" id="toc-long-short-portfolio-democracy-minus-dictatorship" class="nav-link" data-scroll-target="#long-short-portfolio-democracy-minus-dictatorship"><span class="header-section-number">30.3.2</span> Long-Short Portfolio: Democracy minus Dictatorship</a></li>
  <li><a href="#portfolio-characteristics-over-time" id="toc-portfolio-characteristics-over-time" class="nav-link" data-scroll-target="#portfolio-characteristics-over-time"><span class="header-section-number">30.3.3</span> Portfolio Characteristics Over Time</a></li>
  </ul></li>
  <li><a href="#empirical-results" id="toc-empirical-results" class="nav-link" data-scroll-target="#empirical-results"><span class="header-section-number">30.4</span> Empirical Results</a>
  <ul class="collapse">
  <li><a href="#summary-statistics-of-portfolio-returns" id="toc-summary-statistics-of-portfolio-returns" class="nav-link" data-scroll-target="#summary-statistics-of-portfolio-returns"><span class="header-section-number">30.4.1</span> Summary Statistics of Portfolio Returns</a></li>
  <li><a href="#t-test-is-the-long-short-return-statistically-significant" id="toc-t-test-is-the-long-short-return-statistically-significant" class="nav-link" data-scroll-target="#t-test-is-the-long-short-return-statistically-significant"><span class="header-section-number">30.4.2</span> T-Test: Is the Long-Short Return Statistically Significant?</a></li>
  <li><a href="#cumulative-returns-the-visual-case-for-governance" id="toc-cumulative-returns-the-visual-case-for-governance" class="nav-link" data-scroll-target="#cumulative-returns-the-visual-case-for-governance"><span class="header-section-number">30.4.3</span> Cumulative Returns: The Visual Case for Governance</a></li>
  <li><a href="#rolling-performance" id="toc-rolling-performance" class="nav-link" data-scroll-target="#rolling-performance"><span class="header-section-number">30.4.4</span> Rolling Performance</a></li>
  </ul></li>
  <li><a href="#risk-adjusted-performance-factor-model-analysis" id="toc-risk-adjusted-performance-factor-model-analysis" class="nav-link" data-scroll-target="#risk-adjusted-performance-factor-model-analysis"><span class="header-section-number">30.5</span> Risk-Adjusted Performance: Factor Model Analysis</a>
  <ul class="collapse">
  <li><a href="#the-four-factor-model" id="toc-the-four-factor-model" class="nav-link" data-scroll-target="#the-four-factor-model"><span class="header-section-number">30.5.1</span> The Four-Factor Model</a></li>
  <li><a href="#loading-factor-data" id="toc-loading-factor-data" class="nav-link" data-scroll-target="#loading-factor-data"><span class="header-section-number">30.5.2</span> Loading Factor Data</a></li>
  <li><a href="#merging-portfolio-returns-with-factor-data" id="toc-merging-portfolio-returns-with-factor-data" class="nav-link" data-scroll-target="#merging-portfolio-returns-with-factor-data"><span class="header-section-number">30.5.3</span> Merging Portfolio Returns with Factor Data</a></li>
  <li><a href="#capm-regression" id="toc-capm-regression" class="nav-link" data-scroll-target="#capm-regression"><span class="header-section-number">30.5.4</span> CAPM Regression</a></li>
  <li><a href="#three-factor-fama-french-model" id="toc-three-factor-fama-french-model" class="nav-link" data-scroll-target="#three-factor-fama-french-model"><span class="header-section-number">30.5.5</span> Three-Factor Fama-French Model</a></li>
  <li><a href="#four-factor-carhart-model" id="toc-four-factor-carhart-model" class="nav-link" data-scroll-target="#four-factor-carhart-model"><span class="header-section-number">30.5.6</span> Four-Factor Carhart Model</a></li>
  <li><a href="#interpreting-the-factor-loadings" id="toc-interpreting-the-factor-loadings" class="nav-link" data-scroll-target="#interpreting-the-factor-loadings"><span class="header-section-number">30.5.7</span> Interpreting the Factor Loadings</a></li>
  <li><a href="#robustness-white-heteroskedasticity-consistent-standard-errors" id="toc-robustness-white-heteroskedasticity-consistent-standard-errors" class="nav-link" data-scroll-target="#robustness-white-heteroskedasticity-consistent-standard-errors"><span class="header-section-number">30.5.8</span> Robustness: White Heteroskedasticity-Consistent Standard Errors</a></li>
  </ul></li>
  <li><a href="#deeper-analysis" id="toc-deeper-analysis" class="nav-link" data-scroll-target="#deeper-analysis"><span class="header-section-number">30.6</span> Deeper Analysis</a>
  <ul class="collapse">
  <li><a href="#governance-quintile-portfolios" id="toc-governance-quintile-portfolios" class="nav-link" data-scroll-target="#governance-quintile-portfolios"><span class="header-section-number">30.6.1</span> Governance Quintile Portfolios</a></li>
  <li><a href="#subsample-analysis" id="toc-subsample-analysis" class="nav-link" data-scroll-target="#subsample-analysis"><span class="header-section-number">30.6.2</span> Subsample Analysis</a></li>
  <li><a href="#equal-weighted-robustness" id="toc-equal-weighted-robustness" class="nav-link" data-scroll-target="#equal-weighted-robustness"><span class="header-section-number">30.6.3</span> Equal-Weighted Robustness</a></li>
  <li><a href="#factor-loading-stability-rolling-regressions" id="toc-factor-loading-stability-rolling-regressions" class="nav-link" data-scroll-target="#factor-loading-stability-rolling-regressions"><span class="header-section-number">30.6.4</span> Factor Loading Stability: Rolling Regressions</a></li>
  </ul></li>
  <li><a href="#comparison-with-international-evidence" id="toc-comparison-with-international-evidence" class="nav-link" data-scroll-target="#comparison-with-international-evidence"><span class="header-section-number">30.7</span> Comparison with International Evidence</a>
  <ul class="collapse">
  <li><a href="#the-us-experience" id="toc-the-us-experience" class="nav-link" data-scroll-target="#the-us-experience"><span class="header-section-number">30.7.1</span> The US Experience</a></li>
  <li><a href="#emerging-market-context" id="toc-emerging-market-context" class="nav-link" data-scroll-target="#emerging-market-context"><span class="header-section-number">30.7.2</span> Emerging Market Context</a></li>
  </ul></li>
  <li><a href="#drawdown-and-risk-analysis" id="toc-drawdown-and-risk-analysis" class="nav-link" data-scroll-target="#drawdown-and-risk-analysis"><span class="header-section-number">30.8</span> Drawdown and Risk Analysis</a>
  <ul class="collapse">
  <li><a href="#maximum-drawdown" id="toc-maximum-drawdown" class="nav-link" data-scroll-target="#maximum-drawdown"><span class="header-section-number">30.8.1</span> Maximum Drawdown</a></li>
  </ul></li>
  <li><a href="#discussion-and-interpretation" id="toc-discussion-and-interpretation" class="nav-link" data-scroll-target="#discussion-and-interpretation"><span class="header-section-number">30.9</span> Discussion and Interpretation</a>
  <ul class="collapse">
  <li><a href="#why-might-governance-predict-returns-in-vietnam" id="toc-why-might-governance-predict-returns-in-vietnam" class="nav-link" data-scroll-target="#why-might-governance-predict-returns-in-vietnam"><span class="header-section-number">30.9.1</span> Why Might Governance Predict Returns in Vietnam?</a></li>
  <li><a href="#state-ownership-and-the-governance-effect" id="toc-state-ownership-and-the-governance-effect" class="nav-link" data-scroll-target="#state-ownership-and-the-governance-effect"><span class="header-section-number">30.9.2</span> State Ownership and the Governance Effect</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">30.9.3</span> Limitations</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">30.10</span> Exercises</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">30.11</span> Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/edit/main/53_governance.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./50_institutional_ownership.html">Ownership, Market Frictions, and International Exposure</a></li><li class="breadcrumb-item"><a href="./53_governance.html"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Corporate Governance</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Corporate Governance</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Corporate governance (i.e., the system of rules, practices, and processes by which firms are directed and controlled) has been one of the most actively studied determinants of equity returns since the early 2000s. The insight is simple yet powerful: firms that grant shareholders stronger rights tend to outperform firms in which management is entrenched by anti-takeover provisions. This chapter applies that insight to the Vietnamese market, where governance quality varies considerably across listed firms and institutional development remains evolving.</p>
<section id="theoretical-background" class="level2" data-number="30.1">
<h2 data-number="30.1" class="anchored" data-anchor-id="theoretical-background"><span class="header-section-number">30.1</span> Theoretical Background</h2>
<section id="the-governance-return-nexus" class="level3" data-number="30.1.1">
<h3 data-number="30.1.1" class="anchored" data-anchor-id="the-governance-return-nexus"><span class="header-section-number">30.1.1</span> The Governance-Return Nexus</h3>
<p>The theoretical motivation for a link between corporate governance and stock returns rests on agency theory <span class="citation" data-cites="jensen1976theory">(<a href="references.html#ref-jensen1976theory" role="doc-biblioref">Jensen and Meckling 1976</a>)</span>. Managers, as agents of shareholders, may pursue private benefits at the expense of firm value. Anti-takeover provisions, staggered boards, poison pills, and other defensive mechanisms insulate management from the disciplining force of the market for corporate control. When shareholders cannot easily replace underperforming managers, agency costs rise, investment efficiency falls, and firm value declines.</p>
<p><span class="citation" data-cites="gompers2003corporate">Gompers, Ishii, and Metrick (<a href="references.html#ref-gompers2003corporate" role="doc-biblioref">2003</a>)</span> formalized this intuition by constructing a <strong>Governance Index (G-Index)</strong> based on 24 governance provisions tracked by the Investor Responsibility Research Center (IRRC) in the United States. Each provision that restricts shareholder rights increments the index by one. Thus:</p>
<p><span id="eq-gindex-definition"><span class="math display">\[
G\text{-Index}_i = \sum_{k=1}^{24} \mathbf{1}\{\text{Provision } k \text{ is present for firm } i\}
\tag{30.1}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{1}\{\cdot\}\)</span> is the indicator function. Higher values of the G-Index correspond to weaker shareholder rights.</p>
<p>The key empirical finding was striking: during the 1990s, a portfolio that bought firms with the strongest shareholder rights (G-Index <span class="math inline">\(\leq 5\)</span>, labeled the <strong>Democracy Portfolio</strong>) and sold firms with the weakest shareholder rights (G-Index <span class="math inline">\(\geq 14\)</span>, labeled the <strong>Dictatorship Portfolio</strong>) earned an abnormal return of approximately 8.5% per year.</p>
</section>
<section id="adapting-the-framework-to-vietnam" class="level3" data-number="30.1.2">
<h3 data-number="30.1.2" class="anchored" data-anchor-id="adapting-the-framework-to-vietnam"><span class="header-section-number">30.1.2</span> Adapting the Framework to Vietnam</h3>
<p>Vietnam’s corporate governance landscape differs fundamentally from that of the United States. The Vietnamese market is characterized by:</p>
<ol type="1">
<li><p><strong>State ownership</strong>: Many listed firms retain significant government ownership stakes, which creates a distinct agency problem where the state acts as a controlling shareholder rather than dispersed minority shareholders facing entrenched management.</p></li>
<li><p><strong>Concentrated ownership</strong>: Family and controlling-group ownership is prevalent, shifting the primary agency conflict from manager-shareholder to controlling-majority vs.&nbsp;minority shareholders <span class="citation" data-cites="claessens2000separation">(<a href="references.html#ref-claessens2000separation" role="doc-biblioref">Claessens, Djankov, and Lang 2000</a>)</span>.</p></li>
<li><p><strong>Evolving legal framework</strong>: Vietnam’s corporate governance code has been progressively strengthened through Decree 71/2017/ND-CP and subsequent circulars, but enforcement remains uneven.</p></li>
<li><p><strong>Dual listing and foreign ownership caps</strong>: Foreign ownership limits create segmented investor bases with potentially different governance preferences.</p></li>
</ol>
<p>Despite these differences, the core economic logic applies: firms with better governance (i.e., greater board independence, stronger audit committees, more transparent disclosure, better minority shareholder protections) should command higher valuations and deliver superior risk-adjusted returns, all else equal.</p>
<p>For the Vietnamese market, we construct a governance index analogous to the G-Index using governance provisions. While the specific provisions differ from the 24 IRRC items used in the US context, the methodology is identical: count the number of provisions that restrict shareholder rights or entrench management.</p>
</section>
<section id="the-vietnamese-governance-index-vn-gindex" class="level3" data-number="30.1.3">
<h3 data-number="30.1.3" class="anchored" data-anchor-id="the-vietnamese-governance-index-vn-gindex"><span class="header-section-number">30.1.3</span> The Vietnamese Governance Index (VN-GIndex)</h3>
<p>We define the Vietnamese Governance Index based on the following categories of provisions (<a href="#tbl-gindex-categories" class="quarto-xref">Table&nbsp;<span>30.1</span></a>)</p>
<div id="tbl-gindex-categories" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gindex-categories-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.1: Categories of governance provisions for the VN-GIndex
</figcaption>
<div aria-describedby="tbl-gindex-categories-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th>Category</th>
<th>Provisions</th>
<th>Direction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Board Structure</td>
<td>Staggered board, CEO duality, board size &lt; 5</td>
<td>↑ restricts rights</td>
</tr>
<tr class="even">
<td>Ownership</td>
<td>State ownership &gt; 50%, no independent directors</td>
<td>↑ restricts rights</td>
</tr>
<tr class="odd">
<td>Shareholder Rights</td>
<td>Supermajority requirements, limited voting rights</td>
<td>↑ restricts rights</td>
</tr>
<tr class="even">
<td>Transparency</td>
<td>No English-language annual report, delayed filings</td>
<td>↑ restricts rights</td>
</tr>
<tr class="odd">
<td>Anti-takeover</td>
<td>Poison pill equivalents, golden parachutes</td>
<td>↑ restricts rights</td>
</tr>
<tr class="even">
<td>Audit</td>
<td>No independent audit committee, related-party auditor</td>
<td>↑ restricts rights</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The VN-GIndex for firm <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> is:</p>
<p><span id="eq-vngindex"><span class="math display">\[
\text{VN-GIndex}_{i,t} = \sum_{k=1}^{K} \mathbf{1}\{\text{Provision } k \text{ is present for firm } i \text{ at time } t\}
\tag{30.2}\]</span></span></p>
<p>where <span class="math inline">\(K\)</span> is the total number of governance provisions tracked. Higher values indicate weaker governance.</p>
</section>
</section>
<section id="data-preparation" class="level2" data-number="30.2">
<h2 data-number="30.2" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">30.2</span> Data Preparation</h2>
<p>We use three primary datasets:</p>
<ol type="1">
<li><strong>Governance data</strong>: Firm-level governance provisions, updated annually or when material changes occur.</li>
<li><strong>Stock market data</strong>: Monthly returns, prices, and shares outstanding for all firms listed on HOSE and HNX.</li>
<li><strong>Factor data</strong>: Vietnamese Fama-French factors (market, size, value) and a momentum factor.</li>
</ol>
<div id="46c35c98" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.regression.linear_model <span class="im">import</span> OLS</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>pd.options.display.float_format <span class="op">=</span> <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>tidy_finance <span class="op">=</span> sqlite3.<span class="ex">connect</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    database<span class="op">=</span><span class="st">"data/tidy_finance_python.sqlite"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="loading-governance-data" class="level3" data-number="30.2.1">
<h3 data-number="30.2.1" class="anchored" data-anchor-id="loading-governance-data"><span class="header-section-number">30.2.1</span> Loading Governance Data</h3>
<p>The governance dataset contains firm-level governance characteristics. Each observation corresponds to a firm-year, with binary indicators for the presence of each governance provision.</p>
<div id="load-governance" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>governance_raw <span class="op">=</span> pd.read_csv(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/datacore_governance.csv"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>[<span class="st">"date_effective"</span>, <span class="st">"date_expires"</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>governance_raw.info()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-governance-head" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="3">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-governance-head-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.2: First observations of the governance dataset
</figcaption>
<div aria-describedby="tbl-governance-head-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>governance_raw.head(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<p>The key variables are:</p>
<ul>
<li><code>symbol</code>: The stock symbol on HOSE or HNX.</li>
<li><code>date_effective</code>: The date when the governance data became effective (analogous to the rebalancing date).</li>
<li><code>date_expires</code>: The last date for which this governance vintage is valid.</li>
<li><code>year</code>: The governance data vintage year.</li>
</ul>
</section>
<section id="computing-the-vn-gindex" class="level3" data-number="30.2.2">
<h3 data-number="30.2.2" class="anchored" data-anchor-id="computing-the-vn-gindex"><span class="header-section-number">30.2.2</span> Computing the VN-GIndex</h3>
<p>We compute the governance index by summing the binary indicators of governance provision. The provision columns are identified by the prefix <code>gov_</code>.</p>
<div id="compute-gindex" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify governance provision columns</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>gov_columns <span class="op">=</span> [</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    col <span class="cf">for</span> col <span class="kw">in</span> governance_raw.columns <span class="cf">if</span> col.startswith(<span class="st">"gov_"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of governance provisions tracked: </span><span class="sc">{</span><span class="bu">len</span>(gov_columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Provisions: </span><span class="sc">{</span>gov_columns<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute VN-GIndex as sum of all provision indicators</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>governance <span class="op">=</span> governance_raw.assign(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    gindex<span class="op">=</span><span class="kw">lambda</span> x: x[gov_columns].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>governance[[<span class="st">"symbol"</span>, <span class="st">"year"</span>, <span class="st">"gindex"</span>]].describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="distribution-of-the-vn-gindex" class="level3" data-number="30.2.3">
<h3 data-number="30.2.3" class="anchored" data-anchor-id="distribution-of-the-vn-gindex"><span class="header-section-number">30.2.3</span> Distribution of the VN-GIndex</h3>
<p>Understanding the cross-sectional distribution of the governance index is essential for defining portfolio cutoffs. In the US, <span class="citation" data-cites="gompers2003corporate">Gompers, Ishii, and Metrick (<a href="references.html#ref-gompers2003corporate" role="doc-biblioref">2003</a>)</span> used fixed cutoffs of <span class="math inline">\(\leq 5\)</span> for Democracy and <span class="math inline">\(\geq 14\)</span> for Dictatorship. For Vietnam, we examine the empirical distribution and set cutoffs at appropriate percentiles.</p>
<div id="fig-gindex-distribution" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="5">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gindex-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>), sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="va">True</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> <span class="bu">sorted</span>(governance[<span class="st">"year"</span>].unique())</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, yr <span class="kw">in</span> <span class="bu">enumerate</span>(years[:<span class="dv">6</span>]):</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[idx]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    data_yr <span class="op">=</span> governance.query(<span class="ss">f"year == </span><span class="sc">{</span>yr<span class="sc">}</span><span class="ss">"</span>)[<span class="st">"gindex"</span>]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    p20 <span class="op">=</span> data_yr.quantile(<span class="fl">0.20</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    p80 <span class="op">=</span> data_yr.quantile(<span class="fl">0.80</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    ax.hist(data_yr, bins<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">int</span>(data_yr.<span class="bu">max</span>()) <span class="op">+</span> <span class="dv">2</span>), </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">"white"</span>, color<span class="op">=</span><span class="st">"#2c5f8a"</span>, alpha<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    ax.axvline(p20, color<span class="op">=</span><span class="st">"#d63e2a"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="ss">f"P20=</span><span class="sc">{</span>p20<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    ax.axvline(p80, color<span class="op">=</span><span class="st">"#e8a317"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="ss">f"P80=</span><span class="sc">{</span>p80<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"</span><span class="sc">{</span>yr<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    ax.legend(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"VN-GIndex"</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(years), <span class="bu">len</span>(axes)):</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    axes[idx].set_visible(<span class="va">False</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">"Number of Firms"</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_ylabel(<span class="st">"Number of Firms"</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>fig.suptitle(</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distribution of VN-GIndex by Governance Vintage Year"</span>,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>, y<span class="op">=</span><span class="fl">1.01</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-gindex-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30.1
</figcaption>
</figure>
</div>
<div id="tbl-gindex-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="6">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gindex-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.3: Summary statistics of the VN-GIndex by vintage year
</figcaption>
<div aria-describedby="tbl-gindex-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>gindex_summary <span class="op">=</span> (</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    governance</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"year"</span>)[<span class="st">"gindex"</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    .describe()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>gindex_summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="classifying-firms-democracy-neutral-and-dictatorship" class="level3" data-number="30.2.4">
<h3 data-number="30.2.4" class="anchored" data-anchor-id="classifying-firms-democracy-neutral-and-dictatorship"><span class="header-section-number">30.2.4</span> Classifying Firms: Democracy, Neutral, and Dictatorship</h3>
<p>Rather than using fixed cutoffs (which may be inappropriate given varying index ranges across markets), we use percentile-based classification. Firms in the bottom quintile of the VN-GIndex distribution within each vintage year are classified as <strong>Democracy</strong> firms, and firms in the top quintile are classified as <strong>Dictatorship</strong> firms.</p>
<div id="classify-firms" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classify_governance(group):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Classify firms into Democracy, Neutral, or Dictatorship</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">    within each governance vintage year."""</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    p20 <span class="op">=</span> group[<span class="st">"gindex"</span>].quantile(<span class="fl">0.20</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    p80 <span class="op">=</span> group[<span class="st">"gindex"</span>].quantile(<span class="fl">0.80</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    conditions <span class="op">=</span> [</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        group[<span class="st">"gindex"</span>] <span class="op">&lt;=</span> p20,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        group[<span class="st">"gindex"</span>] <span class="op">&gt;=</span> p80</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    choices <span class="op">=</span> [<span class="st">"Democracy"</span>, <span class="st">"Dictatorship"</span>]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> group.assign(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        gx<span class="op">=</span>np.select(conditions, choices, default<span class="op">=</span><span class="st">"Neutral"</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        gx_code<span class="op">=</span>np.select(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>            conditions, [<span class="dv">1</span>, <span class="dv">3</span>], default<span class="op">=</span><span class="dv">2</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>governance_classified <span class="op">=</span> (</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    governance</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"year"</span>, group_keys<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(classify_governance)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of classification</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>classification_counts <span class="op">=</span> (</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    governance_classified</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"year"</span>, <span class="st">"gx"</span>])</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    .size()</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    .unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">"Democracy"</span>, <span class="st">"Neutral"</span>, <span class="st">"Dictatorship"</span>]]</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>classification_counts</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-classification" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="8">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-classification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.4: Number of firms in each governance category by vintage year
</figcaption>
<div aria-describedby="tbl-classification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>classification_counts</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<p>We exclude firms with dual-class share structures, as these create a distinct governance arrangement that conflates voting rights with economic ownership. In the US, <span class="citation" data-cites="gompers2003corporate">Gompers, Ishii, and Metrick (<a href="references.html#ref-gompers2003corporate" role="doc-biblioref">2003</a>)</span> similarly excluded dual-class firms.</p>
<div id="exclude-dualclass" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude dual-class firms if flagged in the data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"dual_class"</span> <span class="kw">in</span> governance_classified.columns:</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    governance_classified <span class="op">=</span> governance_classified.query(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dual_class == 0"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Dual-class firms excluded."</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"No dual_class indicator found; proceeding with all firms."</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only Democracy and Dictatorship firms for the long-short strategy</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>portfolio_firms <span class="op">=</span> governance_classified.query(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gx in ['Democracy', 'Dictatorship']"</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>).copy()</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Firms in portfolio universe: </span><span class="sc">{</span><span class="bu">len</span>(portfolio_firms)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(portfolio_firms[<span class="st">"gx"</span>].value_counts())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="loading-stock-market-data" class="level3" data-number="30.2.5">
<h3 data-number="30.2.5" class="anchored" data-anchor-id="loading-stock-market-data"><span class="header-section-number">30.2.5</span> Loading Stock Market Data</h3>
<p>We merge the governance classifications with monthly stock return data.</p>
<div id="load-stock-data" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>prices_monthly <span class="op">=</span> pd.read_sql_query(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    sql<span class="op">=</span><span class="st">"""</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">        SELECT symbol, date, ret, ret_excess, mktcap, mktcap_lag, risk_free</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">        FROM prices_monthly</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    con<span class="op">=</span>tidy_finance,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>{<span class="st">"date"</span>}</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>).dropna()</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>prices_monthly.info()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.DataFrame'&gt;
Index: 165499 entries, 1 to 209477
Data columns (total 7 columns):
 #   Column      Non-Null Count   Dtype         
---  ------      --------------   -----         
 0   symbol      165499 non-null  str           
 1   date        165499 non-null  datetime64[us]
 2   ret         165499 non-null  float64       
 3   ret_excess  165499 non-null  float64       
 4   mktcap      165499 non-null  float64       
 5   mktcap_lag  165499 non-null  float64       
 6   risk_free   165499 non-null  float64       
dtypes: datetime64[us](1), float64(5), str(1)
memory usage: 10.6 MB</code></pre>
</div>
</div>
<p>The stock market data contains:</p>
<ul>
<li><code>symbol</code>: Stock symbol.</li>
<li><code>date</code>: End-of-month date.</li>
<li><code>ret</code>: Monthly total return (including dividends).</li>
<li><code>retx</code>: Monthly return excluding dividends (price return only).</li>
<li><code>price</code>: End-of-month closing price (adjusted).</li>
<li><code>shares_outstanding</code>: Number of shares outstanding (in thousands).</li>
</ul>
<div id="cell-compute-mktcap" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>prices_monthly[[<span class="st">"symbol"</span>, <span class="st">"date"</span>, <span class="st">"ret"</span>, <span class="st">"mktcap"</span>]].describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="compute-mktcap" class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">ret</th>
<th data-quarto-table-cell-role="th">mktcap</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>165499</td>
<td>165499.0000</td>
<td>165499.0000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>2018-05-18 13:20:13.109444</td>
<td>0.0042</td>
<td>2183.1646</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">min</th>
<td>2010-02-28 00:00:00</td>
<td>-0.9900</td>
<td>0.3536</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25%</th>
<td>2015-06-30 00:00:00</td>
<td>-0.0703</td>
<td>60.3728</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">50%</th>
<td>2018-12-31 00:00:00</td>
<td>0.0000</td>
<td>180.6224</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">75%</th>
<td>2021-07-31 00:00:00</td>
<td>0.0553</td>
<td>660.0000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">max</th>
<td>2023-12-31 00:00:00</td>
<td>12.7500</td>
<td>463886.6454</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">std</th>
<td>NaN</td>
<td>0.1862</td>
<td>13983.9977</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="linking-governance-and-stock-data" class="level3" data-number="30.2.6">
<h3 data-number="30.2.6" class="anchored" data-anchor-id="linking-governance-and-stock-data"><span class="header-section-number">30.2.6</span> Linking Governance and Stock Data</h3>
<p>Each governance vintage is valid from <code>date_effective</code> through <code>date_expires</code>. We assign monthly stock returns to the appropriate governance vintage. This is the portfolio rebalancing logic: portfolios are reformed when new governance data becomes available and held until the next vintage.</p>
<div id="merge-governance-stocks" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge: each stock-month gets its governance classification</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if the month falls within [date_effective, date_expires]</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    portfolio_firms[</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"symbol"</span>, <span class="st">"year"</span>, <span class="st">"gindex"</span>, <span class="st">"gx"</span>, <span class="st">"gx_code"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_effective"</span>, <span class="st">"date_expires"</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    prices_monthly[[<span class="st">"symbol"</span>, <span class="st">"date"</span>, <span class="st">"ret"</span>, <span class="st">"retx"</span>, <span class="st">"mktcap"</span>]],</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">"symbol"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only months within the governance validity window</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merged.query(</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"date &gt;= date_effective and date &lt;= date_expires"</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>).sort_values([<span class="st">"symbol"</span>, <span class="st">"date"</span>])</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total firm-month observations: </span><span class="sc">{</span><span class="bu">len</span>(merged)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>merged.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="computing-lagged-market-capitalization-for-weighting" class="level3" data-number="30.2.7">
<h3 data-number="30.2.7" class="anchored" data-anchor-id="computing-lagged-market-capitalization-for-weighting"><span class="header-section-number">30.2.7</span> Computing Lagged Market Capitalization for Weighting</h3>
<p>Value-weighted portfolio returns require weighting each stock by its beginning-of-period market capitalization. We use the previous month’s market capitalization as the weight. For the first observation of each stock in a given vintage, we estimate the beginning-of-period market value by dividing the current market value by <span class="math inline">\((1 + r_{x,t})\)</span>, where <span class="math inline">\(r_{x,t}\)</span> is the price return.</p>
<p>The value-weighted return of portfolio <span class="math inline">\(p\)</span> in month <span class="math inline">\(t\)</span> is:</p>
<p><span id="eq-vw-return"><span class="math display">\[
r_{p,t}^{vw} = \sum_{i \in p} w_{i,t-1} \cdot r_{i,t}, \quad w_{i,t-1} = \frac{\text{MV}_{i,t-1}}{\sum_{j \in p} \text{MV}_{j,t-1}}
\tag{30.3}\]</span></span></p>
<p>where <span class="math inline">\(\text{MV}_{i,t-1}\)</span> is the market capitalization of stock <span class="math inline">\(i\)</span> at the end of month <span class="math inline">\(t-1\)</span>.</p>
<div id="compute-lag-mktcap" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merged.sort_values([<span class="st">"symbol"</span>, <span class="st">"date"</span>])</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lagged market value (previous month)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>merged[<span class="st">"mktcap_lag"</span>] <span class="op">=</span> merged.groupby(<span class="st">"symbol"</span>)[<span class="st">"mktcap"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For first observation: estimate beginning-of-month market cap</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>first_obs <span class="op">=</span> merged.groupby(<span class="st">"symbol"</span>)[<span class="st">"date"</span>].transform(<span class="st">"min"</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>mask_first <span class="op">=</span> merged[<span class="st">"date"</span>] <span class="op">==</span> first_obs</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>merged.loc[mask_first, <span class="st">"mktcap_lag"</span>] <span class="op">=</span> (</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    merged.loc[mask_first, <span class="st">"mktcap"</span>] </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> merged.loc[mask_first, <span class="st">"retx"</span>])</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle any remaining missing weights</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>mask_missing <span class="op">=</span> merged[<span class="st">"mktcap_lag"</span>].isna()</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>merged.loc[mask_missing, <span class="st">"mktcap_lag"</span>] <span class="op">=</span> (</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    merged.loc[mask_missing, <span class="st">"mktcap"</span>]</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> merged.loc[mask_missing, <span class="st">"retx"</span>])</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop observations with missing returns or weights</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merged.dropna(subset<span class="op">=</span>[<span class="st">"ret"</span>, <span class="st">"mktcap_lag"</span>])</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merged.query(<span class="st">"mktcap_lag &gt; 0"</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Clean firm-month observations: </span><span class="sc">{</span><span class="bu">len</span>(merged)<span class="sc">:,}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="portfolio-construction" class="level2" data-number="30.3">
<h2 data-number="30.3" class="anchored" data-anchor-id="portfolio-construction"><span class="header-section-number">30.3</span> Portfolio Construction</h2>
<section id="value-weighted-portfolio-returns" class="level3" data-number="30.3.1">
<h3 data-number="30.3.1" class="anchored" data-anchor-id="value-weighted-portfolio-returns"><span class="header-section-number">30.3.1</span> Value-Weighted Portfolio Returns</h3>
<p>We now compute the value-weighted monthly returns for the Democracy and Dictatorship portfolios.</p>
<div id="compute-portfolio-returns" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> value_weighted_return(group):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute value-weighted return for a group of stocks."""</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> group[<span class="st">"mktcap_lag"</span>]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    total_weight <span class="op">=</span> weights.<span class="bu">sum</span>()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> total_weight <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    vw_ret <span class="op">=</span> (group[<span class="st">"ret"</span>] <span class="op">*</span> weights).<span class="bu">sum</span>() <span class="op">/</span> total_weight</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vw_ret</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute VW returns by date and governance group</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>portfolio_returns <span class="op">=</span> (</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    merged</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"date"</span>, <span class="st">"gx"</span>])</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(value_weighted_return, include_groups<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">"ret_vw"</span>})</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Also compute equal-weighted returns for robustness</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>portfolio_returns_ew <span class="op">=</span> (</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    merged</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"date"</span>, <span class="st">"gx"</span>])[<span class="st">"ret"</span>]</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    .mean()</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"ret"</span>: <span class="st">"ret_ew"</span>})</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge EW returns</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>portfolio_returns <span class="op">=</span> portfolio_returns.merge(</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    portfolio_returns_ew, on<span class="op">=</span>[<span class="st">"date"</span>, <span class="st">"gx"</span>], how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>portfolio_returns.head(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="long-short-portfolio-democracy-minus-dictatorship" class="level3" data-number="30.3.2">
<h3 data-number="30.3.2" class="anchored" data-anchor-id="long-short-portfolio-democracy-minus-dictatorship"><span class="header-section-number">30.3.2</span> Long-Short Portfolio: Democracy minus Dictatorship</h3>
<p>The trading strategy goes long the Democracy portfolio and short the Dictatorship portfolio. The monthly return of this long-short strategy is:</p>
<p><span id="eq-long-short"><span class="math display">\[
r_{t}^{D-D} = r_{t}^{\text{Democracy}} - r_{t}^{\text{Dictatorship}}
\tag{30.4}\]</span></span></p>
<div id="compute-long-short" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot to wide format</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> portfolio_returns.pivot(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"date"</span>, columns<span class="op">=</span><span class="st">"gx"</span>, values<span class="op">=</span>[<span class="st">"ret_vw"</span>, <span class="st">"ret_ew"</span>]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten column names</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>returns_wide.columns <span class="op">=</span> [</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"</span><span class="sc">{</span>val<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>grp<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> val, grp <span class="kw">in</span> returns_wide.columns</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> returns_wide.reset_index()</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute long-short returns</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> returns_wide.assign(</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    ret_diff_vw<span class="op">=</span><span class="kw">lambda</span> x: (</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        x[<span class="st">"ret_vw_Democracy"</span>] <span class="op">-</span> x[<span class="st">"ret_vw_Dictatorship"</span>]</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    ret_diff_ew<span class="op">=</span><span class="kw">lambda</span> x: (</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        x[<span class="st">"ret_ew_Democracy"</span>] <span class="op">-</span> x[<span class="st">"ret_ew_Dictatorship"</span>]</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> returns_wide.sort_values(<span class="st">"date"</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Monthly return series: </span><span class="sc">{</span><span class="bu">len</span>(returns_wide)<span class="sc">}</span><span class="ss"> months"</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>returns_wide.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="portfolio-characteristics-over-time" class="level3" data-number="30.3.3">
<h3 data-number="30.3.3" class="anchored" data-anchor-id="portfolio-characteristics-over-time"><span class="header-section-number">30.3.3</span> Portfolio Characteristics Over Time</h3>
<p>Before examining returns, we document the number of firms and average governance scores in each portfolio over time.</p>
<div id="tbl-portfolio-chars" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="16">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-portfolio-chars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.5: Portfolio characteristics by governance group and year
</figcaption>
<div aria-describedby="tbl-portfolio-chars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>portfolio_chars <span class="op">=</span> (</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    merged</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    .assign(year_month<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"date"</span>].dt.to_period(<span class="st">"Y"</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"year_month"</span>, <span class="st">"gx"</span>])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        n_firms<span class="op">=</span>(<span class="st">"symbol"</span>, <span class="st">"nunique"</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        avg_gindex<span class="op">=</span>(<span class="st">"gindex"</span>, <span class="st">"mean"</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        avg_mktcap<span class="op">=</span>(<span class="st">"mktcap"</span>, <span class="st">"mean"</span>),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        median_mktcap<span class="op">=</span>(<span class="st">"mktcap"</span>, <span class="st">"median"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>portfolio_chars</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
</section>
<section id="empirical-results" class="level2" data-number="30.4">
<h2 data-number="30.4" class="anchored" data-anchor-id="empirical-results"><span class="header-section-number">30.4</span> Empirical Results</h2>
<section id="summary-statistics-of-portfolio-returns" class="level3" data-number="30.4.1">
<h3 data-number="30.4.1" class="anchored" data-anchor-id="summary-statistics-of-portfolio-returns"><span class="header-section-number">30.4.1</span> Summary Statistics of Portfolio Returns</h3>
<div id="tbl-return-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="17">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-return-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.6: Summary statistics of monthly portfolio returns (in percent)
</figcaption>
<div aria-describedby="tbl-return-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>return_cols <span class="op">=</span> [</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ret_vw_Democracy"</span>, <span class="st">"ret_vw_Dictatorship"</span>, <span class="st">"ret_diff_vw"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ret_ew_Democracy"</span>, <span class="st">"ret_ew_Dictatorship"</span>, <span class="st">"ret_diff_ew"</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="op">=</span> (</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    returns_wide[return_cols]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    .mul(<span class="dv">100</span>)  <span class="co"># Convert to percent</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    .describe()</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    .T</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        skewness<span class="op">=</span>returns_wide[return_cols].mul(<span class="dv">100</span>).skew(),</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        sharpe<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"mean"</span>] <span class="op">/</span> x[<span class="st">"std"</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>summary_stats.index <span class="op">=</span> [</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Democracy (VW)"</span>, <span class="st">"Dictatorship (VW)"</span>, <span class="st">"Long-Short (VW)"</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Democracy (EW)"</span>, <span class="st">"Dictatorship (EW)"</span>, <span class="st">"Long-Short (EW)"</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>summary_stats[[<span class="st">"mean"</span>, <span class="st">"std"</span>, <span class="st">"min"</span>, <span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span>, <span class="st">"max"</span>, </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>               <span class="st">"skewness"</span>, <span class="st">"sharpe"</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<p>The <strong>Sharpe ratio</strong> is computed as:</p>
<p><span id="eq-sharpe"><span class="math display">\[
\text{SR} = \frac{\bar{r}_p}{\sigma_p} \times \sqrt{12}
\tag{30.5}\]</span></span></p>
<p>where <span class="math inline">\(\bar{r}_p\)</span> and <span class="math inline">\(\sigma_p\)</span> are the sample mean and standard deviation of monthly portfolio returns, and the <span class="math inline">\(\sqrt{12}\)</span> scaling annualizes the ratio.</p>
</section>
<section id="t-test-is-the-long-short-return-statistically-significant" class="level3" data-number="30.4.2">
<h3 data-number="30.4.2" class="anchored" data-anchor-id="t-test-is-the-long-short-return-statistically-significant"><span class="header-section-number">30.4.2</span> T-Test: Is the Long-Short Return Statistically Significant?</h3>
<p>The null hypothesis is that the mean monthly return difference between the Democracy and Dictatorship portfolios is zero:</p>
<p><span id="eq-ttest-null"><span class="math display">\[
H_0: \mathbb{E}[r_t^{\text{Democracy}} - r_t^{\text{Dictatorship}}] = 0
\tag{30.6}\]</span></span></p>
<div id="tbl-ttest" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="18">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.7: T-test for the mean difference between Democracy and Dictatorship portfolio returns
</figcaption>
<div aria-describedby="tbl-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perform_ttest(series, label):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Perform a one-sample t-test and return results."""</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    clean <span class="op">=</span> series.dropna()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    t_stat, p_value <span class="op">=</span> stats.ttest_1samp(clean, <span class="dv">0</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Portfolio"</span>: label,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mean (%)"</span>: clean.mean() <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Std (%)"</span>: clean.std() <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"T-statistic"</span>: t_stat,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"P-value"</span>: p_value,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N months"</span>: <span class="bu">len</span>(clean),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Significant (5%)"</span>: <span class="st">"Yes"</span> <span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">"No"</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>ttest_results <span class="op">=</span> pd.DataFrame([</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    perform_ttest(returns_wide[<span class="st">"ret_diff_vw"</span>], <span class="st">"VW Long-Short"</span>),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    perform_ttest(returns_wide[<span class="st">"ret_diff_ew"</span>], <span class="st">"EW Long-Short"</span>),</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    perform_ttest(returns_wide[<span class="st">"ret_vw_Democracy"</span>], <span class="st">"VW Democracy"</span>),</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    perform_ttest(returns_wide[<span class="st">"ret_vw_Dictatorship"</span>], <span class="st">"VW Dictatorship"</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>ttest_results.<span class="bu">round</span>(<span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="cumulative-returns-the-visual-case-for-governance" class="level3" data-number="30.4.3">
<h3 data-number="30.4.3" class="anchored" data-anchor-id="cumulative-returns-the-visual-case-for-governance"><span class="header-section-number">30.4.3</span> Cumulative Returns: The Visual Case for Governance</h3>
<p>One of the most compelling ways to present the governance effect is through cumulative wealth plots. We track the growth of $1 invested in each portfolio at the beginning of the sample period.</p>
<p>The cumulative return at time <span class="math inline">\(T\)</span> is:</p>
<p><span id="eq-cumret"><span class="math display">\[
W_T = \prod_{t=1}^{T} (1 + r_{p,t})
\tag{30.7}\]</span></span></p>
<div id="fig-cumulative-returns" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="19">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cumulative-returns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> returns_wide.sort_values(<span class="st">"date"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>cum_democracy <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_vw_Democracy"</span>]).cumprod()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>cum_dictatorship <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_vw_Dictatorship"</span>]).cumprod()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>ax.plot(</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], cum_democracy,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#1a6b3c"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Democracy Portfolio"</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>ax.plot(</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], cum_dictatorship,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#c0392b"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">"--"</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"Dictatorship Portfolio"</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>],</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    cum_democracy, cum_dictatorship,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    where<span class="op">=</span>cum_democracy <span class="op">&gt;=</span> cum_dictatorship,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.15</span>, color<span class="op">=</span><span class="st">"#1a6b3c"</span>, label<span class="op">=</span><span class="st">"Outperformance"</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>],</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    cum_democracy, cum_dictatorship,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    where<span class="op">=</span>cum_democracy <span class="op">&lt;</span> cum_dictatorship,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.15</span>, color<span class="op">=</span><span class="st">"#c0392b"</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Date"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Cumulative Value of $1 Invested"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Democracy vs. Dictatorship Portfolios: Cumulative Returns"</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">10</span>, loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(returns_wide[<span class="st">"date"</span>].<span class="bu">min</span>(), returns_wide[<span class="st">"date"</span>].<span class="bu">max</span>())</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-cumulative-returns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30.2
</figcaption>
</figure>
</div>
<div id="fig-cumulative-longshort" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="20">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cumulative-longshort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cum_longshort <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_diff_vw"</span>]).cumprod()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>ax.plot(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], cum_longshort,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#2c5f8a"</span>, linewidth<span class="op">=</span><span class="dv">2</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="fl">1.0</span>, color<span class="op">=</span><span class="st">"gray"</span>, linestyle<span class="op">=</span><span class="st">":"</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], <span class="fl">1.0</span>, cum_longshort,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    where<span class="op">=</span>cum_longshort <span class="op">&gt;=</span> <span class="fl">1.0</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"#2c5f8a"</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], <span class="fl">1.0</span>, cum_longshort,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    where<span class="op">=</span>cum_longshort <span class="op">&lt;</span> <span class="fl">1.0</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"#c0392b"</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Date"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Cumulative Long-Short Return"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Long-Short Governance Strategy: Cumulative Performance"</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-cumulative-longshort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30.3
</figcaption>
</figure>
</div>
</section>
<section id="rolling-performance" class="level3" data-number="30.4.4">
<h3 data-number="30.4.4" class="anchored" data-anchor-id="rolling-performance"><span class="header-section-number">30.4.4</span> Rolling Performance</h3>
<p>The governance premium may not be constant over time. We examine 12-month rolling average returns and rolling Sharpe ratios to assess stability.</p>
<div id="fig-rolling-returns" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="21">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rolling-returns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>rolling_mean <span class="op">=</span> (</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"ret_diff_vw"</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    .rolling(window<span class="op">=</span><span class="dv">12</span>, min_periods<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    .mean() <span class="op">*</span> <span class="dv">12</span> <span class="op">*</span> <span class="dv">100</span>  <span class="co"># Annualized</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>rolling_std <span class="op">=</span> (</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"ret_diff_vw"</span>]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    .rolling(window<span class="op">=</span><span class="dv">12</span>, min_periods<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    .std() <span class="op">*</span> np.sqrt(<span class="dv">12</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling annualized return</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], rolling_mean,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#2c5f8a"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"gray"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">"Annualized Return (%)"</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"12-Month Rolling Annualized Return: Long-Short Governance Strategy"</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling annualized volatility</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], rolling_std,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#c0392b"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">"Annualized Volatility (%)"</span>)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">"Date"</span>)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"12-Month Rolling Annualized Volatility"</span>,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-rolling-returns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30.4
</figcaption>
</figure>
</div>
</section>
</section>
<section id="risk-adjusted-performance-factor-model-analysis" class="level2" data-number="30.5">
<h2 data-number="30.5" class="anchored" data-anchor-id="risk-adjusted-performance-factor-model-analysis"><span class="header-section-number">30.5</span> Risk-Adjusted Performance: Factor Model Analysis</h2>
<section id="the-four-factor-model" class="level3" data-number="30.5.1">
<h3 data-number="30.5.1" class="anchored" data-anchor-id="the-four-factor-model"><span class="header-section-number">30.5.1</span> The Four-Factor Model</h3>
<p>Raw returns alone do not tell us whether the governance strategy generates <strong>abnormal</strong> returns (i.e., returns that cannot be explained by exposure to common risk factors). We estimate the following four-factor model:</p>
<p><span id="eq-four-factor"><span class="math display">\[
r_{t}^{D-D} - r_{f,t} = \alpha + \beta_1 (r_{m,t} - r_{f,t}) + \beta_2 \text{SMB}_t + \beta_3 \text{HML}_t + \beta_4 \text{UMD}_t + \varepsilon_t
\tag{30.8}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(r_{t}^{D-D}\)</span> is the long-short governance portfolio return,</li>
<li><span class="math inline">\(r_{f,t}\)</span> is the risk-free rate,</li>
<li><span class="math inline">\(r_{m,t} - r_{f,t}\)</span> is the market excess return (MKTRF),</li>
<li><span class="math inline">\(\text{SMB}_t\)</span> is the size factor (Small Minus Big),</li>
<li><span class="math inline">\(\text{HML}_t\)</span> is the value factor (High Minus Low book-to-market),</li>
<li><span class="math inline">\(\text{UMD}_t\)</span> is the momentum factor (Up Minus Down),</li>
<li><span class="math inline">\(\alpha\)</span> is the abnormal return (the intercept of interest).</li>
</ul>
<p>The <strong>alpha</strong> (<span class="math inline">\(\alpha\)</span>) represents the average monthly return that cannot be attributed to exposure to the four systematic risk factors. A statistically significant positive alpha indicates that the governance strategy generates genuine abnormal returns.</p>
</section>
<section id="loading-factor-data" class="level3" data-number="30.5.2">
<h3 data-number="30.5.2" class="anchored" data-anchor-id="loading-factor-data"><span class="header-section-number">30.5.2</span> Loading Factor Data</h3>
<div id="load-factors" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>factors_ff5_monthly <span class="op">=</span> pd.read_sql_query(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    sql<span class="op">=</span><span class="st">"SELECT * FROM factors_ff5_monthly"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    con<span class="op">=</span>tidy_finance,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>{<span class="st">"date"</span>}</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>factors_ff5_monthly.info()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.DataFrame'&gt;
RangeIndex: 150 entries, 0 to 149
Data columns (total 7 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   date        150 non-null    datetime64[us]
 1   smb         150 non-null    float64       
 2   hml         150 non-null    float64       
 3   rmw         150 non-null    float64       
 4   cma         150 non-null    float64       
 5   mkt_excess  150 non-null    float64       
 6   risk_free   150 non-null    float64       
dtypes: datetime64[us](1), float64(6)
memory usage: 8.3 KB</code></pre>
</div>
</div>
<div id="ab739e36" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>momentum_factor <span class="op">=</span> pd.read_sql_query(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    sql<span class="op">=</span><span class="st">"SELECT * FROM momentum_factor_monthly"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    con<span class="op">=</span>tidy_finance,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>{<span class="st">"date"</span>}</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>factors_ff3_monthly <span class="op">=</span> (</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    factors_ff5_monthly</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    .merge(momentum_factor, on<span class="op">=</span><span class="st">"date"</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"mkt_excess"</span>: <span class="st">"mktrf"</span>, <span class="st">"wml"</span>: <span class="st">"umd"</span>})</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>factor_cols <span class="op">=</span> [<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>, <span class="st">"risk_free"</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    factors_ff3_monthly[factor_cols]</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    .mul(<span class="dv">100</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    .describe()</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    .T</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="tbl-factors-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="24">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-factors-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.8: Summary statistics of Vietnamese Fama-French-Carhart factors (monthly, in percent)
</figcaption>
<div aria-describedby="tbl-factors-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">mktrf</th>
<td>150.0000</td>
<td>-1.0080</td>
<td>5.8580</td>
<td>-21.4910</td>
<td>-3.8030</td>
<td>-0.9510</td>
<td>2.1450</td>
<td>16.7680</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">smb</th>
<td>150.0000</td>
<td>0.7660</td>
<td>4.1900</td>
<td>-15.2200</td>
<td>-1.3730</td>
<td>1.0400</td>
<td>3.1610</td>
<td>12.8380</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">hml</th>
<td>150.0000</td>
<td>1.1460</td>
<td>5.1820</td>
<td>-12.8300</td>
<td>-1.2620</td>
<td>0.4610</td>
<td>3.2270</td>
<td>15.0970</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">umd</th>
<td>150.0000</td>
<td>-2.0910</td>
<td>4.8090</td>
<td>-16.3870</td>
<td>-4.8840</td>
<td>-2.1650</td>
<td>0.6190</td>
<td>15.6040</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">risk_free</th>
<td>150.0000</td>
<td>0.3330</td>
<td>0.0000</td>
<td>0.3330</td>
<td>0.3330</td>
<td>0.3330</td>
<td>0.3330</td>
<td>0.3330</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="merging-portfolio-returns-with-factor-data" class="level3" data-number="30.5.3">
<h3 data-number="30.5.3" class="anchored" data-anchor-id="merging-portfolio-returns-with-factor-data"><span class="header-section-number">30.5.3</span> Merging Portfolio Returns with Factor Data</h3>
<div id="merge-factors" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge on year-month</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>returns_wide[<span class="st">"ym"</span>] <span class="op">=</span> returns_wide[<span class="st">"date"</span>].dt.to_period(<span class="st">"M"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>factors_ff3_monthly[<span class="st">"ym"</span>] <span class="op">=</span> factors_ff3_monthly[<span class="st">"date"</span>].dt.to_period(<span class="st">"M"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="op">=</span> returns_wide.merge(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    factors_ff3_monthly[[<span class="st">"ym"</span>, <span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>, <span class="st">"rf"</span>]],</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">"ym"</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute excess returns</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="op">=</span> analysis_data.assign(</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    ret_excess_democracy<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"ret_vw_Democracy"</span>] <span class="op">-</span> x[<span class="st">"rf"</span>],</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    ret_excess_dictatorship<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"ret_vw_Dictatorship"</span>] <span class="op">-</span> x[<span class="st">"rf"</span>],</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    ret_excess_longshort<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"ret_diff_vw"</span>]</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Long-short is already excess (self-financing)</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Observations for regression: </span><span class="sc">{</span><span class="bu">len</span>(analysis_data)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="capm-regression" class="level3" data-number="30.5.4">
<h3 data-number="30.5.4" class="anchored" data-anchor-id="capm-regression"><span class="header-section-number">30.5.4</span> CAPM Regression</h3>
<p>We start with the single-factor CAPM to understand the market exposure of each portfolio:</p>
<p><span id="eq-capm"><span class="math display">\[
r_{p,t} - r_{f,t} = \alpha_p + \beta_p (r_{m,t} - r_{f,t}) + \varepsilon_{p,t}
\tag{30.9}\]</span></span></p>
<div id="tbl-capm-results" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="26">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-capm-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.9: CAPM regression results for Democracy, Dictatorship, and Long-Short portfolios
</figcaption>
<div aria-describedby="tbl-capm-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_regression(y, X, hac<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Run OLS regression with optional HAC standard errors."""</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    X_const <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> OLS(y, X_const).fit(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        cov_type<span class="op">=</span><span class="st">"HAC"</span> <span class="cf">if</span> hac <span class="cf">else</span> <span class="st">"nonrobust"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>} <span class="cf">if</span> hac <span class="cf">else</span> {}</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>portfolios <span class="op">=</span> {</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Democracy"</span>: analysis_data[<span class="st">"ret_excess_democracy"</span>],</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dictatorship"</span>: analysis_data[<span class="st">"ret_excess_dictatorship"</span>],</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Long-Short"</span>: analysis_data[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>capm_results <span class="op">=</span> {}</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, y <span class="kw">in</span> portfolios.items():</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> analysis_data[[<span class="st">"mktrf"</span>]]</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> run_regression(y, X, hac<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    capm_results[name] <span class="op">=</span> {</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Beta (MKTRF)"</span>: model.params[<span class="st">"mktrf"</span>],</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Beta t-stat"</span>: model.tvalues[<span class="st">"mktrf"</span>],</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model.rsquared,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="bu">int</span>(model.nobs)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(capm_results).T.<span class="bu">round</span>(<span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="three-factor-fama-french-model" class="level3" data-number="30.5.5">
<h3 data-number="30.5.5" class="anchored" data-anchor-id="three-factor-fama-french-model"><span class="header-section-number">30.5.5</span> Three-Factor Fama-French Model</h3>
<p>The three-factor model <span class="citation" data-cites="Fama1993">(<a href="references.html#ref-Fama1993" role="doc-biblioref">Fama and French 1993</a>)</span> augments the CAPM with size (SMB) and value (HML) factors:</p>
<p><span id="eq-ff3"><span class="math display">\[
r_{p,t} - r_{f,t} = \alpha_p + \beta_1 \text{MKTRF}_t + \beta_2 \text{SMB}_t + \beta_3 \text{HML}_t + \varepsilon_{p,t}
\tag{30.10}\]</span></span></p>
<div id="tbl-ff3-results" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="27">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ff3-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.10: Fama-French three-factor model results with Newey-West standard errors
</figcaption>
<div aria-describedby="tbl-ff3-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ff3_results <span class="op">=</span> {}</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, y <span class="kw">in</span> portfolios.items():</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> run_regression(y, X, hac<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    ff3_results[name] <span class="op">=</span> {</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF"</span>: model.params[<span class="st">"mktrf"</span>],</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: model.params[<span class="st">"smb"</span>],</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: model.params[<span class="st">"hml"</span>],</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model.rsquared</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(ff3_results).T.<span class="bu">round</span>(<span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="four-factor-carhart-model" class="level3" data-number="30.5.6">
<h3 data-number="30.5.6" class="anchored" data-anchor-id="four-factor-carhart-model"><span class="header-section-number">30.5.6</span> Four-Factor Carhart Model</h3>
<p>Adding the momentum factor <span class="citation" data-cites="Carhart1997">(<a href="references.html#ref-Carhart1997" role="doc-biblioref">Carhart 1997</a>)</span> controls for the well-documented tendency of past winners to continue outperforming past losers:</p>
<div id="tbl-ff4-results" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="28">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ff4-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.11: Four-factor Carhart model results for governance portfolios. Standard errors are Newey-West adjusted with 6 lags.
</figcaption>
<div aria-describedby="tbl-ff4-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ff4_results <span class="op">=</span> {}</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, y <span class="kw">in</span> portfolios.items():</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> run_regression(y, X, hac<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    ff4_results[name] <span class="op">=</span> {</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha p-value"</span>: model.pvalues[<span class="st">"const"</span>],</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF"</span>: model.params[<span class="st">"mktrf"</span>],</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF t"</span>: model.tvalues[<span class="st">"mktrf"</span>],</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: model.params[<span class="st">"smb"</span>],</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB t"</span>: model.tvalues[<span class="st">"smb"</span>],</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: model.params[<span class="st">"hml"</span>],</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML t"</span>: model.tvalues[<span class="st">"hml"</span>],</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"UMD"</span>: model.params[<span class="st">"umd"</span>],</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"UMD t"</span>: model.tvalues[<span class="st">"umd"</span>],</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model.rsquared,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adj R-sq"</span>: model.rsquared_adj,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="bu">int</span>(model.nobs)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>ff4_df <span class="op">=</span> pd.DataFrame(ff4_results).T</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>ff4_df.<span class="bu">round</span>(<span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<div id="ff4-detailed-longshort" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detailed regression output for the long-short portfolio</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> analysis_data[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>model_ls <span class="op">=</span> OLS(y, X).fit(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>}</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_ls.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="interpreting-the-factor-loadings" class="level3" data-number="30.5.7">
<h3 data-number="30.5.7" class="anchored" data-anchor-id="interpreting-the-factor-loadings"><span class="header-section-number">30.5.7</span> Interpreting the Factor Loadings</h3>
<p>The factor loadings reveal important characteristics of the governance portfolios:</p>
<ol type="1">
<li><p><strong>Market beta (</strong><span class="math inline">\(\beta_{\text{MKTRF}}\)</span>): If the long-short portfolio has a near-zero market beta, the governance strategy is approximately market-neutral. A positive beta would indicate that Democracy firms are more sensitive to market movements than Dictatorship firms.</p></li>
<li><p><strong>Size factor (</strong><span class="math inline">\(\beta_{\text{SMB}}\)</span>): A positive loading suggests the strategy tilts toward smaller firms. If Democracy firms tend to be smaller (or Dictatorship firms larger), the size factor captures this differential.</p></li>
<li><p><strong>Value factor (</strong><span class="math inline">\(\beta_{\text{HML}}\)</span>): A positive loading indicates a value tilt. Governance and value may be related if poorly governed firms also tend to have high book-to-market ratios (i.e., they are “cheap” because of governance risk).</p></li>
<li><p><strong>Momentum factor (</strong><span class="math inline">\(\beta_{\text{UMD}}\)</span>): The momentum loading captures whether the governance effect overlaps with price momentum. In the US, <span class="citation" data-cites="gompers2003corporate">Gompers, Ishii, and Metrick (<a href="references.html#ref-gompers2003corporate" role="doc-biblioref">2003</a>)</span> found a near-zero momentum loading, suggesting the governance effect is distinct from momentum.</p></li>
</ol>
</section>
<section id="robustness-white-heteroskedasticity-consistent-standard-errors" class="level3" data-number="30.5.8">
<h3 data-number="30.5.8" class="anchored" data-anchor-id="robustness-white-heteroskedasticity-consistent-standard-errors"><span class="header-section-number">30.5.8</span> Robustness: White Heteroskedasticity-Consistent Standard Errors</h3>
<p>As a robustness check, we also report results with White (HC1) standard errors, following the original methodology:</p>
<div id="tbl-white-results" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="30">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-white-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.12: Four-factor model with White heteroskedasticity-consistent standard errors (HC1)
</figcaption>
<div aria-describedby="tbl-white-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>white_results <span class="op">=</span> {}</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, y <span class="kw">in</span> portfolios.items():</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> OLS(y, X).fit(cov_type<span class="op">=</span><span class="st">"HC1"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    white_results[name] <span class="op">=</span> {</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha p-value"</span>: model.pvalues[<span class="st">"const"</span>],</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model.rsquared</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(white_results).T.<span class="bu">round</span>(<span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
</section>
<section id="deeper-analysis" class="level2" data-number="30.6">
<h2 data-number="30.6" class="anchored" data-anchor-id="deeper-analysis"><span class="header-section-number">30.6</span> Deeper Analysis</h2>
<section id="governance-quintile-portfolios" class="level3" data-number="30.6.1">
<h3 data-number="30.6.1" class="anchored" data-anchor-id="governance-quintile-portfolios"><span class="header-section-number">30.6.1</span> Governance Quintile Portfolios</h3>
<p>Rather than focusing solely on the extreme portfolios, we examine returns across all five governance quintiles. This allows us to assess whether the governance-return relationship is monotonic.</p>
<div id="quintile-portfolios" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_quintile(group):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Assign governance quintile within each vintage year."""</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> group.copy()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    group[<span class="st">"gindex_quintile"</span>] <span class="op">=</span> pd.qcut(</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        group[<span class="st">"gindex"</span>], q<span class="op">=</span><span class="dv">5</span>, labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        duplicates<span class="op">=</span><span class="st">"drop"</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>governance_quintiles <span class="op">=</span> (</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    governance</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"year"</span>, group_keys<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(assign_quintile)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with stock data</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"dual_class"</span> <span class="kw">in</span> governance_quintiles.columns:</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    governance_quintiles <span class="op">=</span> governance_quintiles.query(<span class="st">"dual_class == 0"</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> pd.merge(</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    governance_quintiles[</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"symbol"</span>, <span class="st">"year"</span>, <span class="st">"gindex"</span>, <span class="st">"gindex_quintile"</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_effective"</span>, <span class="st">"date_expires"</span>]</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    prices_monthly[[<span class="st">"symbol"</span>, <span class="st">"date"</span>, <span class="st">"ret"</span>, <span class="st">"retx"</span>, <span class="st">"mktcap"</span>]],</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">"symbol"</span>,</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> merged_q.query(</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"date &gt;= date_effective and date &lt;= date_expires"</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>).sort_values([<span class="st">"symbol"</span>, <span class="st">"date"</span>])</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute lagged market value</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> merged_q.sort_values([<span class="st">"symbol"</span>, <span class="st">"date"</span>])</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>merged_q[<span class="st">"mktcap_lag"</span>] <span class="op">=</span> merged_q.groupby(<span class="st">"symbol"</span>)[<span class="st">"mktcap"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>first_obs_q <span class="op">=</span> merged_q.groupby(<span class="st">"symbol"</span>)[<span class="st">"date"</span>].transform(<span class="st">"min"</span>)</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>mask_first_q <span class="op">=</span> merged_q[<span class="st">"date"</span>] <span class="op">==</span> first_obs_q</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>merged_q.loc[mask_first_q, <span class="st">"mktcap_lag"</span>] <span class="op">=</span> (</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    merged_q.loc[mask_first_q, <span class="st">"mktcap"</span>]</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> merged_q.loc[mask_first_q, <span class="st">"retx"</span>])</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>mask_missing_q <span class="op">=</span> merged_q[<span class="st">"mktcap_lag"</span>].isna()</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>merged_q.loc[mask_missing_q, <span class="st">"mktcap_lag"</span>] <span class="op">=</span> (</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>    merged_q.loc[mask_missing_q, <span class="st">"mktcap"</span>]</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> merged_q.loc[mask_missing_q, <span class="st">"retx"</span>])</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> merged_q.dropna(subset<span class="op">=</span>[<span class="st">"ret"</span>, <span class="st">"mktcap_lag"</span>])</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> merged_q.query(<span class="st">"mktcap_lag &gt; 0"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fig-quintile-returns" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="32">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-quintile-returns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute VW returns by quintile and date</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>quintile_returns <span class="op">=</span> (</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    merged_q</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"date"</span>, <span class="st">"gindex_quintile"</span>])</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> g: np.average(g[<span class="st">"ret"</span>], weights<span class="op">=</span>g[<span class="st">"mktcap_lag"</span>])</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> g[<span class="st">"mktcap_lag"</span>].<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        include_groups<span class="op">=</span><span class="va">False</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">"ret_vw"</span>})</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Average across time</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>quintile_avg <span class="op">=</span> (</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    quintile_returns</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"gindex_quintile"</span>)[<span class="st">"ret_vw"</span>]</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    .agg([<span class="st">"mean"</span>, <span class="st">"std"</span>, <span class="st">"count"</span>])</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>        se<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"std"</span>] <span class="op">/</span> np.sqrt(x[<span class="st">"count"</span>]),</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        ci95<span class="op">=</span><span class="kw">lambda</span> x: <span class="fl">1.96</span> <span class="op">*</span> x[<span class="st">"std"</span>] <span class="op">/</span> np.sqrt(x[<span class="st">"count"</span>])</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>quintiles <span class="op">=</span> quintile_avg.index.astype(<span class="bu">int</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>means <span class="op">=</span> quintile_avg[<span class="st">"mean"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span>  <span class="co"># Annualized</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>ci <span class="op">=</span> quintile_avg[<span class="st">"ci95"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax.bar(</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    quintiles, means, yerr<span class="op">=</span>ci,</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[<span class="st">"#1a6b3c"</span>, <span class="st">"#5fa35f"</span>, <span class="st">"#b0b0b0"</span>, <span class="st">"#d4836a"</span>, <span class="st">"#c0392b"</span>],</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    edgecolor<span class="op">=</span><span class="st">"white"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, capsize<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    error_kw<span class="op">=</span>{<span class="st">"linewidth"</span>: <span class="fl">1.5</span>}</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"gray"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"VN-GIndex Quintile</span><span class="ch">\n</span><span class="st">(1 = Strongest Rights → 5 = Weakest Rights)"</span>,</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Annualized Return (%)"</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Average Annualized Returns by Governance Quintile"</span>,</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(quintiles)</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">"y"</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-quintile-returns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30.5
</figcaption>
</figure>
</div>
<div id="tbl-quintile-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="33">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-quintile-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.13: Average monthly returns and four-factor alphas by governance quintile
</figcaption>
<div aria-describedby="tbl-quintile-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge quintile returns with factors</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>quintile_wide <span class="op">=</span> quintile_returns.pivot(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"date"</span>, columns<span class="op">=</span><span class="st">"gindex_quintile"</span>, values<span class="op">=</span><span class="st">"ret_vw"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>quintile_wide.columns <span class="op">=</span> [<span class="ss">f"Q</span><span class="sc">{</span><span class="bu">int</span>(c)<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> c <span class="kw">in</span> quintile_wide.columns]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>quintile_wide <span class="op">=</span> quintile_wide.reset_index()</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>quintile_wide[<span class="st">"ym"</span>] <span class="op">=</span> quintile_wide[<span class="st">"date"</span>].dt.to_period(<span class="st">"M"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>quintile_analysis <span class="op">=</span> quintile_wide.merge(</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    factors_ff3_monthly[[<span class="st">"ym"</span>, <span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>, <span class="st">"rf"</span>]],</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">"ym"</span>, how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>quintile_factor_results <span class="op">=</span> {}</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">6</span>):</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    col <span class="op">=</span> <span class="ss">f"Q</span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">in</span> quintile_analysis.columns:</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> quintile_analysis[col] <span class="op">-</span> quintile_analysis[<span class="st">"rf"</span>]</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> sm.add_constant(</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>            quintile_analysis[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]]</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> OLS(y.dropna(), X.loc[y.dropna().index]).fit(</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>            cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>}</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>        quintile_factor_results[<span class="ss">f"Quintile </span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">"</span>] <span class="op">=</span> {</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Mean Return (%)"</span>: y.mean() <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MKTRF Beta"</span>: model.params[<span class="st">"mktrf"</span>],</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">"R-squared"</span>: model.rsquared</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Add 5-1 spread</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"Q1"</span> <span class="kw">in</span> quintile_analysis.columns <span class="kw">and</span> <span class="st">"Q5"</span> <span class="kw">in</span> quintile_analysis.columns:</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>    y_spread <span class="op">=</span> quintile_analysis[<span class="st">"Q1"</span>] <span class="op">-</span> quintile_analysis[<span class="st">"Q5"</span>]</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        quintile_analysis[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]]</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>    model_spread <span class="op">=</span> OLS(</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>        y_spread.dropna(), X.loc[y_spread.dropna().index]</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    ).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    quintile_factor_results[<span class="st">"Q1 - Q5"</span>] <span class="op">=</span> {</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mean Return (%)"</span>: y_spread.mean() <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model_spread.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model_spread.tvalues[<span class="st">"const"</span>],</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF Beta"</span>: model_spread.params[<span class="st">"mktrf"</span>],</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model_spread.rsquared</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(quintile_factor_results).T.<span class="bu">round</span>(<span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="subsample-analysis" class="level3" data-number="30.6.2">
<h3 data-number="30.6.2" class="anchored" data-anchor-id="subsample-analysis"><span class="header-section-number">30.6.2</span> Subsample Analysis</h3>
<p>The governance premium may vary across market regimes. We split the sample at the midpoint and examine whether the effect is concentrated in a particular subperiod.</p>
<div id="tbl-subsample" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="34">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-subsample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.14: Four-factor alpha of the long-short governance strategy across subperiods
</figcaption>
<div aria-describedby="tbl-subsample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>midpoint <span class="op">=</span> analysis_data[<span class="st">"date"</span>].quantile(<span class="fl">0.5</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>subperiods <span class="op">=</span> {</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Full Sample"</span>: analysis_data,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"First Half"</span>: analysis_data.query(<span class="ss">f"date &lt;= '</span><span class="sc">{</span>midpoint<span class="sc">}</span><span class="ss">'"</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Second Half"</span>: analysis_data.query(<span class="ss">f"date &gt; '</span><span class="sc">{</span>midpoint<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>subsample_results <span class="op">=</span> {}</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> period_name, df <span class="kw">in</span> subperiods.items():</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(df) <span class="op">&lt;</span> <span class="dv">12</span>:</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(df[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> OLS(y, X).fit(</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>}</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    subsample_results[period_name] <span class="op">=</span> {</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (% monthly)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (% annual)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"T-statistic"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"P-value"</span>: model.pvalues[<span class="st">"const"</span>],</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N months"</span>: <span class="bu">int</span>(model.nobs),</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Date Range"</span>: <span class="ss">f"</span><span class="sc">{</span>df[<span class="st">'date'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">.</span>strftime(<span class="st">'%Y-%m'</span>)<span class="sc">}</span><span class="ss"> to "</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>                      <span class="ss">f"</span><span class="sc">{</span>df[<span class="st">'date'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">.</span>strftime(<span class="st">'%Y-%m'</span>)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(subsample_results).T</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="equal-weighted-robustness" class="level3" data-number="30.6.3">
<h3 data-number="30.6.3" class="anchored" data-anchor-id="equal-weighted-robustness"><span class="header-section-number">30.6.3</span> Equal-Weighted Robustness</h3>
<p>Value-weighting may cause the results to be driven by a few large firms. We verify robustness with equal-weighted portfolios.</p>
<div id="tbl-ew-robustness" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="35">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ew-robustness-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.15: Four-factor model results: Equal-weighted vs.&nbsp;Value-weighted long-short portfolio
</figcaption>
<div aria-describedby="tbl-ew-robustness-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ew_y <span class="op">=</span> analysis_data[<span class="st">"ret_diff_ew"</span>]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>vw_y <span class="op">=</span> analysis_data[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>model_ew <span class="op">=</span> OLS(ew_y, X).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>model_vw <span class="op">=</span> OLS(vw_y, X).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> pd.DataFrame({</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Value-Weighted"</span>: {</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (% monthly)"</span>: model_vw.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model_vw.tvalues[<span class="st">"const"</span>],</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF"</span>: model_vw.params[<span class="st">"mktrf"</span>],</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: model_vw.params[<span class="st">"smb"</span>],</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: model_vw.params[<span class="st">"hml"</span>],</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"UMD"</span>: model_vw.params[<span class="st">"umd"</span>],</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model_vw.rsquared</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Equal-Weighted"</span>: {</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (% monthly)"</span>: model_ew.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model_ew.tvalues[<span class="st">"const"</span>],</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF"</span>: model_ew.params[<span class="st">"mktrf"</span>],</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: model_ew.params[<span class="st">"smb"</span>],</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: model_ew.params[<span class="st">"hml"</span>],</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"UMD"</span>: model_ew.params[<span class="st">"umd"</span>],</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model_ew.rsquared</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>}).T</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>comparison.<span class="bu">round</span>(<span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="factor-loading-stability-rolling-regressions" class="level3" data-number="30.6.4">
<h3 data-number="30.6.4" class="anchored" data-anchor-id="factor-loading-stability-rolling-regressions"><span class="header-section-number">30.6.4</span> Factor Loading Stability: Rolling Regressions</h3>
<div id="fig-rolling-alpha" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="36">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rolling-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">24</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>rolling_alpha <span class="op">=</span> []</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(window, <span class="bu">len</span>(analysis_data)):</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    subset <span class="op">=</span> analysis_data.iloc[i <span class="op">-</span> window:i]</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> subset[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(subset[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> OLS(y, X).fit()</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        rolling_alpha.append({</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"date"</span>: subset[<span class="st">"date"</span>].iloc[<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"alpha"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"alpha_se"</span>: model.bse[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"t_stat"</span>: model.tvalues[<span class="st">"const"</span>]</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>rolling_alpha_df <span class="op">=</span> pd.DataFrame(rolling_alpha)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>ax.plot(</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"date"</span>],</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"alpha"</span>],</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#2c5f8a"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"date"</span>],</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"alpha"</span>] <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> rolling_alpha_df[<span class="st">"alpha_se"</span>],</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"alpha"</span>] <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> rolling_alpha_df[<span class="st">"alpha_se"</span>],</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"#2c5f8a"</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"gray"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Date"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Annualized Alpha (%)"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"24-Month Rolling Four-Factor Alpha: Governance Long-Short Strategy"</span>,</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-rolling-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30.6
</figcaption>
</figure>
</div>
</section>
</section>
<section id="comparison-with-international-evidence" class="level2" data-number="30.7">
<h2 data-number="30.7" class="anchored" data-anchor-id="comparison-with-international-evidence"><span class="header-section-number">30.7</span> Comparison with International Evidence</h2>
<section id="the-us-experience" class="level3" data-number="30.7.1">
<h3 data-number="30.7.1" class="anchored" data-anchor-id="the-us-experience"><span class="header-section-number">30.7.1</span> The US Experience</h3>
<p>In the United States, <span class="citation" data-cites="gompers2003corporate">Gompers, Ishii, and Metrick (<a href="references.html#ref-gompers2003corporate" role="doc-biblioref">2003</a>)</span> documented an annualized abnormal return of approximately 8.5% for the Democracy-minus-Dictatorship strategy during the 1990s. Subsequent research has provided important nuances:</p>
<ul>
<li><p><span class="citation" data-cites="bebchuk2009matters">L. Bebchuk, Cohen, and Ferrell (<a href="references.html#ref-bebchuk2009matters" role="doc-biblioref">2009</a>)</span> refined the G-Index to a more parsimonious <strong>Entrenchment Index (E-Index)</strong> based on only six provisions that matter most for firm value: staggered boards, limits to shareholder bylaw amendments, poison pills, golden parachutes, and supermajority requirements for mergers and charter amendments. The E-Index explained the governance-return relationship at least as well as the full G-Index.</p></li>
<li><p><span class="citation" data-cites="cremers2005governance">Cremers and Nair (<a href="references.html#ref-cremers2005governance" role="doc-biblioref">2005</a>)</span> found that the governance effect was strongest in firms where external governance mechanisms (the takeover market) were active, suggesting complementarity between internal and external governance.</p></li>
<li><p>The governance premium in the US has largely disappeared in more recent periods <span class="citation" data-cites="bebchuk2013learning">(<a href="references.html#ref-bebchuk2013learning" role="doc-biblioref">L. A. Bebchuk, Cohen, and Wang 2013</a>)</span>, potentially because the market has learned to price governance differences. This “learning hypothesis” has implications for whether similar strategies can persist in less efficient markets like Vietnam.</p></li>
</ul>
</section>
<section id="emerging-market-context" class="level3" data-number="30.7.2">
<h3 data-number="30.7.2" class="anchored" data-anchor-id="emerging-market-context"><span class="header-section-number">30.7.2</span> Emerging Market Context</h3>
<p>The governance-return relationship in emerging markets remains an active area of research. Several features of emerging markets suggest the premium may be larger and more persistent:</p>
<ol type="1">
<li><p><strong>Information asymmetry</strong>: Weaker disclosure requirements and less analyst coverage mean governance quality is harder to observe, creating larger mispricings <span class="citation" data-cites="klapper2004corporate">(<a href="references.html#ref-klapper2004corporate" role="doc-biblioref">Klapper and Love 2004</a>)</span>.</p></li>
<li><p><strong>Weaker legal enforcement</strong>: Where legal protections for minority shareholders are weak, firm-level governance becomes more important as a substitute <span class="citation" data-cites="la2000investor">(<a href="references.html#ref-la2000investor" role="doc-biblioref">La Porta et al. 2000</a>)</span>.</p></li>
<li><p><strong>Concentrated ownership</strong>: The presence of controlling shareholders creates opportunities for tunneling and related-party transactions that good governance mechanisms can mitigate <span class="citation" data-cites="johnson2000tunneling">(<a href="references.html#ref-johnson2000tunneling" role="doc-biblioref">Johnson et al. 2000</a>)</span>.</p></li>
</ol>
<p>Vietnam, as a frontier-to-emerging market with all three characteristics, is a particularly interesting laboratory for testing whether governance generates abnormal returns.</p>
</section>
</section>
<section id="drawdown-and-risk-analysis" class="level2" data-number="30.8">
<h2 data-number="30.8" class="anchored" data-anchor-id="drawdown-and-risk-analysis"><span class="header-section-number">30.8</span> Drawdown and Risk Analysis</h2>
<section id="maximum-drawdown" class="level3" data-number="30.8.1">
<h3 data-number="30.8.1" class="anchored" data-anchor-id="maximum-drawdown"><span class="header-section-number">30.8.1</span> Maximum Drawdown</h3>
<div id="fig-drawdown" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="37">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-drawdown-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_drawdown(cumulative_returns):</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute drawdown series from cumulative returns."""</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    running_max <span class="op">=</span> cumulative_returns.cummax()</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    drawdown <span class="op">=</span> (cumulative_returns <span class="op">-</span> running_max) <span class="op">/</span> running_max</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> drawdown</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>cum_dem <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_vw_Democracy"</span>]).cumprod()</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>cum_dic <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_vw_Dictatorship"</span>]).cumprod()</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>dd_dem <span class="op">=</span> compute_drawdown(cum_dem)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>dd_dic <span class="op">=</span> compute_drawdown(cum_dic)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], dd_dem <span class="op">*</span> <span class="dv">100</span>, <span class="dv">0</span>,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.4</span>, color<span class="op">=</span><span class="st">"#1a6b3c"</span>, label<span class="op">=</span><span class="st">"Democracy"</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], dd_dic <span class="op">*</span> <span class="dv">100</span>, <span class="dv">0</span>,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.4</span>, color<span class="op">=</span><span class="st">"#c0392b"</span>, label<span class="op">=</span><span class="st">"Dictatorship"</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Date"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Drawdown (%)"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Portfolio Drawdowns"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-drawdown-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30.7
</figcaption>
</figure>
</div>
<div id="tbl-risk-metrics" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="38">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-risk-metrics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;30.16: Risk metrics for governance portfolios
</figcaption>
<div aria-describedby="tbl-risk-metrics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_risk_metrics(returns, name, rf<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute standard risk metrics."""</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> returns.dropna()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> rf <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>        excess <span class="op">=</span> r <span class="op">-</span> rf</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>        excess <span class="op">=</span> r</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    ann_return <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> r.mean()) <span class="op">**</span> <span class="dv">12</span> <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    ann_vol <span class="op">=</span> r.std() <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    sharpe <span class="op">=</span> excess.mean() <span class="op">/</span> r.std() <span class="op">*</span> np.sqrt(<span class="dv">12</span>) <span class="cf">if</span> r.std() <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    cum <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> r).cumprod()</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    max_dd <span class="op">=</span> compute_drawdown(cum).<span class="bu">min</span>()</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sortino ratio (downside deviation)</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    downside <span class="op">=</span> r[r <span class="op">&lt;</span> <span class="dv">0</span>].std() <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    sortino <span class="op">=</span> excess.mean() <span class="op">*</span> <span class="dv">12</span> <span class="op">/</span> downside <span class="cf">if</span> downside <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Skewness and kurtosis</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> r.skew()</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    kurt <span class="op">=</span> r.kurtosis()</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Portfolio"</span>: name,</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Ann. Return (%)"</span>: ann_return <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Ann. Volatility (%)"</span>: ann_vol <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sharpe Ratio"</span>: sharpe,</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sortino Ratio"</span>: sortino,</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Max Drawdown (%)"</span>: max_dd <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Skewness"</span>: skew,</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Excess Kurtosis"</span>: kurt,</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">"% Positive Months"</span>: (r <span class="op">&gt;</span> <span class="dv">0</span>).mean() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>rf_series <span class="op">=</span> analysis_data.set_index(<span class="st">"date"</span>)[<span class="st">"rf"</span>].reindex(</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>]</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>).fillna(<span class="dv">0</span>)</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>risk_table <span class="op">=</span> pd.DataFrame([</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>    compute_risk_metrics(</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>        returns_wide[<span class="st">"ret_vw_Democracy"</span>], <span class="st">"Democracy (VW)"</span>,</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>        rf_series.values</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>    compute_risk_metrics(</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>        returns_wide[<span class="st">"ret_vw_Dictatorship"</span>], <span class="st">"Dictatorship (VW)"</span>,</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>        rf_series.values</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>    compute_risk_metrics(</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>        returns_wide[<span class="st">"ret_diff_vw"</span>], <span class="st">"Long-Short (VW)"</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>]).set_index(<span class="st">"Portfolio"</span>)</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>risk_table.<span class="bu">round</span>(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
</section>
<section id="discussion-and-interpretation" class="level2" data-number="30.9">
<h2 data-number="30.9" class="anchored" data-anchor-id="discussion-and-interpretation"><span class="header-section-number">30.9</span> Discussion and Interpretation</h2>
<section id="why-might-governance-predict-returns-in-vietnam" class="level3" data-number="30.9.1">
<h3 data-number="30.9.1" class="anchored" data-anchor-id="why-might-governance-predict-returns-in-vietnam"><span class="header-section-number">30.9.1</span> Why Might Governance Predict Returns in Vietnam?</h3>
<p>Several channels may explain a governance premium in the Vietnamese market:</p>
<p><strong>The risk channel</strong>: Poorly governed firms may be riskier in ways not captured by standard factor models. Investors require a higher expected return to hold these firms, but the return difference reverses (i.e., the governance premium is positive for well-governed firms) if the market overestimates the risk of poorly governed firms or if governance risk is partially diversifiable.</p>
<p><strong>The mispricing channel</strong>: If the market is slow to incorporate governance information into prices, perhaps because governance quality is costly to assess or because many Vietnamese investors are retail traders with limited analytical capacity, then a systematic strategy that buys good governance and sells bad governance can profit from the gradual correction of mispricings.</p>
<p><strong>The cash flow channel</strong>: Better-governed firms may generate genuinely higher cash flows because they waste less on empire-building, related-party transactions, and other value-destroying activities. To the extent that these superior cash flows are not fully anticipated by the market, good governance firms deliver positive return surprises.</p>
</section>
<section id="state-ownership-and-the-governance-effect" class="level3" data-number="30.9.2">
<h3 data-number="30.9.2" class="anchored" data-anchor-id="state-ownership-and-the-governance-effect"><span class="header-section-number">30.9.2</span> State Ownership and the Governance Effect</h3>
<p>A distinctive feature of the Vietnamese market is the prevalence of state-owned enterprises (SOEs). The interaction between state ownership and governance quality creates an interesting dynamic:</p>
<ul>
<li>SOEs may have weak governance by conventional metrics (limited board independence, political appointments) but benefit from implicit government guarantees and preferential access to land, capital, and contracts.</li>
<li>The governance premium may therefore differ between SOEs and private firms. We encourage readers to extend the analysis by interacting the governance index with a state ownership indicator.</li>
</ul>
</section>
<section id="limitations" class="level3" data-number="30.9.3">
<h3 data-number="30.9.3" class="anchored" data-anchor-id="limitations"><span class="header-section-number">30.9.3</span> Limitations</h3>
<p>Several caveats apply to this analysis:</p>
<ol type="1">
<li><p><strong>Survivorship bias</strong>: If poorly governed firms are more likely to delist (due to financial distress or regulatory action), the Dictatorship portfolio’s returns may be biased upward, attenuating the true governance premium.</p></li>
<li><p><strong>Transaction costs</strong>: The long-short strategy requires short selling, which is restricted in Vietnam. Implementation via a long-only tilt toward Democracy firms may be more practical.</p></li>
<li><p><strong>Governance data frequency</strong>: Unlike daily stock prices, governance data is updated infrequently (typically annually). The portfolio rebalancing frequency is therefore low, which limits the strategy’s responsiveness to governance changes.</p></li>
<li><p><strong>Index construction</strong>: The specific provisions included in the VN-GIndex and their equal weighting may not optimally capture governance quality. Future work could explore weighted indices, following <span class="citation" data-cites="bebchuk2009matters">L. Bebchuk, Cohen, and Ferrell (<a href="references.html#ref-bebchuk2009matters" role="doc-biblioref">2009</a>)</span>.</p></li>
</ol>
</section>
</section>
<section id="exercises" class="level2" data-number="30.10">
<h2 data-number="30.10" class="anchored" data-anchor-id="exercises"><span class="header-section-number">30.10</span> Exercises</h2>
<ol type="1">
<li><p><strong>Entrenchment Index</strong>: Following <span class="citation" data-cites="bebchuk2009matters">L. Bebchuk, Cohen, and Ferrell (<a href="references.html#ref-bebchuk2009matters" role="doc-biblioref">2009</a>)</span>, identify the subset of governance provisions in the Vietnamese data that have the strongest association with firm value (measured by Tobin’s Q or market-to-book ratio). Construct a Vietnamese E-Index using only these provisions and compare its predictive power for returns to the full VN-GIndex.</p></li>
<li><p><strong>Fama-MacBeth regressions</strong>: Instead of sorting firms into portfolios, estimate the governance-return relationship using Fama-MacBeth cross-sectional regressions <span class="citation" data-cites="Fama1973">(<a href="references.html#ref-Fama1973" role="doc-biblioref">Fama and MacBeth 1973</a>)</span>:</p></li>
</ol>
<p><span class="math display">\[
r_{i,t} - r_{f,t} = \gamma_{0,t} + \gamma_{1,t} \text{VN-GIndex}_{i,t-1} + \gamma_{2,t} \mathbf{X}_{i,t-1} + \epsilon_{i,t}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{X}_{i,t-1}\)</span> includes controls for size, book-to-market, and momentum. Report the time-series averages of <span class="math inline">\(\hat{\gamma}_{1,t}\)</span> with Newey-West standard errors.</p>
<ol start="3" type="1">
<li><strong>State ownership interaction</strong>: Split the sample into SOEs (state ownership &gt; 50%) and private firms. Does the governance premium differ between these groups? Estimate:</li>
</ol>
<p><span class="math display">\[
r_{t}^{D-D} = \alpha + \beta_1 \text{MKTRF}_t + \beta_2 \text{SMB}_t + \beta_3 \text{HML}_t + \beta_4 \text{UMD}_t + \varepsilon_t
\]</span> separately for SOE and non-SOE subsamples.</p>
<ol start="4" type="1">
<li><p><strong>Transaction cost analysis</strong>: Compute the portfolio turnover at each rebalancing date (when new governance data becomes available). Estimate how much of the abnormal return would be consumed by transaction costs at realistic bid-ask spreads for Vietnamese equities.</p></li>
<li><p><strong>Governance changes</strong>: Do firms that improve their governance (declining VN-GIndex) earn higher subsequent returns than firms whose governance deteriorates? Construct portfolios based on <span class="math inline">\(\Delta \text{VN-GIndex}\)</span> and test.</p></li>
<li><p><strong>Comparison with market-wide governance reforms</strong>: Vietnam has implemented several governance reform waves (e.g., Circular 121/2012/TT-BTC, Decree 71/2017/ND-CP). Test whether the governance premium narrows after these regulatory changes using a structural break or interaction approach.</p></li>
</ol>
</section>
<section id="summary" class="level2" data-number="30.11">
<h2 data-number="30.11" class="anchored" data-anchor-id="summary"><span class="header-section-number">30.11</span> Summary</h2>
<p>This chapter adapts the influential <span class="citation" data-cites="gompers2003corporate">Gompers, Ishii, and Metrick (<a href="references.html#ref-gompers2003corporate" role="doc-biblioref">2003</a>)</span> governance investment strategy to the Vietnamese equity market. The key methodological steps are:</p>
<ol type="1">
<li>Construct a governance index (VN-GIndex) from firm-level governance provisions available through DataCore.vn.</li>
<li>Classify firms into Democracy (strong rights) and Dictatorship (weak rights) portfolios based on the cross-sectional distribution of the index.</li>
<li>Compute value-weighted monthly portfolio returns, rebalancing when new governance data becomes available.</li>
<li>Evaluate the long-short (Democracy minus Dictatorship) strategy using t-tests and Fama-French-Carhart four-factor regressions.</li>
<li>Examine robustness across subperiods, quintile portfolios, and alternative weighting schemes.</li>
</ol>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-bebchuk2013learning" class="csl-entry" role="listitem">
Bebchuk, Lucian A, Alma Cohen, and Charles CY Wang. 2013. <span>“Learning and the Disappearing Association Between Governance and Returns.”</span> <em>Journal of Financial Economics</em> 108 (2): 323–48.
</div>
<div id="ref-bebchuk2009matters" class="csl-entry" role="listitem">
Bebchuk, Lucian, Alma Cohen, and Allen Ferrell. 2009. <span>“What Matters in Corporate Governance?”</span> <em>The Review of Financial Studies</em> 22 (2): 783–827.
</div>
<div id="ref-Carhart1997" class="csl-entry" role="listitem">
Carhart, Mark M. 1997. <span>“<span class="nocase">On persistence in mutual fund performance</span>.”</span> <em><span>The Journal of Finance</span></em> 52 (1): 57–82. <a href="https://doi.org/10.1111/j.1540-6261.1997.tb03808.x">https://doi.org/10.1111/j.1540-6261.1997.tb03808.x</a>.
</div>
<div id="ref-claessens2000separation" class="csl-entry" role="listitem">
Claessens, Stijn, Simeon Djankov, and Larry HP Lang. 2000. <span>“The Separation of Ownership and Control in East Asian Corporations.”</span> <em>Journal of Financial Economics</em> 58 (1-2): 81–112.
</div>
<div id="ref-cremers2005governance" class="csl-entry" role="listitem">
Cremers, KJ Martijn, and Vinay B Nair. 2005. <span>“Governance Mechanisms and Equity Prices.”</span> <em>The Journal of Finance</em> 60 (6): 2859–94.
</div>
<div id="ref-Fama1993" class="csl-entry" role="listitem">
Fama, Eugene F., and Kenneth R. French. 1993. <span>“<span class="nocase">Common risk factors in the returns on stocks and bonds</span>.”</span> <em><span>Journal of Financial Economics</span></em> 33 (1): 3–56. <a href="https://doi.org/10.1016/0304-405X(93)90023-5">https://doi.org/10.1016/0304-405X(93)90023-5</a>.
</div>
<div id="ref-Fama1973" class="csl-entry" role="listitem">
Fama, Eugene F., and James D. MacBeth. 1973. <span>“<span class="nocase">Risk, return, and equilibrium: Empirical tests</span>.”</span> <em><span>Journal of Political Economy</span></em> 81 (3): 607–36. <a href="https://doi.org/10.1086/260061">https://doi.org/10.1086/260061</a>.
</div>
<div id="ref-gompers2003corporate" class="csl-entry" role="listitem">
Gompers, Paul, Joy Ishii, and Andrew Metrick. 2003. <span>“Corporate Governance and Equity Prices.”</span> <em>The Quarterly Journal of Economics</em> 118 (1): 107–56.
</div>
<div id="ref-jensen1976theory" class="csl-entry" role="listitem">
Jensen, Michael C, and William H Meckling. 1976. <span>“Theory of the Firm: Managerial Behavior, Agency Costs and Ownership Structure.”</span> <em>Journal of Financial Economics</em> 3 (4): 305–60.
</div>
<div id="ref-johnson2000tunneling" class="csl-entry" role="listitem">
Johnson, Simon, Rafael La Porta, Florencio Lopez-de-Silanes, and Andrei Shleifer. 2000. <span>“Tunneling.”</span> <em>American Economic Review</em> 90 (2): 22–27.
</div>
<div id="ref-klapper2004corporate" class="csl-entry" role="listitem">
Klapper, Leora F, and Inessa Love. 2004. <span>“Corporate Governance, Investor Protection, and Performance in Emerging Markets.”</span> <em>Journal of Corporate Finance</em> 10 (5): 703–28.
</div>
<div id="ref-la2000investor" class="csl-entry" role="listitem">
La Porta, Rafael, Florencio Lopez-de-Silanes, Andrei Shleifer, and Robert Vishny. 2000. <span>“Investor Protection and Corporate Governance.”</span> <em>Journal of Financial Economics</em> 58 (1-2): 3–27.
</div>
</div>
</section>

</main> <!-- /main -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const year = new Date().getFullYear();
  document.getElementById("copyright").textContent = "© " + year;
});
</script>
<script>
(function () {
  const GA_ID = "G-LMDLDJXXSC";   // your real GA4 ID
  const CONSENT_KEY = "cookie_consent_v1";

  function log(msg) {
    console.log("[GA Loader]", msg);
  }

  function loadGtag() {
    if (window.__gtag_loaded__) {
      log("GA already loaded, skipping");
      return;
    }

    log("Loading Google Analytics...");

    window.__gtag_loaded__ = true;

    const script = document.createElement("script");
    script.async = true;
    script.src = "https://www.googletagmanager.com/gtag/js?id=" + encodeURIComponent(GA_ID);

    script.onload = function () {
      log("gtag.js loaded");

      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      window.gtag = gtag;

      gtag("js", new Date());
      gtag("config", GA_ID, {
        anonymize_ip: true,
        transport_type: "beacon"
      });

      log("GA initialized successfully");
    };

    script.onerror = function () {
      log("FAILED to load gtag.js. Likely blocked by ad blocker or network.");
    };

    document.head.appendChild(script);
  }

  function checkConsentAndLoad() {
    const consent = localStorage.getItem(CONSENT_KEY);
    log("Stored consent value = " + consent);

    if (consent === "accepted") {
      loadGtag();
    } else {
      log("Analytics blocked due to missing or declined consent");
    }
  }

  // Run on page load
  checkConsentAndLoad();

  // Listen for cookie banner decisions
  window.addEventListener("cookie-consent-changed", function (e) {
    log("Consent event received: " + e.detail);
    if (e.detail === "accepted") {
      loadGtag();
    }
  });

})();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/github\.com\/mikenguyen13\/tidy_finance_vn");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./52_institutional_trade_flow.html" class="pagination-link" aria-label="Institutional Trades, Flows, and Turnover Ratios">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Institutional Trades, Flows, and Turnover Ratios</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./54_return_gaps.html" class="pagination-link" aria-label="Return Gap: Measuring Unobserved Actions of Fund Managers">
        <span class="nav-page-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Return Gap: Measuring Unobserved Actions of Fund Managers</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Corporate Governance</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>Corporate governance (i.e., the system of rules, practices, and processes by which firms are directed and controlled) has been one of the most actively studied determinants of equity returns since the early 2000s. The insight is simple yet powerful: firms that grant shareholders stronger rights tend to outperform firms in which management is entrenched by anti-takeover provisions. This chapter applies that insight to the Vietnamese market, where governance quality varies considerably across listed firms and institutional development remains evolving.</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretical Background</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Governance-Return Nexus</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>The theoretical motivation for a link between corporate governance and stock returns rests on agency theory <span class="co">[</span><span class="ot">@jensen1976theory</span><span class="co">]</span>. Managers, as agents of shareholders, may pursue private benefits at the expense of firm value. Anti-takeover provisions, staggered boards, poison pills, and other defensive mechanisms insulate management from the disciplining force of the market for corporate control. When shareholders cannot easily replace underperforming managers, agency costs rise, investment efficiency falls, and firm value declines.</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>@gompers2003corporate formalized this intuition by constructing a **Governance Index (G-Index)** based on 24 governance provisions tracked by the Investor Responsibility Research Center (IRRC) in the United States. Each provision that restricts shareholder rights increments the index by one. Thus:</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>G\text{-Index}_i = \sum_{k=1}^{24} \mathbf{1}<span class="sc">\{</span>\text{Provision } k \text{ is present for firm } i<span class="sc">\}</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gindex-definition}</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>where $\mathbf{1}<span class="sc">\{</span>\cdot<span class="sc">\}</span>$ is the indicator function. Higher values of the G-Index correspond to weaker shareholder rights.</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>The key empirical finding was striking: during the 1990s, a portfolio that bought firms with the strongest shareholder rights (G-Index $\leq 5$, labeled the **Democracy Portfolio**) and sold firms with the weakest shareholder rights (G-Index $\geq 14$, labeled the **Dictatorship Portfolio**) earned an abnormal return of approximately 8.5% per year.</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adapting the Framework to Vietnam</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>Vietnam's corporate governance landscape differs fundamentally from that of the United States. The Vietnamese market is characterized by:</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**State ownership**: Many listed firms retain significant government ownership stakes, which creates a distinct agency problem where the state acts as a controlling shareholder rather than dispersed minority shareholders facing entrenched management.</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Concentrated ownership**: Family and controlling-group ownership is prevalent, shifting the primary agency conflict from manager-shareholder to controlling-majority vs. minority shareholders <span class="co">[</span><span class="ot">@claessens2000separation</span><span class="co">]</span>.</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Evolving legal framework**: Vietnam's corporate governance code has been progressively strengthened through Decree 71/2017/ND-CP and subsequent circulars, but enforcement remains uneven.</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Dual listing and foreign ownership caps**: Foreign ownership limits create segmented investor bases with potentially different governance preferences.</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>Despite these differences, the core economic logic applies: firms with better governance (i.e., greater board independence, stronger audit committees, more transparent disclosure, better minority shareholder protections) should command higher valuations and deliver superior risk-adjusted returns, all else equal.</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>For the Vietnamese market, we construct a governance index analogous to the G-Index using governance provisions. While the specific provisions differ from the 24 IRRC items used in the US context, the methodology is identical: count the number of provisions that restrict shareholder rights or entrench management.</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Vietnamese Governance Index (VN-GIndex)</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>We define the Vietnamese Governance Index based on the following categories of provisions (@tbl-gindex-categories)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Category <span class="pp">|</span> Provisions <span class="pp">|</span> Direction <span class="pp">|</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------------------|-------------------------|-------------------------|</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Board Structure <span class="pp">|</span> Staggered board, CEO duality, board size <span class="sc">\&lt;</span> 5 <span class="pp">|</span> ↑ restricts rights <span class="pp">|</span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Ownership <span class="pp">|</span> State ownership <span class="sc">\&gt;</span> 50%, no independent directors <span class="pp">|</span> ↑ restricts rights <span class="pp">|</span></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Shareholder Rights <span class="pp">|</span> Supermajority requirements, limited voting rights <span class="pp">|</span> ↑ restricts rights <span class="pp">|</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Transparency <span class="pp">|</span> No English-language annual report, delayed filings <span class="pp">|</span> ↑ restricts rights <span class="pp">|</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Anti-takeover <span class="pp">|</span> Poison pill equivalents, golden parachutes <span class="pp">|</span> ↑ restricts rights <span class="pp">|</span></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Audit <span class="pp">|</span> No independent audit committee, related-party auditor <span class="pp">|</span> ↑ restricts rights <span class="pp">|</span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>: Categories of governance provisions for the VN-GIndex {#tbl-gindex-categories}</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>The VN-GIndex for firm $i$ at time $t$ is:</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>\text{VN-GIndex}_{i,t} = \sum_{k=1}^{K} \mathbf{1}<span class="sc">\{</span>\text{Provision } k \text{ is present for firm } i \text{ at time } t<span class="sc">\}</span></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>$$ {#eq-vngindex}</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>where $K$ is the total number of governance provisions tracked. Higher values indicate weaker governance.</span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Preparation</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>We use three primary datasets:</span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Governance data**: Firm-level governance provisions, updated annually or when material changes occur.</span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Stock market data**: Monthly returns, prices, and shares outstanding for all firms listed on HOSE and HNX.</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Factor data**: Vietnamese Fama-French factors (market, size, value) and a momentum factor.</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.regression.linear_model <span class="im">import</span> OLS</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>pd.options.display.float_format <span class="op">=</span> <span class="st">"</span><span class="sc">{:.4f}</span><span class="st">"</span>.<span class="bu">format</span></span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a>tidy_finance <span class="op">=</span> sqlite3.<span class="ex">connect</span>(</span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a>    database<span class="op">=</span><span class="st">"data/tidy_finance_python.sqlite"</span></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a><span class="fu">### Loading Governance Data</span></span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a>The governance dataset contains firm-level governance characteristics. Each observation corresponds to a firm-year, with binary indicators for the presence of each governance provision.</span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-governance</span></span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a>governance_raw <span class="op">=</span> pd.read_csv(</span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/datacore_governance.csv"</span>,</span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>[<span class="st">"date_effective"</span>, <span class="st">"date_expires"</span>]</span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a>governance_raw.info()</span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-110"><a href="#cb41-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-111"><a href="#cb41-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-governance-head</span></span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "First observations of the governance dataset"</span></span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a>governance_raw.head(<span class="dv">10</span>)</span>
<span id="cb41-116"><a href="#cb41-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-117"><a href="#cb41-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-118"><a href="#cb41-118" aria-hidden="true" tabindex="-1"></a>The key variables are:</span>
<span id="cb41-119"><a href="#cb41-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-120"><a href="#cb41-120" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`symbol`</span>: The stock symbol on HOSE or HNX.</span>
<span id="cb41-121"><a href="#cb41-121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`date_effective`</span>: The date when the governance data became effective (analogous to the rebalancing date).</span>
<span id="cb41-122"><a href="#cb41-122" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`date_expires`</span>: The last date for which this governance vintage is valid.</span>
<span id="cb41-123"><a href="#cb41-123" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`year`</span>: The governance data vintage year.</span>
<span id="cb41-124"><a href="#cb41-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-125"><a href="#cb41-125" aria-hidden="true" tabindex="-1"></a><span class="fu">### Computing the VN-GIndex</span></span>
<span id="cb41-126"><a href="#cb41-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-127"><a href="#cb41-127" aria-hidden="true" tabindex="-1"></a>We compute the governance index by summing the binary indicators of governance provision. The provision columns are identified by the prefix <span class="in">`gov_`</span>.</span>
<span id="cb41-128"><a href="#cb41-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-131"><a href="#cb41-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-132"><a href="#cb41-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compute-gindex</span></span>
<span id="cb41-133"><a href="#cb41-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-134"><a href="#cb41-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify governance provision columns</span></span>
<span id="cb41-135"><a href="#cb41-135" aria-hidden="true" tabindex="-1"></a>gov_columns <span class="op">=</span> [</span>
<span id="cb41-136"><a href="#cb41-136" aria-hidden="true" tabindex="-1"></a>    col <span class="cf">for</span> col <span class="kw">in</span> governance_raw.columns <span class="cf">if</span> col.startswith(<span class="st">"gov_"</span>)</span>
<span id="cb41-137"><a href="#cb41-137" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb41-138"><a href="#cb41-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-139"><a href="#cb41-139" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of governance provisions tracked: </span><span class="sc">{</span><span class="bu">len</span>(gov_columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-140"><a href="#cb41-140" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Provisions: </span><span class="sc">{</span>gov_columns<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-141"><a href="#cb41-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-142"><a href="#cb41-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute VN-GIndex as sum of all provision indicators</span></span>
<span id="cb41-143"><a href="#cb41-143" aria-hidden="true" tabindex="-1"></a>governance <span class="op">=</span> governance_raw.assign(</span>
<span id="cb41-144"><a href="#cb41-144" aria-hidden="true" tabindex="-1"></a>    gindex<span class="op">=</span><span class="kw">lambda</span> x: x[gov_columns].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb41-145"><a href="#cb41-145" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-146"><a href="#cb41-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-147"><a href="#cb41-147" aria-hidden="true" tabindex="-1"></a>governance[[<span class="st">"symbol"</span>, <span class="st">"year"</span>, <span class="st">"gindex"</span>]].describe()</span>
<span id="cb41-148"><a href="#cb41-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-149"><a href="#cb41-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-150"><a href="#cb41-150" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distribution of the VN-GIndex</span></span>
<span id="cb41-151"><a href="#cb41-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-152"><a href="#cb41-152" aria-hidden="true" tabindex="-1"></a>Understanding the cross-sectional distribution of the governance index is essential for defining portfolio cutoffs. In the US, @gompers2003corporate used fixed cutoffs of $\leq 5$ for Democracy and $\geq 14$ for Dictatorship. For Vietnam, we examine the empirical distribution and set cutoffs at appropriate percentiles.</span>
<span id="cb41-153"><a href="#cb41-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-156"><a href="#cb41-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-157"><a href="#cb41-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gindex-distribution</span></span>
<span id="cb41-158"><a href="#cb41-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Cross-sectional distribution of the VN-GIndex by vintage year. The dashed vertical lines indicate the 20th and 80th percentiles used to define Democracy and Dictatorship portfolios."</span></span>
<span id="cb41-159"><a href="#cb41-159" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Histogram of VN-GIndex values across firms, faceted by year."</span></span>
<span id="cb41-160"><a href="#cb41-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-161"><a href="#cb41-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-162"><a href="#cb41-162" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(</span>
<span id="cb41-163"><a href="#cb41-163" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>), sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="va">True</span></span>
<span id="cb41-164"><a href="#cb41-164" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-165"><a href="#cb41-165" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb41-166"><a href="#cb41-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-167"><a href="#cb41-167" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> <span class="bu">sorted</span>(governance[<span class="st">"year"</span>].unique())</span>
<span id="cb41-168"><a href="#cb41-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-169"><a href="#cb41-169" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, yr <span class="kw">in</span> <span class="bu">enumerate</span>(years[:<span class="dv">6</span>]):</span>
<span id="cb41-170"><a href="#cb41-170" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[idx]</span>
<span id="cb41-171"><a href="#cb41-171" aria-hidden="true" tabindex="-1"></a>    data_yr <span class="op">=</span> governance.query(<span class="ss">f"year == </span><span class="sc">{</span>yr<span class="sc">}</span><span class="ss">"</span>)[<span class="st">"gindex"</span>]</span>
<span id="cb41-172"><a href="#cb41-172" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-173"><a href="#cb41-173" aria-hidden="true" tabindex="-1"></a>    p20 <span class="op">=</span> data_yr.quantile(<span class="fl">0.20</span>)</span>
<span id="cb41-174"><a href="#cb41-174" aria-hidden="true" tabindex="-1"></a>    p80 <span class="op">=</span> data_yr.quantile(<span class="fl">0.80</span>)</span>
<span id="cb41-175"><a href="#cb41-175" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-176"><a href="#cb41-176" aria-hidden="true" tabindex="-1"></a>    ax.hist(data_yr, bins<span class="op">=</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">int</span>(data_yr.<span class="bu">max</span>()) <span class="op">+</span> <span class="dv">2</span>), </span>
<span id="cb41-177"><a href="#cb41-177" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">"white"</span>, color<span class="op">=</span><span class="st">"#2c5f8a"</span>, alpha<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb41-178"><a href="#cb41-178" aria-hidden="true" tabindex="-1"></a>    ax.axvline(p20, color<span class="op">=</span><span class="st">"#d63e2a"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, </span>
<span id="cb41-179"><a href="#cb41-179" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="ss">f"P20=</span><span class="sc">{</span>p20<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb41-180"><a href="#cb41-180" aria-hidden="true" tabindex="-1"></a>    ax.axvline(p80, color<span class="op">=</span><span class="st">"#e8a317"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, </span>
<span id="cb41-181"><a href="#cb41-181" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="ss">f"P80=</span><span class="sc">{</span>p80<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb41-182"><a href="#cb41-182" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"</span><span class="sc">{</span>yr<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb41-183"><a href="#cb41-183" aria-hidden="true" tabindex="-1"></a>    ax.legend(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb41-184"><a href="#cb41-184" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"VN-GIndex"</span>)</span>
<span id="cb41-185"><a href="#cb41-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-186"><a href="#cb41-186" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(years), <span class="bu">len</span>(axes)):</span>
<span id="cb41-187"><a href="#cb41-187" aria-hidden="true" tabindex="-1"></a>    axes[idx].set_visible(<span class="va">False</span>)</span>
<span id="cb41-188"><a href="#cb41-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-189"><a href="#cb41-189" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">"Number of Firms"</span>)</span>
<span id="cb41-190"><a href="#cb41-190" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">3</span>].set_ylabel(<span class="st">"Number of Firms"</span>)</span>
<span id="cb41-191"><a href="#cb41-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-192"><a href="#cb41-192" aria-hidden="true" tabindex="-1"></a>fig.suptitle(</span>
<span id="cb41-193"><a href="#cb41-193" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distribution of VN-GIndex by Governance Vintage Year"</span>,</span>
<span id="cb41-194"><a href="#cb41-194" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>, y<span class="op">=</span><span class="fl">1.01</span></span>
<span id="cb41-195"><a href="#cb41-195" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-196"><a href="#cb41-196" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-197"><a href="#cb41-197" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-198"><a href="#cb41-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-199"><a href="#cb41-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-202"><a href="#cb41-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-203"><a href="#cb41-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-gindex-summary</span></span>
<span id="cb41-204"><a href="#cb41-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Summary statistics of the VN-GIndex by vintage year"</span></span>
<span id="cb41-205"><a href="#cb41-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-206"><a href="#cb41-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-207"><a href="#cb41-207" aria-hidden="true" tabindex="-1"></a>gindex_summary <span class="op">=</span> (</span>
<span id="cb41-208"><a href="#cb41-208" aria-hidden="true" tabindex="-1"></a>    governance</span>
<span id="cb41-209"><a href="#cb41-209" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"year"</span>)[<span class="st">"gindex"</span>]</span>
<span id="cb41-210"><a href="#cb41-210" aria-hidden="true" tabindex="-1"></a>    .describe()</span>
<span id="cb41-211"><a href="#cb41-211" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb41-212"><a href="#cb41-212" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-213"><a href="#cb41-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-214"><a href="#cb41-214" aria-hidden="true" tabindex="-1"></a>gindex_summary</span>
<span id="cb41-215"><a href="#cb41-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-216"><a href="#cb41-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-217"><a href="#cb41-217" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classifying Firms: Democracy, Neutral, and Dictatorship</span></span>
<span id="cb41-218"><a href="#cb41-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-219"><a href="#cb41-219" aria-hidden="true" tabindex="-1"></a>Rather than using fixed cutoffs (which may be inappropriate given varying index ranges across markets), we use percentile-based classification. Firms in the bottom quintile of the VN-GIndex distribution within each vintage year are classified as **Democracy** firms, and firms in the top quintile are classified as **Dictatorship** firms.</span>
<span id="cb41-220"><a href="#cb41-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-223"><a href="#cb41-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-224"><a href="#cb41-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: classify-firms</span></span>
<span id="cb41-225"><a href="#cb41-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-226"><a href="#cb41-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-227"><a href="#cb41-227" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classify_governance(group):</span>
<span id="cb41-228"><a href="#cb41-228" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Classify firms into Democracy, Neutral, or Dictatorship</span></span>
<span id="cb41-229"><a href="#cb41-229" aria-hidden="true" tabindex="-1"></a><span class="co">    within each governance vintage year."""</span></span>
<span id="cb41-230"><a href="#cb41-230" aria-hidden="true" tabindex="-1"></a>    p20 <span class="op">=</span> group[<span class="st">"gindex"</span>].quantile(<span class="fl">0.20</span>)</span>
<span id="cb41-231"><a href="#cb41-231" aria-hidden="true" tabindex="-1"></a>    p80 <span class="op">=</span> group[<span class="st">"gindex"</span>].quantile(<span class="fl">0.80</span>)</span>
<span id="cb41-232"><a href="#cb41-232" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-233"><a href="#cb41-233" aria-hidden="true" tabindex="-1"></a>    conditions <span class="op">=</span> [</span>
<span id="cb41-234"><a href="#cb41-234" aria-hidden="true" tabindex="-1"></a>        group[<span class="st">"gindex"</span>] <span class="op">&lt;=</span> p20,</span>
<span id="cb41-235"><a href="#cb41-235" aria-hidden="true" tabindex="-1"></a>        group[<span class="st">"gindex"</span>] <span class="op">&gt;=</span> p80</span>
<span id="cb41-236"><a href="#cb41-236" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb41-237"><a href="#cb41-237" aria-hidden="true" tabindex="-1"></a>    choices <span class="op">=</span> [<span class="st">"Democracy"</span>, <span class="st">"Dictatorship"</span>]</span>
<span id="cb41-238"><a href="#cb41-238" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-239"><a href="#cb41-239" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> group.assign(</span>
<span id="cb41-240"><a href="#cb41-240" aria-hidden="true" tabindex="-1"></a>        gx<span class="op">=</span>np.select(conditions, choices, default<span class="op">=</span><span class="st">"Neutral"</span>),</span>
<span id="cb41-241"><a href="#cb41-241" aria-hidden="true" tabindex="-1"></a>        gx_code<span class="op">=</span>np.select(</span>
<span id="cb41-242"><a href="#cb41-242" aria-hidden="true" tabindex="-1"></a>            conditions, [<span class="dv">1</span>, <span class="dv">3</span>], default<span class="op">=</span><span class="dv">2</span></span>
<span id="cb41-243"><a href="#cb41-243" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-244"><a href="#cb41-244" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-245"><a href="#cb41-245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group</span>
<span id="cb41-246"><a href="#cb41-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-247"><a href="#cb41-247" aria-hidden="true" tabindex="-1"></a>governance_classified <span class="op">=</span> (</span>
<span id="cb41-248"><a href="#cb41-248" aria-hidden="true" tabindex="-1"></a>    governance</span>
<span id="cb41-249"><a href="#cb41-249" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"year"</span>, group_keys<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-250"><a href="#cb41-250" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(classify_governance)</span>
<span id="cb41-251"><a href="#cb41-251" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-252"><a href="#cb41-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-253"><a href="#cb41-253" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of classification</span></span>
<span id="cb41-254"><a href="#cb41-254" aria-hidden="true" tabindex="-1"></a>classification_counts <span class="op">=</span> (</span>
<span id="cb41-255"><a href="#cb41-255" aria-hidden="true" tabindex="-1"></a>    governance_classified</span>
<span id="cb41-256"><a href="#cb41-256" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"year"</span>, <span class="st">"gx"</span>])</span>
<span id="cb41-257"><a href="#cb41-257" aria-hidden="true" tabindex="-1"></a>    .size()</span>
<span id="cb41-258"><a href="#cb41-258" aria-hidden="true" tabindex="-1"></a>    .unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb41-259"><a href="#cb41-259" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">"Democracy"</span>, <span class="st">"Neutral"</span>, <span class="st">"Dictatorship"</span>]]</span>
<span id="cb41-260"><a href="#cb41-260" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-261"><a href="#cb41-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-262"><a href="#cb41-262" aria-hidden="true" tabindex="-1"></a>classification_counts</span>
<span id="cb41-263"><a href="#cb41-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-264"><a href="#cb41-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-267"><a href="#cb41-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-268"><a href="#cb41-268" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-classification</span></span>
<span id="cb41-269"><a href="#cb41-269" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Number of firms in each governance category by vintage year"</span></span>
<span id="cb41-270"><a href="#cb41-270" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-271"><a href="#cb41-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-272"><a href="#cb41-272" aria-hidden="true" tabindex="-1"></a>classification_counts</span>
<span id="cb41-273"><a href="#cb41-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-274"><a href="#cb41-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-275"><a href="#cb41-275" aria-hidden="true" tabindex="-1"></a>We exclude firms with dual-class share structures, as these create a distinct governance arrangement that conflates voting rights with economic ownership. In the US, @gompers2003corporate similarly excluded dual-class firms.</span>
<span id="cb41-276"><a href="#cb41-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-279"><a href="#cb41-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-280"><a href="#cb41-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exclude-dualclass</span></span>
<span id="cb41-281"><a href="#cb41-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-282"><a href="#cb41-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-283"><a href="#cb41-283" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude dual-class firms if flagged in the data</span></span>
<span id="cb41-284"><a href="#cb41-284" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"dual_class"</span> <span class="kw">in</span> governance_classified.columns:</span>
<span id="cb41-285"><a href="#cb41-285" aria-hidden="true" tabindex="-1"></a>    governance_classified <span class="op">=</span> governance_classified.query(</span>
<span id="cb41-286"><a href="#cb41-286" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dual_class == 0"</span></span>
<span id="cb41-287"><a href="#cb41-287" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-288"><a href="#cb41-288" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Dual-class firms excluded."</span>)</span>
<span id="cb41-289"><a href="#cb41-289" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb41-290"><a href="#cb41-290" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"No dual_class indicator found; proceeding with all firms."</span>)</span>
<span id="cb41-291"><a href="#cb41-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-292"><a href="#cb41-292" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only Democracy and Dictatorship firms for the long-short strategy</span></span>
<span id="cb41-293"><a href="#cb41-293" aria-hidden="true" tabindex="-1"></a>portfolio_firms <span class="op">=</span> governance_classified.query(</span>
<span id="cb41-294"><a href="#cb41-294" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gx in ['Democracy', 'Dictatorship']"</span></span>
<span id="cb41-295"><a href="#cb41-295" aria-hidden="true" tabindex="-1"></a>).copy()</span>
<span id="cb41-296"><a href="#cb41-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-297"><a href="#cb41-297" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Firms in portfolio universe: </span><span class="sc">{</span><span class="bu">len</span>(portfolio_firms)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-298"><a href="#cb41-298" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(portfolio_firms[<span class="st">"gx"</span>].value_counts())</span>
<span id="cb41-299"><a href="#cb41-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-300"><a href="#cb41-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-301"><a href="#cb41-301" aria-hidden="true" tabindex="-1"></a><span class="fu">### Loading Stock Market Data</span></span>
<span id="cb41-302"><a href="#cb41-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-303"><a href="#cb41-303" aria-hidden="true" tabindex="-1"></a>We merge the governance classifications with monthly stock return data.</span>
<span id="cb41-304"><a href="#cb41-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-307"><a href="#cb41-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-308"><a href="#cb41-308" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-stock-data</span></span>
<span id="cb41-309"><a href="#cb41-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-310"><a href="#cb41-310" aria-hidden="true" tabindex="-1"></a>prices_monthly <span class="op">=</span> pd.read_sql_query(</span>
<span id="cb41-311"><a href="#cb41-311" aria-hidden="true" tabindex="-1"></a>    sql<span class="op">=</span><span class="st">"""</span></span>
<span id="cb41-312"><a href="#cb41-312" aria-hidden="true" tabindex="-1"></a><span class="st">        SELECT symbol, date, ret, ret_excess, mktcap, mktcap_lag, risk_free</span></span>
<span id="cb41-313"><a href="#cb41-313" aria-hidden="true" tabindex="-1"></a><span class="st">        FROM prices_monthly</span></span>
<span id="cb41-314"><a href="#cb41-314" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb41-315"><a href="#cb41-315" aria-hidden="true" tabindex="-1"></a>    con<span class="op">=</span>tidy_finance,</span>
<span id="cb41-316"><a href="#cb41-316" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>{<span class="st">"date"</span>}</span>
<span id="cb41-317"><a href="#cb41-317" aria-hidden="true" tabindex="-1"></a>).dropna()</span>
<span id="cb41-318"><a href="#cb41-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-319"><a href="#cb41-319" aria-hidden="true" tabindex="-1"></a>prices_monthly.info()</span>
<span id="cb41-320"><a href="#cb41-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-321"><a href="#cb41-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-322"><a href="#cb41-322" aria-hidden="true" tabindex="-1"></a>The stock market data contains:</span>
<span id="cb41-323"><a href="#cb41-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-324"><a href="#cb41-324" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`symbol`</span>: Stock symbol.</span>
<span id="cb41-325"><a href="#cb41-325" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`date`</span>: End-of-month date.</span>
<span id="cb41-326"><a href="#cb41-326" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ret`</span>: Monthly total return (including dividends).</span>
<span id="cb41-327"><a href="#cb41-327" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`retx`</span>: Monthly return excluding dividends (price return only).</span>
<span id="cb41-328"><a href="#cb41-328" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`price`</span>: End-of-month closing price (adjusted).</span>
<span id="cb41-329"><a href="#cb41-329" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`shares_outstanding`</span>: Number of shares outstanding (in thousands).</span>
<span id="cb41-330"><a href="#cb41-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-333"><a href="#cb41-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-334"><a href="#cb41-334" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compute-mktcap</span></span>
<span id="cb41-335"><a href="#cb41-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-336"><a href="#cb41-336" aria-hidden="true" tabindex="-1"></a>prices_monthly[[<span class="st">"symbol"</span>, <span class="st">"date"</span>, <span class="st">"ret"</span>, <span class="st">"mktcap"</span>]].describe()</span>
<span id="cb41-337"><a href="#cb41-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-338"><a href="#cb41-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-339"><a href="#cb41-339" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linking Governance and Stock Data</span></span>
<span id="cb41-340"><a href="#cb41-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-341"><a href="#cb41-341" aria-hidden="true" tabindex="-1"></a>Each governance vintage is valid from <span class="in">`date_effective`</span> through <span class="in">`date_expires`</span>. We assign monthly stock returns to the appropriate governance vintage. This is the portfolio rebalancing logic: portfolios are reformed when new governance data becomes available and held until the next vintage.</span>
<span id="cb41-342"><a href="#cb41-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-345"><a href="#cb41-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-346"><a href="#cb41-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: merge-governance-stocks</span></span>
<span id="cb41-347"><a href="#cb41-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-348"><a href="#cb41-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-349"><a href="#cb41-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge: each stock-month gets its governance classification</span></span>
<span id="cb41-350"><a href="#cb41-350" aria-hidden="true" tabindex="-1"></a><span class="co"># if the month falls within [date_effective, date_expires]</span></span>
<span id="cb41-351"><a href="#cb41-351" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(</span>
<span id="cb41-352"><a href="#cb41-352" aria-hidden="true" tabindex="-1"></a>    portfolio_firms[</span>
<span id="cb41-353"><a href="#cb41-353" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"symbol"</span>, <span class="st">"year"</span>, <span class="st">"gindex"</span>, <span class="st">"gx"</span>, <span class="st">"gx_code"</span>,</span>
<span id="cb41-354"><a href="#cb41-354" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_effective"</span>, <span class="st">"date_expires"</span>]</span>
<span id="cb41-355"><a href="#cb41-355" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb41-356"><a href="#cb41-356" aria-hidden="true" tabindex="-1"></a>    prices_monthly[[<span class="st">"symbol"</span>, <span class="st">"date"</span>, <span class="st">"ret"</span>, <span class="st">"retx"</span>, <span class="st">"mktcap"</span>]],</span>
<span id="cb41-357"><a href="#cb41-357" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">"symbol"</span>,</span>
<span id="cb41-358"><a href="#cb41-358" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb41-359"><a href="#cb41-359" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-360"><a href="#cb41-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-361"><a href="#cb41-361" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only months within the governance validity window</span></span>
<span id="cb41-362"><a href="#cb41-362" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merged.query(</span>
<span id="cb41-363"><a href="#cb41-363" aria-hidden="true" tabindex="-1"></a>    <span class="st">"date &gt;= date_effective and date &lt;= date_expires"</span></span>
<span id="cb41-364"><a href="#cb41-364" aria-hidden="true" tabindex="-1"></a>).sort_values([<span class="st">"symbol"</span>, <span class="st">"date"</span>])</span>
<span id="cb41-365"><a href="#cb41-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-366"><a href="#cb41-366" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total firm-month observations: </span><span class="sc">{</span><span class="bu">len</span>(merged)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb41-367"><a href="#cb41-367" aria-hidden="true" tabindex="-1"></a>merged.head()</span>
<span id="cb41-368"><a href="#cb41-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-369"><a href="#cb41-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-370"><a href="#cb41-370" aria-hidden="true" tabindex="-1"></a><span class="fu">### Computing Lagged Market Capitalization for Weighting</span></span>
<span id="cb41-371"><a href="#cb41-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-372"><a href="#cb41-372" aria-hidden="true" tabindex="-1"></a>Value-weighted portfolio returns require weighting each stock by its beginning-of-period market capitalization. We use the previous month's market capitalization as the weight. For the first observation of each stock in a given vintage, we estimate the beginning-of-period market value by dividing the current market value by $(1 + r_{x,t})$, where $r_{x,t}$ is the price return.</span>
<span id="cb41-373"><a href="#cb41-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-374"><a href="#cb41-374" aria-hidden="true" tabindex="-1"></a>The value-weighted return of portfolio $p$ in month $t$ is:</span>
<span id="cb41-375"><a href="#cb41-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-376"><a href="#cb41-376" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-377"><a href="#cb41-377" aria-hidden="true" tabindex="-1"></a>r_{p,t}^{vw} = \sum_{i \in p} w_{i,t-1} \cdot r_{i,t}, \quad w_{i,t-1} = \frac{\text{MV}_{i,t-1}}{\sum_{j \in p} \text{MV}_{j,t-1}}</span>
<span id="cb41-378"><a href="#cb41-378" aria-hidden="true" tabindex="-1"></a>$$ {#eq-vw-return}</span>
<span id="cb41-379"><a href="#cb41-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-380"><a href="#cb41-380" aria-hidden="true" tabindex="-1"></a>where $\text{MV}_{i,t-1}$ is the market capitalization of stock $i$ at the end of month $t-1$.</span>
<span id="cb41-381"><a href="#cb41-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-384"><a href="#cb41-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-385"><a href="#cb41-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compute-lag-mktcap</span></span>
<span id="cb41-386"><a href="#cb41-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-387"><a href="#cb41-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-388"><a href="#cb41-388" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merged.sort_values([<span class="st">"symbol"</span>, <span class="st">"date"</span>])</span>
<span id="cb41-389"><a href="#cb41-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-390"><a href="#cb41-390" aria-hidden="true" tabindex="-1"></a><span class="co"># Lagged market value (previous month)</span></span>
<span id="cb41-391"><a href="#cb41-391" aria-hidden="true" tabindex="-1"></a>merged[<span class="st">"mktcap_lag"</span>] <span class="op">=</span> merged.groupby(<span class="st">"symbol"</span>)[<span class="st">"mktcap"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb41-392"><a href="#cb41-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-393"><a href="#cb41-393" aria-hidden="true" tabindex="-1"></a><span class="co"># For first observation: estimate beginning-of-month market cap</span></span>
<span id="cb41-394"><a href="#cb41-394" aria-hidden="true" tabindex="-1"></a>first_obs <span class="op">=</span> merged.groupby(<span class="st">"symbol"</span>)[<span class="st">"date"</span>].transform(<span class="st">"min"</span>)</span>
<span id="cb41-395"><a href="#cb41-395" aria-hidden="true" tabindex="-1"></a>mask_first <span class="op">=</span> merged[<span class="st">"date"</span>] <span class="op">==</span> first_obs</span>
<span id="cb41-396"><a href="#cb41-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-397"><a href="#cb41-397" aria-hidden="true" tabindex="-1"></a>merged.loc[mask_first, <span class="st">"mktcap_lag"</span>] <span class="op">=</span> (</span>
<span id="cb41-398"><a href="#cb41-398" aria-hidden="true" tabindex="-1"></a>    merged.loc[mask_first, <span class="st">"mktcap"</span>] </span>
<span id="cb41-399"><a href="#cb41-399" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> merged.loc[mask_first, <span class="st">"retx"</span>])</span>
<span id="cb41-400"><a href="#cb41-400" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-401"><a href="#cb41-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-402"><a href="#cb41-402" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle any remaining missing weights</span></span>
<span id="cb41-403"><a href="#cb41-403" aria-hidden="true" tabindex="-1"></a>mask_missing <span class="op">=</span> merged[<span class="st">"mktcap_lag"</span>].isna()</span>
<span id="cb41-404"><a href="#cb41-404" aria-hidden="true" tabindex="-1"></a>merged.loc[mask_missing, <span class="st">"mktcap_lag"</span>] <span class="op">=</span> (</span>
<span id="cb41-405"><a href="#cb41-405" aria-hidden="true" tabindex="-1"></a>    merged.loc[mask_missing, <span class="st">"mktcap"</span>]</span>
<span id="cb41-406"><a href="#cb41-406" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> merged.loc[mask_missing, <span class="st">"retx"</span>])</span>
<span id="cb41-407"><a href="#cb41-407" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-408"><a href="#cb41-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-409"><a href="#cb41-409" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop observations with missing returns or weights</span></span>
<span id="cb41-410"><a href="#cb41-410" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merged.dropna(subset<span class="op">=</span>[<span class="st">"ret"</span>, <span class="st">"mktcap_lag"</span>])</span>
<span id="cb41-411"><a href="#cb41-411" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merged.query(<span class="st">"mktcap_lag &gt; 0"</span>)</span>
<span id="cb41-412"><a href="#cb41-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-413"><a href="#cb41-413" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Clean firm-month observations: </span><span class="sc">{</span><span class="bu">len</span>(merged)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb41-414"><a href="#cb41-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-415"><a href="#cb41-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-416"><a href="#cb41-416" aria-hidden="true" tabindex="-1"></a><span class="fu">## Portfolio Construction</span></span>
<span id="cb41-417"><a href="#cb41-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-418"><a href="#cb41-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### Value-Weighted Portfolio Returns</span></span>
<span id="cb41-419"><a href="#cb41-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-420"><a href="#cb41-420" aria-hidden="true" tabindex="-1"></a>We now compute the value-weighted monthly returns for the Democracy and Dictatorship portfolios.</span>
<span id="cb41-421"><a href="#cb41-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-424"><a href="#cb41-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-425"><a href="#cb41-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compute-portfolio-returns</span></span>
<span id="cb41-426"><a href="#cb41-426" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-427"><a href="#cb41-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-428"><a href="#cb41-428" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> value_weighted_return(group):</span>
<span id="cb41-429"><a href="#cb41-429" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute value-weighted return for a group of stocks."""</span></span>
<span id="cb41-430"><a href="#cb41-430" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> group[<span class="st">"mktcap_lag"</span>]</span>
<span id="cb41-431"><a href="#cb41-431" aria-hidden="true" tabindex="-1"></a>    total_weight <span class="op">=</span> weights.<span class="bu">sum</span>()</span>
<span id="cb41-432"><a href="#cb41-432" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> total_weight <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb41-433"><a href="#cb41-433" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb41-434"><a href="#cb41-434" aria-hidden="true" tabindex="-1"></a>    vw_ret <span class="op">=</span> (group[<span class="st">"ret"</span>] <span class="op">*</span> weights).<span class="bu">sum</span>() <span class="op">/</span> total_weight</span>
<span id="cb41-435"><a href="#cb41-435" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vw_ret</span>
<span id="cb41-436"><a href="#cb41-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-437"><a href="#cb41-437" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute VW returns by date and governance group</span></span>
<span id="cb41-438"><a href="#cb41-438" aria-hidden="true" tabindex="-1"></a>portfolio_returns <span class="op">=</span> (</span>
<span id="cb41-439"><a href="#cb41-439" aria-hidden="true" tabindex="-1"></a>    merged</span>
<span id="cb41-440"><a href="#cb41-440" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"date"</span>, <span class="st">"gx"</span>])</span>
<span id="cb41-441"><a href="#cb41-441" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(value_weighted_return, include_groups<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-442"><a href="#cb41-442" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb41-443"><a href="#cb41-443" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">"ret_vw"</span>})</span>
<span id="cb41-444"><a href="#cb41-444" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-445"><a href="#cb41-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-446"><a href="#cb41-446" aria-hidden="true" tabindex="-1"></a><span class="co"># Also compute equal-weighted returns for robustness</span></span>
<span id="cb41-447"><a href="#cb41-447" aria-hidden="true" tabindex="-1"></a>portfolio_returns_ew <span class="op">=</span> (</span>
<span id="cb41-448"><a href="#cb41-448" aria-hidden="true" tabindex="-1"></a>    merged</span>
<span id="cb41-449"><a href="#cb41-449" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"date"</span>, <span class="st">"gx"</span>])[<span class="st">"ret"</span>]</span>
<span id="cb41-450"><a href="#cb41-450" aria-hidden="true" tabindex="-1"></a>    .mean()</span>
<span id="cb41-451"><a href="#cb41-451" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb41-452"><a href="#cb41-452" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"ret"</span>: <span class="st">"ret_ew"</span>})</span>
<span id="cb41-453"><a href="#cb41-453" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-454"><a href="#cb41-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-455"><a href="#cb41-455" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge EW returns</span></span>
<span id="cb41-456"><a href="#cb41-456" aria-hidden="true" tabindex="-1"></a>portfolio_returns <span class="op">=</span> portfolio_returns.merge(</span>
<span id="cb41-457"><a href="#cb41-457" aria-hidden="true" tabindex="-1"></a>    portfolio_returns_ew, on<span class="op">=</span>[<span class="st">"date"</span>, <span class="st">"gx"</span>], how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb41-458"><a href="#cb41-458" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-459"><a href="#cb41-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-460"><a href="#cb41-460" aria-hidden="true" tabindex="-1"></a>portfolio_returns.head(<span class="dv">10</span>)</span>
<span id="cb41-461"><a href="#cb41-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-462"><a href="#cb41-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-463"><a href="#cb41-463" aria-hidden="true" tabindex="-1"></a><span class="fu">### Long-Short Portfolio: Democracy minus Dictatorship</span></span>
<span id="cb41-464"><a href="#cb41-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-465"><a href="#cb41-465" aria-hidden="true" tabindex="-1"></a>The trading strategy goes long the Democracy portfolio and short the Dictatorship portfolio. The monthly return of this long-short strategy is:</span>
<span id="cb41-466"><a href="#cb41-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-467"><a href="#cb41-467" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-468"><a href="#cb41-468" aria-hidden="true" tabindex="-1"></a>r_{t}^{D-D} = r_{t}^{\text{Democracy}} - r_{t}^{\text{Dictatorship}}</span>
<span id="cb41-469"><a href="#cb41-469" aria-hidden="true" tabindex="-1"></a>$$ {#eq-long-short}</span>
<span id="cb41-470"><a href="#cb41-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-473"><a href="#cb41-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-474"><a href="#cb41-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compute-long-short</span></span>
<span id="cb41-475"><a href="#cb41-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-476"><a href="#cb41-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-477"><a href="#cb41-477" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot to wide format</span></span>
<span id="cb41-478"><a href="#cb41-478" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> portfolio_returns.pivot(</span>
<span id="cb41-479"><a href="#cb41-479" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"date"</span>, columns<span class="op">=</span><span class="st">"gx"</span>, values<span class="op">=</span>[<span class="st">"ret_vw"</span>, <span class="st">"ret_ew"</span>]</span>
<span id="cb41-480"><a href="#cb41-480" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-481"><a href="#cb41-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-482"><a href="#cb41-482" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten column names</span></span>
<span id="cb41-483"><a href="#cb41-483" aria-hidden="true" tabindex="-1"></a>returns_wide.columns <span class="op">=</span> [</span>
<span id="cb41-484"><a href="#cb41-484" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"</span><span class="sc">{</span>val<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>grp<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> val, grp <span class="kw">in</span> returns_wide.columns</span>
<span id="cb41-485"><a href="#cb41-485" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb41-486"><a href="#cb41-486" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> returns_wide.reset_index()</span>
<span id="cb41-487"><a href="#cb41-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-488"><a href="#cb41-488" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute long-short returns</span></span>
<span id="cb41-489"><a href="#cb41-489" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> returns_wide.assign(</span>
<span id="cb41-490"><a href="#cb41-490" aria-hidden="true" tabindex="-1"></a>    ret_diff_vw<span class="op">=</span><span class="kw">lambda</span> x: (</span>
<span id="cb41-491"><a href="#cb41-491" aria-hidden="true" tabindex="-1"></a>        x[<span class="st">"ret_vw_Democracy"</span>] <span class="op">-</span> x[<span class="st">"ret_vw_Dictatorship"</span>]</span>
<span id="cb41-492"><a href="#cb41-492" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-493"><a href="#cb41-493" aria-hidden="true" tabindex="-1"></a>    ret_diff_ew<span class="op">=</span><span class="kw">lambda</span> x: (</span>
<span id="cb41-494"><a href="#cb41-494" aria-hidden="true" tabindex="-1"></a>        x[<span class="st">"ret_ew_Democracy"</span>] <span class="op">-</span> x[<span class="st">"ret_ew_Dictatorship"</span>]</span>
<span id="cb41-495"><a href="#cb41-495" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-496"><a href="#cb41-496" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-497"><a href="#cb41-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-498"><a href="#cb41-498" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> returns_wide.sort_values(<span class="st">"date"</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-499"><a href="#cb41-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-500"><a href="#cb41-500" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Monthly return series: </span><span class="sc">{</span><span class="bu">len</span>(returns_wide)<span class="sc">}</span><span class="ss"> months"</span>)</span>
<span id="cb41-501"><a href="#cb41-501" aria-hidden="true" tabindex="-1"></a>returns_wide.head()</span>
<span id="cb41-502"><a href="#cb41-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-503"><a href="#cb41-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-504"><a href="#cb41-504" aria-hidden="true" tabindex="-1"></a><span class="fu">### Portfolio Characteristics Over Time</span></span>
<span id="cb41-505"><a href="#cb41-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-506"><a href="#cb41-506" aria-hidden="true" tabindex="-1"></a>Before examining returns, we document the number of firms and average governance scores in each portfolio over time.</span>
<span id="cb41-507"><a href="#cb41-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-510"><a href="#cb41-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-511"><a href="#cb41-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-portfolio-chars</span></span>
<span id="cb41-512"><a href="#cb41-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-513"><a href="#cb41-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Portfolio characteristics by governance group and year"</span></span>
<span id="cb41-514"><a href="#cb41-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-515"><a href="#cb41-515" aria-hidden="true" tabindex="-1"></a>portfolio_chars <span class="op">=</span> (</span>
<span id="cb41-516"><a href="#cb41-516" aria-hidden="true" tabindex="-1"></a>    merged</span>
<span id="cb41-517"><a href="#cb41-517" aria-hidden="true" tabindex="-1"></a>    .assign(year_month<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"date"</span>].dt.to_period(<span class="st">"Y"</span>))</span>
<span id="cb41-518"><a href="#cb41-518" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"year_month"</span>, <span class="st">"gx"</span>])</span>
<span id="cb41-519"><a href="#cb41-519" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb41-520"><a href="#cb41-520" aria-hidden="true" tabindex="-1"></a>        n_firms<span class="op">=</span>(<span class="st">"symbol"</span>, <span class="st">"nunique"</span>),</span>
<span id="cb41-521"><a href="#cb41-521" aria-hidden="true" tabindex="-1"></a>        avg_gindex<span class="op">=</span>(<span class="st">"gindex"</span>, <span class="st">"mean"</span>),</span>
<span id="cb41-522"><a href="#cb41-522" aria-hidden="true" tabindex="-1"></a>        avg_mktcap<span class="op">=</span>(<span class="st">"mktcap"</span>, <span class="st">"mean"</span>),</span>
<span id="cb41-523"><a href="#cb41-523" aria-hidden="true" tabindex="-1"></a>        median_mktcap<span class="op">=</span>(<span class="st">"mktcap"</span>, <span class="st">"median"</span>)</span>
<span id="cb41-524"><a href="#cb41-524" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-525"><a href="#cb41-525" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb41-526"><a href="#cb41-526" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-527"><a href="#cb41-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-528"><a href="#cb41-528" aria-hidden="true" tabindex="-1"></a>portfolio_chars</span>
<span id="cb41-529"><a href="#cb41-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-530"><a href="#cb41-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-531"><a href="#cb41-531" aria-hidden="true" tabindex="-1"></a><span class="fu">## Empirical Results</span></span>
<span id="cb41-532"><a href="#cb41-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-533"><a href="#cb41-533" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary Statistics of Portfolio Returns</span></span>
<span id="cb41-534"><a href="#cb41-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-537"><a href="#cb41-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-538"><a href="#cb41-538" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-return-summary</span></span>
<span id="cb41-539"><a href="#cb41-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Summary statistics of monthly portfolio returns (in percent)"</span></span>
<span id="cb41-540"><a href="#cb41-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-541"><a href="#cb41-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-542"><a href="#cb41-542" aria-hidden="true" tabindex="-1"></a>return_cols <span class="op">=</span> [</span>
<span id="cb41-543"><a href="#cb41-543" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ret_vw_Democracy"</span>, <span class="st">"ret_vw_Dictatorship"</span>, <span class="st">"ret_diff_vw"</span>,</span>
<span id="cb41-544"><a href="#cb41-544" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ret_ew_Democracy"</span>, <span class="st">"ret_ew_Dictatorship"</span>, <span class="st">"ret_diff_ew"</span></span>
<span id="cb41-545"><a href="#cb41-545" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb41-546"><a href="#cb41-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-547"><a href="#cb41-547" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="op">=</span> (</span>
<span id="cb41-548"><a href="#cb41-548" aria-hidden="true" tabindex="-1"></a>    returns_wide[return_cols]</span>
<span id="cb41-549"><a href="#cb41-549" aria-hidden="true" tabindex="-1"></a>    .mul(<span class="dv">100</span>)  <span class="co"># Convert to percent</span></span>
<span id="cb41-550"><a href="#cb41-550" aria-hidden="true" tabindex="-1"></a>    .describe()</span>
<span id="cb41-551"><a href="#cb41-551" aria-hidden="true" tabindex="-1"></a>    .T</span>
<span id="cb41-552"><a href="#cb41-552" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb41-553"><a href="#cb41-553" aria-hidden="true" tabindex="-1"></a>        skewness<span class="op">=</span>returns_wide[return_cols].mul(<span class="dv">100</span>).skew(),</span>
<span id="cb41-554"><a href="#cb41-554" aria-hidden="true" tabindex="-1"></a>        sharpe<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"mean"</span>] <span class="op">/</span> x[<span class="st">"std"</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb41-555"><a href="#cb41-555" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-556"><a href="#cb41-556" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb41-557"><a href="#cb41-557" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-558"><a href="#cb41-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-559"><a href="#cb41-559" aria-hidden="true" tabindex="-1"></a>summary_stats.index <span class="op">=</span> [</span>
<span id="cb41-560"><a href="#cb41-560" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Democracy (VW)"</span>, <span class="st">"Dictatorship (VW)"</span>, <span class="st">"Long-Short (VW)"</span>,</span>
<span id="cb41-561"><a href="#cb41-561" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Democracy (EW)"</span>, <span class="st">"Dictatorship (EW)"</span>, <span class="st">"Long-Short (EW)"</span></span>
<span id="cb41-562"><a href="#cb41-562" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb41-563"><a href="#cb41-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-564"><a href="#cb41-564" aria-hidden="true" tabindex="-1"></a>summary_stats[[<span class="st">"mean"</span>, <span class="st">"std"</span>, <span class="st">"min"</span>, <span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span>, <span class="st">"max"</span>, </span>
<span id="cb41-565"><a href="#cb41-565" aria-hidden="true" tabindex="-1"></a>               <span class="st">"skewness"</span>, <span class="st">"sharpe"</span>]]</span>
<span id="cb41-566"><a href="#cb41-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-567"><a href="#cb41-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-568"><a href="#cb41-568" aria-hidden="true" tabindex="-1"></a>The **Sharpe ratio** is computed as:</span>
<span id="cb41-569"><a href="#cb41-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-570"><a href="#cb41-570" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-571"><a href="#cb41-571" aria-hidden="true" tabindex="-1"></a>\text{SR} = \frac{\bar{r}_p}{\sigma_p} \times \sqrt{12}</span>
<span id="cb41-572"><a href="#cb41-572" aria-hidden="true" tabindex="-1"></a>$$ {#eq-sharpe}</span>
<span id="cb41-573"><a href="#cb41-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-574"><a href="#cb41-574" aria-hidden="true" tabindex="-1"></a>where $\bar{r}_p$ and $\sigma_p$ are the sample mean and standard deviation of monthly portfolio returns, and the $\sqrt{12}$ scaling annualizes the ratio.</span>
<span id="cb41-575"><a href="#cb41-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-576"><a href="#cb41-576" aria-hidden="true" tabindex="-1"></a><span class="fu">### T-Test: Is the Long-Short Return Statistically Significant?</span></span>
<span id="cb41-577"><a href="#cb41-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-578"><a href="#cb41-578" aria-hidden="true" tabindex="-1"></a>The null hypothesis is that the mean monthly return difference between the Democracy and Dictatorship portfolios is zero:</span>
<span id="cb41-579"><a href="#cb41-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-580"><a href="#cb41-580" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-581"><a href="#cb41-581" aria-hidden="true" tabindex="-1"></a>H_0: \mathbb{E}<span class="co">[</span><span class="ot">r_t^{\text{Democracy}} - r_t^{\text{Dictatorship}}</span><span class="co">]</span> = 0</span>
<span id="cb41-582"><a href="#cb41-582" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ttest-null}</span>
<span id="cb41-583"><a href="#cb41-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-586"><a href="#cb41-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-587"><a href="#cb41-587" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-ttest</span></span>
<span id="cb41-588"><a href="#cb41-588" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "T-test for the mean difference between Democracy and Dictatorship portfolio returns"</span></span>
<span id="cb41-589"><a href="#cb41-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-590"><a href="#cb41-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-591"><a href="#cb41-591" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perform_ttest(series, label):</span>
<span id="cb41-592"><a href="#cb41-592" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Perform a one-sample t-test and return results."""</span></span>
<span id="cb41-593"><a href="#cb41-593" aria-hidden="true" tabindex="-1"></a>    clean <span class="op">=</span> series.dropna()</span>
<span id="cb41-594"><a href="#cb41-594" aria-hidden="true" tabindex="-1"></a>    t_stat, p_value <span class="op">=</span> stats.ttest_1samp(clean, <span class="dv">0</span>)</span>
<span id="cb41-595"><a href="#cb41-595" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb41-596"><a href="#cb41-596" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Portfolio"</span>: label,</span>
<span id="cb41-597"><a href="#cb41-597" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mean (%)"</span>: clean.mean() <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-598"><a href="#cb41-598" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Std (%)"</span>: clean.std() <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-599"><a href="#cb41-599" aria-hidden="true" tabindex="-1"></a>        <span class="st">"T-statistic"</span>: t_stat,</span>
<span id="cb41-600"><a href="#cb41-600" aria-hidden="true" tabindex="-1"></a>        <span class="st">"P-value"</span>: p_value,</span>
<span id="cb41-601"><a href="#cb41-601" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N months"</span>: <span class="bu">len</span>(clean),</span>
<span id="cb41-602"><a href="#cb41-602" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Significant (5%)"</span>: <span class="st">"Yes"</span> <span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">"No"</span></span>
<span id="cb41-603"><a href="#cb41-603" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-604"><a href="#cb41-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-605"><a href="#cb41-605" aria-hidden="true" tabindex="-1"></a>ttest_results <span class="op">=</span> pd.DataFrame([</span>
<span id="cb41-606"><a href="#cb41-606" aria-hidden="true" tabindex="-1"></a>    perform_ttest(returns_wide[<span class="st">"ret_diff_vw"</span>], <span class="st">"VW Long-Short"</span>),</span>
<span id="cb41-607"><a href="#cb41-607" aria-hidden="true" tabindex="-1"></a>    perform_ttest(returns_wide[<span class="st">"ret_diff_ew"</span>], <span class="st">"EW Long-Short"</span>),</span>
<span id="cb41-608"><a href="#cb41-608" aria-hidden="true" tabindex="-1"></a>    perform_ttest(returns_wide[<span class="st">"ret_vw_Democracy"</span>], <span class="st">"VW Democracy"</span>),</span>
<span id="cb41-609"><a href="#cb41-609" aria-hidden="true" tabindex="-1"></a>    perform_ttest(returns_wide[<span class="st">"ret_vw_Dictatorship"</span>], <span class="st">"VW Dictatorship"</span>)</span>
<span id="cb41-610"><a href="#cb41-610" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb41-611"><a href="#cb41-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-612"><a href="#cb41-612" aria-hidden="true" tabindex="-1"></a>ttest_results.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb41-613"><a href="#cb41-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-614"><a href="#cb41-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-615"><a href="#cb41-615" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cumulative Returns: The Visual Case for Governance</span></span>
<span id="cb41-616"><a href="#cb41-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-617"><a href="#cb41-617" aria-hidden="true" tabindex="-1"></a>One of the most compelling ways to present the governance effect is through cumulative wealth plots. We track the growth of \$1 invested in each portfolio at the beginning of the sample period.</span>
<span id="cb41-618"><a href="#cb41-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-619"><a href="#cb41-619" aria-hidden="true" tabindex="-1"></a>The cumulative return at time $T$ is:</span>
<span id="cb41-620"><a href="#cb41-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-621"><a href="#cb41-621" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-622"><a href="#cb41-622" aria-hidden="true" tabindex="-1"></a>W_T = \prod_{t=1}^{T} (1 + r_{p,t})</span>
<span id="cb41-623"><a href="#cb41-623" aria-hidden="true" tabindex="-1"></a>$$ {#eq-cumret}</span>
<span id="cb41-624"><a href="#cb41-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-627"><a href="#cb41-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-628"><a href="#cb41-628" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-cumulative-returns</span></span>
<span id="cb41-629"><a href="#cb41-629" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Cumulative value of $1 invested in the Democracy portfolio (strong shareholder rights) versus the Dictatorship portfolio (weak shareholder rights). The shaded area represents the cumulative outperformance of the Democracy strategy."</span></span>
<span id="cb41-630"><a href="#cb41-630" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Line chart showing cumulative returns of Democracy and Dictatorship portfolios over time."</span></span>
<span id="cb41-631"><a href="#cb41-631" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-632"><a href="#cb41-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-633"><a href="#cb41-633" aria-hidden="true" tabindex="-1"></a>returns_wide <span class="op">=</span> returns_wide.sort_values(<span class="st">"date"</span>)</span>
<span id="cb41-634"><a href="#cb41-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-635"><a href="#cb41-635" aria-hidden="true" tabindex="-1"></a>cum_democracy <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_vw_Democracy"</span>]).cumprod()</span>
<span id="cb41-636"><a href="#cb41-636" aria-hidden="true" tabindex="-1"></a>cum_dictatorship <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_vw_Dictatorship"</span>]).cumprod()</span>
<span id="cb41-637"><a href="#cb41-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-638"><a href="#cb41-638" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb41-639"><a href="#cb41-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-640"><a href="#cb41-640" aria-hidden="true" tabindex="-1"></a>ax.plot(</span>
<span id="cb41-641"><a href="#cb41-641" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], cum_democracy,</span>
<span id="cb41-642"><a href="#cb41-642" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#1a6b3c"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Democracy Portfolio"</span></span>
<span id="cb41-643"><a href="#cb41-643" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-644"><a href="#cb41-644" aria-hidden="true" tabindex="-1"></a>ax.plot(</span>
<span id="cb41-645"><a href="#cb41-645" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], cum_dictatorship,</span>
<span id="cb41-646"><a href="#cb41-646" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#c0392b"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">"--"</span>,</span>
<span id="cb41-647"><a href="#cb41-647" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"Dictatorship Portfolio"</span></span>
<span id="cb41-648"><a href="#cb41-648" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-649"><a href="#cb41-649" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb41-650"><a href="#cb41-650" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>],</span>
<span id="cb41-651"><a href="#cb41-651" aria-hidden="true" tabindex="-1"></a>    cum_democracy, cum_dictatorship,</span>
<span id="cb41-652"><a href="#cb41-652" aria-hidden="true" tabindex="-1"></a>    where<span class="op">=</span>cum_democracy <span class="op">&gt;=</span> cum_dictatorship,</span>
<span id="cb41-653"><a href="#cb41-653" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.15</span>, color<span class="op">=</span><span class="st">"#1a6b3c"</span>, label<span class="op">=</span><span class="st">"Outperformance"</span></span>
<span id="cb41-654"><a href="#cb41-654" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-655"><a href="#cb41-655" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb41-656"><a href="#cb41-656" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>],</span>
<span id="cb41-657"><a href="#cb41-657" aria-hidden="true" tabindex="-1"></a>    cum_democracy, cum_dictatorship,</span>
<span id="cb41-658"><a href="#cb41-658" aria-hidden="true" tabindex="-1"></a>    where<span class="op">=</span>cum_democracy <span class="op">&lt;</span> cum_dictatorship,</span>
<span id="cb41-659"><a href="#cb41-659" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.15</span>, color<span class="op">=</span><span class="st">"#c0392b"</span></span>
<span id="cb41-660"><a href="#cb41-660" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-661"><a href="#cb41-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-662"><a href="#cb41-662" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Date"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb41-663"><a href="#cb41-663" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Cumulative Value of $1 Invested"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb41-664"><a href="#cb41-664" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb41-665"><a href="#cb41-665" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Democracy vs. Dictatorship Portfolios: Cumulative Returns"</span>,</span>
<span id="cb41-666"><a href="#cb41-666" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb41-667"><a href="#cb41-667" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-668"><a href="#cb41-668" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">10</span>, loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb41-669"><a href="#cb41-669" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb41-670"><a href="#cb41-670" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(returns_wide[<span class="st">"date"</span>].<span class="bu">min</span>(), returns_wide[<span class="st">"date"</span>].<span class="bu">max</span>())</span>
<span id="cb41-671"><a href="#cb41-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-672"><a href="#cb41-672" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-673"><a href="#cb41-673" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-674"><a href="#cb41-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-675"><a href="#cb41-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-678"><a href="#cb41-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-679"><a href="#cb41-679" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-cumulative-longshort</span></span>
<span id="cb41-680"><a href="#cb41-680" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Cumulative return of the long-short (Democracy minus Dictatorship) strategy. Values above 1.0 indicate cumulative outperformance of Democracy over Dictatorship."</span></span>
<span id="cb41-681"><a href="#cb41-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-682"><a href="#cb41-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-683"><a href="#cb41-683" aria-hidden="true" tabindex="-1"></a>cum_longshort <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_diff_vw"</span>]).cumprod()</span>
<span id="cb41-684"><a href="#cb41-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-685"><a href="#cb41-685" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb41-686"><a href="#cb41-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-687"><a href="#cb41-687" aria-hidden="true" tabindex="-1"></a>ax.plot(</span>
<span id="cb41-688"><a href="#cb41-688" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], cum_longshort,</span>
<span id="cb41-689"><a href="#cb41-689" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#2c5f8a"</span>, linewidth<span class="op">=</span><span class="dv">2</span></span>
<span id="cb41-690"><a href="#cb41-690" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-691"><a href="#cb41-691" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="fl">1.0</span>, color<span class="op">=</span><span class="st">"gray"</span>, linestyle<span class="op">=</span><span class="st">":"</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb41-692"><a href="#cb41-692" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb41-693"><a href="#cb41-693" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], <span class="fl">1.0</span>, cum_longshort,</span>
<span id="cb41-694"><a href="#cb41-694" aria-hidden="true" tabindex="-1"></a>    where<span class="op">=</span>cum_longshort <span class="op">&gt;=</span> <span class="fl">1.0</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"#2c5f8a"</span></span>
<span id="cb41-695"><a href="#cb41-695" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-696"><a href="#cb41-696" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb41-697"><a href="#cb41-697" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], <span class="fl">1.0</span>, cum_longshort,</span>
<span id="cb41-698"><a href="#cb41-698" aria-hidden="true" tabindex="-1"></a>    where<span class="op">=</span>cum_longshort <span class="op">&lt;</span> <span class="fl">1.0</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"#c0392b"</span></span>
<span id="cb41-699"><a href="#cb41-699" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-700"><a href="#cb41-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-701"><a href="#cb41-701" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Date"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb41-702"><a href="#cb41-702" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Cumulative Long-Short Return"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb41-703"><a href="#cb41-703" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb41-704"><a href="#cb41-704" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Long-Short Governance Strategy: Cumulative Performance"</span>,</span>
<span id="cb41-705"><a href="#cb41-705" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb41-706"><a href="#cb41-706" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-707"><a href="#cb41-707" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb41-708"><a href="#cb41-708" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-709"><a href="#cb41-709" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-710"><a href="#cb41-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-711"><a href="#cb41-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-712"><a href="#cb41-712" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rolling Performance</span></span>
<span id="cb41-713"><a href="#cb41-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-714"><a href="#cb41-714" aria-hidden="true" tabindex="-1"></a>The governance premium may not be constant over time. We examine 12-month rolling average returns and rolling Sharpe ratios to assess stability.</span>
<span id="cb41-715"><a href="#cb41-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-718"><a href="#cb41-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-719"><a href="#cb41-719" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rolling-returns</span></span>
<span id="cb41-720"><a href="#cb41-720" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "12-month rolling average return of the long-short governance strategy. Dashed horizontal line at zero."</span></span>
<span id="cb41-721"><a href="#cb41-721" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-722"><a href="#cb41-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-723"><a href="#cb41-723" aria-hidden="true" tabindex="-1"></a>rolling_mean <span class="op">=</span> (</span>
<span id="cb41-724"><a href="#cb41-724" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"ret_diff_vw"</span>]</span>
<span id="cb41-725"><a href="#cb41-725" aria-hidden="true" tabindex="-1"></a>    .rolling(window<span class="op">=</span><span class="dv">12</span>, min_periods<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb41-726"><a href="#cb41-726" aria-hidden="true" tabindex="-1"></a>    .mean() <span class="op">*</span> <span class="dv">12</span> <span class="op">*</span> <span class="dv">100</span>  <span class="co"># Annualized</span></span>
<span id="cb41-727"><a href="#cb41-727" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-728"><a href="#cb41-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-729"><a href="#cb41-729" aria-hidden="true" tabindex="-1"></a>rolling_std <span class="op">=</span> (</span>
<span id="cb41-730"><a href="#cb41-730" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"ret_diff_vw"</span>]</span>
<span id="cb41-731"><a href="#cb41-731" aria-hidden="true" tabindex="-1"></a>    .rolling(window<span class="op">=</span><span class="dv">12</span>, min_periods<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb41-732"><a href="#cb41-732" aria-hidden="true" tabindex="-1"></a>    .std() <span class="op">*</span> np.sqrt(<span class="dv">12</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb41-733"><a href="#cb41-733" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-734"><a href="#cb41-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-735"><a href="#cb41-735" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-736"><a href="#cb41-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-737"><a href="#cb41-737" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling annualized return</span></span>
<span id="cb41-738"><a href="#cb41-738" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(</span>
<span id="cb41-739"><a href="#cb41-739" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], rolling_mean,</span>
<span id="cb41-740"><a href="#cb41-740" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#2c5f8a"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb41-741"><a href="#cb41-741" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-742"><a href="#cb41-742" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"gray"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb41-743"><a href="#cb41-743" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">"Annualized Return (%)"</span>)</span>
<span id="cb41-744"><a href="#cb41-744" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(</span>
<span id="cb41-745"><a href="#cb41-745" aria-hidden="true" tabindex="-1"></a>    <span class="st">"12-Month Rolling Annualized Return: Long-Short Governance Strategy"</span>,</span>
<span id="cb41-746"><a href="#cb41-746" aria-hidden="true" tabindex="-1"></a>    fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb41-747"><a href="#cb41-747" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-748"><a href="#cb41-748" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb41-749"><a href="#cb41-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-750"><a href="#cb41-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling annualized volatility</span></span>
<span id="cb41-751"><a href="#cb41-751" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(</span>
<span id="cb41-752"><a href="#cb41-752" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], rolling_std,</span>
<span id="cb41-753"><a href="#cb41-753" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#c0392b"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb41-754"><a href="#cb41-754" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-755"><a href="#cb41-755" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">"Annualized Volatility (%)"</span>)</span>
<span id="cb41-756"><a href="#cb41-756" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">"Date"</span>)</span>
<span id="cb41-757"><a href="#cb41-757" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(</span>
<span id="cb41-758"><a href="#cb41-758" aria-hidden="true" tabindex="-1"></a>    <span class="st">"12-Month Rolling Annualized Volatility"</span>,</span>
<span id="cb41-759"><a href="#cb41-759" aria-hidden="true" tabindex="-1"></a>    fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb41-760"><a href="#cb41-760" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-761"><a href="#cb41-761" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb41-762"><a href="#cb41-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-763"><a href="#cb41-763" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-764"><a href="#cb41-764" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-765"><a href="#cb41-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-766"><a href="#cb41-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-767"><a href="#cb41-767" aria-hidden="true" tabindex="-1"></a><span class="fu">## Risk-Adjusted Performance: Factor Model Analysis</span></span>
<span id="cb41-768"><a href="#cb41-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-769"><a href="#cb41-769" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Four-Factor Model</span></span>
<span id="cb41-770"><a href="#cb41-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-771"><a href="#cb41-771" aria-hidden="true" tabindex="-1"></a>Raw returns alone do not tell us whether the governance strategy generates **abnormal** returns (i.e., returns that cannot be explained by exposure to common risk factors). We estimate the following four-factor model:</span>
<span id="cb41-772"><a href="#cb41-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-773"><a href="#cb41-773" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-774"><a href="#cb41-774" aria-hidden="true" tabindex="-1"></a>r_{t}^{D-D} - r_{f,t} = \alpha + \beta_1 (r_{m,t} - r_{f,t}) + \beta_2 \text{SMB}_t + \beta_3 \text{HML}_t + \beta_4 \text{UMD}_t + \varepsilon_t</span>
<span id="cb41-775"><a href="#cb41-775" aria-hidden="true" tabindex="-1"></a>$$ {#eq-four-factor}</span>
<span id="cb41-776"><a href="#cb41-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-777"><a href="#cb41-777" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb41-778"><a href="#cb41-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-779"><a href="#cb41-779" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$r_{t}^{D-D}$ is the long-short governance portfolio return,</span>
<span id="cb41-780"><a href="#cb41-780" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$r_{f,t}$ is the risk-free rate,</span>
<span id="cb41-781"><a href="#cb41-781" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$r_{m,t} - r_{f,t}$ is the market excess return (MKTRF),</span>
<span id="cb41-782"><a href="#cb41-782" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\text{SMB}_t$ is the size factor (Small Minus Big),</span>
<span id="cb41-783"><a href="#cb41-783" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\text{HML}_t$ is the value factor (High Minus Low book-to-market),</span>
<span id="cb41-784"><a href="#cb41-784" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\text{UMD}_t$ is the momentum factor (Up Minus Down),</span>
<span id="cb41-785"><a href="#cb41-785" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\alpha$ is the abnormal return (the intercept of interest).</span>
<span id="cb41-786"><a href="#cb41-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-787"><a href="#cb41-787" aria-hidden="true" tabindex="-1"></a>The **alpha** ($\alpha$) represents the average monthly return that cannot be attributed to exposure to the four systematic risk factors. A statistically significant positive alpha indicates that the governance strategy generates genuine abnormal returns.</span>
<span id="cb41-788"><a href="#cb41-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-789"><a href="#cb41-789" aria-hidden="true" tabindex="-1"></a><span class="fu">### Loading Factor Data</span></span>
<span id="cb41-790"><a href="#cb41-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-793"><a href="#cb41-793" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-794"><a href="#cb41-794" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-factors</span></span>
<span id="cb41-795"><a href="#cb41-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-796"><a href="#cb41-796" aria-hidden="true" tabindex="-1"></a>factors_ff5_monthly <span class="op">=</span> pd.read_sql_query(</span>
<span id="cb41-797"><a href="#cb41-797" aria-hidden="true" tabindex="-1"></a>    sql<span class="op">=</span><span class="st">"SELECT * FROM factors_ff5_monthly"</span>,</span>
<span id="cb41-798"><a href="#cb41-798" aria-hidden="true" tabindex="-1"></a>    con<span class="op">=</span>tidy_finance,</span>
<span id="cb41-799"><a href="#cb41-799" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>{<span class="st">"date"</span>}</span>
<span id="cb41-800"><a href="#cb41-800" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-801"><a href="#cb41-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-802"><a href="#cb41-802" aria-hidden="true" tabindex="-1"></a>factors_ff5_monthly.info()</span>
<span id="cb41-803"><a href="#cb41-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-804"><a href="#cb41-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-807"><a href="#cb41-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-808"><a href="#cb41-808" aria-hidden="true" tabindex="-1"></a>momentum_factor <span class="op">=</span> pd.read_sql_query(</span>
<span id="cb41-809"><a href="#cb41-809" aria-hidden="true" tabindex="-1"></a>    sql<span class="op">=</span><span class="st">"SELECT * FROM momentum_factor_monthly"</span>,</span>
<span id="cb41-810"><a href="#cb41-810" aria-hidden="true" tabindex="-1"></a>    con<span class="op">=</span>tidy_finance,</span>
<span id="cb41-811"><a href="#cb41-811" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>{<span class="st">"date"</span>}</span>
<span id="cb41-812"><a href="#cb41-812" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-813"><a href="#cb41-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-814"><a href="#cb41-814" aria-hidden="true" tabindex="-1"></a>factors_ff3_monthly <span class="op">=</span> (</span>
<span id="cb41-815"><a href="#cb41-815" aria-hidden="true" tabindex="-1"></a>    factors_ff5_monthly</span>
<span id="cb41-816"><a href="#cb41-816" aria-hidden="true" tabindex="-1"></a>    .merge(momentum_factor, on<span class="op">=</span><span class="st">"date"</span>)</span>
<span id="cb41-817"><a href="#cb41-817" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"mkt_excess"</span>: <span class="st">"mktrf"</span>, <span class="st">"wml"</span>: <span class="st">"umd"</span>})</span>
<span id="cb41-818"><a href="#cb41-818" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-819"><a href="#cb41-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-820"><a href="#cb41-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-821"><a href="#cb41-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-824"><a href="#cb41-824" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-825"><a href="#cb41-825" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-factors-summary</span></span>
<span id="cb41-826"><a href="#cb41-826" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Summary statistics of Vietnamese Fama-French-Carhart factors (monthly, in percent)"</span></span>
<span id="cb41-827"><a href="#cb41-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-828"><a href="#cb41-828" aria-hidden="true" tabindex="-1"></a>factor_cols <span class="op">=</span> [<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>, <span class="st">"risk_free"</span>]</span>
<span id="cb41-829"><a href="#cb41-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-830"><a href="#cb41-830" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb41-831"><a href="#cb41-831" aria-hidden="true" tabindex="-1"></a>    factors_ff3_monthly[factor_cols]</span>
<span id="cb41-832"><a href="#cb41-832" aria-hidden="true" tabindex="-1"></a>    .mul(<span class="dv">100</span>)</span>
<span id="cb41-833"><a href="#cb41-833" aria-hidden="true" tabindex="-1"></a>    .describe()</span>
<span id="cb41-834"><a href="#cb41-834" aria-hidden="true" tabindex="-1"></a>    .T</span>
<span id="cb41-835"><a href="#cb41-835" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb41-836"><a href="#cb41-836" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-837"><a href="#cb41-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-838"><a href="#cb41-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-839"><a href="#cb41-839" aria-hidden="true" tabindex="-1"></a><span class="fu">### Merging Portfolio Returns with Factor Data</span></span>
<span id="cb41-840"><a href="#cb41-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-843"><a href="#cb41-843" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-844"><a href="#cb41-844" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: merge-factors</span></span>
<span id="cb41-845"><a href="#cb41-845" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-846"><a href="#cb41-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-847"><a href="#cb41-847" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge on year-month</span></span>
<span id="cb41-848"><a href="#cb41-848" aria-hidden="true" tabindex="-1"></a>returns_wide[<span class="st">"ym"</span>] <span class="op">=</span> returns_wide[<span class="st">"date"</span>].dt.to_period(<span class="st">"M"</span>)</span>
<span id="cb41-849"><a href="#cb41-849" aria-hidden="true" tabindex="-1"></a>factors_ff3_monthly[<span class="st">"ym"</span>] <span class="op">=</span> factors_ff3_monthly[<span class="st">"date"</span>].dt.to_period(<span class="st">"M"</span>)</span>
<span id="cb41-850"><a href="#cb41-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-851"><a href="#cb41-851" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="op">=</span> returns_wide.merge(</span>
<span id="cb41-852"><a href="#cb41-852" aria-hidden="true" tabindex="-1"></a>    factors_ff3_monthly[[<span class="st">"ym"</span>, <span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>, <span class="st">"rf"</span>]],</span>
<span id="cb41-853"><a href="#cb41-853" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">"ym"</span>,</span>
<span id="cb41-854"><a href="#cb41-854" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb41-855"><a href="#cb41-855" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-856"><a href="#cb41-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-857"><a href="#cb41-857" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute excess returns</span></span>
<span id="cb41-858"><a href="#cb41-858" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="op">=</span> analysis_data.assign(</span>
<span id="cb41-859"><a href="#cb41-859" aria-hidden="true" tabindex="-1"></a>    ret_excess_democracy<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"ret_vw_Democracy"</span>] <span class="op">-</span> x[<span class="st">"rf"</span>],</span>
<span id="cb41-860"><a href="#cb41-860" aria-hidden="true" tabindex="-1"></a>    ret_excess_dictatorship<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"ret_vw_Dictatorship"</span>] <span class="op">-</span> x[<span class="st">"rf"</span>],</span>
<span id="cb41-861"><a href="#cb41-861" aria-hidden="true" tabindex="-1"></a>    ret_excess_longshort<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"ret_diff_vw"</span>]</span>
<span id="cb41-862"><a href="#cb41-862" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Long-short is already excess (self-financing)</span></span>
<span id="cb41-863"><a href="#cb41-863" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-864"><a href="#cb41-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-865"><a href="#cb41-865" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Observations for regression: </span><span class="sc">{</span><span class="bu">len</span>(analysis_data)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-866"><a href="#cb41-866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-867"><a href="#cb41-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-868"><a href="#cb41-868" aria-hidden="true" tabindex="-1"></a><span class="fu">### CAPM Regression</span></span>
<span id="cb41-869"><a href="#cb41-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-870"><a href="#cb41-870" aria-hidden="true" tabindex="-1"></a>We start with the single-factor CAPM to understand the market exposure of each portfolio:</span>
<span id="cb41-871"><a href="#cb41-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-872"><a href="#cb41-872" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-873"><a href="#cb41-873" aria-hidden="true" tabindex="-1"></a>r_{p,t} - r_{f,t} = \alpha_p + \beta_p (r_{m,t} - r_{f,t}) + \varepsilon_{p,t}</span>
<span id="cb41-874"><a href="#cb41-874" aria-hidden="true" tabindex="-1"></a>$$ {#eq-capm}</span>
<span id="cb41-875"><a href="#cb41-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-878"><a href="#cb41-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-879"><a href="#cb41-879" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-capm-results</span></span>
<span id="cb41-880"><a href="#cb41-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "CAPM regression results for Democracy, Dictatorship, and Long-Short portfolios"</span></span>
<span id="cb41-881"><a href="#cb41-881" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-882"><a href="#cb41-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-883"><a href="#cb41-883" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_regression(y, X, hac<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb41-884"><a href="#cb41-884" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Run OLS regression with optional HAC standard errors."""</span></span>
<span id="cb41-885"><a href="#cb41-885" aria-hidden="true" tabindex="-1"></a>    X_const <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb41-886"><a href="#cb41-886" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> OLS(y, X_const).fit(</span>
<span id="cb41-887"><a href="#cb41-887" aria-hidden="true" tabindex="-1"></a>        cov_type<span class="op">=</span><span class="st">"HAC"</span> <span class="cf">if</span> hac <span class="cf">else</span> <span class="st">"nonrobust"</span>,</span>
<span id="cb41-888"><a href="#cb41-888" aria-hidden="true" tabindex="-1"></a>        cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>} <span class="cf">if</span> hac <span class="cf">else</span> {}</span>
<span id="cb41-889"><a href="#cb41-889" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-890"><a href="#cb41-890" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span>
<span id="cb41-891"><a href="#cb41-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-892"><a href="#cb41-892" aria-hidden="true" tabindex="-1"></a>portfolios <span class="op">=</span> {</span>
<span id="cb41-893"><a href="#cb41-893" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Democracy"</span>: analysis_data[<span class="st">"ret_excess_democracy"</span>],</span>
<span id="cb41-894"><a href="#cb41-894" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dictatorship"</span>: analysis_data[<span class="st">"ret_excess_dictatorship"</span>],</span>
<span id="cb41-895"><a href="#cb41-895" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Long-Short"</span>: analysis_data[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb41-896"><a href="#cb41-896" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-897"><a href="#cb41-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-898"><a href="#cb41-898" aria-hidden="true" tabindex="-1"></a>capm_results <span class="op">=</span> {}</span>
<span id="cb41-899"><a href="#cb41-899" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, y <span class="kw">in</span> portfolios.items():</span>
<span id="cb41-900"><a href="#cb41-900" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> analysis_data[[<span class="st">"mktrf"</span>]]</span>
<span id="cb41-901"><a href="#cb41-901" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> run_regression(y, X, hac<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-902"><a href="#cb41-902" aria-hidden="true" tabindex="-1"></a>    capm_results[name] <span class="op">=</span> {</span>
<span id="cb41-903"><a href="#cb41-903" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-904"><a href="#cb41-904" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb41-905"><a href="#cb41-905" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Beta (MKTRF)"</span>: model.params[<span class="st">"mktrf"</span>],</span>
<span id="cb41-906"><a href="#cb41-906" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Beta t-stat"</span>: model.tvalues[<span class="st">"mktrf"</span>],</span>
<span id="cb41-907"><a href="#cb41-907" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model.rsquared,</span>
<span id="cb41-908"><a href="#cb41-908" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="bu">int</span>(model.nobs)</span>
<span id="cb41-909"><a href="#cb41-909" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-910"><a href="#cb41-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-911"><a href="#cb41-911" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(capm_results).T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb41-912"><a href="#cb41-912" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-913"><a href="#cb41-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-914"><a href="#cb41-914" aria-hidden="true" tabindex="-1"></a><span class="fu">### Three-Factor Fama-French Model</span></span>
<span id="cb41-915"><a href="#cb41-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-916"><a href="#cb41-916" aria-hidden="true" tabindex="-1"></a>The three-factor model <span class="co">[</span><span class="ot">@Fama1993</span><span class="co">]</span> augments the CAPM with size (SMB) and value (HML) factors:</span>
<span id="cb41-917"><a href="#cb41-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-918"><a href="#cb41-918" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-919"><a href="#cb41-919" aria-hidden="true" tabindex="-1"></a>r_{p,t} - r_{f,t} = \alpha_p + \beta_1 \text{MKTRF}_t + \beta_2 \text{SMB}_t + \beta_3 \text{HML}_t + \varepsilon_{p,t}</span>
<span id="cb41-920"><a href="#cb41-920" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ff3}</span>
<span id="cb41-921"><a href="#cb41-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-924"><a href="#cb41-924" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-925"><a href="#cb41-925" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-ff3-results</span></span>
<span id="cb41-926"><a href="#cb41-926" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Fama-French three-factor model results with Newey-West standard errors"</span></span>
<span id="cb41-927"><a href="#cb41-927" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-928"><a href="#cb41-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-929"><a href="#cb41-929" aria-hidden="true" tabindex="-1"></a>ff3_results <span class="op">=</span> {}</span>
<span id="cb41-930"><a href="#cb41-930" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, y <span class="kw">in</span> portfolios.items():</span>
<span id="cb41-931"><a href="#cb41-931" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]]</span>
<span id="cb41-932"><a href="#cb41-932" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> run_regression(y, X, hac<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-933"><a href="#cb41-933" aria-hidden="true" tabindex="-1"></a>    ff3_results[name] <span class="op">=</span> {</span>
<span id="cb41-934"><a href="#cb41-934" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-935"><a href="#cb41-935" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb41-936"><a href="#cb41-936" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF"</span>: model.params[<span class="st">"mktrf"</span>],</span>
<span id="cb41-937"><a href="#cb41-937" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: model.params[<span class="st">"smb"</span>],</span>
<span id="cb41-938"><a href="#cb41-938" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: model.params[<span class="st">"hml"</span>],</span>
<span id="cb41-939"><a href="#cb41-939" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model.rsquared</span>
<span id="cb41-940"><a href="#cb41-940" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-941"><a href="#cb41-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-942"><a href="#cb41-942" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(ff3_results).T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb41-943"><a href="#cb41-943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-944"><a href="#cb41-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-945"><a href="#cb41-945" aria-hidden="true" tabindex="-1"></a><span class="fu">### Four-Factor Carhart Model</span></span>
<span id="cb41-946"><a href="#cb41-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-947"><a href="#cb41-947" aria-hidden="true" tabindex="-1"></a>Adding the momentum factor <span class="co">[</span><span class="ot">@Carhart1997</span><span class="co">]</span> controls for the well-documented tendency of past winners to continue outperforming past losers:</span>
<span id="cb41-948"><a href="#cb41-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-951"><a href="#cb41-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-952"><a href="#cb41-952" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-ff4-results</span></span>
<span id="cb41-953"><a href="#cb41-953" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Four-factor Carhart model results for governance portfolios. Standard errors are Newey-West adjusted with 6 lags."</span></span>
<span id="cb41-954"><a href="#cb41-954" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-955"><a href="#cb41-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-956"><a href="#cb41-956" aria-hidden="true" tabindex="-1"></a>ff4_results <span class="op">=</span> {}</span>
<span id="cb41-957"><a href="#cb41-957" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, y <span class="kw">in</span> portfolios.items():</span>
<span id="cb41-958"><a href="#cb41-958" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]]</span>
<span id="cb41-959"><a href="#cb41-959" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> run_regression(y, X, hac<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-960"><a href="#cb41-960" aria-hidden="true" tabindex="-1"></a>    ff4_results[name] <span class="op">=</span> {</span>
<span id="cb41-961"><a href="#cb41-961" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-962"><a href="#cb41-962" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb41-963"><a href="#cb41-963" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha p-value"</span>: model.pvalues[<span class="st">"const"</span>],</span>
<span id="cb41-964"><a href="#cb41-964" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF"</span>: model.params[<span class="st">"mktrf"</span>],</span>
<span id="cb41-965"><a href="#cb41-965" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF t"</span>: model.tvalues[<span class="st">"mktrf"</span>],</span>
<span id="cb41-966"><a href="#cb41-966" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: model.params[<span class="st">"smb"</span>],</span>
<span id="cb41-967"><a href="#cb41-967" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB t"</span>: model.tvalues[<span class="st">"smb"</span>],</span>
<span id="cb41-968"><a href="#cb41-968" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: model.params[<span class="st">"hml"</span>],</span>
<span id="cb41-969"><a href="#cb41-969" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML t"</span>: model.tvalues[<span class="st">"hml"</span>],</span>
<span id="cb41-970"><a href="#cb41-970" aria-hidden="true" tabindex="-1"></a>        <span class="st">"UMD"</span>: model.params[<span class="st">"umd"</span>],</span>
<span id="cb41-971"><a href="#cb41-971" aria-hidden="true" tabindex="-1"></a>        <span class="st">"UMD t"</span>: model.tvalues[<span class="st">"umd"</span>],</span>
<span id="cb41-972"><a href="#cb41-972" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model.rsquared,</span>
<span id="cb41-973"><a href="#cb41-973" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adj R-sq"</span>: model.rsquared_adj,</span>
<span id="cb41-974"><a href="#cb41-974" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="bu">int</span>(model.nobs)</span>
<span id="cb41-975"><a href="#cb41-975" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-976"><a href="#cb41-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-977"><a href="#cb41-977" aria-hidden="true" tabindex="-1"></a>ff4_df <span class="op">=</span> pd.DataFrame(ff4_results).T</span>
<span id="cb41-978"><a href="#cb41-978" aria-hidden="true" tabindex="-1"></a>ff4_df.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb41-979"><a href="#cb41-979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-980"><a href="#cb41-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-983"><a href="#cb41-983" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-984"><a href="#cb41-984" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ff4-detailed-longshort</span></span>
<span id="cb41-985"><a href="#cb41-985" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-986"><a href="#cb41-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-987"><a href="#cb41-987" aria-hidden="true" tabindex="-1"></a><span class="co"># Detailed regression output for the long-short portfolio</span></span>
<span id="cb41-988"><a href="#cb41-988" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb41-989"><a href="#cb41-989" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> analysis_data[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb41-990"><a href="#cb41-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-991"><a href="#cb41-991" aria-hidden="true" tabindex="-1"></a>model_ls <span class="op">=</span> OLS(y, X).fit(</span>
<span id="cb41-992"><a href="#cb41-992" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>}</span>
<span id="cb41-993"><a href="#cb41-993" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-994"><a href="#cb41-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-995"><a href="#cb41-995" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_ls.summary())</span>
<span id="cb41-996"><a href="#cb41-996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-997"><a href="#cb41-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-998"><a href="#cb41-998" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpreting the Factor Loadings</span></span>
<span id="cb41-999"><a href="#cb41-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1000"><a href="#cb41-1000" aria-hidden="true" tabindex="-1"></a>The factor loadings reveal important characteristics of the governance portfolios:</span>
<span id="cb41-1001"><a href="#cb41-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1002"><a href="#cb41-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Market beta (**$\beta_{\text{MKTRF}}$): If the long-short portfolio has a near-zero market beta, the governance strategy is approximately market-neutral. A positive beta would indicate that Democracy firms are more sensitive to market movements than Dictatorship firms.</span>
<span id="cb41-1003"><a href="#cb41-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1004"><a href="#cb41-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Size factor (**$\beta_{\text{SMB}}$): A positive loading suggests the strategy tilts toward smaller firms. If Democracy firms tend to be smaller (or Dictatorship firms larger), the size factor captures this differential.</span>
<span id="cb41-1005"><a href="#cb41-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1006"><a href="#cb41-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Value factor (**$\beta_{\text{HML}}$): A positive loading indicates a value tilt. Governance and value may be related if poorly governed firms also tend to have high book-to-market ratios (i.e., they are "cheap" because of governance risk).</span>
<span id="cb41-1007"><a href="#cb41-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1008"><a href="#cb41-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Momentum factor (**$\beta_{\text{UMD}}$): The momentum loading captures whether the governance effect overlaps with price momentum. In the US, @gompers2003corporate found a near-zero momentum loading, suggesting the governance effect is distinct from momentum.</span>
<span id="cb41-1009"><a href="#cb41-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1010"><a href="#cb41-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">### Robustness: White Heteroskedasticity-Consistent Standard Errors</span></span>
<span id="cb41-1011"><a href="#cb41-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1012"><a href="#cb41-1012" aria-hidden="true" tabindex="-1"></a>As a robustness check, we also report results with White (HC1) standard errors, following the original methodology:</span>
<span id="cb41-1013"><a href="#cb41-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1016"><a href="#cb41-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-1017"><a href="#cb41-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-white-results</span></span>
<span id="cb41-1018"><a href="#cb41-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Four-factor model with White heteroskedasticity-consistent standard errors (HC1)"</span></span>
<span id="cb41-1019"><a href="#cb41-1019" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1020"><a href="#cb41-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1021"><a href="#cb41-1021" aria-hidden="true" tabindex="-1"></a>white_results <span class="op">=</span> {}</span>
<span id="cb41-1022"><a href="#cb41-1022" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, y <span class="kw">in</span> portfolios.items():</span>
<span id="cb41-1023"><a href="#cb41-1023" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb41-1024"><a href="#cb41-1024" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> OLS(y, X).fit(cov_type<span class="op">=</span><span class="st">"HC1"</span>)</span>
<span id="cb41-1025"><a href="#cb41-1025" aria-hidden="true" tabindex="-1"></a>    white_results[name] <span class="op">=</span> {</span>
<span id="cb41-1026"><a href="#cb41-1026" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1027"><a href="#cb41-1027" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb41-1028"><a href="#cb41-1028" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha p-value"</span>: model.pvalues[<span class="st">"const"</span>],</span>
<span id="cb41-1029"><a href="#cb41-1029" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model.rsquared</span>
<span id="cb41-1030"><a href="#cb41-1030" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-1031"><a href="#cb41-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1032"><a href="#cb41-1032" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(white_results).T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb41-1033"><a href="#cb41-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1034"><a href="#cb41-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1035"><a href="#cb41-1035" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deeper Analysis</span></span>
<span id="cb41-1036"><a href="#cb41-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1037"><a href="#cb41-1037" aria-hidden="true" tabindex="-1"></a><span class="fu">### Governance Quintile Portfolios</span></span>
<span id="cb41-1038"><a href="#cb41-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1039"><a href="#cb41-1039" aria-hidden="true" tabindex="-1"></a>Rather than focusing solely on the extreme portfolios, we examine returns across all five governance quintiles. This allows us to assess whether the governance-return relationship is monotonic.</span>
<span id="cb41-1040"><a href="#cb41-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1043"><a href="#cb41-1043" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-1044"><a href="#cb41-1044" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: quintile-portfolios</span></span>
<span id="cb41-1045"><a href="#cb41-1045" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1046"><a href="#cb41-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1047"><a href="#cb41-1047" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_quintile(group):</span>
<span id="cb41-1048"><a href="#cb41-1048" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Assign governance quintile within each vintage year."""</span></span>
<span id="cb41-1049"><a href="#cb41-1049" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> group.copy()</span>
<span id="cb41-1050"><a href="#cb41-1050" aria-hidden="true" tabindex="-1"></a>    group[<span class="st">"gindex_quintile"</span>] <span class="op">=</span> pd.qcut(</span>
<span id="cb41-1051"><a href="#cb41-1051" aria-hidden="true" tabindex="-1"></a>        group[<span class="st">"gindex"</span>], q<span class="op">=</span><span class="dv">5</span>, labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb41-1052"><a href="#cb41-1052" aria-hidden="true" tabindex="-1"></a>        duplicates<span class="op">=</span><span class="st">"drop"</span></span>
<span id="cb41-1053"><a href="#cb41-1053" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-1054"><a href="#cb41-1054" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group</span>
<span id="cb41-1055"><a href="#cb41-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1056"><a href="#cb41-1056" aria-hidden="true" tabindex="-1"></a>governance_quintiles <span class="op">=</span> (</span>
<span id="cb41-1057"><a href="#cb41-1057" aria-hidden="true" tabindex="-1"></a>    governance</span>
<span id="cb41-1058"><a href="#cb41-1058" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"year"</span>, group_keys<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-1059"><a href="#cb41-1059" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(assign_quintile)</span>
<span id="cb41-1060"><a href="#cb41-1060" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1061"><a href="#cb41-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1062"><a href="#cb41-1062" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with stock data</span></span>
<span id="cb41-1063"><a href="#cb41-1063" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"dual_class"</span> <span class="kw">in</span> governance_quintiles.columns:</span>
<span id="cb41-1064"><a href="#cb41-1064" aria-hidden="true" tabindex="-1"></a>    governance_quintiles <span class="op">=</span> governance_quintiles.query(<span class="st">"dual_class == 0"</span>)</span>
<span id="cb41-1065"><a href="#cb41-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1066"><a href="#cb41-1066" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> pd.merge(</span>
<span id="cb41-1067"><a href="#cb41-1067" aria-hidden="true" tabindex="-1"></a>    governance_quintiles[</span>
<span id="cb41-1068"><a href="#cb41-1068" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"symbol"</span>, <span class="st">"year"</span>, <span class="st">"gindex"</span>, <span class="st">"gindex_quintile"</span>,</span>
<span id="cb41-1069"><a href="#cb41-1069" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_effective"</span>, <span class="st">"date_expires"</span>]</span>
<span id="cb41-1070"><a href="#cb41-1070" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb41-1071"><a href="#cb41-1071" aria-hidden="true" tabindex="-1"></a>    prices_monthly[[<span class="st">"symbol"</span>, <span class="st">"date"</span>, <span class="st">"ret"</span>, <span class="st">"retx"</span>, <span class="st">"mktcap"</span>]],</span>
<span id="cb41-1072"><a href="#cb41-1072" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">"symbol"</span>,</span>
<span id="cb41-1073"><a href="#cb41-1073" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb41-1074"><a href="#cb41-1074" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1075"><a href="#cb41-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1076"><a href="#cb41-1076" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> merged_q.query(</span>
<span id="cb41-1077"><a href="#cb41-1077" aria-hidden="true" tabindex="-1"></a>    <span class="st">"date &gt;= date_effective and date &lt;= date_expires"</span></span>
<span id="cb41-1078"><a href="#cb41-1078" aria-hidden="true" tabindex="-1"></a>).sort_values([<span class="st">"symbol"</span>, <span class="st">"date"</span>])</span>
<span id="cb41-1079"><a href="#cb41-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1080"><a href="#cb41-1080" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute lagged market value</span></span>
<span id="cb41-1081"><a href="#cb41-1081" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> merged_q.sort_values([<span class="st">"symbol"</span>, <span class="st">"date"</span>])</span>
<span id="cb41-1082"><a href="#cb41-1082" aria-hidden="true" tabindex="-1"></a>merged_q[<span class="st">"mktcap_lag"</span>] <span class="op">=</span> merged_q.groupby(<span class="st">"symbol"</span>)[<span class="st">"mktcap"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb41-1083"><a href="#cb41-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1084"><a href="#cb41-1084" aria-hidden="true" tabindex="-1"></a>first_obs_q <span class="op">=</span> merged_q.groupby(<span class="st">"symbol"</span>)[<span class="st">"date"</span>].transform(<span class="st">"min"</span>)</span>
<span id="cb41-1085"><a href="#cb41-1085" aria-hidden="true" tabindex="-1"></a>mask_first_q <span class="op">=</span> merged_q[<span class="st">"date"</span>] <span class="op">==</span> first_obs_q</span>
<span id="cb41-1086"><a href="#cb41-1086" aria-hidden="true" tabindex="-1"></a>merged_q.loc[mask_first_q, <span class="st">"mktcap_lag"</span>] <span class="op">=</span> (</span>
<span id="cb41-1087"><a href="#cb41-1087" aria-hidden="true" tabindex="-1"></a>    merged_q.loc[mask_first_q, <span class="st">"mktcap"</span>]</span>
<span id="cb41-1088"><a href="#cb41-1088" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> merged_q.loc[mask_first_q, <span class="st">"retx"</span>])</span>
<span id="cb41-1089"><a href="#cb41-1089" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1090"><a href="#cb41-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1091"><a href="#cb41-1091" aria-hidden="true" tabindex="-1"></a>mask_missing_q <span class="op">=</span> merged_q[<span class="st">"mktcap_lag"</span>].isna()</span>
<span id="cb41-1092"><a href="#cb41-1092" aria-hidden="true" tabindex="-1"></a>merged_q.loc[mask_missing_q, <span class="st">"mktcap_lag"</span>] <span class="op">=</span> (</span>
<span id="cb41-1093"><a href="#cb41-1093" aria-hidden="true" tabindex="-1"></a>    merged_q.loc[mask_missing_q, <span class="st">"mktcap"</span>]</span>
<span id="cb41-1094"><a href="#cb41-1094" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> merged_q.loc[mask_missing_q, <span class="st">"retx"</span>])</span>
<span id="cb41-1095"><a href="#cb41-1095" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1096"><a href="#cb41-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1097"><a href="#cb41-1097" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> merged_q.dropna(subset<span class="op">=</span>[<span class="st">"ret"</span>, <span class="st">"mktcap_lag"</span>])</span>
<span id="cb41-1098"><a href="#cb41-1098" aria-hidden="true" tabindex="-1"></a>merged_q <span class="op">=</span> merged_q.query(<span class="st">"mktcap_lag &gt; 0"</span>)</span>
<span id="cb41-1099"><a href="#cb41-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1100"><a href="#cb41-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1103"><a href="#cb41-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-1104"><a href="#cb41-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-quintile-returns</span></span>
<span id="cb41-1105"><a href="#cb41-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Average monthly value-weighted returns by governance quintile. Quintile 1 represents the strongest shareholder rights (Democracy) and Quintile 5 the weakest (Dictatorship). Error bars show 95% confidence intervals."</span></span>
<span id="cb41-1106"><a href="#cb41-1106" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1107"><a href="#cb41-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1108"><a href="#cb41-1108" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute VW returns by quintile and date</span></span>
<span id="cb41-1109"><a href="#cb41-1109" aria-hidden="true" tabindex="-1"></a>quintile_returns <span class="op">=</span> (</span>
<span id="cb41-1110"><a href="#cb41-1110" aria-hidden="true" tabindex="-1"></a>    merged_q</span>
<span id="cb41-1111"><a href="#cb41-1111" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"date"</span>, <span class="st">"gindex_quintile"</span>])</span>
<span id="cb41-1112"><a href="#cb41-1112" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(</span>
<span id="cb41-1113"><a href="#cb41-1113" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> g: np.average(g[<span class="st">"ret"</span>], weights<span class="op">=</span>g[<span class="st">"mktcap_lag"</span>])</span>
<span id="cb41-1114"><a href="#cb41-1114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> g[<span class="st">"mktcap_lag"</span>].<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan,</span>
<span id="cb41-1115"><a href="#cb41-1115" aria-hidden="true" tabindex="-1"></a>        include_groups<span class="op">=</span><span class="va">False</span></span>
<span id="cb41-1116"><a href="#cb41-1116" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-1117"><a href="#cb41-1117" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb41-1118"><a href="#cb41-1118" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">"ret_vw"</span>})</span>
<span id="cb41-1119"><a href="#cb41-1119" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1120"><a href="#cb41-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1121"><a href="#cb41-1121" aria-hidden="true" tabindex="-1"></a><span class="co"># Average across time</span></span>
<span id="cb41-1122"><a href="#cb41-1122" aria-hidden="true" tabindex="-1"></a>quintile_avg <span class="op">=</span> (</span>
<span id="cb41-1123"><a href="#cb41-1123" aria-hidden="true" tabindex="-1"></a>    quintile_returns</span>
<span id="cb41-1124"><a href="#cb41-1124" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"gindex_quintile"</span>)[<span class="st">"ret_vw"</span>]</span>
<span id="cb41-1125"><a href="#cb41-1125" aria-hidden="true" tabindex="-1"></a>    .agg([<span class="st">"mean"</span>, <span class="st">"std"</span>, <span class="st">"count"</span>])</span>
<span id="cb41-1126"><a href="#cb41-1126" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb41-1127"><a href="#cb41-1127" aria-hidden="true" tabindex="-1"></a>        se<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"std"</span>] <span class="op">/</span> np.sqrt(x[<span class="st">"count"</span>]),</span>
<span id="cb41-1128"><a href="#cb41-1128" aria-hidden="true" tabindex="-1"></a>        ci95<span class="op">=</span><span class="kw">lambda</span> x: <span class="fl">1.96</span> <span class="op">*</span> x[<span class="st">"std"</span>] <span class="op">/</span> np.sqrt(x[<span class="st">"count"</span>])</span>
<span id="cb41-1129"><a href="#cb41-1129" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-1130"><a href="#cb41-1130" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1131"><a href="#cb41-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1132"><a href="#cb41-1132" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb41-1133"><a href="#cb41-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1134"><a href="#cb41-1134" aria-hidden="true" tabindex="-1"></a>quintiles <span class="op">=</span> quintile_avg.index.astype(<span class="bu">int</span>)</span>
<span id="cb41-1135"><a href="#cb41-1135" aria-hidden="true" tabindex="-1"></a>means <span class="op">=</span> quintile_avg[<span class="st">"mean"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span>  <span class="co"># Annualized</span></span>
<span id="cb41-1136"><a href="#cb41-1136" aria-hidden="true" tabindex="-1"></a>ci <span class="op">=</span> quintile_avg[<span class="st">"ci95"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb41-1137"><a href="#cb41-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1138"><a href="#cb41-1138" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax.bar(</span>
<span id="cb41-1139"><a href="#cb41-1139" aria-hidden="true" tabindex="-1"></a>    quintiles, means, yerr<span class="op">=</span>ci,</span>
<span id="cb41-1140"><a href="#cb41-1140" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[<span class="st">"#1a6b3c"</span>, <span class="st">"#5fa35f"</span>, <span class="st">"#b0b0b0"</span>, <span class="st">"#d4836a"</span>, <span class="st">"#c0392b"</span>],</span>
<span id="cb41-1141"><a href="#cb41-1141" aria-hidden="true" tabindex="-1"></a>    edgecolor<span class="op">=</span><span class="st">"white"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, capsize<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb41-1142"><a href="#cb41-1142" aria-hidden="true" tabindex="-1"></a>    error_kw<span class="op">=</span>{<span class="st">"linewidth"</span>: <span class="fl">1.5</span>}</span>
<span id="cb41-1143"><a href="#cb41-1143" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1144"><a href="#cb41-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1145"><a href="#cb41-1145" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"gray"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb41-1146"><a href="#cb41-1146" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"VN-GIndex Quintile</span><span class="ch">\n</span><span class="st">(1 = Strongest Rights → 5 = Weakest Rights)"</span>,</span>
<span id="cb41-1147"><a href="#cb41-1147" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb41-1148"><a href="#cb41-1148" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Annualized Return (%)"</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb41-1149"><a href="#cb41-1149" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb41-1150"><a href="#cb41-1150" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Average Annualized Returns by Governance Quintile"</span>,</span>
<span id="cb41-1151"><a href="#cb41-1151" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb41-1152"><a href="#cb41-1152" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1153"><a href="#cb41-1153" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(quintiles)</span>
<span id="cb41-1154"><a href="#cb41-1154" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">"y"</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb41-1155"><a href="#cb41-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1156"><a href="#cb41-1156" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-1157"><a href="#cb41-1157" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-1158"><a href="#cb41-1158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1159"><a href="#cb41-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1162"><a href="#cb41-1162" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-1163"><a href="#cb41-1163" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-quintile-summary</span></span>
<span id="cb41-1164"><a href="#cb41-1164" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Average monthly returns and four-factor alphas by governance quintile"</span></span>
<span id="cb41-1165"><a href="#cb41-1165" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1166"><a href="#cb41-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1167"><a href="#cb41-1167" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge quintile returns with factors</span></span>
<span id="cb41-1168"><a href="#cb41-1168" aria-hidden="true" tabindex="-1"></a>quintile_wide <span class="op">=</span> quintile_returns.pivot(</span>
<span id="cb41-1169"><a href="#cb41-1169" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"date"</span>, columns<span class="op">=</span><span class="st">"gindex_quintile"</span>, values<span class="op">=</span><span class="st">"ret_vw"</span></span>
<span id="cb41-1170"><a href="#cb41-1170" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1171"><a href="#cb41-1171" aria-hidden="true" tabindex="-1"></a>quintile_wide.columns <span class="op">=</span> [<span class="ss">f"Q</span><span class="sc">{</span><span class="bu">int</span>(c)<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> c <span class="kw">in</span> quintile_wide.columns]</span>
<span id="cb41-1172"><a href="#cb41-1172" aria-hidden="true" tabindex="-1"></a>quintile_wide <span class="op">=</span> quintile_wide.reset_index()</span>
<span id="cb41-1173"><a href="#cb41-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1174"><a href="#cb41-1174" aria-hidden="true" tabindex="-1"></a>quintile_wide[<span class="st">"ym"</span>] <span class="op">=</span> quintile_wide[<span class="st">"date"</span>].dt.to_period(<span class="st">"M"</span>)</span>
<span id="cb41-1175"><a href="#cb41-1175" aria-hidden="true" tabindex="-1"></a>quintile_analysis <span class="op">=</span> quintile_wide.merge(</span>
<span id="cb41-1176"><a href="#cb41-1176" aria-hidden="true" tabindex="-1"></a>    factors_ff3_monthly[[<span class="st">"ym"</span>, <span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>, <span class="st">"rf"</span>]],</span>
<span id="cb41-1177"><a href="#cb41-1177" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">"ym"</span>, how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb41-1178"><a href="#cb41-1178" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1179"><a href="#cb41-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1180"><a href="#cb41-1180" aria-hidden="true" tabindex="-1"></a>quintile_factor_results <span class="op">=</span> {}</span>
<span id="cb41-1181"><a href="#cb41-1181" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">6</span>):</span>
<span id="cb41-1182"><a href="#cb41-1182" aria-hidden="true" tabindex="-1"></a>    col <span class="op">=</span> <span class="ss">f"Q</span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb41-1183"><a href="#cb41-1183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">in</span> quintile_analysis.columns:</span>
<span id="cb41-1184"><a href="#cb41-1184" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> quintile_analysis[col] <span class="op">-</span> quintile_analysis[<span class="st">"rf"</span>]</span>
<span id="cb41-1185"><a href="#cb41-1185" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> sm.add_constant(</span>
<span id="cb41-1186"><a href="#cb41-1186" aria-hidden="true" tabindex="-1"></a>            quintile_analysis[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]]</span>
<span id="cb41-1187"><a href="#cb41-1187" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-1188"><a href="#cb41-1188" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> OLS(y.dropna(), X.loc[y.dropna().index]).fit(</span>
<span id="cb41-1189"><a href="#cb41-1189" aria-hidden="true" tabindex="-1"></a>            cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>}</span>
<span id="cb41-1190"><a href="#cb41-1190" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-1191"><a href="#cb41-1191" aria-hidden="true" tabindex="-1"></a>        quintile_factor_results[<span class="ss">f"Quintile </span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">"</span>] <span class="op">=</span> {</span>
<span id="cb41-1192"><a href="#cb41-1192" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Mean Return (%)"</span>: y.mean() <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1193"><a href="#cb41-1193" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Alpha (%)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1194"><a href="#cb41-1194" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Alpha t-stat"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb41-1195"><a href="#cb41-1195" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MKTRF Beta"</span>: model.params[<span class="st">"mktrf"</span>],</span>
<span id="cb41-1196"><a href="#cb41-1196" aria-hidden="true" tabindex="-1"></a>            <span class="st">"R-squared"</span>: model.rsquared</span>
<span id="cb41-1197"><a href="#cb41-1197" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb41-1198"><a href="#cb41-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1199"><a href="#cb41-1199" aria-hidden="true" tabindex="-1"></a><span class="co"># Add 5-1 spread</span></span>
<span id="cb41-1200"><a href="#cb41-1200" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"Q1"</span> <span class="kw">in</span> quintile_analysis.columns <span class="kw">and</span> <span class="st">"Q5"</span> <span class="kw">in</span> quintile_analysis.columns:</span>
<span id="cb41-1201"><a href="#cb41-1201" aria-hidden="true" tabindex="-1"></a>    y_spread <span class="op">=</span> quintile_analysis[<span class="st">"Q1"</span>] <span class="op">-</span> quintile_analysis[<span class="st">"Q5"</span>]</span>
<span id="cb41-1202"><a href="#cb41-1202" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(</span>
<span id="cb41-1203"><a href="#cb41-1203" aria-hidden="true" tabindex="-1"></a>        quintile_analysis[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]]</span>
<span id="cb41-1204"><a href="#cb41-1204" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-1205"><a href="#cb41-1205" aria-hidden="true" tabindex="-1"></a>    model_spread <span class="op">=</span> OLS(</span>
<span id="cb41-1206"><a href="#cb41-1206" aria-hidden="true" tabindex="-1"></a>        y_spread.dropna(), X.loc[y_spread.dropna().index]</span>
<span id="cb41-1207"><a href="#cb41-1207" aria-hidden="true" tabindex="-1"></a>    ).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span>
<span id="cb41-1208"><a href="#cb41-1208" aria-hidden="true" tabindex="-1"></a>    quintile_factor_results[<span class="st">"Q1 - Q5"</span>] <span class="op">=</span> {</span>
<span id="cb41-1209"><a href="#cb41-1209" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mean Return (%)"</span>: y_spread.mean() <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1210"><a href="#cb41-1210" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (%)"</span>: model_spread.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1211"><a href="#cb41-1211" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model_spread.tvalues[<span class="st">"const"</span>],</span>
<span id="cb41-1212"><a href="#cb41-1212" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF Beta"</span>: model_spread.params[<span class="st">"mktrf"</span>],</span>
<span id="cb41-1213"><a href="#cb41-1213" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model_spread.rsquared</span>
<span id="cb41-1214"><a href="#cb41-1214" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-1215"><a href="#cb41-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1216"><a href="#cb41-1216" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(quintile_factor_results).T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb41-1217"><a href="#cb41-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1218"><a href="#cb41-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1219"><a href="#cb41-1219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Subsample Analysis</span></span>
<span id="cb41-1220"><a href="#cb41-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1221"><a href="#cb41-1221" aria-hidden="true" tabindex="-1"></a>The governance premium may vary across market regimes. We split the sample at the midpoint and examine whether the effect is concentrated in a particular subperiod.</span>
<span id="cb41-1222"><a href="#cb41-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1225"><a href="#cb41-1225" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-1226"><a href="#cb41-1226" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-subsample</span></span>
<span id="cb41-1227"><a href="#cb41-1227" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Four-factor alpha of the long-short governance strategy across subperiods"</span></span>
<span id="cb41-1228"><a href="#cb41-1228" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1229"><a href="#cb41-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1230"><a href="#cb41-1230" aria-hidden="true" tabindex="-1"></a>midpoint <span class="op">=</span> analysis_data[<span class="st">"date"</span>].quantile(<span class="fl">0.5</span>)</span>
<span id="cb41-1231"><a href="#cb41-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1232"><a href="#cb41-1232" aria-hidden="true" tabindex="-1"></a>subperiods <span class="op">=</span> {</span>
<span id="cb41-1233"><a href="#cb41-1233" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Full Sample"</span>: analysis_data,</span>
<span id="cb41-1234"><a href="#cb41-1234" aria-hidden="true" tabindex="-1"></a>    <span class="st">"First Half"</span>: analysis_data.query(<span class="ss">f"date &lt;= '</span><span class="sc">{</span>midpoint<span class="sc">}</span><span class="ss">'"</span>),</span>
<span id="cb41-1235"><a href="#cb41-1235" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Second Half"</span>: analysis_data.query(<span class="ss">f"date &gt; '</span><span class="sc">{</span>midpoint<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb41-1236"><a href="#cb41-1236" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-1237"><a href="#cb41-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1238"><a href="#cb41-1238" aria-hidden="true" tabindex="-1"></a>subsample_results <span class="op">=</span> {}</span>
<span id="cb41-1239"><a href="#cb41-1239" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> period_name, df <span class="kw">in</span> subperiods.items():</span>
<span id="cb41-1240"><a href="#cb41-1240" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(df) <span class="op">&lt;</span> <span class="dv">12</span>:</span>
<span id="cb41-1241"><a href="#cb41-1241" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb41-1242"><a href="#cb41-1242" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb41-1243"><a href="#cb41-1243" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(df[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb41-1244"><a href="#cb41-1244" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> OLS(y, X).fit(</span>
<span id="cb41-1245"><a href="#cb41-1245" aria-hidden="true" tabindex="-1"></a>        cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>}</span>
<span id="cb41-1246"><a href="#cb41-1246" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-1247"><a href="#cb41-1247" aria-hidden="true" tabindex="-1"></a>    subsample_results[period_name] <span class="op">=</span> {</span>
<span id="cb41-1248"><a href="#cb41-1248" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (% monthly)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1249"><a href="#cb41-1249" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (% annual)"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span>,</span>
<span id="cb41-1250"><a href="#cb41-1250" aria-hidden="true" tabindex="-1"></a>        <span class="st">"T-statistic"</span>: model.tvalues[<span class="st">"const"</span>],</span>
<span id="cb41-1251"><a href="#cb41-1251" aria-hidden="true" tabindex="-1"></a>        <span class="st">"P-value"</span>: model.pvalues[<span class="st">"const"</span>],</span>
<span id="cb41-1252"><a href="#cb41-1252" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N months"</span>: <span class="bu">int</span>(model.nobs),</span>
<span id="cb41-1253"><a href="#cb41-1253" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Date Range"</span>: <span class="ss">f"</span><span class="sc">{</span>df[<span class="st">'date'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">.</span>strftime(<span class="st">'%Y-%m'</span>)<span class="sc">}</span><span class="ss"> to "</span></span>
<span id="cb41-1254"><a href="#cb41-1254" aria-hidden="true" tabindex="-1"></a>                      <span class="ss">f"</span><span class="sc">{</span>df[<span class="st">'date'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">.</span>strftime(<span class="st">'%Y-%m'</span>)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb41-1255"><a href="#cb41-1255" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-1256"><a href="#cb41-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1257"><a href="#cb41-1257" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(subsample_results).T</span>
<span id="cb41-1258"><a href="#cb41-1258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1259"><a href="#cb41-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1260"><a href="#cb41-1260" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equal-Weighted Robustness</span></span>
<span id="cb41-1261"><a href="#cb41-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1262"><a href="#cb41-1262" aria-hidden="true" tabindex="-1"></a>Value-weighting may cause the results to be driven by a few large firms. We verify robustness with equal-weighted portfolios.</span>
<span id="cb41-1263"><a href="#cb41-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1266"><a href="#cb41-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-1267"><a href="#cb41-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-ew-robustness</span></span>
<span id="cb41-1268"><a href="#cb41-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Four-factor model results: Equal-weighted vs. Value-weighted long-short portfolio"</span></span>
<span id="cb41-1269"><a href="#cb41-1269" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1270"><a href="#cb41-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1271"><a href="#cb41-1271" aria-hidden="true" tabindex="-1"></a>ew_y <span class="op">=</span> analysis_data[<span class="st">"ret_diff_ew"</span>]</span>
<span id="cb41-1272"><a href="#cb41-1272" aria-hidden="true" tabindex="-1"></a>vw_y <span class="op">=</span> analysis_data[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb41-1273"><a href="#cb41-1273" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(analysis_data[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb41-1274"><a href="#cb41-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1275"><a href="#cb41-1275" aria-hidden="true" tabindex="-1"></a>model_ew <span class="op">=</span> OLS(ew_y, X).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span>
<span id="cb41-1276"><a href="#cb41-1276" aria-hidden="true" tabindex="-1"></a>model_vw <span class="op">=</span> OLS(vw_y, X).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span>
<span id="cb41-1277"><a href="#cb41-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1278"><a href="#cb41-1278" aria-hidden="true" tabindex="-1"></a>comparison <span class="op">=</span> pd.DataFrame({</span>
<span id="cb41-1279"><a href="#cb41-1279" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Value-Weighted"</span>: {</span>
<span id="cb41-1280"><a href="#cb41-1280" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (% monthly)"</span>: model_vw.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1281"><a href="#cb41-1281" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model_vw.tvalues[<span class="st">"const"</span>],</span>
<span id="cb41-1282"><a href="#cb41-1282" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF"</span>: model_vw.params[<span class="st">"mktrf"</span>],</span>
<span id="cb41-1283"><a href="#cb41-1283" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: model_vw.params[<span class="st">"smb"</span>],</span>
<span id="cb41-1284"><a href="#cb41-1284" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: model_vw.params[<span class="st">"hml"</span>],</span>
<span id="cb41-1285"><a href="#cb41-1285" aria-hidden="true" tabindex="-1"></a>        <span class="st">"UMD"</span>: model_vw.params[<span class="st">"umd"</span>],</span>
<span id="cb41-1286"><a href="#cb41-1286" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model_vw.rsquared</span>
<span id="cb41-1287"><a href="#cb41-1287" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb41-1288"><a href="#cb41-1288" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Equal-Weighted"</span>: {</span>
<span id="cb41-1289"><a href="#cb41-1289" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (% monthly)"</span>: model_ew.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1290"><a href="#cb41-1290" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha t-stat"</span>: model_ew.tvalues[<span class="st">"const"</span>],</span>
<span id="cb41-1291"><a href="#cb41-1291" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKTRF"</span>: model_ew.params[<span class="st">"mktrf"</span>],</span>
<span id="cb41-1292"><a href="#cb41-1292" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: model_ew.params[<span class="st">"smb"</span>],</span>
<span id="cb41-1293"><a href="#cb41-1293" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: model_ew.params[<span class="st">"hml"</span>],</span>
<span id="cb41-1294"><a href="#cb41-1294" aria-hidden="true" tabindex="-1"></a>        <span class="st">"UMD"</span>: model_ew.params[<span class="st">"umd"</span>],</span>
<span id="cb41-1295"><a href="#cb41-1295" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R-squared"</span>: model_ew.rsquared</span>
<span id="cb41-1296"><a href="#cb41-1296" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-1297"><a href="#cb41-1297" aria-hidden="true" tabindex="-1"></a>}).T</span>
<span id="cb41-1298"><a href="#cb41-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1299"><a href="#cb41-1299" aria-hidden="true" tabindex="-1"></a>comparison.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb41-1300"><a href="#cb41-1300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1301"><a href="#cb41-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1302"><a href="#cb41-1302" aria-hidden="true" tabindex="-1"></a><span class="fu">### Factor Loading Stability: Rolling Regressions</span></span>
<span id="cb41-1303"><a href="#cb41-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1306"><a href="#cb41-1306" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-1307"><a href="#cb41-1307" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rolling-alpha</span></span>
<span id="cb41-1308"><a href="#cb41-1308" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "24-month rolling four-factor alpha (annualized) of the long-short governance strategy. The shaded band represents the 95% confidence interval."</span></span>
<span id="cb41-1309"><a href="#cb41-1309" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1310"><a href="#cb41-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1311"><a href="#cb41-1311" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">24</span></span>
<span id="cb41-1312"><a href="#cb41-1312" aria-hidden="true" tabindex="-1"></a>rolling_alpha <span class="op">=</span> []</span>
<span id="cb41-1313"><a href="#cb41-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1314"><a href="#cb41-1314" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(window, <span class="bu">len</span>(analysis_data)):</span>
<span id="cb41-1315"><a href="#cb41-1315" aria-hidden="true" tabindex="-1"></a>    subset <span class="op">=</span> analysis_data.iloc[i <span class="op">-</span> window:i]</span>
<span id="cb41-1316"><a href="#cb41-1316" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> subset[<span class="st">"ret_excess_longshort"</span>]</span>
<span id="cb41-1317"><a href="#cb41-1317" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(subset[[<span class="st">"mktrf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>, <span class="st">"umd"</span>]])</span>
<span id="cb41-1318"><a href="#cb41-1318" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb41-1319"><a href="#cb41-1319" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> OLS(y, X).fit()</span>
<span id="cb41-1320"><a href="#cb41-1320" aria-hidden="true" tabindex="-1"></a>        rolling_alpha.append({</span>
<span id="cb41-1321"><a href="#cb41-1321" aria-hidden="true" tabindex="-1"></a>            <span class="st">"date"</span>: subset[<span class="st">"date"</span>].iloc[<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb41-1322"><a href="#cb41-1322" aria-hidden="true" tabindex="-1"></a>            <span class="st">"alpha"</span>: model.params[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span>,</span>
<span id="cb41-1323"><a href="#cb41-1323" aria-hidden="true" tabindex="-1"></a>            <span class="st">"alpha_se"</span>: model.bse[<span class="st">"const"</span>] <span class="op">*</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">12</span>,</span>
<span id="cb41-1324"><a href="#cb41-1324" aria-hidden="true" tabindex="-1"></a>            <span class="st">"t_stat"</span>: model.tvalues[<span class="st">"const"</span>]</span>
<span id="cb41-1325"><a href="#cb41-1325" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb41-1326"><a href="#cb41-1326" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb41-1327"><a href="#cb41-1327" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb41-1328"><a href="#cb41-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1329"><a href="#cb41-1329" aria-hidden="true" tabindex="-1"></a>rolling_alpha_df <span class="op">=</span> pd.DataFrame(rolling_alpha)</span>
<span id="cb41-1330"><a href="#cb41-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1331"><a href="#cb41-1331" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb41-1332"><a href="#cb41-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1333"><a href="#cb41-1333" aria-hidden="true" tabindex="-1"></a>ax.plot(</span>
<span id="cb41-1334"><a href="#cb41-1334" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"date"</span>],</span>
<span id="cb41-1335"><a href="#cb41-1335" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"alpha"</span>],</span>
<span id="cb41-1336"><a href="#cb41-1336" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"#2c5f8a"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb41-1337"><a href="#cb41-1337" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1338"><a href="#cb41-1338" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb41-1339"><a href="#cb41-1339" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"date"</span>],</span>
<span id="cb41-1340"><a href="#cb41-1340" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"alpha"</span>] <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> rolling_alpha_df[<span class="st">"alpha_se"</span>],</span>
<span id="cb41-1341"><a href="#cb41-1341" aria-hidden="true" tabindex="-1"></a>    rolling_alpha_df[<span class="st">"alpha"</span>] <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> rolling_alpha_df[<span class="st">"alpha_se"</span>],</span>
<span id="cb41-1342"><a href="#cb41-1342" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"#2c5f8a"</span></span>
<span id="cb41-1343"><a href="#cb41-1343" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1344"><a href="#cb41-1344" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"gray"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb41-1345"><a href="#cb41-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1346"><a href="#cb41-1346" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Date"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb41-1347"><a href="#cb41-1347" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Annualized Alpha (%)"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb41-1348"><a href="#cb41-1348" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb41-1349"><a href="#cb41-1349" aria-hidden="true" tabindex="-1"></a>    <span class="st">"24-Month Rolling Four-Factor Alpha: Governance Long-Short Strategy"</span>,</span>
<span id="cb41-1350"><a href="#cb41-1350" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">"bold"</span></span>
<span id="cb41-1351"><a href="#cb41-1351" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1352"><a href="#cb41-1352" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb41-1353"><a href="#cb41-1353" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-1354"><a href="#cb41-1354" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-1355"><a href="#cb41-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1356"><a href="#cb41-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1357"><a href="#cb41-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison with International Evidence</span></span>
<span id="cb41-1358"><a href="#cb41-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1359"><a href="#cb41-1359" aria-hidden="true" tabindex="-1"></a><span class="fu">### The US Experience</span></span>
<span id="cb41-1360"><a href="#cb41-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1361"><a href="#cb41-1361" aria-hidden="true" tabindex="-1"></a>In the United States, @gompers2003corporate documented an annualized abnormal return of approximately 8.5% for the Democracy-minus-Dictatorship strategy during the 1990s. Subsequent research has provided important nuances:</span>
<span id="cb41-1362"><a href="#cb41-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1363"><a href="#cb41-1363" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>@bebchuk2009matters refined the G-Index to a more parsimonious **Entrenchment Index (E-Index)** based on only six provisions that matter most for firm value: staggered boards, limits to shareholder bylaw amendments, poison pills, golden parachutes, and supermajority requirements for mergers and charter amendments. The E-Index explained the governance-return relationship at least as well as the full G-Index.</span>
<span id="cb41-1364"><a href="#cb41-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1365"><a href="#cb41-1365" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>@cremers2005governance found that the governance effect was strongest in firms where external governance mechanisms (the takeover market) were active, suggesting complementarity between internal and external governance.</span>
<span id="cb41-1366"><a href="#cb41-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1367"><a href="#cb41-1367" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The governance premium in the US has largely disappeared in more recent periods <span class="co">[</span><span class="ot">@bebchuk2013learning</span><span class="co">]</span>, potentially because the market has learned to price governance differences. This "learning hypothesis" has implications for whether similar strategies can persist in less efficient markets like Vietnam.</span>
<span id="cb41-1368"><a href="#cb41-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1369"><a href="#cb41-1369" aria-hidden="true" tabindex="-1"></a><span class="fu">### Emerging Market Context</span></span>
<span id="cb41-1370"><a href="#cb41-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1371"><a href="#cb41-1371" aria-hidden="true" tabindex="-1"></a>The governance-return relationship in emerging markets remains an active area of research. Several features of emerging markets suggest the premium may be larger and more persistent:</span>
<span id="cb41-1372"><a href="#cb41-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1373"><a href="#cb41-1373" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Information asymmetry**: Weaker disclosure requirements and less analyst coverage mean governance quality is harder to observe, creating larger mispricings <span class="co">[</span><span class="ot">@klapper2004corporate</span><span class="co">]</span>.</span>
<span id="cb41-1374"><a href="#cb41-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1375"><a href="#cb41-1375" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Weaker legal enforcement**: Where legal protections for minority shareholders are weak, firm-level governance becomes more important as a substitute <span class="co">[</span><span class="ot">@la2000investor</span><span class="co">]</span>.</span>
<span id="cb41-1376"><a href="#cb41-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1377"><a href="#cb41-1377" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Concentrated ownership**: The presence of controlling shareholders creates opportunities for tunneling and related-party transactions that good governance mechanisms can mitigate <span class="co">[</span><span class="ot">@johnson2000tunneling</span><span class="co">]</span>.</span>
<span id="cb41-1378"><a href="#cb41-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1379"><a href="#cb41-1379" aria-hidden="true" tabindex="-1"></a>Vietnam, as a frontier-to-emerging market with all three characteristics, is a particularly interesting laboratory for testing whether governance generates abnormal returns.</span>
<span id="cb41-1380"><a href="#cb41-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1381"><a href="#cb41-1381" aria-hidden="true" tabindex="-1"></a><span class="fu">## Drawdown and Risk Analysis</span></span>
<span id="cb41-1382"><a href="#cb41-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1383"><a href="#cb41-1383" aria-hidden="true" tabindex="-1"></a><span class="fu">### Maximum Drawdown</span></span>
<span id="cb41-1384"><a href="#cb41-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1387"><a href="#cb41-1387" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-1388"><a href="#cb41-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-drawdown</span></span>
<span id="cb41-1389"><a href="#cb41-1389" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1390"><a href="#cb41-1390" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Drawdown of the Democracy and Dictatorship portfolios from their respective peak cumulative values."</span></span>
<span id="cb41-1391"><a href="#cb41-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1392"><a href="#cb41-1392" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_drawdown(cumulative_returns):</span>
<span id="cb41-1393"><a href="#cb41-1393" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute drawdown series from cumulative returns."""</span></span>
<span id="cb41-1394"><a href="#cb41-1394" aria-hidden="true" tabindex="-1"></a>    running_max <span class="op">=</span> cumulative_returns.cummax()</span>
<span id="cb41-1395"><a href="#cb41-1395" aria-hidden="true" tabindex="-1"></a>    drawdown <span class="op">=</span> (cumulative_returns <span class="op">-</span> running_max) <span class="op">/</span> running_max</span>
<span id="cb41-1396"><a href="#cb41-1396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> drawdown</span>
<span id="cb41-1397"><a href="#cb41-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1398"><a href="#cb41-1398" aria-hidden="true" tabindex="-1"></a>cum_dem <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_vw_Democracy"</span>]).cumprod()</span>
<span id="cb41-1399"><a href="#cb41-1399" aria-hidden="true" tabindex="-1"></a>cum_dic <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns_wide[<span class="st">"ret_vw_Dictatorship"</span>]).cumprod()</span>
<span id="cb41-1400"><a href="#cb41-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1401"><a href="#cb41-1401" aria-hidden="true" tabindex="-1"></a>dd_dem <span class="op">=</span> compute_drawdown(cum_dem)</span>
<span id="cb41-1402"><a href="#cb41-1402" aria-hidden="true" tabindex="-1"></a>dd_dic <span class="op">=</span> compute_drawdown(cum_dic)</span>
<span id="cb41-1403"><a href="#cb41-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1404"><a href="#cb41-1404" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb41-1405"><a href="#cb41-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1406"><a href="#cb41-1406" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb41-1407"><a href="#cb41-1407" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], dd_dem <span class="op">*</span> <span class="dv">100</span>, <span class="dv">0</span>,</span>
<span id="cb41-1408"><a href="#cb41-1408" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.4</span>, color<span class="op">=</span><span class="st">"#1a6b3c"</span>, label<span class="op">=</span><span class="st">"Democracy"</span></span>
<span id="cb41-1409"><a href="#cb41-1409" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1410"><a href="#cb41-1410" aria-hidden="true" tabindex="-1"></a>ax.fill_between(</span>
<span id="cb41-1411"><a href="#cb41-1411" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>], dd_dic <span class="op">*</span> <span class="dv">100</span>, <span class="dv">0</span>,</span>
<span id="cb41-1412"><a href="#cb41-1412" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.4</span>, color<span class="op">=</span><span class="st">"#c0392b"</span>, label<span class="op">=</span><span class="st">"Dictatorship"</span></span>
<span id="cb41-1413"><a href="#cb41-1413" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-1414"><a href="#cb41-1414" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Date"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb41-1415"><a href="#cb41-1415" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Drawdown (%)"</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb41-1416"><a href="#cb41-1416" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Portfolio Drawdowns"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb41-1417"><a href="#cb41-1417" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb41-1418"><a href="#cb41-1418" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb41-1419"><a href="#cb41-1419" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-1420"><a href="#cb41-1420" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-1421"><a href="#cb41-1421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1422"><a href="#cb41-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1425"><a href="#cb41-1425" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb41-1426"><a href="#cb41-1426" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-risk-metrics</span></span>
<span id="cb41-1427"><a href="#cb41-1427" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb41-1428"><a href="#cb41-1428" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Risk metrics for governance portfolios"</span></span>
<span id="cb41-1429"><a href="#cb41-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1430"><a href="#cb41-1430" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_risk_metrics(returns, name, rf<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb41-1431"><a href="#cb41-1431" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute standard risk metrics."""</span></span>
<span id="cb41-1432"><a href="#cb41-1432" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> returns.dropna()</span>
<span id="cb41-1433"><a href="#cb41-1433" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> rf <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb41-1434"><a href="#cb41-1434" aria-hidden="true" tabindex="-1"></a>        excess <span class="op">=</span> r <span class="op">-</span> rf</span>
<span id="cb41-1435"><a href="#cb41-1435" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb41-1436"><a href="#cb41-1436" aria-hidden="true" tabindex="-1"></a>        excess <span class="op">=</span> r</span>
<span id="cb41-1437"><a href="#cb41-1437" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-1438"><a href="#cb41-1438" aria-hidden="true" tabindex="-1"></a>    ann_return <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> r.mean()) <span class="op">**</span> <span class="dv">12</span> <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb41-1439"><a href="#cb41-1439" aria-hidden="true" tabindex="-1"></a>    ann_vol <span class="op">=</span> r.std() <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb41-1440"><a href="#cb41-1440" aria-hidden="true" tabindex="-1"></a>    sharpe <span class="op">=</span> excess.mean() <span class="op">/</span> r.std() <span class="op">*</span> np.sqrt(<span class="dv">12</span>) <span class="cf">if</span> r.std() <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan</span>
<span id="cb41-1441"><a href="#cb41-1441" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-1442"><a href="#cb41-1442" aria-hidden="true" tabindex="-1"></a>    cum <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> r).cumprod()</span>
<span id="cb41-1443"><a href="#cb41-1443" aria-hidden="true" tabindex="-1"></a>    max_dd <span class="op">=</span> compute_drawdown(cum).<span class="bu">min</span>()</span>
<span id="cb41-1444"><a href="#cb41-1444" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-1445"><a href="#cb41-1445" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sortino ratio (downside deviation)</span></span>
<span id="cb41-1446"><a href="#cb41-1446" aria-hidden="true" tabindex="-1"></a>    downside <span class="op">=</span> r[r <span class="op">&lt;</span> <span class="dv">0</span>].std() <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb41-1447"><a href="#cb41-1447" aria-hidden="true" tabindex="-1"></a>    sortino <span class="op">=</span> excess.mean() <span class="op">*</span> <span class="dv">12</span> <span class="op">/</span> downside <span class="cf">if</span> downside <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan</span>
<span id="cb41-1448"><a href="#cb41-1448" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-1449"><a href="#cb41-1449" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Skewness and kurtosis</span></span>
<span id="cb41-1450"><a href="#cb41-1450" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> r.skew()</span>
<span id="cb41-1451"><a href="#cb41-1451" aria-hidden="true" tabindex="-1"></a>    kurt <span class="op">=</span> r.kurtosis()</span>
<span id="cb41-1452"><a href="#cb41-1452" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-1453"><a href="#cb41-1453" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb41-1454"><a href="#cb41-1454" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Portfolio"</span>: name,</span>
<span id="cb41-1455"><a href="#cb41-1455" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Ann. Return (%)"</span>: ann_return <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1456"><a href="#cb41-1456" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Ann. Volatility (%)"</span>: ann_vol <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1457"><a href="#cb41-1457" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sharpe Ratio"</span>: sharpe,</span>
<span id="cb41-1458"><a href="#cb41-1458" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sortino Ratio"</span>: sortino,</span>
<span id="cb41-1459"><a href="#cb41-1459" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Max Drawdown (%)"</span>: max_dd <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb41-1460"><a href="#cb41-1460" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Skewness"</span>: skew,</span>
<span id="cb41-1461"><a href="#cb41-1461" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Excess Kurtosis"</span>: kurt,</span>
<span id="cb41-1462"><a href="#cb41-1462" aria-hidden="true" tabindex="-1"></a>        <span class="st">"% Positive Months"</span>: (r <span class="op">&gt;</span> <span class="dv">0</span>).mean() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb41-1463"><a href="#cb41-1463" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-1464"><a href="#cb41-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1465"><a href="#cb41-1465" aria-hidden="true" tabindex="-1"></a>rf_series <span class="op">=</span> analysis_data.set_index(<span class="st">"date"</span>)[<span class="st">"rf"</span>].reindex(</span>
<span id="cb41-1466"><a href="#cb41-1466" aria-hidden="true" tabindex="-1"></a>    returns_wide[<span class="st">"date"</span>]</span>
<span id="cb41-1467"><a href="#cb41-1467" aria-hidden="true" tabindex="-1"></a>).fillna(<span class="dv">0</span>)</span>
<span id="cb41-1468"><a href="#cb41-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1469"><a href="#cb41-1469" aria-hidden="true" tabindex="-1"></a>risk_table <span class="op">=</span> pd.DataFrame([</span>
<span id="cb41-1470"><a href="#cb41-1470" aria-hidden="true" tabindex="-1"></a>    compute_risk_metrics(</span>
<span id="cb41-1471"><a href="#cb41-1471" aria-hidden="true" tabindex="-1"></a>        returns_wide[<span class="st">"ret_vw_Democracy"</span>], <span class="st">"Democracy (VW)"</span>,</span>
<span id="cb41-1472"><a href="#cb41-1472" aria-hidden="true" tabindex="-1"></a>        rf_series.values</span>
<span id="cb41-1473"><a href="#cb41-1473" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-1474"><a href="#cb41-1474" aria-hidden="true" tabindex="-1"></a>    compute_risk_metrics(</span>
<span id="cb41-1475"><a href="#cb41-1475" aria-hidden="true" tabindex="-1"></a>        returns_wide[<span class="st">"ret_vw_Dictatorship"</span>], <span class="st">"Dictatorship (VW)"</span>,</span>
<span id="cb41-1476"><a href="#cb41-1476" aria-hidden="true" tabindex="-1"></a>        rf_series.values</span>
<span id="cb41-1477"><a href="#cb41-1477" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-1478"><a href="#cb41-1478" aria-hidden="true" tabindex="-1"></a>    compute_risk_metrics(</span>
<span id="cb41-1479"><a href="#cb41-1479" aria-hidden="true" tabindex="-1"></a>        returns_wide[<span class="st">"ret_diff_vw"</span>], <span class="st">"Long-Short (VW)"</span></span>
<span id="cb41-1480"><a href="#cb41-1480" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-1481"><a href="#cb41-1481" aria-hidden="true" tabindex="-1"></a>]).set_index(<span class="st">"Portfolio"</span>)</span>
<span id="cb41-1482"><a href="#cb41-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1483"><a href="#cb41-1483" aria-hidden="true" tabindex="-1"></a>risk_table.<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb41-1484"><a href="#cb41-1484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-1485"><a href="#cb41-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1486"><a href="#cb41-1486" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion and Interpretation</span></span>
<span id="cb41-1487"><a href="#cb41-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1488"><a href="#cb41-1488" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why Might Governance Predict Returns in Vietnam?</span></span>
<span id="cb41-1489"><a href="#cb41-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1490"><a href="#cb41-1490" aria-hidden="true" tabindex="-1"></a>Several channels may explain a governance premium in the Vietnamese market:</span>
<span id="cb41-1491"><a href="#cb41-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1492"><a href="#cb41-1492" aria-hidden="true" tabindex="-1"></a>**The risk channel**: Poorly governed firms may be riskier in ways not captured by standard factor models. Investors require a higher expected return to hold these firms, but the return difference reverses (i.e., the governance premium is positive for well-governed firms) if the market overestimates the risk of poorly governed firms or if governance risk is partially diversifiable.</span>
<span id="cb41-1493"><a href="#cb41-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1494"><a href="#cb41-1494" aria-hidden="true" tabindex="-1"></a>**The mispricing channel**: If the market is slow to incorporate governance information into prices, perhaps because governance quality is costly to assess or because many Vietnamese investors are retail traders with limited analytical capacity, then a systematic strategy that buys good governance and sells bad governance can profit from the gradual correction of mispricings.</span>
<span id="cb41-1495"><a href="#cb41-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1496"><a href="#cb41-1496" aria-hidden="true" tabindex="-1"></a>**The cash flow channel**: Better-governed firms may generate genuinely higher cash flows because they waste less on empire-building, related-party transactions, and other value-destroying activities. To the extent that these superior cash flows are not fully anticipated by the market, good governance firms deliver positive return surprises.</span>
<span id="cb41-1497"><a href="#cb41-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1498"><a href="#cb41-1498" aria-hidden="true" tabindex="-1"></a><span class="fu">### State Ownership and the Governance Effect</span></span>
<span id="cb41-1499"><a href="#cb41-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1500"><a href="#cb41-1500" aria-hidden="true" tabindex="-1"></a>A distinctive feature of the Vietnamese market is the prevalence of state-owned enterprises (SOEs). The interaction between state ownership and governance quality creates an interesting dynamic:</span>
<span id="cb41-1501"><a href="#cb41-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1502"><a href="#cb41-1502" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SOEs may have weak governance by conventional metrics (limited board independence, political appointments) but benefit from implicit government guarantees and preferential access to land, capital, and contracts.</span>
<span id="cb41-1503"><a href="#cb41-1503" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The governance premium may therefore differ between SOEs and private firms. We encourage readers to extend the analysis by interacting the governance index with a state ownership indicator.</span>
<span id="cb41-1504"><a href="#cb41-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1505"><a href="#cb41-1505" aria-hidden="true" tabindex="-1"></a><span class="fu">### Limitations</span></span>
<span id="cb41-1506"><a href="#cb41-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1507"><a href="#cb41-1507" aria-hidden="true" tabindex="-1"></a>Several caveats apply to this analysis:</span>
<span id="cb41-1508"><a href="#cb41-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1509"><a href="#cb41-1509" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Survivorship bias**: If poorly governed firms are more likely to delist (due to financial distress or regulatory action), the Dictatorship portfolio's returns may be biased upward, attenuating the true governance premium.</span>
<span id="cb41-1510"><a href="#cb41-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1511"><a href="#cb41-1511" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Transaction costs**: The long-short strategy requires short selling, which is restricted in Vietnam. Implementation via a long-only tilt toward Democracy firms may be more practical.</span>
<span id="cb41-1512"><a href="#cb41-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1513"><a href="#cb41-1513" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Governance data frequency**: Unlike daily stock prices, governance data is updated infrequently (typically annually). The portfolio rebalancing frequency is therefore low, which limits the strategy's responsiveness to governance changes.</span>
<span id="cb41-1514"><a href="#cb41-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1515"><a href="#cb41-1515" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Index construction**: The specific provisions included in the VN-GIndex and their equal weighting may not optimally capture governance quality. Future work could explore weighted indices, following @bebchuk2009matters.</span>
<span id="cb41-1516"><a href="#cb41-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1517"><a href="#cb41-1517" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb41-1518"><a href="#cb41-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1519"><a href="#cb41-1519" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Entrenchment Index**: Following @bebchuk2009matters, identify the subset of governance provisions in the Vietnamese data that have the strongest association with firm value (measured by Tobin's Q or market-to-book ratio). Construct a Vietnamese E-Index using only these provisions and compare its predictive power for returns to the full VN-GIndex.</span>
<span id="cb41-1520"><a href="#cb41-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1521"><a href="#cb41-1521" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Fama-MacBeth regressions**: Instead of sorting firms into portfolios, estimate the governance-return relationship using Fama-MacBeth cross-sectional regressions <span class="co">[</span><span class="ot">@Fama1973</span><span class="co">]</span>: </span>
<span id="cb41-1522"><a href="#cb41-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1523"><a href="#cb41-1523" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-1524"><a href="#cb41-1524" aria-hidden="true" tabindex="-1"></a>r_{i,t} - r_{f,t} = \gamma_{0,t} + \gamma_{1,t} \text{VN-GIndex}_{i,t-1} + \gamma_{2,t} \mathbf{X}_{i,t-1} + \epsilon_{i,t}</span>
<span id="cb41-1525"><a href="#cb41-1525" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb41-1526"><a href="#cb41-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1527"><a href="#cb41-1527" aria-hidden="true" tabindex="-1"></a>where $\mathbf{X}_{i,t-1}$ includes controls for size, book-to-market, and momentum. Report the time-series averages of $\hat{\gamma}_{1,t}$ with Newey-West standard errors.</span>
<span id="cb41-1528"><a href="#cb41-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1529"><a href="#cb41-1529" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**State ownership interaction**: Split the sample into SOEs (state ownership <span class="sc">\&gt;</span> 50%) and private firms. Does the governance premium differ between these groups? Estimate: </span>
<span id="cb41-1530"><a href="#cb41-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1531"><a href="#cb41-1531" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb41-1532"><a href="#cb41-1532" aria-hidden="true" tabindex="-1"></a>r_{t}^{D-D} = \alpha + \beta_1 \text{MKTRF}_t + \beta_2 \text{SMB}_t + \beta_3 \text{HML}_t + \beta_4 \text{UMD}_t + \varepsilon_t</span>
<span id="cb41-1533"><a href="#cb41-1533" aria-hidden="true" tabindex="-1"></a>$$ separately for SOE and non-SOE subsamples.</span>
<span id="cb41-1534"><a href="#cb41-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1535"><a href="#cb41-1535" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Transaction cost analysis**: Compute the portfolio turnover at each rebalancing date (when new governance data becomes available). Estimate how much of the abnormal return would be consumed by transaction costs at realistic bid-ask spreads for Vietnamese equities.</span>
<span id="cb41-1536"><a href="#cb41-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1537"><a href="#cb41-1537" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Governance changes**: Do firms that improve their governance (declining VN-GIndex) earn higher subsequent returns than firms whose governance deteriorates? Construct portfolios based on $\Delta \text{VN-GIndex}$ and test.</span>
<span id="cb41-1538"><a href="#cb41-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1539"><a href="#cb41-1539" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>**Comparison with market-wide governance reforms**: Vietnam has implemented several governance reform waves (e.g., Circular 121/2012/TT-BTC, Decree 71/2017/ND-CP). Test whether the governance premium narrows after these regulatory changes using a structural break or interaction approach.</span>
<span id="cb41-1540"><a href="#cb41-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1541"><a href="#cb41-1541" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb41-1542"><a href="#cb41-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1543"><a href="#cb41-1543" aria-hidden="true" tabindex="-1"></a>This chapter adapts the influential @gompers2003corporate governance investment strategy to the Vietnamese equity market. The key methodological steps are:</span>
<span id="cb41-1544"><a href="#cb41-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-1545"><a href="#cb41-1545" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Construct a governance index (VN-GIndex) from firm-level governance provisions available through DataCore.vn.</span>
<span id="cb41-1546"><a href="#cb41-1546" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Classify firms into Democracy (strong rights) and Dictatorship (weak rights) portfolios based on the cross-sectional distribution of the index.</span>
<span id="cb41-1547"><a href="#cb41-1547" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Compute value-weighted monthly portfolio returns, rebalancing when new governance data becomes available.</span>
<span id="cb41-1548"><a href="#cb41-1548" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Evaluate the long-short (Democracy minus Dictatorship) strategy using t-tests and Fama-French-Carhart four-factor regressions.</span>
<span id="cb41-1549"><a href="#cb41-1549" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Examine robustness across subperiods, quintile portfolios, and alternative weighting schemes.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span id="copyright"></span> Mike. All rights reserved.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/edit/main/53_governance.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>