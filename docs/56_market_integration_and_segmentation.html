<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>38&nbsp; Market Integration and Segmentation – Applying Tidy Finance with Python to Vietnam</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./57_exchange_rate.html" rel="next">
<link href="./55_price_limits_and_volatility.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-50a4fa9e9ef121803c2355a2deb1af4d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d8431037eefe704a1e7a103aa5b75ea7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-50a4fa9e9ef121803c2355a2deb1af4d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="38&nbsp; Market Integration and Segmentation – Applying Tidy Finance with Python to Vietnam">
<meta property="og:description" content="">
<meta property="og:site_name" content="Applying Tidy Finance with Python to Vietnam">
<meta name="twitter:title" content="38&nbsp; Market Integration and Segmentation – Applying Tidy Finance with Python to Vietnam">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./50_institutional_ownership.html">Ownership, Market Frictions, and International Exposure</a></li><li class="breadcrumb-item"><a href="./56_market_integration_and_segmentation.html"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Market Integration and Segmentation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applying Tidy Finance with Python to Vietnam</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/mikenguyen13/tidy_finance_vn" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Vietnam Financial Markets, Institutions, and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_institutional_background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Institutional Background and Market Structure of Vietnam’s Equity Market</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_accessing_and_managing_financial_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Accessing and Managing VN Financial Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_datacore_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Datacore Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_market_microstructure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Market Microstructure in Vietnam</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_risk_free_rate_construction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Risk-Free Rate Construction in Vietnam</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_working_with_stock_returns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Constructing and Analyzing Equity Return Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_compound_return.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Compound Returns</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Portfolio Construction, Risk, and Empirical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_modern_portfolio_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modern Portfolio Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_univariate_portfolio_sort.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Univariate Portfolio Sorts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_size_sorts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Size Sorts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_value_bivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Value and Bivariate Sorts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_portfolio_weighting_and_rebalancing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Portfolio Weighting and Rebalancing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_missing_data_and_survivorship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Missing Data and Survivorship Bias</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_liquidity_and_turnover_measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Liquidity and Turnover Measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_beta_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Beta Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Asset Pricing Models and Cross-Sectional Tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_capm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">The Capital Asset Pricing Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_fama_french.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Fama-French Factors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_momentum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Momentum Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23_factor_construction_principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Factor Construction Principles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24_fama_macbeth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Fama-MacBeth Regressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25_factor_zoo_and_multiple_testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Factor Zoo and Multiple Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26_time_series_vs_cross_section.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Time-Series vs.&nbsp;Cross-Sectional Factor Tests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Firm Fundamentals, Valuation, and Corporate Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30_financial_statement_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Financial Statement Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31_discounted_cash_flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Discounted Cash Flow Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32_info_earnings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Information Content of Earnings Announcements</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33_accruals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Accruals, Earnings Persistence, and Market Efficiency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34_earning_management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Earnings Management: Detection and Measurement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./35_pe_ratio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">P/E Ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./36_valuation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Firm Valuation, Financial Distress, and Company Maturity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./37_disclosure_quality_and_timing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Disclosure Quality and Timing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./38_sue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Standardized Earnings Surprises (SUE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./39_divop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Measuring Divergence of Investor Opinion</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Ownership, Market Frictions, and International Exposure</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./50_institutional_ownership.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Institutional Ownership Analytics in Vietnam</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./52_institutional_trade_flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Institutional Trades, Flows, and Turnover Ratios</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./53_governance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Corporate Governance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./54_return_gaps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Return Gap: Measuring Unobserved Actions of Fund Managers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./55_price_limits_and_volatility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Price Limits and Volatility</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./56_market_integration_and_segmentation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Market Integration and Segmentation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./57_exchange_rate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Exchange Rate Dynamics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Data, Research Design, and Frontiers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./60_textual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Textual Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./65_event_studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Event Studies in Finance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./66_tail_risk_extreme_events.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Tail Risk and Extreme Events</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./67_corporate_finance_estimators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Corporate Finance Estimators and Identification</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99_conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-market-integration-theory" id="toc-sec-market-integration-theory" class="nav-link active" data-scroll-target="#sec-market-integration-theory"><span class="header-section-number">38.1</span> Integration in Theory</a>
  <ul class="collapse">
  <li><a href="#the-integrated-and-segmented-benchmarks" id="toc-the-integrated-and-segmented-benchmarks" class="nav-link" data-scroll-target="#the-integrated-and-segmented-benchmarks"><span class="header-section-number">38.1.1</span> The Integrated and Segmented Benchmarks</a></li>
  <li><a href="#the-segmentation-premium" id="toc-the-segmentation-premium" class="nav-link" data-scroll-target="#the-segmentation-premium"><span class="header-section-number">38.1.2</span> The Segmentation Premium</a></li>
  </ul></li>
  <li><a href="#sec-market-integration-data" id="toc-sec-market-integration-data" class="nav-link" data-scroll-target="#sec-market-integration-data"><span class="header-section-number">38.2</span> Data Construction</a>
  <ul class="collapse">
  <li><a href="#vietnams-liberalization-timeline" id="toc-vietnams-liberalization-timeline" class="nav-link" data-scroll-target="#vietnams-liberalization-timeline"><span class="header-section-number">38.2.1</span> Vietnam’s Liberalization Timeline</a></li>
  </ul></li>
  <li><a href="#sec-market-integration-correlation" id="toc-sec-market-integration-correlation" class="nav-link" data-scroll-target="#sec-market-integration-correlation"><span class="header-section-number">38.3</span> Correlation-Based Integration Measures</a>
  <ul class="collapse">
  <li><a href="#rolling-correlations" id="toc-rolling-correlations" class="nav-link" data-scroll-target="#rolling-correlations"><span class="header-section-number">38.3.1</span> Rolling Correlations</a></li>
  <li><a href="#dcc-garch-dynamic-correlations" id="toc-dcc-garch-dynamic-correlations" class="nav-link" data-scroll-target="#dcc-garch-dynamic-correlations"><span class="header-section-number">38.3.2</span> DCC-GARCH Dynamic Correlations</a></li>
  <li><a href="#asymmetric-integration" id="toc-asymmetric-integration" class="nav-link" data-scroll-target="#asymmetric-integration"><span class="header-section-number">38.3.3</span> Asymmetric Integration</a></li>
  </ul></li>
  <li><a href="#sec-market-integration-factor" id="toc-sec-market-integration-factor" class="nav-link" data-scroll-target="#sec-market-integration-factor"><span class="header-section-number">38.4</span> Factor-Based Integration Measures</a>
  <ul class="collapse">
  <li><a href="#the-pukthuanthong-roll-r²-measure" id="toc-the-pukthuanthong-roll-r²-measure" class="nav-link" data-scroll-target="#the-pukthuanthong-roll-r²-measure"><span class="header-section-number">38.4.1</span> The Pukthuanthong-Roll R² Measure</a></li>
  <li><a href="#global-vs.-local-factor-pricing" id="toc-global-vs.-local-factor-pricing" class="nav-link" data-scroll-target="#global-vs.-local-factor-pricing"><span class="header-section-number">38.4.2</span> Global vs.&nbsp;Local Factor Pricing</a></li>
  </ul></li>
  <li><a href="#sec-market-integration-pricing-error" id="toc-sec-market-integration-pricing-error" class="nav-link" data-scroll-target="#sec-market-integration-pricing-error"><span class="header-section-number">38.5</span> Pricing-Error-Based Integration</a>
  <ul class="collapse">
  <li><a href="#the-bekaert-harvey-approach" id="toc-the-bekaert-harvey-approach" class="nav-link" data-scroll-target="#the-bekaert-harvey-approach"><span class="header-section-number">38.5.1</span> The Bekaert-Harvey Approach</a></li>
  <li><a href="#composite-integration-index" id="toc-composite-integration-index" class="nav-link" data-scroll-target="#composite-integration-index"><span class="header-section-number">38.5.2</span> Composite Integration Index</a></li>
  </ul></li>
  <li><a href="#sec-market-integration-breaks" id="toc-sec-market-integration-breaks" class="nav-link" data-scroll-target="#sec-market-integration-breaks"><span class="header-section-number">38.6</span> Structural Break Detection</a>
  <ul class="collapse">
  <li><a href="#bai-perron-tests-for-integration-regime-shifts" id="toc-bai-perron-tests-for-integration-regime-shifts" class="nav-link" data-scroll-target="#bai-perron-tests-for-integration-regime-shifts"><span class="header-section-number">38.6.1</span> Bai-Perron Tests for Integration Regime Shifts</a></li>
  </ul></li>
  <li><a href="#sec-market-integration-premium" id="toc-sec-market-integration-premium" class="nav-link" data-scroll-target="#sec-market-integration-premium"><span class="header-section-number">38.7</span> The Segmentation Premium for Vietnam</a>
  <ul class="collapse">
  <li><a href="#cross-sectional-evidence" id="toc-cross-sectional-evidence" class="nav-link" data-scroll-target="#cross-sectional-evidence"><span class="header-section-number">38.7.1</span> Cross-Sectional Evidence</a></li>
  </ul></li>
  <li><a href="#sec-market-integration-fx" id="toc-sec-market-integration-fx" class="nav-link" data-scroll-target="#sec-market-integration-fx"><span class="header-section-number">38.8</span> Exchange Rate Risk and Integration</a>
  <ul class="collapse">
  <li><a href="#is-currency-risk-priced" id="toc-is-currency-risk-priced" class="nav-link" data-scroll-target="#is-currency-risk-priced"><span class="header-section-number">38.8.1</span> Is Currency Risk Priced?</a></li>
  </ul></li>
  <li><a href="#sec-market-integration-contagion" id="toc-sec-market-integration-contagion" class="nav-link" data-scroll-target="#sec-market-integration-contagion"><span class="header-section-number">38.9</span> Contagion vs.&nbsp;Interdependence</a></li>
  <li><a href="#sec-market-integration-asean" id="toc-sec-market-integration-asean" class="nav-link" data-scroll-target="#sec-market-integration-asean"><span class="header-section-number">38.10</span> ASEAN Peer Comparison</a></li>
  <li><a href="#sec-market-integration-implications" id="toc-sec-market-integration-implications" class="nav-link" data-scroll-target="#sec-market-integration-implications"><span class="header-section-number">38.11</span> Practical Implications</a></li>
  <li><a href="#sec-market-integration-summary" id="toc-sec-market-integration-summary" class="nav-link" data-scroll-target="#sec-market-integration-summary"><span class="header-section-number">38.12</span> Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/edit/main/56_market_integration_and_segmentation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./50_institutional_ownership.html">Ownership, Market Frictions, and International Exposure</a></li><li class="breadcrumb-item"><a href="./56_market_integration_and_segmentation.html"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Market Integration and Segmentation</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Market Integration and Segmentation</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this chapter, we measure the degree to which the Vietnamese equity market is integrated with or segmented from global capital markets. We construct multiple integration metrics, including correlation-based, factor-based, and pricing-error-based, trace their evolution through Vietnam’s liberalization timeline, and quantify the cost of segmentation for Vietnamese firms.</p>
</div>
</div>
<p>A market is <em>fully integrated</em> when its assets are priced by a global stochastic discount factor: risk premia reflect only exposures to global risk factors, and identical cash flow streams command the same expected return regardless of where the issuer is domiciled. A market is <em>fully segmented</em> when domestic risk factors alone determine prices, and the country’s risk-return trade-off is independent of the rest of the world. Reality sits somewhere between these poles, and the location shifts over time.</p>
<p>Vietnam is a particularly interesting case. It opened its stock exchange in July 2000 with heavy restrictions on foreign participation. Foreign ownership limits (initially 20%, raised to 30% in 2003, 49% in 2015, and selectively removed for some firms) have been gradually relaxed. Vietnam joined the WTO in 2007. FTSE Russell upgraded Vietnam from “unclassified” to “secondary emerging” in its frontier index in 2018 and has been evaluating further upgrades. Each of these events has potentially shifted the degree of integration.</p>
<p><span class="citation" data-cites="bekaert1995time">Bekaert and Harvey (<a href="references.html#ref-bekaert1995time" role="doc-biblioref">1995</a>)</span> and <span class="citation" data-cites="bekaert2002research">Bekaert and Harvey (<a href="references.html#ref-bekaert2002research" role="doc-biblioref">2002</a>)</span> establish the modern framework for measuring time-varying integration. <span class="citation" data-cites="errunza1985international">Errunza and Losq (<a href="references.html#ref-errunza1985international" role="doc-biblioref">1985</a>)</span> develop the “mild segmentation” model in which foreign investors face barriers but can partially replicate emerging market returns through global securities. <span class="citation" data-cites="pukthuanthong2009global">Pukthuanthong and Roll (<a href="references.html#ref-pukthuanthong2009global" role="doc-biblioref">2009</a>)</span> propose a factor-model-based measure that avoids the pitfalls of simple correlation analysis. This chapter implements all three approaches and applies them to Vietnam’s integration trajectory.</p>
<section id="sec-market-integration-theory" class="level2" data-number="38.1">
<h2 data-number="38.1" class="anchored" data-anchor-id="sec-market-integration-theory"><span class="header-section-number">38.1</span> Integration in Theory</h2>
<section id="the-integrated-and-segmented-benchmarks" class="level3" data-number="38.1.1">
<h3 data-number="38.1.1" class="anchored" data-anchor-id="the-integrated-and-segmented-benchmarks"><span class="header-section-number">38.1.1</span> The Integrated and Segmented Benchmarks</h3>
<p>Under full integration, the expected excess return of Vietnamese stock <span class="math inline">\(i\)</span> is:</p>
<p><span id="eq-integrated"><span class="math display">\[
E[R_{i,t} - R_{f,t}] = \beta_{i,\text{world}} \cdot \lambda_{\text{world},t}
\tag{38.1}\]</span></span></p>
<p>where <span class="math inline">\(\beta_{i,\text{world}}\)</span> is the stock’s loading on the global market factor and <span class="math inline">\(\lambda_{\text{world},t}\)</span> is the global risk premium. Only global systematic risk is priced; country-specific risk is diversifiable and commands no premium.</p>
<p>Under full segmentation:</p>
<p><span id="eq-segmented"><span class="math display">\[
E[R_{i,t} - R_{f,t}] = \beta_{i,\text{local}} \cdot \lambda_{\text{local},t}
\tag{38.2}\]</span></span></p>
<p>where <span class="math inline">\(\beta_{i,\text{local}}\)</span> is the stock’s loading on the Vietnamese market and <span class="math inline">\(\lambda_{\text{local},t}\)</span> is the domestic risk premium. The domestic market is effectively a closed economy for pricing purposes.</p>
<p><span class="citation" data-cites="bekaert1995time">Bekaert and Harvey (<a href="references.html#ref-bekaert1995time" role="doc-biblioref">1995</a>)</span> model the transition between these states as a regime-switching process where the mixing weight <span class="math inline">\(\omega_t \in [0, 1]\)</span> evolves over time:</p>
<p><span id="eq-partial"><span class="math display">\[
E[R_{i,t} - R_{f,t}] = \omega_t \cdot \beta_{i,\text{world}} \lambda_{\text{world},t} + (1 - \omega_t) \cdot \beta_{i,\text{local}} \lambda_{\text{local},t}
\tag{38.3}\]</span></span></p>
<p>The weight <span class="math inline">\(\omega_t\)</span> is the <em>degree of integration</em>: <span class="math inline">\(\omega_t = 1\)</span> is full integration, <span class="math inline">\(\omega_t = 0\)</span> is full segmentation.</p>
</section>
<section id="the-segmentation-premium" class="level3" data-number="38.1.2">
<h3 data-number="38.1.2" class="anchored" data-anchor-id="the-segmentation-premium"><span class="header-section-number">38.1.2</span> The Segmentation Premium</h3>
<p>When a market transitions from segmented to integrated, its cost of capital falls because the relevant risk for pricing narrows from total domestic risk to only the portion correlated with the global market <span class="citation" data-cites="henry2000stock bekaert2005does">(<a href="references.html#ref-henry2000stock" role="doc-biblioref">Henry 2000</a>; <a href="references.html#ref-bekaert2005does" role="doc-biblioref">Bekaert, Harvey, and Lundblad 2005</a>)</span>. The <em>segmentation premium</em> is the excess expected return that investors in a segmented market require:</p>
<p><span id="eq-segmentation-premium"><span class="math display">\[
\text{Segmentation premium} = (1 - \omega_t) \cdot (\lambda_{\text{local}} - \beta_{\text{local,world}} \cdot \lambda_{\text{world}})
\tag{38.4}\]</span></span></p>
<p>This premium represents a deadweight cost: it raises the cost of capital for Vietnamese firms, reduces investment, and lowers welfare relative to the integrated benchmark.</p>
</section>
</section>
<section id="sec-market-integration-data" class="level2" data-number="38.2">
<h2 data-number="38.2" class="anchored" data-anchor-id="sec-market-integration-data"><span class="header-section-number">38.2</span> Data Construction</h2>
<div id="setup" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats, optimize</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch <span class="im">import</span> arch_model</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch.univariate <span class="im">import</span> ConstantMean, GARCH</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: (<span class="dv">12</span>, <span class="dv">6</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.dpi'</span>: <span class="dv">150</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: <span class="dv">11</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.spines.top'</span>: <span class="va">False</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.spines.right'</span>: <span class="va">False</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="data-load" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datacore <span class="im">import</span> DataCoreClient</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> DataCoreClient()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Vietnamese market returns</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>vn_index <span class="op">=</span> client.get_index_returns(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">'VNINDEX'</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[<span class="st">'date'</span>, <span class="st">'return'</span>, <span class="st">'total_return_index'</span>]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>vn_index[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(vn_index[<span class="st">'date'</span>])</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>vn_index <span class="op">=</span> vn_index.set_index(<span class="st">'date'</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Global and regional indices (USD-denominated for comparability)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>global_indices <span class="op">=</span> client.get_global_indices(</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    indices<span class="op">=</span>[</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSCI_WORLD'</span>, <span class="st">'MSCI_EM'</span>, <span class="st">'MSCI_ASIA_PAC_EX_JP'</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSCI_FM'</span>,  <span class="co"># Frontier markets</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'SP500'</span>, <span class="st">'STOXX600'</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSCI_CHINA'</span>, <span class="st">'MSCI_THAILAND'</span>, <span class="st">'MSCI_INDONESIA'</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSCI_PHILIPPINES'</span>, <span class="st">'MSCI_MALAYSIA'</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    currency<span class="op">=</span><span class="st">'USD'</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>global_indices[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(global_indices[<span class="st">'date'</span>])</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>global_indices <span class="op">=</span> global_indices.pivot(index<span class="op">=</span><span class="st">'date'</span>, columns<span class="op">=</span><span class="st">'index'</span>, values<span class="op">=</span><span class="st">'return'</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Vietnam returns in USD for apples-to-apples comparison</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>vn_usd <span class="op">=</span> client.get_index_returns(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">'VNINDEX'</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    currency<span class="op">=</span><span class="st">'USD'</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>vn_usd[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(vn_usd[<span class="st">'date'</span>])</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>global_indices[<span class="st">'VIETNAM'</span>] <span class="op">=</span> vn_usd.set_index(<span class="st">'date'</span>)[<span class="st">'return'</span>]</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co"># VND/USD exchange rate</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>fx <span class="op">=</span> client.get_exchange_rates(</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    pair<span class="op">=</span><span class="st">'USD_VND'</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>fx[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(fx[<span class="st">'date'</span>])</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>fx <span class="op">=</span> fx.set_index(<span class="st">'date'</span>)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Global factor returns (Fama-French global)</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>global_factors <span class="op">=</span> client.get_global_factor_returns(</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span>,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    factors<span class="op">=</span>[<span class="st">'mkt_excess_world'</span>, <span class="st">'smb_world'</span>, <span class="st">'hml_world'</span>,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>             <span class="st">'rmw_world'</span>, <span class="st">'cma_world'</span>, <span class="st">'wml_world'</span>]</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>global_factors[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(global_factors[<span class="st">'date'</span>])</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>global_factors <span class="op">=</span> global_factors.set_index(<span class="st">'date'</span>)</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Vietnamese factor returns (local)</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>local_factors <span class="op">=</span> client.get_factor_returns(</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    market<span class="op">=</span><span class="st">'vietnam'</span>,</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2008-01-01'</span>,</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    factors<span class="op">=</span>[<span class="st">'mkt_excess'</span>, <span class="st">'smb'</span>, <span class="st">'hml'</span>, <span class="st">'rmw'</span>, <span class="st">'cma'</span>, <span class="st">'wml'</span>]</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>local_factors[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(local_factors[<span class="st">'date'</span>])</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>local_factors <span class="op">=</span> local_factors.set_index(<span class="st">'date'</span>)</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Vietnam index: </span><span class="sc">{</span><span class="bu">len</span>(vn_index)<span class="sc">}</span><span class="ss"> months"</span>)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Global indices: </span><span class="sc">{</span>global_indices<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Global factors: </span><span class="sc">{</span><span class="bu">len</span>(global_factors)<span class="sc">}</span><span class="ss"> months"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="vietnams-liberalization-timeline" class="level3" data-number="38.2.1">
<h3 data-number="38.2.1" class="anchored" data-anchor-id="vietnams-liberalization-timeline"><span class="header-section-number">38.2.1</span> Vietnam’s Liberalization Timeline</h3>
<div id="timeline" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>liberalization_events <span class="op">=</span> pd.DataFrame([</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2000-07-28'</span>, <span class="st">'HOSE opens'</span>, <span class="st">'Institutional'</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2002-03-01'</span>, <span class="st">'FOL raised to 30%'</span>, <span class="st">'Ownership'</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2005-03-01'</span>, <span class="st">'HNX opens'</span>, <span class="st">'Institutional'</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2006-01-01'</span>, <span class="st">'Securities Law enacted'</span>, <span class="st">'Legal'</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2007-01-11'</span>, <span class="st">'WTO accession'</span>, <span class="st">'Trade'</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2007-06-01'</span>, <span class="st">'FOL raised to 49%'</span>, <span class="st">'Ownership'</span>),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2009-06-24'</span>, <span class="st">'UPCoM opens'</span>, <span class="st">'Institutional'</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2012-01-01'</span>, <span class="st">'SSC restructuring'</span>, <span class="st">'Regulatory'</span>),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2015-09-01'</span>, <span class="st">'FOL selectively removed'</span>, <span class="st">'Ownership'</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2017-08-01'</span>, <span class="st">'Derivatives market opens'</span>, <span class="st">'Institutional'</span>),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2018-09-01'</span>, <span class="st">'FTSE Frontier Secondary'</span>, <span class="st">'Index'</span>),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2021-01-01'</span>, <span class="st">'New Securities Law'</span>, <span class="st">'Legal'</span>),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2023-06-01'</span>, <span class="st">'KRX trading system'</span>, <span class="st">'Infrastructure'</span>),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>], columns<span class="op">=</span>[<span class="st">'date'</span>, <span class="st">'event'</span>, <span class="st">'category'</span>])</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>liberalization_events[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(liberalization_events[<span class="st">'date'</span>])</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vietnam Liberalization Timeline:"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>row[<span class="st">'date'</span>]<span class="sc">.</span>strftime(<span class="st">'%Y-%m'</span>)<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>row[<span class="st">'event'</span>]<span class="sc">}</span><span class="ss"> [</span><span class="sc">{</span>row[<span class="st">'category'</span>]<span class="sc">}</span><span class="ss">]"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="sec-market-integration-correlation" class="level2" data-number="38.3">
<h2 data-number="38.3" class="anchored" data-anchor-id="sec-market-integration-correlation"><span class="header-section-number">38.3</span> Correlation-Based Integration Measures</h2>
<section id="rolling-correlations" class="level3" data-number="38.3.1">
<h3 data-number="38.3.1" class="anchored" data-anchor-id="rolling-correlations"><span class="header-section-number">38.3.1</span> Rolling Correlations</h3>
<p>The simplest integration metric is the correlation between Vietnamese and global market returns. Higher correlation implies more integration (returns are driven by the same global factors). However, simple correlation is confounded by volatility changes (i.e., correlations tend to increase mechanically during high-volatility periods <span class="citation" data-cites="longin2001extreme">(<a href="references.html#ref-longin2001extreme" role="doc-biblioref">Longin and Solnik 2001</a>)</span>).</p>
<div id="rolling-correlations" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Align all series</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>indices_aligned <span class="op">=</span> global_indices.dropna(subset<span class="op">=</span>[<span class="st">'VIETNAM'</span>, <span class="st">'MSCI_WORLD'</span>]).copy()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling 36-month correlations</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>rolling_window <span class="op">=</span> <span class="dv">36</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>corr_series <span class="op">=</span> {}</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> [<span class="st">'MSCI_WORLD'</span>, <span class="st">'MSCI_EM'</span>, <span class="st">'MSCI_ASIA_PAC_EX_JP'</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SP500'</span>, <span class="st">'MSCI_CHINA'</span>, <span class="st">'MSCI_THAILAND'</span>]:</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="kw">in</span> indices_aligned.columns:</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        corr <span class="op">=</span> (</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            indices_aligned[[<span class="st">'VIETNAM'</span>, idx]]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            .rolling(rolling_window)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>            .corr()</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>            .unstack()[<span class="st">'VIETNAM'</span>][idx]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        corr_series[idx] <span class="op">=</span> corr</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>corr_df <span class="op">=</span> pd.DataFrame(corr_series)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fig-rolling-corr" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="6">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rolling-corr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>colors_idx <span class="op">=</span> {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_WORLD'</span>: <span class="st">'#2C5F8A'</span>, <span class="st">'MSCI_EM'</span>: <span class="st">'#C0392B'</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_ASIA_PAC_EX_JP'</span>: <span class="st">'#27AE60'</span>, <span class="st">'SP500'</span>: <span class="st">'#8E44AD'</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_CHINA'</span>: <span class="st">'#E67E22'</span>, <span class="st">'MSCI_THAILAND'</span>: <span class="st">'#1ABC9C'</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, color <span class="kw">in</span> colors_idx.items():</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="kw">in</span> corr_df.columns:</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        ax.plot(corr_df.index, corr_df[idx], color<span class="op">=</span>color,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span>idx.replace(<span class="st">'MSCI_'</span>, <span class="st">''</span>).replace(<span class="st">'_'</span>, <span class="st">' '</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add liberalization events</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, event <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> event[<span class="st">'date'</span>] <span class="op">&gt;=</span> corr_df.index.<span class="bu">min</span>():</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        ax.axvline(x<span class="op">=</span>event[<span class="st">'date'</span>], color<span class="op">=</span><span class="st">'gray'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                   linestyle<span class="op">=</span><span class="st">':'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Correlation with Vietnam'</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Rolling 36-Month Correlation: Vietnam vs Global Markets'</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">8</span>, ncol<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.8</span>])</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-rolling-corr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;38.1
</figcaption>
</figure>
</div>
</section>
<section id="dcc-garch-dynamic-correlations" class="level3" data-number="38.3.2">
<h3 data-number="38.3.2" class="anchored" data-anchor-id="dcc-garch-dynamic-correlations"><span class="header-section-number">38.3.2</span> DCC-GARCH Dynamic Correlations</h3>
<p>To separate changes in correlation from changes in volatility, we estimate a Dynamic Conditional Correlation (DCC) model <span class="citation" data-cites="engle2002dynamic">(<a href="references.html#ref-engle2002dynamic" role="doc-biblioref">Engle 2002</a>)</span>. The DCC decomposes the time-varying covariance matrix into time-varying volatilities and a time-varying correlation matrix:</p>
<p><span id="eq-dcc-decomp"><span class="math display">\[
H_t = D_t R_t D_t
\tag{38.5}\]</span></span></p>
<p>where <span class="math inline">\(D_t = \text{diag}(\sigma_{1,t}, \ldots, \sigma_{n,t})\)</span> and <span class="math inline">\(R_t\)</span> is the conditional correlation matrix that evolves according to:</p>
<p><span id="eq-dcc-evolution"><span class="math display">\[
Q_t = (1 - a - b) \bar{Q} + a \epsilon_{t-1} \epsilon_{t-1}' + b Q_{t-1}
\tag{38.6}\]</span></span></p>
<p><span id="eq-dcc-normalize"><span class="math display">\[
R_t = \text{diag}(Q_t)^{-1/2} Q_t \text{diag}(Q_t)^{-1/2}
\tag{38.7}\]</span></span></p>
<div id="dcc-garch" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_dcc(y1, y2, p<span class="op">=</span><span class="dv">1</span>, q<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Two-step DCC-GARCH estimation.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1: Univariate GARCH for each series.</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2: DCC parameters from standardized residuals.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 1: Univariate GARCH(1,1) for each series</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> []</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    std_resids <span class="op">=</span> []</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    cond_vols <span class="op">=</span> []</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> y <span class="kw">in</span> [y1, y2]:</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        am <span class="op">=</span> arch_model(y <span class="op">*</span> <span class="dv">100</span>, vol<span class="op">=</span><span class="st">'GARCH'</span>, p<span class="op">=</span>p, q<span class="op">=</span>q,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                          mean<span class="op">=</span><span class="st">'Constant'</span>, dist<span class="op">=</span><span class="st">'normal'</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> am.fit(disp<span class="op">=</span><span class="st">'off'</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        models.append(res)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        std_resids.append(res.std_resid)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        cond_vols.append(res.conditional_volatility <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Align residuals</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    e1 <span class="op">=</span> std_resids[<span class="dv">0</span>]</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    e2 <span class="op">=</span> std_resids[<span class="dv">1</span>]</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    common <span class="op">=</span> e1.dropna().index.intersection(e2.dropna().index)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    e1 <span class="op">=</span> e1[common].values</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    e2 <span class="op">=</span> e2[common].values</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="bu">len</span>(e1)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2: DCC estimation</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Q_bar = unconditional correlation of standardized residuals</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    Q_bar <span class="op">=</span> np.corrcoef(e1, e2)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dcc_loglik(params):</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> params</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> a <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> b <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> a <span class="op">+</span> b <span class="op">&gt;=</span> <span class="dv">1</span>:</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fl">1e10</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>        Q <span class="op">=</span> np.zeros((T, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        R <span class="op">=</span> np.zeros((T, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>        Q[<span class="dv">0</span>] <span class="op">=</span> Q_bar.copy()</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        ll <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(T):</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> t <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>                et <span class="op">=</span> np.array([[e1[t<span class="op">-</span><span class="dv">1</span>]], [e2[t<span class="op">-</span><span class="dv">1</span>]]])</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>                Q[t] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> a <span class="op">-</span> b) <span class="op">*</span> Q_bar <span class="op">+</span> a <span class="op">*</span> (et <span class="op">@</span> et.T) <span class="op">+</span> b <span class="op">*</span> Q[t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Normalize</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>            d <span class="op">=</span> np.sqrt(np.diag(Q[t]))</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> d[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> d[<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>                R[t] <span class="op">=</span> Q[t] <span class="op">/</span> np.outer(d, d)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>                R[t] <span class="op">=</span> np.eye(<span class="dv">2</span>)</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Clip correlation</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>            R[t, <span class="dv">0</span>, <span class="dv">1</span>] <span class="op">=</span> np.clip(R[t, <span class="dv">0</span>, <span class="dv">1</span>], <span class="op">-</span><span class="fl">0.999</span>, <span class="fl">0.999</span>)</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>            R[t, <span class="dv">1</span>, <span class="dv">0</span>] <span class="op">=</span> R[t, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Log-likelihood contribution</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>            det_R <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> R[t, <span class="dv">0</span>, <span class="dv">1</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> det_R <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>                et_vec <span class="op">=</span> np.array([e1[t], e2[t]])</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>                ll <span class="op">+=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> (np.log(det_R) <span class="op">+</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>                              et_vec <span class="op">@</span> np.linalg.inv(R[t]) <span class="op">@</span> et_vec <span class="op">-</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>                              et_vec <span class="op">@</span> et_vec)</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">-</span>ll</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> optimize.minimize(dcc_loglik, [<span class="fl">0.05</span>, <span class="fl">0.90</span>],</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>                                method<span class="op">=</span><span class="st">'Nelder-Mead'</span>,</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>                                options<span class="op">=</span>{<span class="st">'maxiter'</span>: <span class="dv">5000</span>})</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>    a_hat, b_hat <span class="op">=</span> result.x</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reconstruct dynamic correlations</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    Q <span class="op">=</span> np.zeros((T, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    dcc_corr <span class="op">=</span> np.zeros(T)</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>    Q[<span class="dv">0</span>] <span class="op">=</span> Q_bar.copy()</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(T):</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> t <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>            et <span class="op">=</span> np.array([[e1[t<span class="op">-</span><span class="dv">1</span>]], [e2[t<span class="op">-</span><span class="dv">1</span>]]])</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>            Q[t] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> a_hat <span class="op">-</span> b_hat) <span class="op">*</span> Q_bar <span class="op">+</span> a_hat <span class="op">*</span> (et <span class="op">@</span> et.T) <span class="op">+</span> b_hat <span class="op">*</span> Q[t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>        d <span class="op">=</span> np.sqrt(np.diag(Q[t]))</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> d[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> d[<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>            dcc_corr[t] <span class="op">=</span> Q[t, <span class="dv">0</span>, <span class="dv">1</span>] <span class="op">/</span> (d[<span class="dv">0</span>] <span class="op">*</span> d[<span class="dv">1</span>])</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>            dcc_corr[t] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>        <span class="st">'a'</span>: a_hat, <span class="st">'b'</span>: b_hat,</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>        <span class="st">'persistence'</span>: a_hat <span class="op">+</span> b_hat,</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>        <span class="st">'dcc_corr'</span>: pd.Series(dcc_corr, index<span class="op">=</span>common),</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>        <span class="st">'cond_vol_1'</span>: cond_vols[<span class="dv">0</span>],</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>        <span class="st">'cond_vol_2'</span>: cond_vols[<span class="dv">1</span>]</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate DCC: Vietnam vs MSCI World</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>vn_ret <span class="op">=</span> indices_aligned[<span class="st">'VIETNAM'</span>].dropna()</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>world_ret <span class="op">=</span> indices_aligned[<span class="st">'MSCI_WORLD'</span>].dropna()</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>common_dates <span class="op">=</span> vn_ret.index.intersection(world_ret.index)</span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>dcc_result <span class="op">=</span> estimate_dcc(vn_ret[common_dates], world_ret[common_dates])</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"DCC Parameters:"</span>)</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  a (news): </span><span class="sc">{</span>dcc_result[<span class="st">'a'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  b (persistence): </span><span class="sc">{</span>dcc_result[<span class="st">'b'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  a + b: </span><span class="sc">{</span>dcc_result[<span class="st">'persistence'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">DCC Correlation with MSCI World:"</span>)</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean: </span><span class="sc">{</span>dcc_result[<span class="st">'dcc_corr'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Min:  </span><span class="sc">{</span>dcc_result[<span class="st">'dcc_corr'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Max:  </span><span class="sc">{</span>dcc_result[<span class="st">'dcc_corr'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fig-dcc" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="8">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dcc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>), sharex<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                          gridspec_kw<span class="op">=</span>{<span class="st">'height_ratios'</span>: [<span class="dv">2</span>, <span class="dv">1</span>]})</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: DCC correlation</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(dcc_result[<span class="st">'dcc_corr'</span>].index, dcc_result[<span class="st">'dcc_corr'</span>].values,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>             color<span class="op">=</span><span class="st">'#2C5F8A'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].fill_between(dcc_result[<span class="st">'dcc_corr'</span>].index,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                       dcc_result[<span class="st">'dcc_corr'</span>].values, <span class="dv">0</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                       alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">'#2C5F8A'</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Liberalization events</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>event_colors <span class="op">=</span> {<span class="st">'Ownership'</span>: <span class="st">'#C0392B'</span>, <span class="st">'Trade'</span>: <span class="st">'#27AE60'</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Institutional'</span>: <span class="st">'#E67E22'</span>, <span class="st">'Legal'</span>: <span class="st">'#8E44AD'</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Index'</span>: <span class="st">'#1ABC9C'</span>, <span class="st">'Regulatory'</span>: <span class="st">'#F1C40F'</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Infrastructure'</span>: <span class="st">'#3498DB'</span>}</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, event <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> event[<span class="st">'date'</span>] <span class="kw">in</span> dcc_result[<span class="st">'dcc_corr'</span>].index <span class="kw">or</span> <span class="va">True</span>:</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> event_colors.get(event[<span class="st">'category'</span>], <span class="st">'gray'</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].axvline(x<span class="op">=</span>event[<span class="st">'date'</span>], color<span class="op">=</span>color, linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                         linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].text(event[<span class="st">'date'</span>], axes[<span class="dv">0</span>].get_ylim()[<span class="dv">1</span>] <span class="op">*</span> <span class="fl">0.95</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                      event[<span class="st">'event'</span>][:<span class="dv">15</span>], rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">6</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                      va<span class="op">=</span><span class="st">'top'</span>, color<span class="op">=</span>color)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Dynamic Conditional Correlation'</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Panel A: DCC-GARCH Correlation (Vietnam–World)'</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Conditional volatilities</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>vol1 <span class="op">=</span> dcc_result[<span class="st">'cond_vol_1'</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>)  <span class="co"># Annualized</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>vol2 <span class="op">=</span> dcc_result[<span class="st">'cond_vol_2'</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>common_vol <span class="op">=</span> vol1.index.intersection(vol2.index)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(common_vol, vol1[common_vol], color<span class="op">=</span><span class="st">'#C0392B'</span>,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">'Vietnam'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(common_vol, vol2[common_vol], color<span class="op">=</span><span class="st">'#2C5F8A'</span>,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">'World'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Annualized Cond. Vol'</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Panel B: Conditional Volatility'</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-dcc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;38.2
</figcaption>
</figure>
</div>
</section>
<section id="asymmetric-integration" class="level3" data-number="38.3.3">
<h3 data-number="38.3.3" class="anchored" data-anchor-id="asymmetric-integration"><span class="header-section-number">38.3.3</span> Asymmetric Integration</h3>
<p>Integration may be state-dependent: co-movement often increases during global crises (contagion) but not during local booms. <span class="citation" data-cites="longin2001extreme">Longin and Solnik (<a href="references.html#ref-longin2001extreme" role="doc-biblioref">2001</a>)</span> and <span class="citation" data-cites="ang2002asymmetric">Ang and Chen (<a href="references.html#ref-ang2002asymmetric" role="doc-biblioref">2002</a>)</span> show that equity correlations are higher during market downturns. We test for asymmetry:</p>
<div id="asymmetric-corr" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify global market regimes</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>world_ret_aligned <span class="op">=</span> world_ret[common_dates]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>vn_ret_aligned <span class="op">=</span> vn_ret[common_dates]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bear: world return in bottom 25th percentile</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Bull: world return in top 25th percentile</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>q25 <span class="op">=</span> world_ret_aligned.quantile(<span class="fl">0.25</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>q75 <span class="op">=</span> world_ret_aligned.quantile(<span class="fl">0.75</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>bear <span class="op">=</span> world_ret_aligned <span class="op">&lt;=</span> q25</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>bull <span class="op">=</span> world_ret_aligned <span class="op">&gt;=</span> q75</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>normal <span class="op">=</span> <span class="op">~</span>bear <span class="op">&amp;</span> <span class="op">~</span>bull</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>regimes <span class="op">=</span> {</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Bear (bottom 25%)'</span>: bear,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Normal (middle 50%)'</span>: normal,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Bull (top 25%)'</span>: bull,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'All'</span>: pd.Series(<span class="va">True</span>, index<span class="op">=</span>world_ret_aligned.index)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Asymmetric Correlation:"</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Regime'</span><span class="sc">:&lt;25}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Correlation'</span><span class="sc">:&gt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'N months'</span><span class="sc">:&gt;10}</span><span class="ss">"</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">47</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, mask <span class="kw">in</span> regimes.items():</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    r_vn <span class="op">=</span> vn_ret_aligned[mask]</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    r_w <span class="op">=</span> world_ret_aligned[mask]</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    corr <span class="op">=</span> r_vn.corr(r_w)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">:&lt;25}</span><span class="ss"> </span><span class="sc">{</span>corr<span class="sc">:&gt;12.3f}</span><span class="ss"> </span><span class="sc">{</span>mask<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:&gt;10}</span><span class="ss">"</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Test: is bear correlation &gt; bull correlation?</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>r_bear_vn <span class="op">=</span> vn_ret_aligned[bear]</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>r_bear_w <span class="op">=</span> world_ret_aligned[bear]</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>r_bull_vn <span class="op">=</span> vn_ret_aligned[bull]</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>r_bull_w <span class="op">=</span> world_ret_aligned[bull]</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Fisher z-transformation test</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fisher_z_test(r1, n1, r2, n2):</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    z1 <span class="op">=</span> np.arctanh(r1)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    z2 <span class="op">=</span> np.arctanh(r2)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    se <span class="op">=</span> np.sqrt(<span class="dv">1</span> <span class="op">/</span> (n1 <span class="op">-</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">1</span> <span class="op">/</span> (n2 <span class="op">-</span> <span class="dv">3</span>))</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    z_stat <span class="op">=</span> (z1 <span class="op">-</span> z2) <span class="op">/</span> se</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    p_val <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.norm.cdf(<span class="bu">abs</span>(z_stat)))</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> z_stat, p_val</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>z, p <span class="op">=</span> fisher_z_test(</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    r_bear_vn.corr(r_bear_w), <span class="bu">len</span>(r_bear_vn),</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    r_bull_vn.corr(r_bull_w), <span class="bu">len</span>(r_bull_vn)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Fisher z-test (bear vs bull): z = </span><span class="sc">{</span>z<span class="sc">:.2f}</span><span class="ss">, p = </span><span class="sc">{</span>p<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="sec-market-integration-factor" class="level2" data-number="38.4">
<h2 data-number="38.4" class="anchored" data-anchor-id="sec-market-integration-factor"><span class="header-section-number">38.4</span> Factor-Based Integration Measures</h2>
<section id="the-pukthuanthong-roll-r²-measure" class="level3" data-number="38.4.1">
<h3 data-number="38.4.1" class="anchored" data-anchor-id="the-pukthuanthong-roll-r²-measure"><span class="header-section-number">38.4.1</span> The Pukthuanthong-Roll R² Measure</h3>
<p><span class="citation" data-cites="pukthuanthong2009global">Pukthuanthong and Roll (<a href="references.html#ref-pukthuanthong2009global" role="doc-biblioref">2009</a>)</span> propose measuring integration as the <span class="math inline">\(R^2\)</span> from regressing a country’s returns on a set of global principal components. The intuition: if a market is fully integrated, global factors should explain all of its systematic return variation.</p>
<div id="pr-measure" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pukthuanthong_roll_integration(country_returns, global_returns_matrix,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                                     n_components<span class="op">=</span><span class="dv">10</span>, rolling_window<span class="op">=</span><span class="dv">36</span>):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Pukthuanthong-Roll (2009) R²-based integration measure.</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">    1. Extract principal components from global returns.</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">    2. Regress country returns on these PCs.</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">    3. R² = degree of integration.</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    common <span class="op">=</span> country_returns.dropna().index.intersection(</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        global_returns_matrix.dropna().index</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    dates <span class="op">=</span> <span class="bu">sorted</span>(common)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="bu">len</span>(dates)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    integration <span class="op">=</span> []</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(rolling_window, T):</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        window <span class="op">=</span> dates[t <span class="op">-</span> rolling_window:t]</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Global returns in window</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        G <span class="op">=</span> global_returns_matrix.loc[window].dropna(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> G.shape[<span class="dv">1</span>] <span class="op">&lt;</span> n_components:</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Standardize</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        G_std <span class="op">=</span> (G <span class="op">-</span> G.mean()) <span class="op">/</span> G.std()</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># PCA</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        cov <span class="op">=</span> G_std.T <span class="op">@</span> G_std <span class="op">/</span> <span class="bu">len</span>(G_std)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        eigenvalues, eigenvectors <span class="op">=</span> np.linalg.eigh(cov.values)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sort descending</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        idx <span class="op">=</span> np.argsort(<span class="op">-</span>eigenvalues)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        eigenvalues <span class="op">=</span> eigenvalues[idx]</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        eigenvectors <span class="op">=</span> eigenvectors[:, idx]</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Project onto top K PCs</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        PCs <span class="op">=</span> G_std.values <span class="op">@</span> eigenvectors[:, :n_components]</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Regress country returns on PCs</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> country_returns.loc[window].values</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> sm.add_constant(PCs)</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>            integration.append({</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">'date'</span>: dates[t],</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">'r_squared'</span>: model.rsquared,</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">'adj_r_squared'</span>: model.rsquared_adj,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>                <span class="st">'var_explained_pc1'</span>: eigenvalues[<span class="dv">0</span>] <span class="op">/</span> eigenvalues.<span class="bu">sum</span>(),</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>                <span class="st">'n_countries'</span>: G.shape[<span class="dv">1</span>]</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(integration)</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Build global returns matrix from multiple country indices</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>global_matrix <span class="op">=</span> global_indices.drop(columns<span class="op">=</span>[<span class="st">'VIETNAM'</span>], errors<span class="op">=</span><span class="st">'ignore'</span>)</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>pr_result <span class="op">=</span> pukthuanthong_roll_integration(</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>    indices_aligned[<span class="st">'VIETNAM'</span>],</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>    global_matrix,</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>    n_components<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>    rolling_window<span class="op">=</span><span class="dv">36</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(pr_result) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>    pr_result[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(pr_result[<span class="st">'date'</span>])</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Pukthuanthong-Roll Integration (R²):"</span>)</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Mean: </span><span class="sc">{</span>pr_result[<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  2008-2012: </span><span class="sc">{</span>pr_result[(pr_result[<span class="st">'date'</span>] <span class="op">&gt;=</span> <span class="st">'2008'</span>) <span class="op">&amp;</span> (pr_result[<span class="st">'date'</span>] <span class="op">&lt;</span> <span class="st">'2013'</span>)][<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  2013-2018: </span><span class="sc">{</span>pr_result[(pr_result[<span class="st">'date'</span>] <span class="op">&gt;=</span> <span class="st">'2013'</span>) <span class="op">&amp;</span> (pr_result[<span class="st">'date'</span>] <span class="op">&lt;</span> <span class="st">'2019'</span>)][<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  2019-2024: </span><span class="sc">{</span>pr_result[pr_result[<span class="st">'date'</span>] <span class="op">&gt;=</span> <span class="st">'2019'</span>][<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="global-vs.-local-factor-pricing" class="level3" data-number="38.4.2">
<h3 data-number="38.4.2" class="anchored" data-anchor-id="global-vs.-local-factor-pricing"><span class="header-section-number">38.4.2</span> Global vs.&nbsp;Local Factor Pricing</h3>
<p><span class="citation" data-cites="griffin2002fama">Griffin (<a href="references.html#ref-griffin2002fama" role="doc-biblioref">2002</a>)</span> tests whether global or local versions of the Fama-French factors better explain country-level returns. We implement this horse race for Vietnam:</p>
<div id="global-vs-local" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Align global and local factors</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>common_factor_dates <span class="op">=</span> (</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    global_factors.index</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    .intersection(local_factors.index)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    .intersection(vn_index.index)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>vn_excess <span class="op">=</span> vn_index.loc[common_factor_dates, <span class="st">'return'</span>]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Global FF5</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>X_global <span class="op">=</span> sm.add_constant(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    global_factors.loc[common_factor_dates,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                        [<span class="st">'mkt_excess_world'</span>, <span class="st">'smb_world'</span>, <span class="st">'hml_world'</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'rmw_world'</span>, <span class="st">'cma_world'</span>]]</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>model_global <span class="op">=</span> sm.OLS(vn_excess, X_global).fit(</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">6</span>}</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Local FF5</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>X_local <span class="op">=</span> sm.add_constant(</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    local_factors.loc[common_factor_dates,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                       [<span class="st">'mkt_excess'</span>, <span class="st">'smb'</span>, <span class="st">'hml'</span>, <span class="st">'rmw'</span>, <span class="st">'cma'</span>]]</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>model_local <span class="op">=</span> sm.OLS(vn_excess, X_local).fit(</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">6</span>}</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3: Both global and local</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>X_both <span class="op">=</span> sm.add_constant(pd.concat([</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    global_factors.loc[common_factor_dates,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>                        [<span class="st">'mkt_excess_world'</span>, <span class="st">'smb_world'</span>, <span class="st">'hml_world'</span>]],</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    local_factors.loc[common_factor_dates,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>                       [<span class="st">'mkt_excess'</span>, <span class="st">'smb'</span>, <span class="st">'hml'</span>]]</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>], axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>model_both <span class="op">=</span> sm.OLS(vn_excess, X_both).fit(</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">6</span>}</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Global vs Local Factor Models for VN-Index:"</span>)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Model'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'R²'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Adj R²'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'α (ann)'</span><span class="sc">:&gt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'α t-stat'</span><span class="sc">:&gt;10}</span><span class="ss">"</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">56</span>)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, mod <span class="kw">in</span> [(<span class="st">'Global FF5'</span>, model_global),</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>                    (<span class="st">'Local FF5'</span>, model_local),</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>                    (<span class="st">'Global + Local'</span>, model_both)]:</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>mod<span class="sc">.</span>rsquared<span class="sc">:&gt;8.3f}</span><span class="ss"> </span><span class="sc">{</span>mod<span class="sc">.</span>rsquared_adj<span class="sc">:&gt;8.3f}</span><span class="ss"> "</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>mod<span class="sc">.</span>params[<span class="st">'const'</span>]<span class="op">*</span><span class="dv">12</span><span class="sc">:&gt;10.4f}</span><span class="ss"> </span><span class="sc">{</span>mod<span class="sc">.</span>tvalues[<span class="st">'const'</span>]<span class="sc">:&gt;10.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fig-global-local-r2" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="12">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-global-local-r2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rolling_r2 <span class="op">=</span> []</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>rw <span class="op">=</span> <span class="dv">36</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(rw, <span class="bu">len</span>(common_factor_dates)):</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    window <span class="op">=</span> common_factor_dates[t <span class="op">-</span> rw:t]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> vn_excess[window]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Global</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    X_g <span class="op">=</span> sm.add_constant(global_factors.loc[window,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                           [<span class="st">'mkt_excess_world'</span>, <span class="st">'smb_world'</span>, <span class="st">'hml_world'</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'rmw_world'</span>, <span class="st">'cma_world'</span>]])</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        r2_g <span class="op">=</span> sm.OLS(y, X_g).fit().rsquared</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        r2_g <span class="op">=</span> np.nan</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Local</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    X_l <span class="op">=</span> sm.add_constant(local_factors.loc[window,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                           [<span class="st">'mkt_excess'</span>, <span class="st">'smb'</span>, <span class="st">'hml'</span>, <span class="st">'rmw'</span>, <span class="st">'cma'</span>]])</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        r2_l <span class="op">=</span> sm.OLS(y, X_l).fit().rsquared</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        r2_l <span class="op">=</span> np.nan</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    rolling_r2.append({</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">'date'</span>: common_factor_dates[t],</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'r2_global'</span>: r2_g,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'r2_local'</span>: r2_l,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ratio'</span>: r2_g <span class="op">/</span> r2_l <span class="cf">if</span> r2_l <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>r2_df <span class="op">=</span> pd.DataFrame(rolling_r2)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(r2_df[<span class="st">'date'</span>], r2_df[<span class="st">'r2_global'</span>], color<span class="op">=</span><span class="st">'#2C5F8A'</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="st">'Global FF5'</span>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(r2_df[<span class="st">'date'</span>], r2_df[<span class="st">'r2_local'</span>], color<span class="op">=</span><span class="st">'#C0392B'</span>,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="st">'Local FF5'</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'R²'</span>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Panel A: Global vs Local Factor R²'</span>)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(r2_df[<span class="st">'date'</span>], r2_df[<span class="st">'ratio'</span>], color<span class="op">=</span><span class="st">'#27AE60'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axhline(y<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'gray'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'Full integration (ratio = 1)'</span>)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Global R² / Local R²'</span>)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Panel B: Integration Ratio'</span>)</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend()</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylim([<span class="dv">0</span>, <span class="fl">1.5</span>])</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-global-local-r2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;38.3
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-market-integration-pricing-error" class="level2" data-number="38.5">
<h2 data-number="38.5" class="anchored" data-anchor-id="sec-market-integration-pricing-error"><span class="header-section-number">38.5</span> Pricing-Error-Based Integration</h2>
<section id="the-bekaert-harvey-approach" class="level3" data-number="38.5.1">
<h3 data-number="38.5.1" class="anchored" data-anchor-id="the-bekaert-harvey-approach"><span class="header-section-number">38.5.1</span> The Bekaert-Harvey Approach</h3>
<p><span class="citation" data-cites="bekaert1995time">Bekaert and Harvey (<a href="references.html#ref-bekaert1995time" role="doc-biblioref">1995</a>)</span> measure integration as the ability of a global CAPM to price local assets. Under integration, the local market alpha (intercept) in a regression on the global market should be zero, and the global risk premium should explain the local expected return. Under segmentation, the local alpha captures the segmentation premium.</p>
<div id="bh-integration" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bekaert_harvey_integration(local_return, global_return,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                                 rolling_window<span class="op">=</span><span class="dv">36</span>):</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Rolling alpha from regressing local on global market.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Under integration, alpha -&gt; 0.</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    common <span class="op">=</span> local_return.dropna().index.intersection(global_return.dropna().index)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(rolling_window, <span class="bu">len</span>(common)):</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        window <span class="op">=</span> common[t <span class="op">-</span> rolling_window:t]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> local_return[window]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> sm.add_constant(global_return[window])</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">'date'</span>: common[t],</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">'alpha'</span>: model.params[<span class="st">'const'</span>],</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">'alpha_t'</span>: model.tvalues[<span class="st">'const'</span>],</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">'beta_global'</span>: model.params.iloc[<span class="dv">1</span>],</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'r_squared'</span>: model.rsquared</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(results)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>bh_result <span class="op">=</span> bekaert_harvey_integration(</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    indices_aligned[<span class="st">'VIETNAM'</span>],</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    indices_aligned[<span class="st">'MSCI_WORLD'</span>],</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    rolling_window<span class="op">=</span><span class="dv">36</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co"># The absolute alpha is the segmentation premium</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>bh_result[<span class="st">'abs_alpha_ann'</span>] <span class="op">=</span> bh_result[<span class="st">'alpha'</span>].<span class="bu">abs</span>() <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Bekaert-Harvey Integration Diagnostic:"</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean |α| (ann.): </span><span class="sc">{</span>bh_result[<span class="st">'abs_alpha_ann'</span>]<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean β_world: </span><span class="sc">{</span>bh_result[<span class="st">'beta_global'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean R²: </span><span class="sc">{</span>bh_result[<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="composite-integration-index" class="level3" data-number="38.5.2">
<h3 data-number="38.5.2" class="anchored" data-anchor-id="composite-integration-index"><span class="header-section-number">38.5.2</span> Composite Integration Index</h3>
<p>We combine all measures into a single composite index of Vietnamese market integration:</p>
<div id="composite-index" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize each measure to [0, 1] using historical percentile ranks</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>measures <span class="op">=</span> pd.DataFrame(index<span class="op">=</span>bh_result[<span class="st">'date'</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. DCC correlation (higher = more integrated)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>dcc_aligned <span class="op">=</span> dcc_result[<span class="st">'dcc_corr'</span>].reindex(measures.index).interpolate()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'dcc_corr'</span>] <span class="op">=</span> dcc_aligned</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. PR R² (higher = more integrated)</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>pr_aligned <span class="op">=</span> pr_result.set_index(<span class="st">'date'</span>)[<span class="st">'r_squared'</span>].reindex(measures.index).interpolate()</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'pr_r2'</span>] <span class="op">=</span> pr_aligned</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Global/Local R² ratio (higher = more integrated)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>r2_aligned <span class="op">=</span> r2_df.set_index(<span class="st">'date'</span>)[<span class="st">'ratio'</span>].reindex(measures.index).interpolate()</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'gl_ratio'</span>] <span class="op">=</span> r2_aligned</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. |Alpha| from global CAPM (lower = more integrated)</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Invert: 1 - percentile rank of |alpha|</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'inv_alpha'</span>] <span class="op">=</span> bh_result.set_index(<span class="st">'date'</span>)[<span class="st">'abs_alpha_ann'</span>]</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'inv_alpha'</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> measures[<span class="st">'inv_alpha'</span>].rank(pct<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Global beta (higher = more integrated, up to a point)</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'global_beta'</span>] <span class="op">=</span> bh_result.set_index(<span class="st">'date'</span>)[<span class="st">'beta_global'</span>]</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize to percentile ranks</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">'dcc_corr'</span>, <span class="st">'pr_r2'</span>, <span class="st">'gl_ratio'</span>, <span class="st">'inv_alpha'</span>, <span class="st">'global_beta'</span>]:</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    measures[<span class="ss">f'</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">_rank'</span>] <span class="op">=</span> measures[col].rank(pct<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Composite = equal-weighted average of ranks</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>rank_cols <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> measures.columns <span class="cf">if</span> c.endswith(<span class="st">'_rank'</span>)]</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'composite'</span>] <span class="op">=</span> measures[rank_cols].mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Smooth with 6-month moving average</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'composite_smooth'</span>] <span class="op">=</span> measures[<span class="st">'composite'</span>].rolling(<span class="dv">6</span>).mean()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fig-composite" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="15">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-composite-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>ax.fill_between(measures.index, measures[<span class="st">'composite_smooth'</span>],</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                 alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'#2C5F8A'</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ax.plot(measures.index, measures[<span class="st">'composite_smooth'</span>],</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'#2C5F8A'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add event markers</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, event <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> event[<span class="st">'date'</span>] <span class="op">&gt;=</span> measures.index.<span class="bu">min</span>():</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> event_colors.get(event[<span class="st">'category'</span>], <span class="st">'gray'</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        ax.axvline(x<span class="op">=</span>event[<span class="st">'date'</span>], color<span class="op">=</span>color,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                   linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Integration Index (0 = segmented, 1 = integrated)'</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Vietnam Equity Market Integration: Composite Index'</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend for event categories</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Patch</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>legend_patches <span class="op">=</span> [Patch(facecolor<span class="op">=</span>c, label<span class="op">=</span>cat)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">for</span> cat, c <span class="kw">in</span> event_colors.items() <span class="cf">if</span> cat <span class="kw">in</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>                   liberalization_events[<span class="st">'category'</span>].values]</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>ax.legend(handles<span class="op">=</span>legend_patches, fontsize<span class="op">=</span><span class="dv">7</span>, loc<span class="op">=</span><span class="st">'lower right'</span>, ncol<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-composite-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;38.4
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-market-integration-breaks" class="level2" data-number="38.6">
<h2 data-number="38.6" class="anchored" data-anchor-id="sec-market-integration-breaks"><span class="header-section-number">38.6</span> Structural Break Detection</h2>
<section id="bai-perron-tests-for-integration-regime-shifts" class="level3" data-number="38.6.1">
<h3 data-number="38.6.1" class="anchored" data-anchor-id="bai-perron-tests-for-integration-regime-shifts"><span class="header-section-number">38.6.1</span> Bai-Perron Tests for Integration Regime Shifts</h3>
<p>We test whether Vietnam’s integration trajectory contains discrete structural breaks (i.e., sudden shifts in the integration level) rather than a smooth trend:</p>
<div id="structural-breaks" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_breaks_cusum(series, significance<span class="op">=</span><span class="fl">0.05</span>):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">    CUSUM-based structural break detection.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> series.dropna().values</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recursive residuals from rolling mean</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    cumsum <span class="op">=</span> np.cumsum(y <span class="op">-</span> y.mean()) <span class="op">/</span> (y.std() <span class="op">*</span> np.sqrt(T))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Brown-Durbin-Evans critical values (approximate)</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># At 5%: ±0.948</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    critical <span class="op">=</span> <span class="fl">0.948</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    breaks <span class="op">=</span> []</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, T <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(cumsum[t]) <span class="op">&gt;</span> critical:</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>            breaks.append(t)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cumsum, breaks</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to composite index</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>composite_clean <span class="op">=</span> measures[<span class="st">'composite_smooth'</span>].dropna()</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>cusum, break_points <span class="op">=</span> detect_breaks_cusum(composite_clean)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: Chow test at key liberalization dates</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chow_test(y, breakpoint_idx):</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Simple Chow test for structural break."""</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    y1 <span class="op">=</span> y[:breakpoint_idx]</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    y2 <span class="op">=</span> y[breakpoint_idx:]</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Full sample regression (on constant)</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    rss_full <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y.mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split samples</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    rss1 <span class="op">=</span> np.<span class="bu">sum</span>((y1 <span class="op">-</span> y1.mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    rss2 <span class="op">=</span> np.<span class="bu">sum</span>((y2 <span class="op">-</span> y2.mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    rss_split <span class="op">=</span> rss1 <span class="op">+</span> rss2</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> <span class="dv">1</span>  <span class="co"># Number of parameters</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    f_stat <span class="op">=</span> ((rss_full <span class="op">-</span> rss_split) <span class="op">/</span> k) <span class="op">/</span> (rss_split <span class="op">/</span> (T <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> k))</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    p_val <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> stats.f.cdf(f_stat, k, T <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> k)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f_stat, p_val</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Chow Tests for Structural Breaks at Key Dates:"</span>)</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Event'</span><span class="sc">:&lt;30}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Date'</span><span class="sc">:&gt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'F-stat'</span><span class="sc">:&gt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'p-value'</span><span class="sc">:&gt;10}</span><span class="ss">"</span>)</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">62</span>)</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, event <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> event[<span class="st">'date'</span>] <span class="op">&lt;</span> composite_clean.index.<span class="bu">min</span>():</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find nearest date</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    nearest <span class="op">=</span> composite_clean.index.searchsorted(event[<span class="st">'date'</span>])</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> nearest <span class="op">&lt;</span> <span class="dv">12</span> <span class="kw">or</span> nearest <span class="op">&gt;</span> <span class="bu">len</span>(composite_clean) <span class="op">-</span> <span class="dv">12</span>:</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>    f_stat, p_val <span class="op">=</span> chow_test(composite_clean.values, nearest)</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>    sig <span class="op">=</span> <span class="st">'***'</span> <span class="cf">if</span> p_val <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="st">'**'</span> <span class="cf">if</span> p_val <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'*'</span> <span class="cf">if</span> p_val <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>event[<span class="st">'event'</span>]<span class="sc">:&lt;30}</span><span class="ss"> </span><span class="sc">{</span>event[<span class="st">'date'</span>]<span class="sc">.</span>strftime(<span class="st">'%Y-%m'</span>)<span class="sc">:&gt;12}</span><span class="ss"> "</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>f_stat<span class="sc">:&gt;10.2f}</span><span class="ss"> </span><span class="sc">{</span>p_val<span class="sc">:&gt;10.4f}</span><span class="ss"> </span><span class="sc">{</span>sig<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="sec-market-integration-premium" class="level2" data-number="38.7">
<h2 data-number="38.7" class="anchored" data-anchor-id="sec-market-integration-premium"><span class="header-section-number">38.7</span> The Segmentation Premium for Vietnam</h2>
<section id="cross-sectional-evidence" class="level3" data-number="38.7.1">
<h3 data-number="38.7.1" class="anchored" data-anchor-id="cross-sectional-evidence"><span class="header-section-number">38.7.1</span> Cross-Sectional Evidence</h3>
<p>Under partial segmentation, stocks with higher foreign ownership should have lower expected returns (because foreign investors can diversify away local risk). This yields a testable prediction: foreign ownership should be negatively associated with expected returns, controlling for global risk exposure.</p>
<div id="segmentation-premium" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get monthly stock returns with foreign ownership</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>stock_data <span class="op">=</span> client.get_monthly_returns(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    exchanges<span class="op">=</span>[<span class="st">'HOSE'</span>, <span class="st">'HNX'</span>],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2008-01-01'</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[<span class="st">'ticker'</span>, <span class="st">'month_end'</span>, <span class="st">'monthly_return'</span>, <span class="st">'market_cap'</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">'foreign_ownership_pct'</span>]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>stock_data[<span class="st">'month_end'</span>] <span class="op">=</span> pd.to_datetime(stock_data[<span class="st">'month_end'</span>])</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fama-MacBeth: regress returns on lagged foreign ownership</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>stock_data <span class="op">=</span> stock_data.sort_values([<span class="st">'ticker'</span>, <span class="st">'month_end'</span>])</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>stock_data[<span class="st">'fol_lag'</span>] <span class="op">=</span> (</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    stock_data.groupby(<span class="st">'ticker'</span>)[<span class="st">'foreign_ownership_pct'</span>].shift(<span class="dv">1</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>stock_data[<span class="st">'log_mcap'</span>] <span class="op">=</span> np.log(stock_data[<span class="st">'market_cap'</span>].clip(lower<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly cross-sectional regressions</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>gamma_fol <span class="op">=</span> []</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> month, group <span class="kw">in</span> stock_data.dropna(subset<span class="op">=</span>[<span class="st">'fol_lag'</span>, <span class="st">'monthly_return'</span>]).groupby(<span class="st">'month_end'</span>):</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(group) <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> group[<span class="st">'monthly_return'</span>].values</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(group[[<span class="st">'fol_lag'</span>, <span class="st">'log_mcap'</span>]].values)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>        gamma_fol.append({</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">'month'</span>: month,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">'gamma_fol'</span>: model.params[<span class="dv">1</span>],</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'gamma_size'</span>: model.params[<span class="dv">2</span>],</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'n'</span>: <span class="bu">len</span>(group)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>gamma_fol_df <span class="op">=</span> pd.DataFrame(gamma_fol)</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>mean_gamma <span class="op">=</span> gamma_fol_df[<span class="st">'gamma_fol'</span>].mean()</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>se_gamma <span class="op">=</span> gamma_fol_df[<span class="st">'gamma_fol'</span>].std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(gamma_fol_df))</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>t_gamma <span class="op">=</span> mean_gamma <span class="op">/</span> se_gamma</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Fama-MacBeth: Foreign Ownership and Expected Returns"</span>)</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  γ_FOL (monthly):  </span><span class="sc">{</span>mean_gamma<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  γ_FOL (ann.):     </span><span class="sc">{</span>mean_gamma <span class="op">*</span> <span class="dv">12</span><span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic:      </span><span class="sc">{</span>t_gamma<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Interpretation:   A 10pp increase in foreign ownership is "</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"associated with a </span><span class="sc">{</span>mean_gamma <span class="op">*</span> <span class="dv">12</span> <span class="op">*</span> <span class="dv">10</span><span class="sc">:.2f}</span><span class="ss">% change in "</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"annual expected returns"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fig-segmentation-premium" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="18">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-segmentation-premium-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Quintile returns by foreign ownership</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>fol_quintiles <span class="op">=</span> stock_data.dropna(subset<span class="op">=</span>[<span class="st">'fol_lag'</span>, <span class="st">'monthly_return'</span>]).copy()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>fol_quintiles[<span class="st">'fol_q'</span>] <span class="op">=</span> (</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    fol_quintiles.groupby(<span class="st">'month_end'</span>)[<span class="st">'fol_lag'</span>]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    .transform(<span class="kw">lambda</span> x: pd.qcut(x.rank(method<span class="op">=</span><span class="st">'first'</span>), <span class="dv">5</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                                    labels<span class="op">=</span>[<span class="st">'Q1</span><span class="ch">\n</span><span class="st">(Low FOL)'</span>, <span class="st">'Q2'</span>, <span class="st">'Q3'</span>, <span class="st">'Q4'</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">'Q5</span><span class="ch">\n</span><span class="st">(High FOL)'</span>]))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>q_returns <span class="op">=</span> (</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    fol_quintiles.groupby(<span class="st">'fol_q'</span>)[<span class="st">'monthly_return'</span>]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    .mean() <span class="op">*</span> <span class="dv">12</span> <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>colors_q <span class="op">=</span> plt.cm.RdYlGn_r(np.linspace(<span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="dv">5</span>))</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].bar(<span class="bu">range</span>(<span class="dv">5</span>), q_returns.values, color<span class="op">=</span>colors_q,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(<span class="bu">range</span>(<span class="dv">5</span>))</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(q_returns.index)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Ann. Return (%)'</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Panel A: Returns by Foreign Ownership Quintile'</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Rolling FM coefficient</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>gamma_fol_df[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(gamma_fol_df[<span class="st">'month'</span>])</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>rolling_gamma <span class="op">=</span> gamma_fol_df.set_index(<span class="st">'date'</span>)[<span class="st">'gamma_fol'</span>].rolling(<span class="dv">24</span>).mean() <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(rolling_gamma.index, rolling_gamma.values,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>             color<span class="op">=</span><span class="st">'#2C5F8A'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'γ_FOL (annualized)'</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Panel B: Rolling Segmentation Premium'</span>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].fill_between(rolling_gamma.index, rolling_gamma.values, <span class="dv">0</span>,</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>                      where<span class="op">=</span>rolling_gamma.values <span class="op">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>                      alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'#27AE60'</span>, label<span class="op">=</span><span class="st">'Negative (integration)'</span>)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].fill_between(rolling_gamma.index, rolling_gamma.values, <span class="dv">0</span>,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>                      where<span class="op">=</span>rolling_gamma.values <span class="op">&gt;=</span> <span class="dv">0</span>,</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>                      alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'#C0392B'</span>, label<span class="op">=</span><span class="st">'Positive (segmentation)'</span>)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-segmentation-premium-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;38.5
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-market-integration-fx" class="level2" data-number="38.8">
<h2 data-number="38.8" class="anchored" data-anchor-id="sec-market-integration-fx"><span class="header-section-number">38.8</span> Exchange Rate Risk and Integration</h2>
<section id="is-currency-risk-priced" class="level3" data-number="38.8.1">
<h3 data-number="38.8.1" class="anchored" data-anchor-id="is-currency-risk-priced"><span class="header-section-number">38.8.1</span> Is Currency Risk Priced?</h3>
<p>In a partially integrated market, exchange rate risk may carry a separate premium. <span class="citation" data-cites="jorion1991pricing">Jorion (<a href="references.html#ref-jorion1991pricing" role="doc-biblioref">1991</a>)</span> and <span class="citation" data-cites="dumas1995world">Dumas and Solnik (<a href="references.html#ref-dumas1995world" role="doc-biblioref">1995</a>)</span> test whether currency exposure is priced beyond global equity risk. For Vietnam, the VND/USD exchange rate is managed (a crawling peg with occasional step devaluations), creating a specific risk that is neither fully diversifiable nor fully priced by global equity factors.</p>
<div id="fx-risk" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VND depreciation</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fx_return <span class="op">=</span> fx[<span class="st">'rate'</span>].pct_change()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>fx_return.name <span class="op">=</span> <span class="st">'fx_return'</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with stock data</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>stock_fx <span class="op">=</span> stock_data.merge(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    fx_return.to_frame().reset_index().rename(columns<span class="op">=</span>{<span class="st">'date'</span>: <span class="st">'month_end'</span>}),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">'month_end'</span>, how<span class="op">=</span><span class="st">'left'</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate FX beta for each stock (rolling 60-month)</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Then test in Fama-MacBeth whether FX beta is priced</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>fx_betas <span class="op">=</span> {}</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ticker, group <span class="kw">in</span> stock_fx.groupby(<span class="st">'ticker'</span>):</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(group) <span class="op">&lt;</span> <span class="dv">60</span>:</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> group.sort_values(<span class="st">'month_end'</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> group[<span class="st">'monthly_return'</span>]</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> group[[<span class="st">'fx_return'</span>]].dropna()</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    common <span class="op">=</span> y.dropna().index.intersection(x.index)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(common) <span class="op">&lt;</span> <span class="dv">48</span>:</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> sm.OLS(y[common], sm.add_constant(x.loc[common])).fit()</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    fx_betas[ticker] <span class="op">=</span> model.params.get(<span class="st">'fx_return'</span>, np.nan)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>fx_beta_series <span class="op">=</span> pd.Series(fx_betas, name<span class="op">=</span><span class="st">'fx_beta'</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-sectional test: do stocks with higher FX beta earn different returns?</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>stock_fx_beta <span class="op">=</span> stock_fx.merge(</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    fx_beta_series.to_frame().reset_index().rename(columns<span class="op">=</span>{<span class="st">'index'</span>: <span class="st">'ticker'</span>}),</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">'ticker'</span>, how<span class="op">=</span><span class="st">'left'</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Quintile sort on FX beta</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>fx_q <span class="op">=</span> stock_fx_beta.dropna(subset<span class="op">=</span>[<span class="st">'fx_beta'</span>, <span class="st">'monthly_return'</span>])</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>fx_q[<span class="st">'fx_quintile'</span>] <span class="op">=</span> pd.qcut(fx_q[<span class="st">'fx_beta'</span>].rank(method<span class="op">=</span><span class="st">'first'</span>),</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">5</span>, labels<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>fx_premium <span class="op">=</span> fx_q.groupby(<span class="st">'fx_quintile'</span>)[<span class="st">'monthly_return'</span>].mean() <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Returns by FX Beta Quintile:"</span>)</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q, ret <span class="kw">in</span> fx_premium.items():</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Q</span><span class="sc">{</span>q<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>ret<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% ann."</span>)</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Q5-Q1: </span><span class="sc">{</span>(fx_premium.iloc[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> fx_premium.iloc[<span class="dv">0</span>])<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% ann."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="sec-market-integration-contagion" class="level2" data-number="38.9">
<h2 data-number="38.9" class="anchored" data-anchor-id="sec-market-integration-contagion"><span class="header-section-number">38.9</span> Contagion vs.&nbsp;Interdependence</h2>
<p>During global crises, correlations between Vietnam and world markets spike. The question is whether this represents <em>contagion</em> (a structural change in the transmission mechanism) or simply <em>interdependence</em> (normal co-movement amplified by higher volatility). <span class="citation" data-cites="longin2001extreme">Longin and Solnik (<a href="references.html#ref-longin2001extreme" role="doc-biblioref">2001</a>)</span> show that correlation increases mechanically with volatility even without any change in the underlying dependence structure.</p>
<div id="contagion-test" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forbes_rigobon_test(r_local, r_global, crisis_dates, tranquil_dates):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Forbes-Rigobon (2002) contagion test.</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Adjusts for heteroskedasticity-induced bias in correlation.</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">    H0: No contagion (correlation increase is explained by volatility)</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">    H1: Contagion (correlation increase exceeds what volatility explains)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    r_l_crisis <span class="op">=</span> r_local[crisis_dates]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    r_g_crisis <span class="op">=</span> r_global[crisis_dates]</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    r_l_tranquil <span class="op">=</span> r_local[tranquil_dates]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    r_g_tranquil <span class="op">=</span> r_global[tranquil_dates]</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Unadjusted correlations</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    rho_crisis <span class="op">=</span> r_l_crisis.corr(r_g_crisis)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    rho_tranquil <span class="op">=</span> r_l_tranquil.corr(r_g_tranquil)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Volatility ratio</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> r_g_crisis.var() <span class="op">/</span> r_g_tranquil.var() <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjusted correlation</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    rho_adj <span class="op">=</span> rho_crisis <span class="op">/</span> np.sqrt(<span class="dv">1</span> <span class="op">+</span> delta <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> rho_crisis <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fisher z-test on adjusted vs tranquil</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    z_adj <span class="op">=</span> np.arctanh(rho_adj)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    z_tranquil <span class="op">=</span> np.arctanh(rho_tranquil)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    se <span class="op">=</span> np.sqrt(<span class="dv">1</span> <span class="op">/</span> (<span class="bu">len</span>(r_l_crisis) <span class="op">-</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">1</span> <span class="op">/</span> (<span class="bu">len</span>(r_l_tranquil) <span class="op">-</span> <span class="dv">3</span>))</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    z_stat <span class="op">=</span> (z_adj <span class="op">-</span> z_tranquil) <span class="op">/</span> se</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    p_val <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.norm.cdf(<span class="bu">abs</span>(z_stat)))</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'rho_crisis_raw'</span>: rho_crisis,</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">'rho_crisis_adj'</span>: rho_adj,</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">'rho_tranquil'</span>: rho_tranquil,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">'delta'</span>: delta,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">'z_stat'</span>: z_stat,</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">'p_value'</span>: p_val,</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'contagion'</span>: p_val <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Define crisis and tranquil periods</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>crises <span class="op">=</span> {</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GFC (2008-09)'</span>: (pd.Timestamp(<span class="st">'2008-09-01'</span>), pd.Timestamp(<span class="st">'2009-03-31'</span>)),</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">'European Debt (2011-12)'</span>: (pd.Timestamp(<span class="st">'2011-06-01'</span>), pd.Timestamp(<span class="st">'2012-06-30'</span>)),</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">'COVID (2020)'</span>: (pd.Timestamp(<span class="st">'2020-02-01'</span>), pd.Timestamp(<span class="st">'2020-06-30'</span>)),</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Fed Tightening (2022)'</span>: (pd.Timestamp(<span class="st">'2022-01-01'</span>), pd.Timestamp(<span class="st">'2022-12-31'</span>)),</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Tranquil = 24 months before each crisis</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>vn_aligned <span class="op">=</span> indices_aligned[<span class="st">'VIETNAM'</span>]</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>world_aligned <span class="op">=</span> indices_aligned[<span class="st">'MSCI_WORLD'</span>]</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Contagion Tests (Forbes-Rigobon):"</span>)</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Crisis'</span><span class="sc">:&lt;28}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'ρ(raw)'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'ρ(adj)'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'ρ(calm)'</span><span class="sc">:&gt;8}</span><span class="ss"> "</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"</span><span class="sc">{</span><span class="st">'z-stat'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'p-val'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Result'</span><span class="sc">:&gt;12}</span><span class="ss">"</span>)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, (start, end) <span class="kw">in</span> crises.items():</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>    crisis_mask <span class="op">=</span> (vn_aligned.index <span class="op">&gt;=</span> start) <span class="op">&amp;</span> (vn_aligned.index <span class="op">&lt;=</span> end)</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>    tranquil_start <span class="op">=</span> start <span class="op">-</span> pd.DateOffset(months<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>    tranquil_mask <span class="op">=</span> ((vn_aligned.index <span class="op">&gt;=</span> tranquil_start) <span class="op">&amp;</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>                      (vn_aligned.index <span class="op">&lt;</span> start))</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>    crisis_dates <span class="op">=</span> vn_aligned.index[crisis_mask]</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>    tranquil_dates <span class="op">=</span> vn_aligned.index[tranquil_mask]</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(crisis_dates) <span class="op">&lt;</span> <span class="dv">3</span> <span class="kw">or</span> <span class="bu">len</span>(tranquil_dates) <span class="op">&lt;</span> <span class="dv">12</span>:</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> forbes_rigobon_test(vn_aligned, world_aligned,</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>                                  crisis_dates, tranquil_dates)</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>    verdict <span class="op">=</span> <span class="st">'CONTAGION'</span> <span class="cf">if</span> result[<span class="st">'contagion'</span>] <span class="cf">else</span> <span class="st">'Interdependence'</span></span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">:&lt;28}</span><span class="ss"> </span><span class="sc">{</span>result[<span class="st">'rho_crisis_raw'</span>]<span class="sc">:&gt;8.3f}</span><span class="ss"> "</span></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>result[<span class="st">'rho_crisis_adj'</span>]<span class="sc">:&gt;8.3f}</span><span class="ss"> </span><span class="sc">{</span>result[<span class="st">'rho_tranquil'</span>]<span class="sc">:&gt;8.3f}</span><span class="ss"> "</span></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>result[<span class="st">'z_stat'</span>]<span class="sc">:&gt;8.2f}</span><span class="ss"> </span><span class="sc">{</span>result[<span class="st">'p_value'</span>]<span class="sc">:&gt;8.3f}</span><span class="ss"> "</span></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>verdict<span class="sc">:&gt;12}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="sec-market-integration-asean" class="level2" data-number="38.10">
<h2 data-number="38.10" class="anchored" data-anchor-id="sec-market-integration-asean"><span class="header-section-number">38.10</span> ASEAN Peer Comparison</h2>
<p>Vietnam’s integration trajectory is best understood in the context of its ASEAN peers, which share similar starting conditions but have followed different liberalization paths:</p>
<div id="fig-asean-comparison" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="21">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-asean-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>asean_markets <span class="op">=</span> {</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VIETNAM'</span>: <span class="st">'#C0392B'</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_THAILAND'</span>: <span class="st">'#2C5F8A'</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_INDONESIA'</span>: <span class="st">'#27AE60'</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_PHILIPPINES'</span>: <span class="st">'#E67E22'</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_MALAYSIA'</span>: <span class="st">'#8E44AD'</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> market, color <span class="kw">in</span> asean_markets.items():</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> market <span class="kw">not</span> <span class="kw">in</span> global_indices.columns:</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    corr <span class="op">=</span> (</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        global_indices[[<span class="st">'MSCI_WORLD'</span>, market]]</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        .rolling(<span class="dv">36</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        .corr()</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        .unstack()[<span class="st">'MSCI_WORLD'</span>][market]</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> market.replace(<span class="st">'MSCI_'</span>, <span class="st">''</span>).replace(<span class="st">'_'</span>, <span class="st">' '</span>).title()</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> market <span class="op">==</span> <span class="st">'VIETNAM'</span>:</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        ax.plot(corr.index, corr.values, color<span class="op">=</span>color,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">2.5</span>, label<span class="op">=</span>label, zorder<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>        ax.plot(corr.index, corr.values, color<span class="op">=</span>color,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span>label, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Correlation with MSCI World'</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'ASEAN Market Integration: Rolling 36-Month Correlation'</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.9</span>])</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-asean-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;38.6
</figcaption>
</figure>
</div>
</section>
<section id="sec-market-integration-implications" class="level2" data-number="38.11">
<h2 data-number="38.11" class="anchored" data-anchor-id="sec-market-integration-implications"><span class="header-section-number">38.11</span> Practical Implications</h2>
<p>The degree of integration determines which asset pricing model is appropriate for Vietnamese equities. The evidence in this chapter supports several practical conclusions:</p>
<p><strong>Vietnam is partially integrated and trending toward integration.</strong> The composite index shows a clear upward trajectory, with the post-2015 period representing the highest sustained integration in the market’s history. However, Vietnam remains less integrated than Thailand or Malaysia, and far from fully integrated with global markets.</p>
<p><strong>Local factors dominate global factors for pricing Vietnamese stocks.</strong> The rolling <span class="math inline">\(R^2\)</span> comparison shows that local Vietnamese factors consistently explain more return variation than global factors. This means that researchers studying Vietnamese cross-sectional returns should use local factor models (Vietnamese FF5) rather than global factors. Global factors are useful primarily for international investors assessing co-movement risk.</p>
<p><strong>The segmentation premium is shrinking but not zero.</strong> The Fama-MacBeth evidence shows that stocks with higher foreign ownership earn lower returns, consistent with partial segmentation. The magnitude has declined over time as foreign ownership limits have been relaxed, but a residual premium persists—likely driven by remaining ownership caps in banking and strategic sectors.</p>
<p><strong>Crisis-period co-movement is mostly interdependence, not contagion.</strong> The Forbes-Rigobon adjusted correlations show that the spike in Vietnam-World correlation during crises is largely explained by increased global volatility, not a structural change in the transmission mechanism. This is reassuring for diversification: Vietnam continues to offer meaningful diversification benefits even during global stress.</p>
<p><strong>The FTSE/MSCI upgrade path matters.</strong> Vietnam’s potential upgrade from frontier to emerging market status would trigger mandatory index rebalancing by passive funds, increasing foreign flows and likely accelerating integration. Researchers and investors should monitor upgrade criteria and their implications for the cost of capital.</p>
</section>
<section id="sec-market-integration-summary" class="level2" data-number="38.12">
<h2 data-number="38.12" class="anchored" data-anchor-id="sec-market-integration-summary"><span class="header-section-number">38.12</span> Summary</h2>
<div id="tbl-market-integration-summary" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-market-integration-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;38.1: Summary of integration measures for the Vietnamese equity market.
</figcaption>
<div aria-describedby="tbl-market-integration-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Measure</th>
<th>What It Captures</th>
<th>Vietnam Range</th>
<th>Current Level</th>
<th>Trend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DCC correlation (World)</td>
<td>Co-movement</td>
<td>0.0–0.5</td>
<td>~0.35–0.45</td>
<td>Rising</td>
</tr>
<tr class="even">
<td>PR R² (global PCs)</td>
<td>Global factor exposure</td>
<td>0.05–0.50</td>
<td>~0.30–0.40</td>
<td>Rising</td>
</tr>
<tr class="odd">
<td>Global/Local R² ratio</td>
<td>Relative pricing power</td>
<td>0.1–0.8</td>
<td>~0.5–0.6</td>
<td>Rising</td>
</tr>
<tr class="even">
<td>Global CAPM α</td>
<td>Pricing error</td>
<td>0–15% ann.</td>
<td>~3–5% ann.</td>
<td>Falling</td>
</tr>
<tr class="odd">
<td>FOL premium (γ)</td>
<td>Segmentation cost</td>
<td>-5% to +2%</td>
<td>~-1% to 0%</td>
<td>Shrinking</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<!-- ## Exercises {#sec-market-integration-exercises}

1.  **Regime-switching model.** Estimate the @bekaert1995time regime-switching model for Vietnam with two states (integrated, segmented). Use Hamilton filtering to extract the smoothed probability of being in the integrated state at each point in time. Does the filtered probability align with the composite index from this chapter?

2.  **Spanning test.** Can a U.S. investor replicate the Vietnamese market return using a portfolio of U.S.-listed ETFs (e.g., VNM ETF, EEM, FXI, EWY)? Regress the VN-Index on these ETFs and examine the alpha. A zero alpha means the Vietnamese market is "spanned" and offers no diversification benefit beyond what is available through U.S.-listed instruments [@errunza1985international].

3.  **Capital flow and integration.** Obtain monthly net foreign capital flow data for Vietnam (from the SSC or central bank). Test whether months of high foreign inflows are followed by higher Vietnam-World correlation. This tests whether integration is driven by capital flows or by other channels (trade, information).

4.  **Sector-level integration.** Estimate DCC correlations separately for Vietnamese banking, real estate, consumer goods, and technology sectors against their global sector counterparts. Which sectors are most integrated? Sectors with heavy state ownership may be more segmented.

5.  **Integration and the cost of capital.** Using the @bekaert2005does framework, estimate the reduction in Vietnam's implied cost of equity capital associated with the measured increase in integration since 2000. Use the local CAPM vs. global CAPM implied risk premia to quantify the "integration dividend."

6.  **Chinn-Ito index.** Download the @chinn2006what capital account openness index (KAOPEN) for Vietnam and its ASEAN peers. Plot KAOPEN against the market-based integration measures from this chapter. Is de jure openness (legal capital account liberalization) a good predictor of de facto integration (market co-movement)?

7.  **Frequency-domain integration.** Decompose Vietnam-World co-movement by frequency band (weekly, monthly, quarterly, annual) using wavelet coherence. Integration may differ at different frequencies: high-frequency co-movement reflects arbitrage and information transmission, while low-frequency co-movement reflects shared business cycles.

8.  **COVID stress test.** The March 2020 COVID crash was the most severe global synchronized selloff in a decade. Using daily data, estimate hour-by-hour or day-by-day correlation between Vietnam and global markets during the crisis. Did Vietnam's price limits (Chapter on price limits) prevent full contagion transmission, or merely delay it? -->


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-ang2002asymmetric" class="csl-entry" role="listitem">
Ang, Andrew, and Joseph Chen. 2002. <span>“Asymmetric Correlations of Equity Portfolios.”</span> <em>Journal of Financial Economics</em> 63 (3): 443–94.
</div>
<div id="ref-bekaert1995time" class="csl-entry" role="listitem">
Bekaert, Geert, and Campbell R Harvey. 1995. <span>“Time-Varying World Market Integration.”</span> <em>The Journal of Finance</em> 50 (2): 403–44.
</div>
<div id="ref-bekaert2002research" class="csl-entry" role="listitem">
———. 2002. <span>“Research in Emerging Markets Finance: Looking to the Future.”</span> <em>Emerging Markets Review</em> 3 (4): 429–48.
</div>
<div id="ref-bekaert2005does" class="csl-entry" role="listitem">
Bekaert, Geert, Campbell R Harvey, and Christian Lundblad. 2005. <span>“Does Financial Liberalization Spur Growth?”</span> <em>Journal of Financial Economics</em> 77 (1): 3–55.
</div>
<div id="ref-dumas1995world" class="csl-entry" role="listitem">
Dumas, Bernard, and Bruno Solnik. 1995. <span>“The World Price of Foreign Exchange Risk.”</span> <em>The Journal of Finance</em> 50 (2): 445–79.
</div>
<div id="ref-engle2002dynamic" class="csl-entry" role="listitem">
Engle, Robert. 2002. <span>“Dynamic Conditional Correlation: A Simple Class of Multivariate Generalized Autoregressive Conditional Heteroskedasticity Models.”</span> <em>Journal of Business &amp; Economic Statistics</em> 20 (3): 339–50.
</div>
<div id="ref-errunza1985international" class="csl-entry" role="listitem">
Errunza, Vihang, and Etienne Losq. 1985. <span>“International Asset Pricing Under Mild Segmentation: Theory and Test.”</span> <em>The Journal of Finance</em> 40 (1): 105–24.
</div>
<div id="ref-griffin2002fama" class="csl-entry" role="listitem">
Griffin, John M. 2002. <span>“Are the Fama and French Factors Global or Country Specific?”</span> <em>The Review of Financial Studies</em> 15 (3): 783–803.
</div>
<div id="ref-henry2000stock" class="csl-entry" role="listitem">
Henry, Peter Blair. 2000. <span>“Stock Market Liberalization, Economic Reform, and Emerging Market Equity Prices.”</span> <em>The Journal of Finance</em> 55 (2): 529–64.
</div>
<div id="ref-jorion1991pricing" class="csl-entry" role="listitem">
Jorion, Philippe. 1991. <span>“The Pricing of Exchange Rate Risk in the Stock Market.”</span> <em>Journal of Financial and Quantitative Analysis</em> 26 (3): 363–76.
</div>
<div id="ref-longin2001extreme" class="csl-entry" role="listitem">
Longin, Francois, and Bruno Solnik. 2001. <span>“Extreme Correlation of International Equity Markets.”</span> <em>The Journal of Finance</em> 56 (2): 649–76.
</div>
<div id="ref-pukthuanthong2009global" class="csl-entry" role="listitem">
Pukthuanthong, Kuntara, and Richard Roll. 2009. <span>“Global Market Integration: An Alternative Measure and Its Application.”</span> <em>Journal of Financial Economics</em> 94 (2): 214–32.
</div>
</div>
</section>

</main> <!-- /main -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const year = new Date().getFullYear();
  document.getElementById("copyright").textContent = "© " + year;
});
</script>
<script>
(function () {
  const GA_ID = "G-LMDLDJXXSC";   // your real GA4 ID
  const CONSENT_KEY = "cookie_consent_v1";

  function log(msg) {
    console.log("[GA Loader]", msg);
  }

  function loadGtag() {
    if (window.__gtag_loaded__) {
      log("GA already loaded, skipping");
      return;
    }

    log("Loading Google Analytics...");

    window.__gtag_loaded__ = true;

    const script = document.createElement("script");
    script.async = true;
    script.src = "https://www.googletagmanager.com/gtag/js?id=" + encodeURIComponent(GA_ID);

    script.onload = function () {
      log("gtag.js loaded");

      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      window.gtag = gtag;

      gtag("js", new Date());
      gtag("config", GA_ID, {
        anonymize_ip: true,
        transport_type: "beacon"
      });

      log("GA initialized successfully");
    };

    script.onerror = function () {
      log("FAILED to load gtag.js. Likely blocked by ad blocker or network.");
    };

    document.head.appendChild(script);
  }

  function checkConsentAndLoad() {
    const consent = localStorage.getItem(CONSENT_KEY);
    log("Stored consent value = " + consent);

    if (consent === "accepted") {
      loadGtag();
    } else {
      log("Analytics blocked due to missing or declined consent");
    }
  }

  // Run on page load
  checkConsentAndLoad();

  // Listen for cookie banner decisions
  window.addEventListener("cookie-consent-changed", function (e) {
    log("Consent event received: " + e.detail);
    if (e.detail === "accepted") {
      loadGtag();
    }
  });

})();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/github\.com\/mikenguyen13\/tidy_finance_vn");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./55_price_limits_and_volatility.html" class="pagination-link" aria-label="Price Limits and Volatility">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Price Limits and Volatility</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./57_exchange_rate.html" class="pagination-link" aria-label="Exchange Rate Dynamics">
        <span class="nav-page-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Exchange Rate Dynamics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Market Integration and Segmentation</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>In this chapter, we measure the degree to which the Vietnamese equity market is integrated with or segmented from global capital markets. We construct multiple integration metrics, including correlation-based, factor-based, and pricing-error-based, trace their evolution through Vietnam's liberalization timeline, and quantify the cost of segmentation for Vietnamese firms.</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>A market is *fully integrated* when its assets are priced by a global stochastic discount factor: risk premia reflect only exposures to global risk factors, and identical cash flow streams command the same expected return regardless of where the issuer is domiciled. A market is *fully segmented* when domestic risk factors alone determine prices, and the country's risk-return trade-off is independent of the rest of the world. Reality sits somewhere between these poles, and the location shifts over time.</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>Vietnam is a particularly interesting case. It opened its stock exchange in July 2000 with heavy restrictions on foreign participation. Foreign ownership limits (initially 20%, raised to 30% in 2003, 49% in 2015, and selectively removed for some firms) have been gradually relaxed. Vietnam joined the WTO in 2007. FTSE Russell upgraded Vietnam from "unclassified" to "secondary emerging" in its frontier index in 2018 and has been evaluating further upgrades. Each of these events has potentially shifted the degree of integration.</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>@bekaert1995time and @bekaert2002research establish the modern framework for measuring time-varying integration. @errunza1985international develop the "mild segmentation" model in which foreign investors face barriers but can partially replicate emerging market returns through global securities. @pukthuanthong2009global propose a factor-model-based measure that avoids the pitfalls of simple correlation analysis. This chapter implements all three approaches and applies them to Vietnam's integration trajectory.</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Integration in Theory {#sec-market-integration-theory}</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Integrated and Segmented Benchmarks</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>Under full integration, the expected excess return of Vietnamese stock $i$ is:</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>E<span class="co">[</span><span class="ot">R_{i,t} - R_{f,t}</span><span class="co">]</span> = \beta_{i,\text{world}} \cdot \lambda_{\text{world},t}</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>$$ {#eq-integrated}</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>where $\beta_{i,\text{world}}$ is the stock's loading on the global market factor and $\lambda_{\text{world},t}$ is the global risk premium. Only global systematic risk is priced; country-specific risk is diversifiable and commands no premium.</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>Under full segmentation:</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>E<span class="co">[</span><span class="ot">R_{i,t} - R_{f,t}</span><span class="co">]</span> = \beta_{i,\text{local}} \cdot \lambda_{\text{local},t}</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>$$ {#eq-segmented}</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>where $\beta_{i,\text{local}}$ is the stock's loading on the Vietnamese market and $\lambda_{\text{local},t}$ is the domestic risk premium. The domestic market is effectively a closed economy for pricing purposes.</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>@bekaert1995time model the transition between these states as a regime-switching process where the mixing weight $\omega_t \in <span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$ evolves over time:</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>E<span class="co">[</span><span class="ot">R_{i,t} - R_{f,t}</span><span class="co">]</span> = \omega_t \cdot \beta_{i,\text{world}} \lambda_{\text{world},t} + (1 - \omega_t) \cdot \beta_{i,\text{local}} \lambda_{\text{local},t}</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>$$ {#eq-partial}</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>The weight $\omega_t$ is the *degree of integration*: $\omega_t = 1$ is full integration, $\omega_t = 0$ is full segmentation.</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Segmentation Premium</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>When a market transitions from segmented to integrated, its cost of capital falls because the relevant risk for pricing narrows from total domestic risk to only the portion correlated with the global market <span class="co">[</span><span class="ot">@henry2000stock; @bekaert2005does</span><span class="co">]</span>. The *segmentation premium* is the excess expected return that investors in a segmented market require:</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>\text{Segmentation premium} = (1 - \omega_t) \cdot (\lambda_{\text{local}} - \beta_{\text{local,world}} \cdot \lambda_{\text{world}})</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>$$ {#eq-segmentation-premium}</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>This premium represents a deadweight cost: it raises the cost of capital for Vietnamese firms, reduces investment, and lowers welfare relative to the integrated benchmark.</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Construction {#sec-market-integration-data}</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Import libraries and configure environment"</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats, optimize</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch <span class="im">import</span> arch_model</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch.univariate <span class="im">import</span> ConstantMean, GARCH</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: (<span class="dv">12</span>, <span class="dv">6</span>),</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.dpi'</span>: <span class="dv">150</span>,</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: <span class="dv">11</span>,</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.spines.top'</span>: <span class="va">False</span>,</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.spines.right'</span>: <span class="va">False</span></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data-load</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Load Vietnamese and global market data"</span></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datacore <span class="im">import</span> DataCoreClient</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> DataCoreClient()</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Vietnamese market returns</span></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>vn_index <span class="op">=</span> client.get_index_returns(</span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">'VNINDEX'</span>,</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span>,</span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[<span class="st">'date'</span>, <span class="st">'return'</span>, <span class="st">'total_return_index'</span>]</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>vn_index[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(vn_index[<span class="st">'date'</span>])</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>vn_index <span class="op">=</span> vn_index.set_index(<span class="st">'date'</span>)</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Global and regional indices (USD-denominated for comparability)</span></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>global_indices <span class="op">=</span> client.get_global_indices(</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>    indices<span class="op">=</span>[</span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSCI_WORLD'</span>, <span class="st">'MSCI_EM'</span>, <span class="st">'MSCI_ASIA_PAC_EX_JP'</span>,</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSCI_FM'</span>,  <span class="co"># Frontier markets</span></span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>        <span class="st">'SP500'</span>, <span class="st">'STOXX600'</span>,</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSCI_CHINA'</span>, <span class="st">'MSCI_THAILAND'</span>, <span class="st">'MSCI_INDONESIA'</span>,</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSCI_PHILIPPINES'</span>, <span class="st">'MSCI_MALAYSIA'</span></span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span>,</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>    currency<span class="op">=</span><span class="st">'USD'</span></span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>global_indices[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(global_indices[<span class="st">'date'</span>])</span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a>global_indices <span class="op">=</span> global_indices.pivot(index<span class="op">=</span><span class="st">'date'</span>, columns<span class="op">=</span><span class="st">'index'</span>, values<span class="op">=</span><span class="st">'return'</span>)</span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Vietnam returns in USD for apples-to-apples comparison</span></span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>vn_usd <span class="op">=</span> client.get_index_returns(</span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">'VNINDEX'</span>,</span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span>,</span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a>    currency<span class="op">=</span><span class="st">'USD'</span></span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>vn_usd[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(vn_usd[<span class="st">'date'</span>])</span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a>global_indices[<span class="st">'VIETNAM'</span>] <span class="op">=</span> vn_usd.set_index(<span class="st">'date'</span>)[<span class="st">'return'</span>]</span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a><span class="co"># VND/USD exchange rate</span></span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a>fx <span class="op">=</span> client.get_exchange_rates(</span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>    pair<span class="op">=</span><span class="st">'USD_VND'</span>,</span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span></span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a>fx[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(fx[<span class="st">'date'</span>])</span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>fx <span class="op">=</span> fx.set_index(<span class="st">'date'</span>)</span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a><span class="co"># Global factor returns (Fama-French global)</span></span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a>global_factors <span class="op">=</span> client.get_global_factor_returns(</span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2000-07-01'</span>,</span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">'monthly'</span>,</span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a>    factors<span class="op">=</span>[<span class="st">'mkt_excess_world'</span>, <span class="st">'smb_world'</span>, <span class="st">'hml_world'</span>,</span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a>             <span class="st">'rmw_world'</span>, <span class="st">'cma_world'</span>, <span class="st">'wml_world'</span>]</span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a>global_factors[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(global_factors[<span class="st">'date'</span>])</span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a>global_factors <span class="op">=</span> global_factors.set_index(<span class="st">'date'</span>)</span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a><span class="co"># Vietnamese factor returns (local)</span></span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>local_factors <span class="op">=</span> client.get_factor_returns(</span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a>    market<span class="op">=</span><span class="st">'vietnam'</span>,</span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2008-01-01'</span>,</span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>    factors<span class="op">=</span>[<span class="st">'mkt_excess'</span>, <span class="st">'smb'</span>, <span class="st">'hml'</span>, <span class="st">'rmw'</span>, <span class="st">'cma'</span>, <span class="st">'wml'</span>]</span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a>local_factors[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(local_factors[<span class="st">'date'</span>])</span>
<span id="cb21-156"><a href="#cb21-156" aria-hidden="true" tabindex="-1"></a>local_factors <span class="op">=</span> local_factors.set_index(<span class="st">'date'</span>)</span>
<span id="cb21-157"><a href="#cb21-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Vietnam index: </span><span class="sc">{</span><span class="bu">len</span>(vn_index)<span class="sc">}</span><span class="ss"> months"</span>)</span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Global indices: </span><span class="sc">{</span>global_indices<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Global factors: </span><span class="sc">{</span><span class="bu">len</span>(global_factors)<span class="sc">}</span><span class="ss"> months"</span>)</span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vietnam's Liberalization Timeline</span></span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: timeline</span></span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Define key liberalization events for Vietnam"</span></span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a>liberalization_events <span class="op">=</span> pd.DataFrame([</span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2000-07-28'</span>, <span class="st">'HOSE opens'</span>, <span class="st">'Institutional'</span>),</span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2002-03-01'</span>, <span class="st">'FOL raised to 30%'</span>, <span class="st">'Ownership'</span>),</span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2005-03-01'</span>, <span class="st">'HNX opens'</span>, <span class="st">'Institutional'</span>),</span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2006-01-01'</span>, <span class="st">'Securities Law enacted'</span>, <span class="st">'Legal'</span>),</span>
<span id="cb21-176"><a href="#cb21-176" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2007-01-11'</span>, <span class="st">'WTO accession'</span>, <span class="st">'Trade'</span>),</span>
<span id="cb21-177"><a href="#cb21-177" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2007-06-01'</span>, <span class="st">'FOL raised to 49%'</span>, <span class="st">'Ownership'</span>),</span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2009-06-24'</span>, <span class="st">'UPCoM opens'</span>, <span class="st">'Institutional'</span>),</span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2012-01-01'</span>, <span class="st">'SSC restructuring'</span>, <span class="st">'Regulatory'</span>),</span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2015-09-01'</span>, <span class="st">'FOL selectively removed'</span>, <span class="st">'Ownership'</span>),</span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2017-08-01'</span>, <span class="st">'Derivatives market opens'</span>, <span class="st">'Institutional'</span>),</span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2018-09-01'</span>, <span class="st">'FTSE Frontier Secondary'</span>, <span class="st">'Index'</span>),</span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2021-01-01'</span>, <span class="st">'New Securities Law'</span>, <span class="st">'Legal'</span>),</span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'2023-06-01'</span>, <span class="st">'KRX trading system'</span>, <span class="st">'Infrastructure'</span>),</span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a>], columns<span class="op">=</span>[<span class="st">'date'</span>, <span class="st">'event'</span>, <span class="st">'category'</span>])</span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a>liberalization_events[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(liberalization_events[<span class="st">'date'</span>])</span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-188"><a href="#cb21-188" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vietnam Liberalization Timeline:"</span>)</span>
<span id="cb21-189"><a href="#cb21-189" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>row[<span class="st">'date'</span>]<span class="sc">.</span>strftime(<span class="st">'%Y-%m'</span>)<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>row[<span class="st">'event'</span>]<span class="sc">}</span><span class="ss"> [</span><span class="sc">{</span>row[<span class="st">'category'</span>]<span class="sc">}</span><span class="ss">]"</span>)</span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation-Based Integration Measures {#sec-market-integration-correlation}</span></span>
<span id="cb21-194"><a href="#cb21-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-195"><a href="#cb21-195" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rolling Correlations</span></span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a>The simplest integration metric is the correlation between Vietnamese and global market returns. Higher correlation implies more integration (returns are driven by the same global factors). However, simple correlation is confounded by volatility changes (i.e., correlations tend to increase mechanically during high-volatility periods <span class="co">[</span><span class="ot">@longin2001extreme</span><span class="co">]</span>).</span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-202"><a href="#cb21-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rolling-correlations</span></span>
<span id="cb21-203"><a href="#cb21-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-204"><a href="#cb21-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Compute rolling correlations between Vietnam and global markets"</span></span>
<span id="cb21-205"><a href="#cb21-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Align all series</span></span>
<span id="cb21-206"><a href="#cb21-206" aria-hidden="true" tabindex="-1"></a>indices_aligned <span class="op">=</span> global_indices.dropna(subset<span class="op">=</span>[<span class="st">'VIETNAM'</span>, <span class="st">'MSCI_WORLD'</span>]).copy()</span>
<span id="cb21-207"><a href="#cb21-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-208"><a href="#cb21-208" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling 36-month correlations</span></span>
<span id="cb21-209"><a href="#cb21-209" aria-hidden="true" tabindex="-1"></a>rolling_window <span class="op">=</span> <span class="dv">36</span></span>
<span id="cb21-210"><a href="#cb21-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-211"><a href="#cb21-211" aria-hidden="true" tabindex="-1"></a>corr_series <span class="op">=</span> {}</span>
<span id="cb21-212"><a href="#cb21-212" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> [<span class="st">'MSCI_WORLD'</span>, <span class="st">'MSCI_EM'</span>, <span class="st">'MSCI_ASIA_PAC_EX_JP'</span>,</span>
<span id="cb21-213"><a href="#cb21-213" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SP500'</span>, <span class="st">'MSCI_CHINA'</span>, <span class="st">'MSCI_THAILAND'</span>]:</span>
<span id="cb21-214"><a href="#cb21-214" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="kw">in</span> indices_aligned.columns:</span>
<span id="cb21-215"><a href="#cb21-215" aria-hidden="true" tabindex="-1"></a>        corr <span class="op">=</span> (</span>
<span id="cb21-216"><a href="#cb21-216" aria-hidden="true" tabindex="-1"></a>            indices_aligned[[<span class="st">'VIETNAM'</span>, idx]]</span>
<span id="cb21-217"><a href="#cb21-217" aria-hidden="true" tabindex="-1"></a>            .rolling(rolling_window)</span>
<span id="cb21-218"><a href="#cb21-218" aria-hidden="true" tabindex="-1"></a>            .corr()</span>
<span id="cb21-219"><a href="#cb21-219" aria-hidden="true" tabindex="-1"></a>            .unstack()[<span class="st">'VIETNAM'</span>][idx]</span>
<span id="cb21-220"><a href="#cb21-220" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-221"><a href="#cb21-221" aria-hidden="true" tabindex="-1"></a>        corr_series[idx] <span class="op">=</span> corr</span>
<span id="cb21-222"><a href="#cb21-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-223"><a href="#cb21-223" aria-hidden="true" tabindex="-1"></a>corr_df <span class="op">=</span> pd.DataFrame(corr_series)</span>
<span id="cb21-224"><a href="#cb21-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-225"><a href="#cb21-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-228"><a href="#cb21-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-229"><a href="#cb21-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rolling-corr</span></span>
<span id="cb21-230"><a href="#cb21-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-231"><a href="#cb21-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Rolling 36-month correlations between Vietnamese equity returns (USD) and major global/regional indices. Vietnam's correlation with the MSCI World rose from near zero in the early 2000s to 0.3–0.5 by the mid-2010s, reflecting gradual integration. The correlation is highest with ASEAN peers (Thailand, Indonesia) and MSCI Emerging Markets, and lowest with the S&amp;P 500. Liberalization events (vertical lines) precede periods of rising correlation."</span></span>
<span id="cb21-232"><a href="#cb21-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot rolling correlations with event timeline"</span></span>
<span id="cb21-233"><a href="#cb21-233" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb21-234"><a href="#cb21-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-235"><a href="#cb21-235" aria-hidden="true" tabindex="-1"></a>colors_idx <span class="op">=</span> {</span>
<span id="cb21-236"><a href="#cb21-236" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_WORLD'</span>: <span class="st">'#2C5F8A'</span>, <span class="st">'MSCI_EM'</span>: <span class="st">'#C0392B'</span>,</span>
<span id="cb21-237"><a href="#cb21-237" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_ASIA_PAC_EX_JP'</span>: <span class="st">'#27AE60'</span>, <span class="st">'SP500'</span>: <span class="st">'#8E44AD'</span>,</span>
<span id="cb21-238"><a href="#cb21-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_CHINA'</span>: <span class="st">'#E67E22'</span>, <span class="st">'MSCI_THAILAND'</span>: <span class="st">'#1ABC9C'</span></span>
<span id="cb21-239"><a href="#cb21-239" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-240"><a href="#cb21-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-241"><a href="#cb21-241" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, color <span class="kw">in</span> colors_idx.items():</span>
<span id="cb21-242"><a href="#cb21-242" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="kw">in</span> corr_df.columns:</span>
<span id="cb21-243"><a href="#cb21-243" aria-hidden="true" tabindex="-1"></a>        ax.plot(corr_df.index, corr_df[idx], color<span class="op">=</span>color,</span>
<span id="cb21-244"><a href="#cb21-244" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span>idx.replace(<span class="st">'MSCI_'</span>, <span class="st">''</span>).replace(<span class="st">'_'</span>, <span class="st">' '</span>),</span>
<span id="cb21-245"><a href="#cb21-245" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb21-246"><a href="#cb21-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-247"><a href="#cb21-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Add liberalization events</span></span>
<span id="cb21-248"><a href="#cb21-248" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, event <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb21-249"><a href="#cb21-249" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> event[<span class="st">'date'</span>] <span class="op">&gt;=</span> corr_df.index.<span class="bu">min</span>():</span>
<span id="cb21-250"><a href="#cb21-250" aria-hidden="true" tabindex="-1"></a>        ax.axvline(x<span class="op">=</span>event[<span class="st">'date'</span>], color<span class="op">=</span><span class="st">'gray'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb21-251"><a href="#cb21-251" aria-hidden="true" tabindex="-1"></a>                   linestyle<span class="op">=</span><span class="st">':'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb21-252"><a href="#cb21-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-253"><a href="#cb21-253" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb21-254"><a href="#cb21-254" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Correlation with Vietnam'</span>)</span>
<span id="cb21-255"><a href="#cb21-255" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Rolling 36-Month Correlation: Vietnam vs Global Markets'</span>)</span>
<span id="cb21-256"><a href="#cb21-256" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">8</span>, ncol<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb21-257"><a href="#cb21-257" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.8</span>])</span>
<span id="cb21-258"><a href="#cb21-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-259"><a href="#cb21-259" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-260"><a href="#cb21-260" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-261"><a href="#cb21-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-262"><a href="#cb21-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-263"><a href="#cb21-263" aria-hidden="true" tabindex="-1"></a><span class="fu">### DCC-GARCH Dynamic Correlations</span></span>
<span id="cb21-264"><a href="#cb21-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-265"><a href="#cb21-265" aria-hidden="true" tabindex="-1"></a>To separate changes in correlation from changes in volatility, we estimate a Dynamic Conditional Correlation (DCC) model <span class="co">[</span><span class="ot">@engle2002dynamic</span><span class="co">]</span>. The DCC decomposes the time-varying covariance matrix into time-varying volatilities and a time-varying correlation matrix:</span>
<span id="cb21-266"><a href="#cb21-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-267"><a href="#cb21-267" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb21-268"><a href="#cb21-268" aria-hidden="true" tabindex="-1"></a>H_t = D_t R_t D_t</span>
<span id="cb21-269"><a href="#cb21-269" aria-hidden="true" tabindex="-1"></a>$$ {#eq-dcc-decomp}</span>
<span id="cb21-270"><a href="#cb21-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-271"><a href="#cb21-271" aria-hidden="true" tabindex="-1"></a>where $D_t = \text{diag}(\sigma_{1,t}, \ldots, \sigma_{n,t})$ and $R_t$ is the conditional correlation matrix that evolves according to:</span>
<span id="cb21-272"><a href="#cb21-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-273"><a href="#cb21-273" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb21-274"><a href="#cb21-274" aria-hidden="true" tabindex="-1"></a>Q_t = (1 - a - b) \bar{Q} + a \epsilon_{t-1} \epsilon_{t-1}' + b Q_{t-1}</span>
<span id="cb21-275"><a href="#cb21-275" aria-hidden="true" tabindex="-1"></a>$$ {#eq-dcc-evolution}</span>
<span id="cb21-276"><a href="#cb21-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-277"><a href="#cb21-277" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb21-278"><a href="#cb21-278" aria-hidden="true" tabindex="-1"></a>R_t = \text{diag}(Q_t)^{-1/2} Q_t \text{diag}(Q_t)^{-1/2}</span>
<span id="cb21-279"><a href="#cb21-279" aria-hidden="true" tabindex="-1"></a>$$ {#eq-dcc-normalize}</span>
<span id="cb21-280"><a href="#cb21-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-283"><a href="#cb21-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-284"><a href="#cb21-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dcc-garch</span></span>
<span id="cb21-285"><a href="#cb21-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-286"><a href="#cb21-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Estimate DCC-GARCH model for Vietnam and global market"</span></span>
<span id="cb21-287"><a href="#cb21-287" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_dcc(y1, y2, p<span class="op">=</span><span class="dv">1</span>, q<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb21-288"><a href="#cb21-288" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb21-289"><a href="#cb21-289" aria-hidden="true" tabindex="-1"></a><span class="co">    Two-step DCC-GARCH estimation.</span></span>
<span id="cb21-290"><a href="#cb21-290" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1: Univariate GARCH for each series.</span></span>
<span id="cb21-291"><a href="#cb21-291" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2: DCC parameters from standardized residuals.</span></span>
<span id="cb21-292"><a href="#cb21-292" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-293"><a href="#cb21-293" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 1: Univariate GARCH(1,1) for each series</span></span>
<span id="cb21-294"><a href="#cb21-294" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> []</span>
<span id="cb21-295"><a href="#cb21-295" aria-hidden="true" tabindex="-1"></a>    std_resids <span class="op">=</span> []</span>
<span id="cb21-296"><a href="#cb21-296" aria-hidden="true" tabindex="-1"></a>    cond_vols <span class="op">=</span> []</span>
<span id="cb21-297"><a href="#cb21-297" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-298"><a href="#cb21-298" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> y <span class="kw">in</span> [y1, y2]:</span>
<span id="cb21-299"><a href="#cb21-299" aria-hidden="true" tabindex="-1"></a>        am <span class="op">=</span> arch_model(y <span class="op">*</span> <span class="dv">100</span>, vol<span class="op">=</span><span class="st">'GARCH'</span>, p<span class="op">=</span>p, q<span class="op">=</span>q,</span>
<span id="cb21-300"><a href="#cb21-300" aria-hidden="true" tabindex="-1"></a>                          mean<span class="op">=</span><span class="st">'Constant'</span>, dist<span class="op">=</span><span class="st">'normal'</span>)</span>
<span id="cb21-301"><a href="#cb21-301" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> am.fit(disp<span class="op">=</span><span class="st">'off'</span>)</span>
<span id="cb21-302"><a href="#cb21-302" aria-hidden="true" tabindex="-1"></a>        models.append(res)</span>
<span id="cb21-303"><a href="#cb21-303" aria-hidden="true" tabindex="-1"></a>        std_resids.append(res.std_resid)</span>
<span id="cb21-304"><a href="#cb21-304" aria-hidden="true" tabindex="-1"></a>        cond_vols.append(res.conditional_volatility <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb21-305"><a href="#cb21-305" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-306"><a href="#cb21-306" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Align residuals</span></span>
<span id="cb21-307"><a href="#cb21-307" aria-hidden="true" tabindex="-1"></a>    e1 <span class="op">=</span> std_resids[<span class="dv">0</span>]</span>
<span id="cb21-308"><a href="#cb21-308" aria-hidden="true" tabindex="-1"></a>    e2 <span class="op">=</span> std_resids[<span class="dv">1</span>]</span>
<span id="cb21-309"><a href="#cb21-309" aria-hidden="true" tabindex="-1"></a>    common <span class="op">=</span> e1.dropna().index.intersection(e2.dropna().index)</span>
<span id="cb21-310"><a href="#cb21-310" aria-hidden="true" tabindex="-1"></a>    e1 <span class="op">=</span> e1[common].values</span>
<span id="cb21-311"><a href="#cb21-311" aria-hidden="true" tabindex="-1"></a>    e2 <span class="op">=</span> e2[common].values</span>
<span id="cb21-312"><a href="#cb21-312" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="bu">len</span>(e1)</span>
<span id="cb21-313"><a href="#cb21-313" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-314"><a href="#cb21-314" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2: DCC estimation</span></span>
<span id="cb21-315"><a href="#cb21-315" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Q_bar = unconditional correlation of standardized residuals</span></span>
<span id="cb21-316"><a href="#cb21-316" aria-hidden="true" tabindex="-1"></a>    Q_bar <span class="op">=</span> np.corrcoef(e1, e2)</span>
<span id="cb21-317"><a href="#cb21-317" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-318"><a href="#cb21-318" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dcc_loglik(params):</span>
<span id="cb21-319"><a href="#cb21-319" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> params</span>
<span id="cb21-320"><a href="#cb21-320" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> a <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> b <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> a <span class="op">+</span> b <span class="op">&gt;=</span> <span class="dv">1</span>:</span>
<span id="cb21-321"><a href="#cb21-321" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fl">1e10</span></span>
<span id="cb21-322"><a href="#cb21-322" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-323"><a href="#cb21-323" aria-hidden="true" tabindex="-1"></a>        Q <span class="op">=</span> np.zeros((T, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb21-324"><a href="#cb21-324" aria-hidden="true" tabindex="-1"></a>        R <span class="op">=</span> np.zeros((T, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb21-325"><a href="#cb21-325" aria-hidden="true" tabindex="-1"></a>        Q[<span class="dv">0</span>] <span class="op">=</span> Q_bar.copy()</span>
<span id="cb21-326"><a href="#cb21-326" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-327"><a href="#cb21-327" aria-hidden="true" tabindex="-1"></a>        ll <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-328"><a href="#cb21-328" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(T):</span>
<span id="cb21-329"><a href="#cb21-329" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> t <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-330"><a href="#cb21-330" aria-hidden="true" tabindex="-1"></a>                et <span class="op">=</span> np.array([[e1[t<span class="op">-</span><span class="dv">1</span>]], [e2[t<span class="op">-</span><span class="dv">1</span>]]])</span>
<span id="cb21-331"><a href="#cb21-331" aria-hidden="true" tabindex="-1"></a>                Q[t] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> a <span class="op">-</span> b) <span class="op">*</span> Q_bar <span class="op">+</span> a <span class="op">*</span> (et <span class="op">@</span> et.T) <span class="op">+</span> b <span class="op">*</span> Q[t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb21-332"><a href="#cb21-332" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb21-333"><a href="#cb21-333" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Normalize</span></span>
<span id="cb21-334"><a href="#cb21-334" aria-hidden="true" tabindex="-1"></a>            d <span class="op">=</span> np.sqrt(np.diag(Q[t]))</span>
<span id="cb21-335"><a href="#cb21-335" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> d[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> d[<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-336"><a href="#cb21-336" aria-hidden="true" tabindex="-1"></a>                R[t] <span class="op">=</span> Q[t] <span class="op">/</span> np.outer(d, d)</span>
<span id="cb21-337"><a href="#cb21-337" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb21-338"><a href="#cb21-338" aria-hidden="true" tabindex="-1"></a>                R[t] <span class="op">=</span> np.eye(<span class="dv">2</span>)</span>
<span id="cb21-339"><a href="#cb21-339" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb21-340"><a href="#cb21-340" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Clip correlation</span></span>
<span id="cb21-341"><a href="#cb21-341" aria-hidden="true" tabindex="-1"></a>            R[t, <span class="dv">0</span>, <span class="dv">1</span>] <span class="op">=</span> np.clip(R[t, <span class="dv">0</span>, <span class="dv">1</span>], <span class="op">-</span><span class="fl">0.999</span>, <span class="fl">0.999</span>)</span>
<span id="cb21-342"><a href="#cb21-342" aria-hidden="true" tabindex="-1"></a>            R[t, <span class="dv">1</span>, <span class="dv">0</span>] <span class="op">=</span> R[t, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb21-343"><a href="#cb21-343" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb21-344"><a href="#cb21-344" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Log-likelihood contribution</span></span>
<span id="cb21-345"><a href="#cb21-345" aria-hidden="true" tabindex="-1"></a>            det_R <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> R[t, <span class="dv">0</span>, <span class="dv">1</span>] <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb21-346"><a href="#cb21-346" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> det_R <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-347"><a href="#cb21-347" aria-hidden="true" tabindex="-1"></a>                et_vec <span class="op">=</span> np.array([e1[t], e2[t]])</span>
<span id="cb21-348"><a href="#cb21-348" aria-hidden="true" tabindex="-1"></a>                ll <span class="op">+=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> (np.log(det_R) <span class="op">+</span></span>
<span id="cb21-349"><a href="#cb21-349" aria-hidden="true" tabindex="-1"></a>                              et_vec <span class="op">@</span> np.linalg.inv(R[t]) <span class="op">@</span> et_vec <span class="op">-</span></span>
<span id="cb21-350"><a href="#cb21-350" aria-hidden="true" tabindex="-1"></a>                              et_vec <span class="op">@</span> et_vec)</span>
<span id="cb21-351"><a href="#cb21-351" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-352"><a href="#cb21-352" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">-</span>ll</span>
<span id="cb21-353"><a href="#cb21-353" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-354"><a href="#cb21-354" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> optimize.minimize(dcc_loglik, [<span class="fl">0.05</span>, <span class="fl">0.90</span>],</span>
<span id="cb21-355"><a href="#cb21-355" aria-hidden="true" tabindex="-1"></a>                                method<span class="op">=</span><span class="st">'Nelder-Mead'</span>,</span>
<span id="cb21-356"><a href="#cb21-356" aria-hidden="true" tabindex="-1"></a>                                options<span class="op">=</span>{<span class="st">'maxiter'</span>: <span class="dv">5000</span>})</span>
<span id="cb21-357"><a href="#cb21-357" aria-hidden="true" tabindex="-1"></a>    a_hat, b_hat <span class="op">=</span> result.x</span>
<span id="cb21-358"><a href="#cb21-358" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-359"><a href="#cb21-359" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reconstruct dynamic correlations</span></span>
<span id="cb21-360"><a href="#cb21-360" aria-hidden="true" tabindex="-1"></a>    Q <span class="op">=</span> np.zeros((T, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb21-361"><a href="#cb21-361" aria-hidden="true" tabindex="-1"></a>    dcc_corr <span class="op">=</span> np.zeros(T)</span>
<span id="cb21-362"><a href="#cb21-362" aria-hidden="true" tabindex="-1"></a>    Q[<span class="dv">0</span>] <span class="op">=</span> Q_bar.copy()</span>
<span id="cb21-363"><a href="#cb21-363" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-364"><a href="#cb21-364" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(T):</span>
<span id="cb21-365"><a href="#cb21-365" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> t <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-366"><a href="#cb21-366" aria-hidden="true" tabindex="-1"></a>            et <span class="op">=</span> np.array([[e1[t<span class="op">-</span><span class="dv">1</span>]], [e2[t<span class="op">-</span><span class="dv">1</span>]]])</span>
<span id="cb21-367"><a href="#cb21-367" aria-hidden="true" tabindex="-1"></a>            Q[t] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> a_hat <span class="op">-</span> b_hat) <span class="op">*</span> Q_bar <span class="op">+</span> a_hat <span class="op">*</span> (et <span class="op">@</span> et.T) <span class="op">+</span> b_hat <span class="op">*</span> Q[t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb21-368"><a href="#cb21-368" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-369"><a href="#cb21-369" aria-hidden="true" tabindex="-1"></a>        d <span class="op">=</span> np.sqrt(np.diag(Q[t]))</span>
<span id="cb21-370"><a href="#cb21-370" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> d[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> d[<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-371"><a href="#cb21-371" aria-hidden="true" tabindex="-1"></a>            dcc_corr[t] <span class="op">=</span> Q[t, <span class="dv">0</span>, <span class="dv">1</span>] <span class="op">/</span> (d[<span class="dv">0</span>] <span class="op">*</span> d[<span class="dv">1</span>])</span>
<span id="cb21-372"><a href="#cb21-372" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb21-373"><a href="#cb21-373" aria-hidden="true" tabindex="-1"></a>            dcc_corr[t] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-374"><a href="#cb21-374" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-375"><a href="#cb21-375" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb21-376"><a href="#cb21-376" aria-hidden="true" tabindex="-1"></a>        <span class="st">'a'</span>: a_hat, <span class="st">'b'</span>: b_hat,</span>
<span id="cb21-377"><a href="#cb21-377" aria-hidden="true" tabindex="-1"></a>        <span class="st">'persistence'</span>: a_hat <span class="op">+</span> b_hat,</span>
<span id="cb21-378"><a href="#cb21-378" aria-hidden="true" tabindex="-1"></a>        <span class="st">'dcc_corr'</span>: pd.Series(dcc_corr, index<span class="op">=</span>common),</span>
<span id="cb21-379"><a href="#cb21-379" aria-hidden="true" tabindex="-1"></a>        <span class="st">'cond_vol_1'</span>: cond_vols[<span class="dv">0</span>],</span>
<span id="cb21-380"><a href="#cb21-380" aria-hidden="true" tabindex="-1"></a>        <span class="st">'cond_vol_2'</span>: cond_vols[<span class="dv">1</span>]</span>
<span id="cb21-381"><a href="#cb21-381" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-382"><a href="#cb21-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-383"><a href="#cb21-383" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate DCC: Vietnam vs MSCI World</span></span>
<span id="cb21-384"><a href="#cb21-384" aria-hidden="true" tabindex="-1"></a>vn_ret <span class="op">=</span> indices_aligned[<span class="st">'VIETNAM'</span>].dropna()</span>
<span id="cb21-385"><a href="#cb21-385" aria-hidden="true" tabindex="-1"></a>world_ret <span class="op">=</span> indices_aligned[<span class="st">'MSCI_WORLD'</span>].dropna()</span>
<span id="cb21-386"><a href="#cb21-386" aria-hidden="true" tabindex="-1"></a>common_dates <span class="op">=</span> vn_ret.index.intersection(world_ret.index)</span>
<span id="cb21-387"><a href="#cb21-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-388"><a href="#cb21-388" aria-hidden="true" tabindex="-1"></a>dcc_result <span class="op">=</span> estimate_dcc(vn_ret[common_dates], world_ret[common_dates])</span>
<span id="cb21-389"><a href="#cb21-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-390"><a href="#cb21-390" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"DCC Parameters:"</span>)</span>
<span id="cb21-391"><a href="#cb21-391" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  a (news): </span><span class="sc">{</span>dcc_result[<span class="st">'a'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb21-392"><a href="#cb21-392" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  b (persistence): </span><span class="sc">{</span>dcc_result[<span class="st">'b'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb21-393"><a href="#cb21-393" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  a + b: </span><span class="sc">{</span>dcc_result[<span class="st">'persistence'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb21-394"><a href="#cb21-394" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">DCC Correlation with MSCI World:"</span>)</span>
<span id="cb21-395"><a href="#cb21-395" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean: </span><span class="sc">{</span>dcc_result[<span class="st">'dcc_corr'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-396"><a href="#cb21-396" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Min:  </span><span class="sc">{</span>dcc_result[<span class="st">'dcc_corr'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-397"><a href="#cb21-397" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Max:  </span><span class="sc">{</span>dcc_result[<span class="st">'dcc_corr'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-398"><a href="#cb21-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-399"><a href="#cb21-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-402"><a href="#cb21-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-403"><a href="#cb21-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dcc</span></span>
<span id="cb21-404"><a href="#cb21-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-405"><a href="#cb21-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "DCC-GARCH dynamic correlation between Vietnam and the MSCI World Index. Unlike simple rolling correlation, the DCC isolates true changes in co-movement from volatility effects. The trend is clearly upward from near zero in the early 2000s to 0.3–0.5 in recent years. Major liberalization events (colored lines) are associated with sustained increases in the conditional correlation."</span></span>
<span id="cb21-406"><a href="#cb21-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot DCC dynamic correlation with event annotations"</span></span>
<span id="cb21-407"><a href="#cb21-407" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>), sharex<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb21-408"><a href="#cb21-408" aria-hidden="true" tabindex="-1"></a>                          gridspec_kw<span class="op">=</span>{<span class="st">'height_ratios'</span>: [<span class="dv">2</span>, <span class="dv">1</span>]})</span>
<span id="cb21-409"><a href="#cb21-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-410"><a href="#cb21-410" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: DCC correlation</span></span>
<span id="cb21-411"><a href="#cb21-411" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(dcc_result[<span class="st">'dcc_corr'</span>].index, dcc_result[<span class="st">'dcc_corr'</span>].values,</span>
<span id="cb21-412"><a href="#cb21-412" aria-hidden="true" tabindex="-1"></a>             color<span class="op">=</span><span class="st">'#2C5F8A'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb21-413"><a href="#cb21-413" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].fill_between(dcc_result[<span class="st">'dcc_corr'</span>].index,</span>
<span id="cb21-414"><a href="#cb21-414" aria-hidden="true" tabindex="-1"></a>                       dcc_result[<span class="st">'dcc_corr'</span>].values, <span class="dv">0</span>,</span>
<span id="cb21-415"><a href="#cb21-415" aria-hidden="true" tabindex="-1"></a>                       alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">'#2C5F8A'</span>)</span>
<span id="cb21-416"><a href="#cb21-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-417"><a href="#cb21-417" aria-hidden="true" tabindex="-1"></a><span class="co"># Liberalization events</span></span>
<span id="cb21-418"><a href="#cb21-418" aria-hidden="true" tabindex="-1"></a>event_colors <span class="op">=</span> {<span class="st">'Ownership'</span>: <span class="st">'#C0392B'</span>, <span class="st">'Trade'</span>: <span class="st">'#27AE60'</span>,</span>
<span id="cb21-419"><a href="#cb21-419" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Institutional'</span>: <span class="st">'#E67E22'</span>, <span class="st">'Legal'</span>: <span class="st">'#8E44AD'</span>,</span>
<span id="cb21-420"><a href="#cb21-420" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Index'</span>: <span class="st">'#1ABC9C'</span>, <span class="st">'Regulatory'</span>: <span class="st">'#F1C40F'</span>,</span>
<span id="cb21-421"><a href="#cb21-421" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Infrastructure'</span>: <span class="st">'#3498DB'</span>}</span>
<span id="cb21-422"><a href="#cb21-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-423"><a href="#cb21-423" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, event <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb21-424"><a href="#cb21-424" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> event[<span class="st">'date'</span>] <span class="kw">in</span> dcc_result[<span class="st">'dcc_corr'</span>].index <span class="kw">or</span> <span class="va">True</span>:</span>
<span id="cb21-425"><a href="#cb21-425" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> event_colors.get(event[<span class="st">'category'</span>], <span class="st">'gray'</span>)</span>
<span id="cb21-426"><a href="#cb21-426" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].axvline(x<span class="op">=</span>event[<span class="st">'date'</span>], color<span class="op">=</span>color, linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb21-427"><a href="#cb21-427" aria-hidden="true" tabindex="-1"></a>                         linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb21-428"><a href="#cb21-428" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].text(event[<span class="st">'date'</span>], axes[<span class="dv">0</span>].get_ylim()[<span class="dv">1</span>] <span class="op">*</span> <span class="fl">0.95</span>,</span>
<span id="cb21-429"><a href="#cb21-429" aria-hidden="true" tabindex="-1"></a>                      event[<span class="st">'event'</span>][:<span class="dv">15</span>], rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">6</span>,</span>
<span id="cb21-430"><a href="#cb21-430" aria-hidden="true" tabindex="-1"></a>                      va<span class="op">=</span><span class="st">'top'</span>, color<span class="op">=</span>color)</span>
<span id="cb21-431"><a href="#cb21-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-432"><a href="#cb21-432" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Dynamic Conditional Correlation'</span>)</span>
<span id="cb21-433"><a href="#cb21-433" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Panel A: DCC-GARCH Correlation (Vietnam–World)'</span>)</span>
<span id="cb21-434"><a href="#cb21-434" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb21-435"><a href="#cb21-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-436"><a href="#cb21-436" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Conditional volatilities</span></span>
<span id="cb21-437"><a href="#cb21-437" aria-hidden="true" tabindex="-1"></a>vol1 <span class="op">=</span> dcc_result[<span class="st">'cond_vol_1'</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>)  <span class="co"># Annualized</span></span>
<span id="cb21-438"><a href="#cb21-438" aria-hidden="true" tabindex="-1"></a>vol2 <span class="op">=</span> dcc_result[<span class="st">'cond_vol_2'</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb21-439"><a href="#cb21-439" aria-hidden="true" tabindex="-1"></a>common_vol <span class="op">=</span> vol1.index.intersection(vol2.index)</span>
<span id="cb21-440"><a href="#cb21-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-441"><a href="#cb21-441" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(common_vol, vol1[common_vol], color<span class="op">=</span><span class="st">'#C0392B'</span>,</span>
<span id="cb21-442"><a href="#cb21-442" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">'Vietnam'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb21-443"><a href="#cb21-443" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(common_vol, vol2[common_vol], color<span class="op">=</span><span class="st">'#2C5F8A'</span>,</span>
<span id="cb21-444"><a href="#cb21-444" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">'World'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb21-445"><a href="#cb21-445" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Annualized Cond. Vol'</span>)</span>
<span id="cb21-446"><a href="#cb21-446" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Panel B: Conditional Volatility'</span>)</span>
<span id="cb21-447"><a href="#cb21-447" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb21-448"><a href="#cb21-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-449"><a href="#cb21-449" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-450"><a href="#cb21-450" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-451"><a href="#cb21-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-452"><a href="#cb21-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-453"><a href="#cb21-453" aria-hidden="true" tabindex="-1"></a><span class="fu">### Asymmetric Integration</span></span>
<span id="cb21-454"><a href="#cb21-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-455"><a href="#cb21-455" aria-hidden="true" tabindex="-1"></a>Integration may be state-dependent: co-movement often increases during global crises (contagion) but not during local booms. @longin2001extreme and @ang2002asymmetric show that equity correlations are higher during market downturns. We test for asymmetry:</span>
<span id="cb21-456"><a href="#cb21-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-459"><a href="#cb21-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-460"><a href="#cb21-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: asymmetric-corr</span></span>
<span id="cb21-461"><a href="#cb21-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-462"><a href="#cb21-462" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Test for asymmetric integration (bear vs bull markets)"</span></span>
<span id="cb21-463"><a href="#cb21-463" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify global market regimes</span></span>
<span id="cb21-464"><a href="#cb21-464" aria-hidden="true" tabindex="-1"></a>world_ret_aligned <span class="op">=</span> world_ret[common_dates]</span>
<span id="cb21-465"><a href="#cb21-465" aria-hidden="true" tabindex="-1"></a>vn_ret_aligned <span class="op">=</span> vn_ret[common_dates]</span>
<span id="cb21-466"><a href="#cb21-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-467"><a href="#cb21-467" aria-hidden="true" tabindex="-1"></a><span class="co"># Bear: world return in bottom 25th percentile</span></span>
<span id="cb21-468"><a href="#cb21-468" aria-hidden="true" tabindex="-1"></a><span class="co"># Bull: world return in top 25th percentile</span></span>
<span id="cb21-469"><a href="#cb21-469" aria-hidden="true" tabindex="-1"></a>q25 <span class="op">=</span> world_ret_aligned.quantile(<span class="fl">0.25</span>)</span>
<span id="cb21-470"><a href="#cb21-470" aria-hidden="true" tabindex="-1"></a>q75 <span class="op">=</span> world_ret_aligned.quantile(<span class="fl">0.75</span>)</span>
<span id="cb21-471"><a href="#cb21-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-472"><a href="#cb21-472" aria-hidden="true" tabindex="-1"></a>bear <span class="op">=</span> world_ret_aligned <span class="op">&lt;=</span> q25</span>
<span id="cb21-473"><a href="#cb21-473" aria-hidden="true" tabindex="-1"></a>bull <span class="op">=</span> world_ret_aligned <span class="op">&gt;=</span> q75</span>
<span id="cb21-474"><a href="#cb21-474" aria-hidden="true" tabindex="-1"></a>normal <span class="op">=</span> <span class="op">~</span>bear <span class="op">&amp;</span> <span class="op">~</span>bull</span>
<span id="cb21-475"><a href="#cb21-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-476"><a href="#cb21-476" aria-hidden="true" tabindex="-1"></a>regimes <span class="op">=</span> {</span>
<span id="cb21-477"><a href="#cb21-477" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Bear (bottom 25%)'</span>: bear,</span>
<span id="cb21-478"><a href="#cb21-478" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Normal (middle 50%)'</span>: normal,</span>
<span id="cb21-479"><a href="#cb21-479" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Bull (top 25%)'</span>: bull,</span>
<span id="cb21-480"><a href="#cb21-480" aria-hidden="true" tabindex="-1"></a>    <span class="st">'All'</span>: pd.Series(<span class="va">True</span>, index<span class="op">=</span>world_ret_aligned.index)</span>
<span id="cb21-481"><a href="#cb21-481" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-482"><a href="#cb21-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-483"><a href="#cb21-483" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Asymmetric Correlation:"</span>)</span>
<span id="cb21-484"><a href="#cb21-484" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Regime'</span><span class="sc">:&lt;25}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Correlation'</span><span class="sc">:&gt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'N months'</span><span class="sc">:&gt;10}</span><span class="ss">"</span>)</span>
<span id="cb21-485"><a href="#cb21-485" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">47</span>)</span>
<span id="cb21-486"><a href="#cb21-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-487"><a href="#cb21-487" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, mask <span class="kw">in</span> regimes.items():</span>
<span id="cb21-488"><a href="#cb21-488" aria-hidden="true" tabindex="-1"></a>    r_vn <span class="op">=</span> vn_ret_aligned[mask]</span>
<span id="cb21-489"><a href="#cb21-489" aria-hidden="true" tabindex="-1"></a>    r_w <span class="op">=</span> world_ret_aligned[mask]</span>
<span id="cb21-490"><a href="#cb21-490" aria-hidden="true" tabindex="-1"></a>    corr <span class="op">=</span> r_vn.corr(r_w)</span>
<span id="cb21-491"><a href="#cb21-491" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">:&lt;25}</span><span class="ss"> </span><span class="sc">{</span>corr<span class="sc">:&gt;12.3f}</span><span class="ss"> </span><span class="sc">{</span>mask<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:&gt;10}</span><span class="ss">"</span>)</span>
<span id="cb21-492"><a href="#cb21-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-493"><a href="#cb21-493" aria-hidden="true" tabindex="-1"></a><span class="co"># Test: is bear correlation &gt; bull correlation?</span></span>
<span id="cb21-494"><a href="#cb21-494" aria-hidden="true" tabindex="-1"></a>r_bear_vn <span class="op">=</span> vn_ret_aligned[bear]</span>
<span id="cb21-495"><a href="#cb21-495" aria-hidden="true" tabindex="-1"></a>r_bear_w <span class="op">=</span> world_ret_aligned[bear]</span>
<span id="cb21-496"><a href="#cb21-496" aria-hidden="true" tabindex="-1"></a>r_bull_vn <span class="op">=</span> vn_ret_aligned[bull]</span>
<span id="cb21-497"><a href="#cb21-497" aria-hidden="true" tabindex="-1"></a>r_bull_w <span class="op">=</span> world_ret_aligned[bull]</span>
<span id="cb21-498"><a href="#cb21-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-499"><a href="#cb21-499" aria-hidden="true" tabindex="-1"></a><span class="co"># Fisher z-transformation test</span></span>
<span id="cb21-500"><a href="#cb21-500" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fisher_z_test(r1, n1, r2, n2):</span>
<span id="cb21-501"><a href="#cb21-501" aria-hidden="true" tabindex="-1"></a>    z1 <span class="op">=</span> np.arctanh(r1)</span>
<span id="cb21-502"><a href="#cb21-502" aria-hidden="true" tabindex="-1"></a>    z2 <span class="op">=</span> np.arctanh(r2)</span>
<span id="cb21-503"><a href="#cb21-503" aria-hidden="true" tabindex="-1"></a>    se <span class="op">=</span> np.sqrt(<span class="dv">1</span> <span class="op">/</span> (n1 <span class="op">-</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">1</span> <span class="op">/</span> (n2 <span class="op">-</span> <span class="dv">3</span>))</span>
<span id="cb21-504"><a href="#cb21-504" aria-hidden="true" tabindex="-1"></a>    z_stat <span class="op">=</span> (z1 <span class="op">-</span> z2) <span class="op">/</span> se</span>
<span id="cb21-505"><a href="#cb21-505" aria-hidden="true" tabindex="-1"></a>    p_val <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.norm.cdf(<span class="bu">abs</span>(z_stat)))</span>
<span id="cb21-506"><a href="#cb21-506" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> z_stat, p_val</span>
<span id="cb21-507"><a href="#cb21-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-508"><a href="#cb21-508" aria-hidden="true" tabindex="-1"></a>z, p <span class="op">=</span> fisher_z_test(</span>
<span id="cb21-509"><a href="#cb21-509" aria-hidden="true" tabindex="-1"></a>    r_bear_vn.corr(r_bear_w), <span class="bu">len</span>(r_bear_vn),</span>
<span id="cb21-510"><a href="#cb21-510" aria-hidden="true" tabindex="-1"></a>    r_bull_vn.corr(r_bull_w), <span class="bu">len</span>(r_bull_vn)</span>
<span id="cb21-511"><a href="#cb21-511" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-512"><a href="#cb21-512" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Fisher z-test (bear vs bull): z = </span><span class="sc">{</span>z<span class="sc">:.2f}</span><span class="ss">, p = </span><span class="sc">{</span>p<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb21-513"><a href="#cb21-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-514"><a href="#cb21-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-515"><a href="#cb21-515" aria-hidden="true" tabindex="-1"></a><span class="fu">## Factor-Based Integration Measures {#sec-market-integration-factor}</span></span>
<span id="cb21-516"><a href="#cb21-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-517"><a href="#cb21-517" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Pukthuanthong-Roll R² Measure</span></span>
<span id="cb21-518"><a href="#cb21-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-519"><a href="#cb21-519" aria-hidden="true" tabindex="-1"></a>@pukthuanthong2009global propose measuring integration as the $R^2$ from regressing a country's returns on a set of global principal components. The intuition: if a market is fully integrated, global factors should explain all of its systematic return variation.</span>
<span id="cb21-520"><a href="#cb21-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-523"><a href="#cb21-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-524"><a href="#cb21-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pr-measure</span></span>
<span id="cb21-525"><a href="#cb21-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-526"><a href="#cb21-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Implement the Pukthuanthong-Roll integration measure"</span></span>
<span id="cb21-527"><a href="#cb21-527" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pukthuanthong_roll_integration(country_returns, global_returns_matrix,</span>
<span id="cb21-528"><a href="#cb21-528" aria-hidden="true" tabindex="-1"></a>                                     n_components<span class="op">=</span><span class="dv">10</span>, rolling_window<span class="op">=</span><span class="dv">36</span>):</span>
<span id="cb21-529"><a href="#cb21-529" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb21-530"><a href="#cb21-530" aria-hidden="true" tabindex="-1"></a><span class="co">    Pukthuanthong-Roll (2009) R²-based integration measure.</span></span>
<span id="cb21-531"><a href="#cb21-531" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb21-532"><a href="#cb21-532" aria-hidden="true" tabindex="-1"></a><span class="co">    1. Extract principal components from global returns.</span></span>
<span id="cb21-533"><a href="#cb21-533" aria-hidden="true" tabindex="-1"></a><span class="co">    2. Regress country returns on these PCs.</span></span>
<span id="cb21-534"><a href="#cb21-534" aria-hidden="true" tabindex="-1"></a><span class="co">    3. R² = degree of integration.</span></span>
<span id="cb21-535"><a href="#cb21-535" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-536"><a href="#cb21-536" aria-hidden="true" tabindex="-1"></a>    common <span class="op">=</span> country_returns.dropna().index.intersection(</span>
<span id="cb21-537"><a href="#cb21-537" aria-hidden="true" tabindex="-1"></a>        global_returns_matrix.dropna().index</span>
<span id="cb21-538"><a href="#cb21-538" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-539"><a href="#cb21-539" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-540"><a href="#cb21-540" aria-hidden="true" tabindex="-1"></a>    dates <span class="op">=</span> <span class="bu">sorted</span>(common)</span>
<span id="cb21-541"><a href="#cb21-541" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="bu">len</span>(dates)</span>
<span id="cb21-542"><a href="#cb21-542" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-543"><a href="#cb21-543" aria-hidden="true" tabindex="-1"></a>    integration <span class="op">=</span> []</span>
<span id="cb21-544"><a href="#cb21-544" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-545"><a href="#cb21-545" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(rolling_window, T):</span>
<span id="cb21-546"><a href="#cb21-546" aria-hidden="true" tabindex="-1"></a>        window <span class="op">=</span> dates[t <span class="op">-</span> rolling_window:t]</span>
<span id="cb21-547"><a href="#cb21-547" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-548"><a href="#cb21-548" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Global returns in window</span></span>
<span id="cb21-549"><a href="#cb21-549" aria-hidden="true" tabindex="-1"></a>        G <span class="op">=</span> global_returns_matrix.loc[window].dropna(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-550"><a href="#cb21-550" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> G.shape[<span class="dv">1</span>] <span class="op">&lt;</span> n_components:</span>
<span id="cb21-551"><a href="#cb21-551" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb21-552"><a href="#cb21-552" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-553"><a href="#cb21-553" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Standardize</span></span>
<span id="cb21-554"><a href="#cb21-554" aria-hidden="true" tabindex="-1"></a>        G_std <span class="op">=</span> (G <span class="op">-</span> G.mean()) <span class="op">/</span> G.std()</span>
<span id="cb21-555"><a href="#cb21-555" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-556"><a href="#cb21-556" aria-hidden="true" tabindex="-1"></a>        <span class="co"># PCA</span></span>
<span id="cb21-557"><a href="#cb21-557" aria-hidden="true" tabindex="-1"></a>        cov <span class="op">=</span> G_std.T <span class="op">@</span> G_std <span class="op">/</span> <span class="bu">len</span>(G_std)</span>
<span id="cb21-558"><a href="#cb21-558" aria-hidden="true" tabindex="-1"></a>        eigenvalues, eigenvectors <span class="op">=</span> np.linalg.eigh(cov.values)</span>
<span id="cb21-559"><a href="#cb21-559" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-560"><a href="#cb21-560" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sort descending</span></span>
<span id="cb21-561"><a href="#cb21-561" aria-hidden="true" tabindex="-1"></a>        idx <span class="op">=</span> np.argsort(<span class="op">-</span>eigenvalues)</span>
<span id="cb21-562"><a href="#cb21-562" aria-hidden="true" tabindex="-1"></a>        eigenvalues <span class="op">=</span> eigenvalues[idx]</span>
<span id="cb21-563"><a href="#cb21-563" aria-hidden="true" tabindex="-1"></a>        eigenvectors <span class="op">=</span> eigenvectors[:, idx]</span>
<span id="cb21-564"><a href="#cb21-564" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-565"><a href="#cb21-565" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Project onto top K PCs</span></span>
<span id="cb21-566"><a href="#cb21-566" aria-hidden="true" tabindex="-1"></a>        PCs <span class="op">=</span> G_std.values <span class="op">@</span> eigenvectors[:, :n_components]</span>
<span id="cb21-567"><a href="#cb21-567" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-568"><a href="#cb21-568" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Regress country returns on PCs</span></span>
<span id="cb21-569"><a href="#cb21-569" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> country_returns.loc[window].values</span>
<span id="cb21-570"><a href="#cb21-570" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> sm.add_constant(PCs)</span>
<span id="cb21-571"><a href="#cb21-571" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-572"><a href="#cb21-572" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb21-573"><a href="#cb21-573" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb21-574"><a href="#cb21-574" aria-hidden="true" tabindex="-1"></a>            integration.append({</span>
<span id="cb21-575"><a href="#cb21-575" aria-hidden="true" tabindex="-1"></a>                <span class="st">'date'</span>: dates[t],</span>
<span id="cb21-576"><a href="#cb21-576" aria-hidden="true" tabindex="-1"></a>                <span class="st">'r_squared'</span>: model.rsquared,</span>
<span id="cb21-577"><a href="#cb21-577" aria-hidden="true" tabindex="-1"></a>                <span class="st">'adj_r_squared'</span>: model.rsquared_adj,</span>
<span id="cb21-578"><a href="#cb21-578" aria-hidden="true" tabindex="-1"></a>                <span class="st">'var_explained_pc1'</span>: eigenvalues[<span class="dv">0</span>] <span class="op">/</span> eigenvalues.<span class="bu">sum</span>(),</span>
<span id="cb21-579"><a href="#cb21-579" aria-hidden="true" tabindex="-1"></a>                <span class="st">'n_countries'</span>: G.shape[<span class="dv">1</span>]</span>
<span id="cb21-580"><a href="#cb21-580" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb21-581"><a href="#cb21-581" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb21-582"><a href="#cb21-582" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb21-583"><a href="#cb21-583" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-584"><a href="#cb21-584" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(integration)</span>
<span id="cb21-585"><a href="#cb21-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-586"><a href="#cb21-586" aria-hidden="true" tabindex="-1"></a><span class="co"># Build global returns matrix from multiple country indices</span></span>
<span id="cb21-587"><a href="#cb21-587" aria-hidden="true" tabindex="-1"></a>global_matrix <span class="op">=</span> global_indices.drop(columns<span class="op">=</span>[<span class="st">'VIETNAM'</span>], errors<span class="op">=</span><span class="st">'ignore'</span>)</span>
<span id="cb21-588"><a href="#cb21-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-589"><a href="#cb21-589" aria-hidden="true" tabindex="-1"></a>pr_result <span class="op">=</span> pukthuanthong_roll_integration(</span>
<span id="cb21-590"><a href="#cb21-590" aria-hidden="true" tabindex="-1"></a>    indices_aligned[<span class="st">'VIETNAM'</span>],</span>
<span id="cb21-591"><a href="#cb21-591" aria-hidden="true" tabindex="-1"></a>    global_matrix,</span>
<span id="cb21-592"><a href="#cb21-592" aria-hidden="true" tabindex="-1"></a>    n_components<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb21-593"><a href="#cb21-593" aria-hidden="true" tabindex="-1"></a>    rolling_window<span class="op">=</span><span class="dv">36</span></span>
<span id="cb21-594"><a href="#cb21-594" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-595"><a href="#cb21-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-596"><a href="#cb21-596" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(pr_result) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-597"><a href="#cb21-597" aria-hidden="true" tabindex="-1"></a>    pr_result[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(pr_result[<span class="st">'date'</span>])</span>
<span id="cb21-598"><a href="#cb21-598" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Pukthuanthong-Roll Integration (R²):"</span>)</span>
<span id="cb21-599"><a href="#cb21-599" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Mean: </span><span class="sc">{</span>pr_result[<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-600"><a href="#cb21-600" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  2008-2012: </span><span class="sc">{</span>pr_result[(pr_result[<span class="st">'date'</span>] <span class="op">&gt;=</span> <span class="st">'2008'</span>) <span class="op">&amp;</span> (pr_result[<span class="st">'date'</span>] <span class="op">&lt;</span> <span class="st">'2013'</span>)][<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-601"><a href="#cb21-601" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  2013-2018: </span><span class="sc">{</span>pr_result[(pr_result[<span class="st">'date'</span>] <span class="op">&gt;=</span> <span class="st">'2013'</span>) <span class="op">&amp;</span> (pr_result[<span class="st">'date'</span>] <span class="op">&lt;</span> <span class="st">'2019'</span>)][<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-602"><a href="#cb21-602" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  2019-2024: </span><span class="sc">{</span>pr_result[pr_result[<span class="st">'date'</span>] <span class="op">&gt;=</span> <span class="st">'2019'</span>][<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-603"><a href="#cb21-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-604"><a href="#cb21-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-605"><a href="#cb21-605" aria-hidden="true" tabindex="-1"></a><span class="fu">### Global vs. Local Factor Pricing</span></span>
<span id="cb21-606"><a href="#cb21-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-607"><a href="#cb21-607" aria-hidden="true" tabindex="-1"></a>@griffin2002fama tests whether global or local versions of the Fama-French factors better explain country-level returns. We implement this horse race for Vietnam:</span>
<span id="cb21-608"><a href="#cb21-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-611"><a href="#cb21-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-612"><a href="#cb21-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: global-vs-local</span></span>
<span id="cb21-613"><a href="#cb21-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-614"><a href="#cb21-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Compare explanatory power of global vs local factor models"</span></span>
<span id="cb21-615"><a href="#cb21-615" aria-hidden="true" tabindex="-1"></a><span class="co"># Align global and local factors</span></span>
<span id="cb21-616"><a href="#cb21-616" aria-hidden="true" tabindex="-1"></a>common_factor_dates <span class="op">=</span> (</span>
<span id="cb21-617"><a href="#cb21-617" aria-hidden="true" tabindex="-1"></a>    global_factors.index</span>
<span id="cb21-618"><a href="#cb21-618" aria-hidden="true" tabindex="-1"></a>    .intersection(local_factors.index)</span>
<span id="cb21-619"><a href="#cb21-619" aria-hidden="true" tabindex="-1"></a>    .intersection(vn_index.index)</span>
<span id="cb21-620"><a href="#cb21-620" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-621"><a href="#cb21-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-622"><a href="#cb21-622" aria-hidden="true" tabindex="-1"></a>vn_excess <span class="op">=</span> vn_index.loc[common_factor_dates, <span class="st">'return'</span>]</span>
<span id="cb21-623"><a href="#cb21-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-624"><a href="#cb21-624" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Global FF5</span></span>
<span id="cb21-625"><a href="#cb21-625" aria-hidden="true" tabindex="-1"></a>X_global <span class="op">=</span> sm.add_constant(</span>
<span id="cb21-626"><a href="#cb21-626" aria-hidden="true" tabindex="-1"></a>    global_factors.loc[common_factor_dates,</span>
<span id="cb21-627"><a href="#cb21-627" aria-hidden="true" tabindex="-1"></a>                        [<span class="st">'mkt_excess_world'</span>, <span class="st">'smb_world'</span>, <span class="st">'hml_world'</span>,</span>
<span id="cb21-628"><a href="#cb21-628" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'rmw_world'</span>, <span class="st">'cma_world'</span>]]</span>
<span id="cb21-629"><a href="#cb21-629" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-630"><a href="#cb21-630" aria-hidden="true" tabindex="-1"></a>model_global <span class="op">=</span> sm.OLS(vn_excess, X_global).fit(</span>
<span id="cb21-631"><a href="#cb21-631" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">6</span>}</span>
<span id="cb21-632"><a href="#cb21-632" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-633"><a href="#cb21-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-634"><a href="#cb21-634" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Local FF5</span></span>
<span id="cb21-635"><a href="#cb21-635" aria-hidden="true" tabindex="-1"></a>X_local <span class="op">=</span> sm.add_constant(</span>
<span id="cb21-636"><a href="#cb21-636" aria-hidden="true" tabindex="-1"></a>    local_factors.loc[common_factor_dates,</span>
<span id="cb21-637"><a href="#cb21-637" aria-hidden="true" tabindex="-1"></a>                       [<span class="st">'mkt_excess'</span>, <span class="st">'smb'</span>, <span class="st">'hml'</span>, <span class="st">'rmw'</span>, <span class="st">'cma'</span>]]</span>
<span id="cb21-638"><a href="#cb21-638" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-639"><a href="#cb21-639" aria-hidden="true" tabindex="-1"></a>model_local <span class="op">=</span> sm.OLS(vn_excess, X_local).fit(</span>
<span id="cb21-640"><a href="#cb21-640" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">6</span>}</span>
<span id="cb21-641"><a href="#cb21-641" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-642"><a href="#cb21-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-643"><a href="#cb21-643" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3: Both global and local</span></span>
<span id="cb21-644"><a href="#cb21-644" aria-hidden="true" tabindex="-1"></a>X_both <span class="op">=</span> sm.add_constant(pd.concat([</span>
<span id="cb21-645"><a href="#cb21-645" aria-hidden="true" tabindex="-1"></a>    global_factors.loc[common_factor_dates,</span>
<span id="cb21-646"><a href="#cb21-646" aria-hidden="true" tabindex="-1"></a>                        [<span class="st">'mkt_excess_world'</span>, <span class="st">'smb_world'</span>, <span class="st">'hml_world'</span>]],</span>
<span id="cb21-647"><a href="#cb21-647" aria-hidden="true" tabindex="-1"></a>    local_factors.loc[common_factor_dates,</span>
<span id="cb21-648"><a href="#cb21-648" aria-hidden="true" tabindex="-1"></a>                       [<span class="st">'mkt_excess'</span>, <span class="st">'smb'</span>, <span class="st">'hml'</span>]]</span>
<span id="cb21-649"><a href="#cb21-649" aria-hidden="true" tabindex="-1"></a>], axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb21-650"><a href="#cb21-650" aria-hidden="true" tabindex="-1"></a>model_both <span class="op">=</span> sm.OLS(vn_excess, X_both).fit(</span>
<span id="cb21-651"><a href="#cb21-651" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">6</span>}</span>
<span id="cb21-652"><a href="#cb21-652" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-653"><a href="#cb21-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-654"><a href="#cb21-654" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Global vs Local Factor Models for VN-Index:"</span>)</span>
<span id="cb21-655"><a href="#cb21-655" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Model'</span><span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'R²'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Adj R²'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'α (ann)'</span><span class="sc">:&gt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'α t-stat'</span><span class="sc">:&gt;10}</span><span class="ss">"</span>)</span>
<span id="cb21-656"><a href="#cb21-656" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">56</span>)</span>
<span id="cb21-657"><a href="#cb21-657" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, mod <span class="kw">in</span> [(<span class="st">'Global FF5'</span>, model_global),</span>
<span id="cb21-658"><a href="#cb21-658" aria-hidden="true" tabindex="-1"></a>                    (<span class="st">'Local FF5'</span>, model_local),</span>
<span id="cb21-659"><a href="#cb21-659" aria-hidden="true" tabindex="-1"></a>                    (<span class="st">'Global + Local'</span>, model_both)]:</span>
<span id="cb21-660"><a href="#cb21-660" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">:&lt;20}</span><span class="ss"> </span><span class="sc">{</span>mod<span class="sc">.</span>rsquared<span class="sc">:&gt;8.3f}</span><span class="ss"> </span><span class="sc">{</span>mod<span class="sc">.</span>rsquared_adj<span class="sc">:&gt;8.3f}</span><span class="ss"> "</span></span>
<span id="cb21-661"><a href="#cb21-661" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>mod<span class="sc">.</span>params[<span class="st">'const'</span>]<span class="op">*</span><span class="dv">12</span><span class="sc">:&gt;10.4f}</span><span class="ss"> </span><span class="sc">{</span>mod<span class="sc">.</span>tvalues[<span class="st">'const'</span>]<span class="sc">:&gt;10.2f}</span><span class="ss">"</span>)</span>
<span id="cb21-662"><a href="#cb21-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-663"><a href="#cb21-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-666"><a href="#cb21-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-667"><a href="#cb21-667" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-global-local-r2</span></span>
<span id="cb21-668"><a href="#cb21-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-669"><a href="#cb21-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Rolling 36-month R² from regressing Vietnamese market excess returns on global factors (MSCI World FF5) versus local factors (Vietnamese FF5). Panel A shows the R² time series for each model. When the local model dominates (higher R²), the market is more segmented; when the global model's R² approaches the local model's, the market is more integrated. Panel B shows the ratio of global R² to local R², which serves as an alternative integration metric."</span></span>
<span id="cb21-670"><a href="#cb21-670" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Rolling R² comparison of global and local models"</span></span>
<span id="cb21-671"><a href="#cb21-671" aria-hidden="true" tabindex="-1"></a>rolling_r2 <span class="op">=</span> []</span>
<span id="cb21-672"><a href="#cb21-672" aria-hidden="true" tabindex="-1"></a>rw <span class="op">=</span> <span class="dv">36</span></span>
<span id="cb21-673"><a href="#cb21-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-674"><a href="#cb21-674" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(rw, <span class="bu">len</span>(common_factor_dates)):</span>
<span id="cb21-675"><a href="#cb21-675" aria-hidden="true" tabindex="-1"></a>    window <span class="op">=</span> common_factor_dates[t <span class="op">-</span> rw:t]</span>
<span id="cb21-676"><a href="#cb21-676" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> vn_excess[window]</span>
<span id="cb21-677"><a href="#cb21-677" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-678"><a href="#cb21-678" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Global</span></span>
<span id="cb21-679"><a href="#cb21-679" aria-hidden="true" tabindex="-1"></a>    X_g <span class="op">=</span> sm.add_constant(global_factors.loc[window,</span>
<span id="cb21-680"><a href="#cb21-680" aria-hidden="true" tabindex="-1"></a>                           [<span class="st">'mkt_excess_world'</span>, <span class="st">'smb_world'</span>, <span class="st">'hml_world'</span>,</span>
<span id="cb21-681"><a href="#cb21-681" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'rmw_world'</span>, <span class="st">'cma_world'</span>]])</span>
<span id="cb21-682"><a href="#cb21-682" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb21-683"><a href="#cb21-683" aria-hidden="true" tabindex="-1"></a>        r2_g <span class="op">=</span> sm.OLS(y, X_g).fit().rsquared</span>
<span id="cb21-684"><a href="#cb21-684" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb21-685"><a href="#cb21-685" aria-hidden="true" tabindex="-1"></a>        r2_g <span class="op">=</span> np.nan</span>
<span id="cb21-686"><a href="#cb21-686" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-687"><a href="#cb21-687" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Local</span></span>
<span id="cb21-688"><a href="#cb21-688" aria-hidden="true" tabindex="-1"></a>    X_l <span class="op">=</span> sm.add_constant(local_factors.loc[window,</span>
<span id="cb21-689"><a href="#cb21-689" aria-hidden="true" tabindex="-1"></a>                           [<span class="st">'mkt_excess'</span>, <span class="st">'smb'</span>, <span class="st">'hml'</span>, <span class="st">'rmw'</span>, <span class="st">'cma'</span>]])</span>
<span id="cb21-690"><a href="#cb21-690" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb21-691"><a href="#cb21-691" aria-hidden="true" tabindex="-1"></a>        r2_l <span class="op">=</span> sm.OLS(y, X_l).fit().rsquared</span>
<span id="cb21-692"><a href="#cb21-692" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb21-693"><a href="#cb21-693" aria-hidden="true" tabindex="-1"></a>        r2_l <span class="op">=</span> np.nan</span>
<span id="cb21-694"><a href="#cb21-694" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-695"><a href="#cb21-695" aria-hidden="true" tabindex="-1"></a>    rolling_r2.append({</span>
<span id="cb21-696"><a href="#cb21-696" aria-hidden="true" tabindex="-1"></a>        <span class="st">'date'</span>: common_factor_dates[t],</span>
<span id="cb21-697"><a href="#cb21-697" aria-hidden="true" tabindex="-1"></a>        <span class="st">'r2_global'</span>: r2_g,</span>
<span id="cb21-698"><a href="#cb21-698" aria-hidden="true" tabindex="-1"></a>        <span class="st">'r2_local'</span>: r2_l,</span>
<span id="cb21-699"><a href="#cb21-699" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ratio'</span>: r2_g <span class="op">/</span> r2_l <span class="cf">if</span> r2_l <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.nan</span>
<span id="cb21-700"><a href="#cb21-700" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb21-701"><a href="#cb21-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-702"><a href="#cb21-702" aria-hidden="true" tabindex="-1"></a>r2_df <span class="op">=</span> pd.DataFrame(rolling_r2)</span>
<span id="cb21-703"><a href="#cb21-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-704"><a href="#cb21-704" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-705"><a href="#cb21-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-706"><a href="#cb21-706" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(r2_df[<span class="st">'date'</span>], r2_df[<span class="st">'r2_global'</span>], color<span class="op">=</span><span class="st">'#2C5F8A'</span>,</span>
<span id="cb21-707"><a href="#cb21-707" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="st">'Global FF5'</span>)</span>
<span id="cb21-708"><a href="#cb21-708" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(r2_df[<span class="st">'date'</span>], r2_df[<span class="st">'r2_local'</span>], color<span class="op">=</span><span class="st">'#C0392B'</span>,</span>
<span id="cb21-709"><a href="#cb21-709" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="st">'Local FF5'</span>)</span>
<span id="cb21-710"><a href="#cb21-710" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'R²'</span>)</span>
<span id="cb21-711"><a href="#cb21-711" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Panel A: Global vs Local Factor R²'</span>)</span>
<span id="cb21-712"><a href="#cb21-712" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb21-713"><a href="#cb21-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-714"><a href="#cb21-714" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(r2_df[<span class="st">'date'</span>], r2_df[<span class="st">'ratio'</span>], color<span class="op">=</span><span class="st">'#27AE60'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb21-715"><a href="#cb21-715" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axhline(y<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'gray'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb21-716"><a href="#cb21-716" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'Full integration (ratio = 1)'</span>)</span>
<span id="cb21-717"><a href="#cb21-717" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Global R² / Local R²'</span>)</span>
<span id="cb21-718"><a href="#cb21-718" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Panel B: Integration Ratio'</span>)</span>
<span id="cb21-719"><a href="#cb21-719" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend()</span>
<span id="cb21-720"><a href="#cb21-720" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylim([<span class="dv">0</span>, <span class="fl">1.5</span>])</span>
<span id="cb21-721"><a href="#cb21-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-722"><a href="#cb21-722" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-723"><a href="#cb21-723" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-724"><a href="#cb21-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-725"><a href="#cb21-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-726"><a href="#cb21-726" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pricing-Error-Based Integration {#sec-market-integration-pricing-error}</span></span>
<span id="cb21-727"><a href="#cb21-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-728"><a href="#cb21-728" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Bekaert-Harvey Approach</span></span>
<span id="cb21-729"><a href="#cb21-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-730"><a href="#cb21-730" aria-hidden="true" tabindex="-1"></a>@bekaert1995time measure integration as the ability of a global CAPM to price local assets. Under integration, the local market alpha (intercept) in a regression on the global market should be zero, and the global risk premium should explain the local expected return. Under segmentation, the local alpha captures the segmentation premium.</span>
<span id="cb21-731"><a href="#cb21-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-734"><a href="#cb21-734" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-735"><a href="#cb21-735" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: bh-integration</span></span>
<span id="cb21-736"><a href="#cb21-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-737"><a href="#cb21-737" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Bekaert-Harvey integration measure: rolling alpha from global CAPM"</span></span>
<span id="cb21-738"><a href="#cb21-738" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bekaert_harvey_integration(local_return, global_return,</span>
<span id="cb21-739"><a href="#cb21-739" aria-hidden="true" tabindex="-1"></a>                                 rolling_window<span class="op">=</span><span class="dv">36</span>):</span>
<span id="cb21-740"><a href="#cb21-740" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb21-741"><a href="#cb21-741" aria-hidden="true" tabindex="-1"></a><span class="co">    Rolling alpha from regressing local on global market.</span></span>
<span id="cb21-742"><a href="#cb21-742" aria-hidden="true" tabindex="-1"></a><span class="co">    Under integration, alpha -&gt; 0.</span></span>
<span id="cb21-743"><a href="#cb21-743" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-744"><a href="#cb21-744" aria-hidden="true" tabindex="-1"></a>    common <span class="op">=</span> local_return.dropna().index.intersection(global_return.dropna().index)</span>
<span id="cb21-745"><a href="#cb21-745" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-746"><a href="#cb21-746" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb21-747"><a href="#cb21-747" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(rolling_window, <span class="bu">len</span>(common)):</span>
<span id="cb21-748"><a href="#cb21-748" aria-hidden="true" tabindex="-1"></a>        window <span class="op">=</span> common[t <span class="op">-</span> rolling_window:t]</span>
<span id="cb21-749"><a href="#cb21-749" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> local_return[window]</span>
<span id="cb21-750"><a href="#cb21-750" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> sm.add_constant(global_return[window])</span>
<span id="cb21-751"><a href="#cb21-751" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-752"><a href="#cb21-752" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb21-753"><a href="#cb21-753" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-754"><a href="#cb21-754" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb21-755"><a href="#cb21-755" aria-hidden="true" tabindex="-1"></a>            <span class="st">'date'</span>: common[t],</span>
<span id="cb21-756"><a href="#cb21-756" aria-hidden="true" tabindex="-1"></a>            <span class="st">'alpha'</span>: model.params[<span class="st">'const'</span>],</span>
<span id="cb21-757"><a href="#cb21-757" aria-hidden="true" tabindex="-1"></a>            <span class="st">'alpha_t'</span>: model.tvalues[<span class="st">'const'</span>],</span>
<span id="cb21-758"><a href="#cb21-758" aria-hidden="true" tabindex="-1"></a>            <span class="st">'beta_global'</span>: model.params.iloc[<span class="dv">1</span>],</span>
<span id="cb21-759"><a href="#cb21-759" aria-hidden="true" tabindex="-1"></a>            <span class="st">'r_squared'</span>: model.rsquared</span>
<span id="cb21-760"><a href="#cb21-760" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb21-761"><a href="#cb21-761" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-762"><a href="#cb21-762" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(results)</span>
<span id="cb21-763"><a href="#cb21-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-764"><a href="#cb21-764" aria-hidden="true" tabindex="-1"></a>bh_result <span class="op">=</span> bekaert_harvey_integration(</span>
<span id="cb21-765"><a href="#cb21-765" aria-hidden="true" tabindex="-1"></a>    indices_aligned[<span class="st">'VIETNAM'</span>],</span>
<span id="cb21-766"><a href="#cb21-766" aria-hidden="true" tabindex="-1"></a>    indices_aligned[<span class="st">'MSCI_WORLD'</span>],</span>
<span id="cb21-767"><a href="#cb21-767" aria-hidden="true" tabindex="-1"></a>    rolling_window<span class="op">=</span><span class="dv">36</span></span>
<span id="cb21-768"><a href="#cb21-768" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-769"><a href="#cb21-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-770"><a href="#cb21-770" aria-hidden="true" tabindex="-1"></a><span class="co"># The absolute alpha is the segmentation premium</span></span>
<span id="cb21-771"><a href="#cb21-771" aria-hidden="true" tabindex="-1"></a>bh_result[<span class="st">'abs_alpha_ann'</span>] <span class="op">=</span> bh_result[<span class="st">'alpha'</span>].<span class="bu">abs</span>() <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb21-772"><a href="#cb21-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-773"><a href="#cb21-773" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Bekaert-Harvey Integration Diagnostic:"</span>)</span>
<span id="cb21-774"><a href="#cb21-774" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean |α| (ann.): </span><span class="sc">{</span>bh_result[<span class="st">'abs_alpha_ann'</span>]<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb21-775"><a href="#cb21-775" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean β_world: </span><span class="sc">{</span>bh_result[<span class="st">'beta_global'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-776"><a href="#cb21-776" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean R²: </span><span class="sc">{</span>bh_result[<span class="st">'r_squared'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-777"><a href="#cb21-777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-778"><a href="#cb21-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-779"><a href="#cb21-779" aria-hidden="true" tabindex="-1"></a><span class="fu">### Composite Integration Index</span></span>
<span id="cb21-780"><a href="#cb21-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-781"><a href="#cb21-781" aria-hidden="true" tabindex="-1"></a>We combine all measures into a single composite index of Vietnamese market integration:</span>
<span id="cb21-782"><a href="#cb21-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-785"><a href="#cb21-785" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-786"><a href="#cb21-786" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: composite-index</span></span>
<span id="cb21-787"><a href="#cb21-787" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-788"><a href="#cb21-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Construct a composite integration index"</span></span>
<span id="cb21-789"><a href="#cb21-789" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize each measure to [0, 1] using historical percentile ranks</span></span>
<span id="cb21-790"><a href="#cb21-790" aria-hidden="true" tabindex="-1"></a>measures <span class="op">=</span> pd.DataFrame(index<span class="op">=</span>bh_result[<span class="st">'date'</span>])</span>
<span id="cb21-791"><a href="#cb21-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-792"><a href="#cb21-792" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. DCC correlation (higher = more integrated)</span></span>
<span id="cb21-793"><a href="#cb21-793" aria-hidden="true" tabindex="-1"></a>dcc_aligned <span class="op">=</span> dcc_result[<span class="st">'dcc_corr'</span>].reindex(measures.index).interpolate()</span>
<span id="cb21-794"><a href="#cb21-794" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'dcc_corr'</span>] <span class="op">=</span> dcc_aligned</span>
<span id="cb21-795"><a href="#cb21-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-796"><a href="#cb21-796" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. PR R² (higher = more integrated)</span></span>
<span id="cb21-797"><a href="#cb21-797" aria-hidden="true" tabindex="-1"></a>pr_aligned <span class="op">=</span> pr_result.set_index(<span class="st">'date'</span>)[<span class="st">'r_squared'</span>].reindex(measures.index).interpolate()</span>
<span id="cb21-798"><a href="#cb21-798" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'pr_r2'</span>] <span class="op">=</span> pr_aligned</span>
<span id="cb21-799"><a href="#cb21-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-800"><a href="#cb21-800" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Global/Local R² ratio (higher = more integrated)</span></span>
<span id="cb21-801"><a href="#cb21-801" aria-hidden="true" tabindex="-1"></a>r2_aligned <span class="op">=</span> r2_df.set_index(<span class="st">'date'</span>)[<span class="st">'ratio'</span>].reindex(measures.index).interpolate()</span>
<span id="cb21-802"><a href="#cb21-802" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'gl_ratio'</span>] <span class="op">=</span> r2_aligned</span>
<span id="cb21-803"><a href="#cb21-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-804"><a href="#cb21-804" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. |Alpha| from global CAPM (lower = more integrated)</span></span>
<span id="cb21-805"><a href="#cb21-805" aria-hidden="true" tabindex="-1"></a><span class="co"># Invert: 1 - percentile rank of |alpha|</span></span>
<span id="cb21-806"><a href="#cb21-806" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'inv_alpha'</span>] <span class="op">=</span> bh_result.set_index(<span class="st">'date'</span>)[<span class="st">'abs_alpha_ann'</span>]</span>
<span id="cb21-807"><a href="#cb21-807" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'inv_alpha'</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> measures[<span class="st">'inv_alpha'</span>].rank(pct<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-808"><a href="#cb21-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-809"><a href="#cb21-809" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Global beta (higher = more integrated, up to a point)</span></span>
<span id="cb21-810"><a href="#cb21-810" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'global_beta'</span>] <span class="op">=</span> bh_result.set_index(<span class="st">'date'</span>)[<span class="st">'beta_global'</span>]</span>
<span id="cb21-811"><a href="#cb21-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-812"><a href="#cb21-812" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize to percentile ranks</span></span>
<span id="cb21-813"><a href="#cb21-813" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">'dcc_corr'</span>, <span class="st">'pr_r2'</span>, <span class="st">'gl_ratio'</span>, <span class="st">'inv_alpha'</span>, <span class="st">'global_beta'</span>]:</span>
<span id="cb21-814"><a href="#cb21-814" aria-hidden="true" tabindex="-1"></a>    measures[<span class="ss">f'</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">_rank'</span>] <span class="op">=</span> measures[col].rank(pct<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-815"><a href="#cb21-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-816"><a href="#cb21-816" aria-hidden="true" tabindex="-1"></a><span class="co"># Composite = equal-weighted average of ranks</span></span>
<span id="cb21-817"><a href="#cb21-817" aria-hidden="true" tabindex="-1"></a>rank_cols <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> measures.columns <span class="cf">if</span> c.endswith(<span class="st">'_rank'</span>)]</span>
<span id="cb21-818"><a href="#cb21-818" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'composite'</span>] <span class="op">=</span> measures[rank_cols].mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-819"><a href="#cb21-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-820"><a href="#cb21-820" aria-hidden="true" tabindex="-1"></a><span class="co"># Smooth with 6-month moving average</span></span>
<span id="cb21-821"><a href="#cb21-821" aria-hidden="true" tabindex="-1"></a>measures[<span class="st">'composite_smooth'</span>] <span class="op">=</span> measures[<span class="st">'composite'</span>].rolling(<span class="dv">6</span>).mean()</span>
<span id="cb21-822"><a href="#cb21-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-823"><a href="#cb21-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-826"><a href="#cb21-826" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-827"><a href="#cb21-827" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-composite</span></span>
<span id="cb21-828"><a href="#cb21-828" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-829"><a href="#cb21-829" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Composite integration index for the Vietnamese equity market, combining DCC correlation, Pukthuanthong-Roll R², global/local factor R² ratio, and global CAPM alpha. The index is scaled to [0, 1] where 1 represents maximum observed integration. Vietnam has followed a broad upward trend with significant setbacks during the GFC (2008–2009) and COVID (2020). The post-2018 period shows the highest sustained integration, coinciding with FTSE inclusion and relaxed foreign ownership limits."</span></span>
<span id="cb21-830"><a href="#cb21-830" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot the composite integration index with milestones"</span></span>
<span id="cb21-831"><a href="#cb21-831" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb21-832"><a href="#cb21-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-833"><a href="#cb21-833" aria-hidden="true" tabindex="-1"></a>ax.fill_between(measures.index, measures[<span class="st">'composite_smooth'</span>],</span>
<span id="cb21-834"><a href="#cb21-834" aria-hidden="true" tabindex="-1"></a>                 alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'#2C5F8A'</span>)</span>
<span id="cb21-835"><a href="#cb21-835" aria-hidden="true" tabindex="-1"></a>ax.plot(measures.index, measures[<span class="st">'composite_smooth'</span>],</span>
<span id="cb21-836"><a href="#cb21-836" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'#2C5F8A'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb21-837"><a href="#cb21-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-838"><a href="#cb21-838" aria-hidden="true" tabindex="-1"></a><span class="co"># Add event markers</span></span>
<span id="cb21-839"><a href="#cb21-839" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, event <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb21-840"><a href="#cb21-840" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> event[<span class="st">'date'</span>] <span class="op">&gt;=</span> measures.index.<span class="bu">min</span>():</span>
<span id="cb21-841"><a href="#cb21-841" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> event_colors.get(event[<span class="st">'category'</span>], <span class="st">'gray'</span>)</span>
<span id="cb21-842"><a href="#cb21-842" aria-hidden="true" tabindex="-1"></a>        ax.axvline(x<span class="op">=</span>event[<span class="st">'date'</span>], color<span class="op">=</span>color,</span>
<span id="cb21-843"><a href="#cb21-843" aria-hidden="true" tabindex="-1"></a>                   linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb21-844"><a href="#cb21-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-845"><a href="#cb21-845" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Integration Index (0 = segmented, 1 = integrated)'</span>)</span>
<span id="cb21-846"><a href="#cb21-846" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Vietnam Equity Market Integration: Composite Index'</span>)</span>
<span id="cb21-847"><a href="#cb21-847" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb21-848"><a href="#cb21-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-849"><a href="#cb21-849" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend for event categories</span></span>
<span id="cb21-850"><a href="#cb21-850" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Patch</span>
<span id="cb21-851"><a href="#cb21-851" aria-hidden="true" tabindex="-1"></a>legend_patches <span class="op">=</span> [Patch(facecolor<span class="op">=</span>c, label<span class="op">=</span>cat)</span>
<span id="cb21-852"><a href="#cb21-852" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">for</span> cat, c <span class="kw">in</span> event_colors.items() <span class="cf">if</span> cat <span class="kw">in</span></span>
<span id="cb21-853"><a href="#cb21-853" aria-hidden="true" tabindex="-1"></a>                   liberalization_events[<span class="st">'category'</span>].values]</span>
<span id="cb21-854"><a href="#cb21-854" aria-hidden="true" tabindex="-1"></a>ax.legend(handles<span class="op">=</span>legend_patches, fontsize<span class="op">=</span><span class="dv">7</span>, loc<span class="op">=</span><span class="st">'lower right'</span>, ncol<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb21-855"><a href="#cb21-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-856"><a href="#cb21-856" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-857"><a href="#cb21-857" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-858"><a href="#cb21-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-859"><a href="#cb21-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-860"><a href="#cb21-860" aria-hidden="true" tabindex="-1"></a><span class="fu">## Structural Break Detection {#sec-market-integration-breaks}</span></span>
<span id="cb21-861"><a href="#cb21-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-862"><a href="#cb21-862" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bai-Perron Tests for Integration Regime Shifts</span></span>
<span id="cb21-863"><a href="#cb21-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-864"><a href="#cb21-864" aria-hidden="true" tabindex="-1"></a>We test whether Vietnam's integration trajectory contains discrete structural breaks (i.e., sudden shifts in the integration level) rather than a smooth trend:</span>
<span id="cb21-865"><a href="#cb21-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-868"><a href="#cb21-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-869"><a href="#cb21-869" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: structural-breaks</span></span>
<span id="cb21-870"><a href="#cb21-870" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-871"><a href="#cb21-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Detect structural breaks in the integration time series"</span></span>
<span id="cb21-872"><a href="#cb21-872" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_breaks_cusum(series, significance<span class="op">=</span><span class="fl">0.05</span>):</span>
<span id="cb21-873"><a href="#cb21-873" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb21-874"><a href="#cb21-874" aria-hidden="true" tabindex="-1"></a><span class="co">    CUSUM-based structural break detection.</span></span>
<span id="cb21-875"><a href="#cb21-875" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-876"><a href="#cb21-876" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> series.dropna().values</span>
<span id="cb21-877"><a href="#cb21-877" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb21-878"><a href="#cb21-878" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-879"><a href="#cb21-879" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recursive residuals from rolling mean</span></span>
<span id="cb21-880"><a href="#cb21-880" aria-hidden="true" tabindex="-1"></a>    cumsum <span class="op">=</span> np.cumsum(y <span class="op">-</span> y.mean()) <span class="op">/</span> (y.std() <span class="op">*</span> np.sqrt(T))</span>
<span id="cb21-881"><a href="#cb21-881" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-882"><a href="#cb21-882" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Brown-Durbin-Evans critical values (approximate)</span></span>
<span id="cb21-883"><a href="#cb21-883" aria-hidden="true" tabindex="-1"></a>    <span class="co"># At 5%: ±0.948</span></span>
<span id="cb21-884"><a href="#cb21-884" aria-hidden="true" tabindex="-1"></a>    critical <span class="op">=</span> <span class="fl">0.948</span></span>
<span id="cb21-885"><a href="#cb21-885" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-886"><a href="#cb21-886" aria-hidden="true" tabindex="-1"></a>    breaks <span class="op">=</span> []</span>
<span id="cb21-887"><a href="#cb21-887" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, T <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb21-888"><a href="#cb21-888" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(cumsum[t]) <span class="op">&gt;</span> critical:</span>
<span id="cb21-889"><a href="#cb21-889" aria-hidden="true" tabindex="-1"></a>            breaks.append(t)</span>
<span id="cb21-890"><a href="#cb21-890" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-891"><a href="#cb21-891" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cumsum, breaks</span>
<span id="cb21-892"><a href="#cb21-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-893"><a href="#cb21-893" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to composite index</span></span>
<span id="cb21-894"><a href="#cb21-894" aria-hidden="true" tabindex="-1"></a>composite_clean <span class="op">=</span> measures[<span class="st">'composite_smooth'</span>].dropna()</span>
<span id="cb21-895"><a href="#cb21-895" aria-hidden="true" tabindex="-1"></a>cusum, break_points <span class="op">=</span> detect_breaks_cusum(composite_clean)</span>
<span id="cb21-896"><a href="#cb21-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-897"><a href="#cb21-897" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: Chow test at key liberalization dates</span></span>
<span id="cb21-898"><a href="#cb21-898" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chow_test(y, breakpoint_idx):</span>
<span id="cb21-899"><a href="#cb21-899" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Simple Chow test for structural break."""</span></span>
<span id="cb21-900"><a href="#cb21-900" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb21-901"><a href="#cb21-901" aria-hidden="true" tabindex="-1"></a>    y1 <span class="op">=</span> y[:breakpoint_idx]</span>
<span id="cb21-902"><a href="#cb21-902" aria-hidden="true" tabindex="-1"></a>    y2 <span class="op">=</span> y[breakpoint_idx:]</span>
<span id="cb21-903"><a href="#cb21-903" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-904"><a href="#cb21-904" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Full sample regression (on constant)</span></span>
<span id="cb21-905"><a href="#cb21-905" aria-hidden="true" tabindex="-1"></a>    rss_full <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y.mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb21-906"><a href="#cb21-906" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-907"><a href="#cb21-907" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split samples</span></span>
<span id="cb21-908"><a href="#cb21-908" aria-hidden="true" tabindex="-1"></a>    rss1 <span class="op">=</span> np.<span class="bu">sum</span>((y1 <span class="op">-</span> y1.mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb21-909"><a href="#cb21-909" aria-hidden="true" tabindex="-1"></a>    rss2 <span class="op">=</span> np.<span class="bu">sum</span>((y2 <span class="op">-</span> y2.mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb21-910"><a href="#cb21-910" aria-hidden="true" tabindex="-1"></a>    rss_split <span class="op">=</span> rss1 <span class="op">+</span> rss2</span>
<span id="cb21-911"><a href="#cb21-911" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-912"><a href="#cb21-912" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> <span class="dv">1</span>  <span class="co"># Number of parameters</span></span>
<span id="cb21-913"><a href="#cb21-913" aria-hidden="true" tabindex="-1"></a>    f_stat <span class="op">=</span> ((rss_full <span class="op">-</span> rss_split) <span class="op">/</span> k) <span class="op">/</span> (rss_split <span class="op">/</span> (T <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> k))</span>
<span id="cb21-914"><a href="#cb21-914" aria-hidden="true" tabindex="-1"></a>    p_val <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> stats.f.cdf(f_stat, k, T <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> k)</span>
<span id="cb21-915"><a href="#cb21-915" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-916"><a href="#cb21-916" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f_stat, p_val</span>
<span id="cb21-917"><a href="#cb21-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-918"><a href="#cb21-918" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Chow Tests for Structural Breaks at Key Dates:"</span>)</span>
<span id="cb21-919"><a href="#cb21-919" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Event'</span><span class="sc">:&lt;30}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Date'</span><span class="sc">:&gt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'F-stat'</span><span class="sc">:&gt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'p-value'</span><span class="sc">:&gt;10}</span><span class="ss">"</span>)</span>
<span id="cb21-920"><a href="#cb21-920" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">62</span>)</span>
<span id="cb21-921"><a href="#cb21-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-922"><a href="#cb21-922" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, event <span class="kw">in</span> liberalization_events.iterrows():</span>
<span id="cb21-923"><a href="#cb21-923" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> event[<span class="st">'date'</span>] <span class="op">&lt;</span> composite_clean.index.<span class="bu">min</span>():</span>
<span id="cb21-924"><a href="#cb21-924" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb21-925"><a href="#cb21-925" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find nearest date</span></span>
<span id="cb21-926"><a href="#cb21-926" aria-hidden="true" tabindex="-1"></a>    nearest <span class="op">=</span> composite_clean.index.searchsorted(event[<span class="st">'date'</span>])</span>
<span id="cb21-927"><a href="#cb21-927" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> nearest <span class="op">&lt;</span> <span class="dv">12</span> <span class="kw">or</span> nearest <span class="op">&gt;</span> <span class="bu">len</span>(composite_clean) <span class="op">-</span> <span class="dv">12</span>:</span>
<span id="cb21-928"><a href="#cb21-928" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb21-929"><a href="#cb21-929" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-930"><a href="#cb21-930" aria-hidden="true" tabindex="-1"></a>    f_stat, p_val <span class="op">=</span> chow_test(composite_clean.values, nearest)</span>
<span id="cb21-931"><a href="#cb21-931" aria-hidden="true" tabindex="-1"></a>    sig <span class="op">=</span> <span class="st">'***'</span> <span class="cf">if</span> p_val <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="st">'**'</span> <span class="cf">if</span> p_val <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'*'</span> <span class="cf">if</span> p_val <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb21-932"><a href="#cb21-932" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>event[<span class="st">'event'</span>]<span class="sc">:&lt;30}</span><span class="ss"> </span><span class="sc">{</span>event[<span class="st">'date'</span>]<span class="sc">.</span>strftime(<span class="st">'%Y-%m'</span>)<span class="sc">:&gt;12}</span><span class="ss"> "</span></span>
<span id="cb21-933"><a href="#cb21-933" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>f_stat<span class="sc">:&gt;10.2f}</span><span class="ss"> </span><span class="sc">{</span>p_val<span class="sc">:&gt;10.4f}</span><span class="ss"> </span><span class="sc">{</span>sig<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-934"><a href="#cb21-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-935"><a href="#cb21-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-936"><a href="#cb21-936" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Segmentation Premium for Vietnam {#sec-market-integration-premium}</span></span>
<span id="cb21-937"><a href="#cb21-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-938"><a href="#cb21-938" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cross-Sectional Evidence</span></span>
<span id="cb21-939"><a href="#cb21-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-940"><a href="#cb21-940" aria-hidden="true" tabindex="-1"></a>Under partial segmentation, stocks with higher foreign ownership should have lower expected returns (because foreign investors can diversify away local risk). This yields a testable prediction: foreign ownership should be negatively associated with expected returns, controlling for global risk exposure.</span>
<span id="cb21-941"><a href="#cb21-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-944"><a href="#cb21-944" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-945"><a href="#cb21-945" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: segmentation-premium</span></span>
<span id="cb21-946"><a href="#cb21-946" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-947"><a href="#cb21-947" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Estimate the cross-sectional segmentation premium"</span></span>
<span id="cb21-948"><a href="#cb21-948" aria-hidden="true" tabindex="-1"></a><span class="co"># Get monthly stock returns with foreign ownership</span></span>
<span id="cb21-949"><a href="#cb21-949" aria-hidden="true" tabindex="-1"></a>stock_data <span class="op">=</span> client.get_monthly_returns(</span>
<span id="cb21-950"><a href="#cb21-950" aria-hidden="true" tabindex="-1"></a>    exchanges<span class="op">=</span>[<span class="st">'HOSE'</span>, <span class="st">'HNX'</span>],</span>
<span id="cb21-951"><a href="#cb21-951" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">'2008-01-01'</span>,</span>
<span id="cb21-952"><a href="#cb21-952" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">'2024-12-31'</span>,</span>
<span id="cb21-953"><a href="#cb21-953" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[<span class="st">'ticker'</span>, <span class="st">'month_end'</span>, <span class="st">'monthly_return'</span>, <span class="st">'market_cap'</span>,</span>
<span id="cb21-954"><a href="#cb21-954" aria-hidden="true" tabindex="-1"></a>            <span class="st">'foreign_ownership_pct'</span>]</span>
<span id="cb21-955"><a href="#cb21-955" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-956"><a href="#cb21-956" aria-hidden="true" tabindex="-1"></a>stock_data[<span class="st">'month_end'</span>] <span class="op">=</span> pd.to_datetime(stock_data[<span class="st">'month_end'</span>])</span>
<span id="cb21-957"><a href="#cb21-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-958"><a href="#cb21-958" aria-hidden="true" tabindex="-1"></a><span class="co"># Fama-MacBeth: regress returns on lagged foreign ownership</span></span>
<span id="cb21-959"><a href="#cb21-959" aria-hidden="true" tabindex="-1"></a>stock_data <span class="op">=</span> stock_data.sort_values([<span class="st">'ticker'</span>, <span class="st">'month_end'</span>])</span>
<span id="cb21-960"><a href="#cb21-960" aria-hidden="true" tabindex="-1"></a>stock_data[<span class="st">'fol_lag'</span>] <span class="op">=</span> (</span>
<span id="cb21-961"><a href="#cb21-961" aria-hidden="true" tabindex="-1"></a>    stock_data.groupby(<span class="st">'ticker'</span>)[<span class="st">'foreign_ownership_pct'</span>].shift(<span class="dv">1</span>)</span>
<span id="cb21-962"><a href="#cb21-962" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-963"><a href="#cb21-963" aria-hidden="true" tabindex="-1"></a>stock_data[<span class="st">'log_mcap'</span>] <span class="op">=</span> np.log(stock_data[<span class="st">'market_cap'</span>].clip(lower<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb21-964"><a href="#cb21-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-965"><a href="#cb21-965" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly cross-sectional regressions</span></span>
<span id="cb21-966"><a href="#cb21-966" aria-hidden="true" tabindex="-1"></a>gamma_fol <span class="op">=</span> []</span>
<span id="cb21-967"><a href="#cb21-967" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> month, group <span class="kw">in</span> stock_data.dropna(subset<span class="op">=</span>[<span class="st">'fol_lag'</span>, <span class="st">'monthly_return'</span>]).groupby(<span class="st">'month_end'</span>):</span>
<span id="cb21-968"><a href="#cb21-968" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(group) <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb21-969"><a href="#cb21-969" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb21-970"><a href="#cb21-970" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-971"><a href="#cb21-971" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> group[<span class="st">'monthly_return'</span>].values</span>
<span id="cb21-972"><a href="#cb21-972" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> sm.add_constant(group[[<span class="st">'fol_lag'</span>, <span class="st">'log_mcap'</span>]].values)</span>
<span id="cb21-973"><a href="#cb21-973" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-974"><a href="#cb21-974" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb21-975"><a href="#cb21-975" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> sm.OLS(y, X).fit()</span>
<span id="cb21-976"><a href="#cb21-976" aria-hidden="true" tabindex="-1"></a>        gamma_fol.append({</span>
<span id="cb21-977"><a href="#cb21-977" aria-hidden="true" tabindex="-1"></a>            <span class="st">'month'</span>: month,</span>
<span id="cb21-978"><a href="#cb21-978" aria-hidden="true" tabindex="-1"></a>            <span class="st">'gamma_fol'</span>: model.params[<span class="dv">1</span>],</span>
<span id="cb21-979"><a href="#cb21-979" aria-hidden="true" tabindex="-1"></a>            <span class="st">'gamma_size'</span>: model.params[<span class="dv">2</span>],</span>
<span id="cb21-980"><a href="#cb21-980" aria-hidden="true" tabindex="-1"></a>            <span class="st">'n'</span>: <span class="bu">len</span>(group)</span>
<span id="cb21-981"><a href="#cb21-981" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb21-982"><a href="#cb21-982" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb21-983"><a href="#cb21-983" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb21-984"><a href="#cb21-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-985"><a href="#cb21-985" aria-hidden="true" tabindex="-1"></a>gamma_fol_df <span class="op">=</span> pd.DataFrame(gamma_fol)</span>
<span id="cb21-986"><a href="#cb21-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-987"><a href="#cb21-987" aria-hidden="true" tabindex="-1"></a>mean_gamma <span class="op">=</span> gamma_fol_df[<span class="st">'gamma_fol'</span>].mean()</span>
<span id="cb21-988"><a href="#cb21-988" aria-hidden="true" tabindex="-1"></a>se_gamma <span class="op">=</span> gamma_fol_df[<span class="st">'gamma_fol'</span>].std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(gamma_fol_df))</span>
<span id="cb21-989"><a href="#cb21-989" aria-hidden="true" tabindex="-1"></a>t_gamma <span class="op">=</span> mean_gamma <span class="op">/</span> se_gamma</span>
<span id="cb21-990"><a href="#cb21-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-991"><a href="#cb21-991" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Fama-MacBeth: Foreign Ownership and Expected Returns"</span>)</span>
<span id="cb21-992"><a href="#cb21-992" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  γ_FOL (monthly):  </span><span class="sc">{</span>mean_gamma<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb21-993"><a href="#cb21-993" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  γ_FOL (ann.):     </span><span class="sc">{</span>mean_gamma <span class="op">*</span> <span class="dv">12</span><span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb21-994"><a href="#cb21-994" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic:      </span><span class="sc">{</span>t_gamma<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb21-995"><a href="#cb21-995" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Interpretation:   A 10pp increase in foreign ownership is "</span></span>
<span id="cb21-996"><a href="#cb21-996" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"associated with a </span><span class="sc">{</span>mean_gamma <span class="op">*</span> <span class="dv">12</span> <span class="op">*</span> <span class="dv">10</span><span class="sc">:.2f}</span><span class="ss">% change in "</span></span>
<span id="cb21-997"><a href="#cb21-997" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"annual expected returns"</span>)</span>
<span id="cb21-998"><a href="#cb21-998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-999"><a href="#cb21-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1002"><a href="#cb21-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-1003"><a href="#cb21-1003" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-segmentation-premium</span></span>
<span id="cb21-1004"><a href="#cb21-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-1005"><a href="#cb21-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The segmentation premium in Vietnam. Panel A shows quintile portfolio returns sorted on lagged foreign ownership: a negative gradient (high FOL → lower returns) is consistent with segmentation theory. Panel B shows the rolling Fama-MacBeth coefficient on foreign ownership—the time-varying segmentation premium. The premium has been shrinking over time as the market integrates."</span></span>
<span id="cb21-1006"><a href="#cb21-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Visualize the segmentation premium"</span></span>
<span id="cb21-1007"><a href="#cb21-1007" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb21-1008"><a href="#cb21-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1009"><a href="#cb21-1009" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Quintile returns by foreign ownership</span></span>
<span id="cb21-1010"><a href="#cb21-1010" aria-hidden="true" tabindex="-1"></a>fol_quintiles <span class="op">=</span> stock_data.dropna(subset<span class="op">=</span>[<span class="st">'fol_lag'</span>, <span class="st">'monthly_return'</span>]).copy()</span>
<span id="cb21-1011"><a href="#cb21-1011" aria-hidden="true" tabindex="-1"></a>fol_quintiles[<span class="st">'fol_q'</span>] <span class="op">=</span> (</span>
<span id="cb21-1012"><a href="#cb21-1012" aria-hidden="true" tabindex="-1"></a>    fol_quintiles.groupby(<span class="st">'month_end'</span>)[<span class="st">'fol_lag'</span>]</span>
<span id="cb21-1013"><a href="#cb21-1013" aria-hidden="true" tabindex="-1"></a>    .transform(<span class="kw">lambda</span> x: pd.qcut(x.rank(method<span class="op">=</span><span class="st">'first'</span>), <span class="dv">5</span>,</span>
<span id="cb21-1014"><a href="#cb21-1014" aria-hidden="true" tabindex="-1"></a>                                    labels<span class="op">=</span>[<span class="st">'Q1</span><span class="ch">\n</span><span class="st">(Low FOL)'</span>, <span class="st">'Q2'</span>, <span class="st">'Q3'</span>, <span class="st">'Q4'</span>,</span>
<span id="cb21-1015"><a href="#cb21-1015" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">'Q5</span><span class="ch">\n</span><span class="st">(High FOL)'</span>]))</span>
<span id="cb21-1016"><a href="#cb21-1016" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-1017"><a href="#cb21-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1018"><a href="#cb21-1018" aria-hidden="true" tabindex="-1"></a>q_returns <span class="op">=</span> (</span>
<span id="cb21-1019"><a href="#cb21-1019" aria-hidden="true" tabindex="-1"></a>    fol_quintiles.groupby(<span class="st">'fol_q'</span>)[<span class="st">'monthly_return'</span>]</span>
<span id="cb21-1020"><a href="#cb21-1020" aria-hidden="true" tabindex="-1"></a>    .mean() <span class="op">*</span> <span class="dv">12</span> <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb21-1021"><a href="#cb21-1021" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-1022"><a href="#cb21-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1023"><a href="#cb21-1023" aria-hidden="true" tabindex="-1"></a>colors_q <span class="op">=</span> plt.cm.RdYlGn_r(np.linspace(<span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="dv">5</span>))</span>
<span id="cb21-1024"><a href="#cb21-1024" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].bar(<span class="bu">range</span>(<span class="dv">5</span>), q_returns.values, color<span class="op">=</span>colors_q,</span>
<span id="cb21-1025"><a href="#cb21-1025" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb21-1026"><a href="#cb21-1026" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(<span class="bu">range</span>(<span class="dv">5</span>))</span>
<span id="cb21-1027"><a href="#cb21-1027" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(q_returns.index)</span>
<span id="cb21-1028"><a href="#cb21-1028" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Ann. Return (%)'</span>)</span>
<span id="cb21-1029"><a href="#cb21-1029" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Panel A: Returns by Foreign Ownership Quintile'</span>)</span>
<span id="cb21-1030"><a href="#cb21-1030" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb21-1031"><a href="#cb21-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1032"><a href="#cb21-1032" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Rolling FM coefficient</span></span>
<span id="cb21-1033"><a href="#cb21-1033" aria-hidden="true" tabindex="-1"></a>gamma_fol_df[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(gamma_fol_df[<span class="st">'month'</span>])</span>
<span id="cb21-1034"><a href="#cb21-1034" aria-hidden="true" tabindex="-1"></a>rolling_gamma <span class="op">=</span> gamma_fol_df.set_index(<span class="st">'date'</span>)[<span class="st">'gamma_fol'</span>].rolling(<span class="dv">24</span>).mean() <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb21-1035"><a href="#cb21-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1036"><a href="#cb21-1036" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(rolling_gamma.index, rolling_gamma.values,</span>
<span id="cb21-1037"><a href="#cb21-1037" aria-hidden="true" tabindex="-1"></a>             color<span class="op">=</span><span class="st">'#2C5F8A'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb21-1038"><a href="#cb21-1038" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb21-1039"><a href="#cb21-1039" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'γ_FOL (annualized)'</span>)</span>
<span id="cb21-1040"><a href="#cb21-1040" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Panel B: Rolling Segmentation Premium'</span>)</span>
<span id="cb21-1041"><a href="#cb21-1041" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].fill_between(rolling_gamma.index, rolling_gamma.values, <span class="dv">0</span>,</span>
<span id="cb21-1042"><a href="#cb21-1042" aria-hidden="true" tabindex="-1"></a>                      where<span class="op">=</span>rolling_gamma.values <span class="op">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb21-1043"><a href="#cb21-1043" aria-hidden="true" tabindex="-1"></a>                      alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'#27AE60'</span>, label<span class="op">=</span><span class="st">'Negative (integration)'</span>)</span>
<span id="cb21-1044"><a href="#cb21-1044" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].fill_between(rolling_gamma.index, rolling_gamma.values, <span class="dv">0</span>,</span>
<span id="cb21-1045"><a href="#cb21-1045" aria-hidden="true" tabindex="-1"></a>                      where<span class="op">=</span>rolling_gamma.values <span class="op">&gt;=</span> <span class="dv">0</span>,</span>
<span id="cb21-1046"><a href="#cb21-1046" aria-hidden="true" tabindex="-1"></a>                      alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'#C0392B'</span>, label<span class="op">=</span><span class="st">'Positive (segmentation)'</span>)</span>
<span id="cb21-1047"><a href="#cb21-1047" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb21-1048"><a href="#cb21-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1049"><a href="#cb21-1049" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-1050"><a href="#cb21-1050" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-1051"><a href="#cb21-1051" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-1052"><a href="#cb21-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1053"><a href="#cb21-1053" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exchange Rate Risk and Integration {#sec-market-integration-fx}</span></span>
<span id="cb21-1054"><a href="#cb21-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1055"><a href="#cb21-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">### Is Currency Risk Priced?</span></span>
<span id="cb21-1056"><a href="#cb21-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1057"><a href="#cb21-1057" aria-hidden="true" tabindex="-1"></a>In a partially integrated market, exchange rate risk may carry a separate premium. @jorion1991pricing and @dumas1995world test whether currency exposure is priced beyond global equity risk. For Vietnam, the VND/USD exchange rate is managed (a crawling peg with occasional step devaluations), creating a specific risk that is neither fully diversifiable nor fully priced by global equity factors.</span>
<span id="cb21-1058"><a href="#cb21-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1061"><a href="#cb21-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-1062"><a href="#cb21-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fx-risk</span></span>
<span id="cb21-1063"><a href="#cb21-1063" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-1064"><a href="#cb21-1064" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Test whether VND/USD exchange rate risk is priced"</span></span>
<span id="cb21-1065"><a href="#cb21-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># VND depreciation</span></span>
<span id="cb21-1066"><a href="#cb21-1066" aria-hidden="true" tabindex="-1"></a>fx_return <span class="op">=</span> fx[<span class="st">'rate'</span>].pct_change()</span>
<span id="cb21-1067"><a href="#cb21-1067" aria-hidden="true" tabindex="-1"></a>fx_return.name <span class="op">=</span> <span class="st">'fx_return'</span></span>
<span id="cb21-1068"><a href="#cb21-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1069"><a href="#cb21-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with stock data</span></span>
<span id="cb21-1070"><a href="#cb21-1070" aria-hidden="true" tabindex="-1"></a>stock_fx <span class="op">=</span> stock_data.merge(</span>
<span id="cb21-1071"><a href="#cb21-1071" aria-hidden="true" tabindex="-1"></a>    fx_return.to_frame().reset_index().rename(columns<span class="op">=</span>{<span class="st">'date'</span>: <span class="st">'month_end'</span>}),</span>
<span id="cb21-1072"><a href="#cb21-1072" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">'month_end'</span>, how<span class="op">=</span><span class="st">'left'</span></span>
<span id="cb21-1073"><a href="#cb21-1073" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-1074"><a href="#cb21-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1075"><a href="#cb21-1075" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate FX beta for each stock (rolling 60-month)</span></span>
<span id="cb21-1076"><a href="#cb21-1076" aria-hidden="true" tabindex="-1"></a><span class="co"># Then test in Fama-MacBeth whether FX beta is priced</span></span>
<span id="cb21-1077"><a href="#cb21-1077" aria-hidden="true" tabindex="-1"></a>fx_betas <span class="op">=</span> {}</span>
<span id="cb21-1078"><a href="#cb21-1078" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ticker, group <span class="kw">in</span> stock_fx.groupby(<span class="st">'ticker'</span>):</span>
<span id="cb21-1079"><a href="#cb21-1079" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(group) <span class="op">&lt;</span> <span class="dv">60</span>:</span>
<span id="cb21-1080"><a href="#cb21-1080" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb21-1081"><a href="#cb21-1081" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> group.sort_values(<span class="st">'month_end'</span>)</span>
<span id="cb21-1082"><a href="#cb21-1082" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> group[<span class="st">'monthly_return'</span>]</span>
<span id="cb21-1083"><a href="#cb21-1083" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> group[[<span class="st">'fx_return'</span>]].dropna()</span>
<span id="cb21-1084"><a href="#cb21-1084" aria-hidden="true" tabindex="-1"></a>    common <span class="op">=</span> y.dropna().index.intersection(x.index)</span>
<span id="cb21-1085"><a href="#cb21-1085" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(common) <span class="op">&lt;</span> <span class="dv">48</span>:</span>
<span id="cb21-1086"><a href="#cb21-1086" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb21-1087"><a href="#cb21-1087" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> sm.OLS(y[common], sm.add_constant(x.loc[common])).fit()</span>
<span id="cb21-1088"><a href="#cb21-1088" aria-hidden="true" tabindex="-1"></a>    fx_betas[ticker] <span class="op">=</span> model.params.get(<span class="st">'fx_return'</span>, np.nan)</span>
<span id="cb21-1089"><a href="#cb21-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1090"><a href="#cb21-1090" aria-hidden="true" tabindex="-1"></a>fx_beta_series <span class="op">=</span> pd.Series(fx_betas, name<span class="op">=</span><span class="st">'fx_beta'</span>)</span>
<span id="cb21-1091"><a href="#cb21-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1092"><a href="#cb21-1092" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-sectional test: do stocks with higher FX beta earn different returns?</span></span>
<span id="cb21-1093"><a href="#cb21-1093" aria-hidden="true" tabindex="-1"></a>stock_fx_beta <span class="op">=</span> stock_fx.merge(</span>
<span id="cb21-1094"><a href="#cb21-1094" aria-hidden="true" tabindex="-1"></a>    fx_beta_series.to_frame().reset_index().rename(columns<span class="op">=</span>{<span class="st">'index'</span>: <span class="st">'ticker'</span>}),</span>
<span id="cb21-1095"><a href="#cb21-1095" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">'ticker'</span>, how<span class="op">=</span><span class="st">'left'</span></span>
<span id="cb21-1096"><a href="#cb21-1096" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-1097"><a href="#cb21-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1098"><a href="#cb21-1098" aria-hidden="true" tabindex="-1"></a><span class="co"># Quintile sort on FX beta</span></span>
<span id="cb21-1099"><a href="#cb21-1099" aria-hidden="true" tabindex="-1"></a>fx_q <span class="op">=</span> stock_fx_beta.dropna(subset<span class="op">=</span>[<span class="st">'fx_beta'</span>, <span class="st">'monthly_return'</span>])</span>
<span id="cb21-1100"><a href="#cb21-1100" aria-hidden="true" tabindex="-1"></a>fx_q[<span class="st">'fx_quintile'</span>] <span class="op">=</span> pd.qcut(fx_q[<span class="st">'fx_beta'</span>].rank(method<span class="op">=</span><span class="st">'first'</span>),</span>
<span id="cb21-1101"><a href="#cb21-1101" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">5</span>, labels<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-1102"><a href="#cb21-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1103"><a href="#cb21-1103" aria-hidden="true" tabindex="-1"></a>fx_premium <span class="op">=</span> fx_q.groupby(<span class="st">'fx_quintile'</span>)[<span class="st">'monthly_return'</span>].mean() <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb21-1104"><a href="#cb21-1104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Returns by FX Beta Quintile:"</span>)</span>
<span id="cb21-1105"><a href="#cb21-1105" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q, ret <span class="kw">in</span> fx_premium.items():</span>
<span id="cb21-1106"><a href="#cb21-1106" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Q</span><span class="sc">{</span>q<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>ret<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% ann."</span>)</span>
<span id="cb21-1107"><a href="#cb21-1107" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Q5-Q1: </span><span class="sc">{</span>(fx_premium.iloc[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> fx_premium.iloc[<span class="dv">0</span>])<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% ann."</span>)</span>
<span id="cb21-1108"><a href="#cb21-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-1109"><a href="#cb21-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1110"><a href="#cb21-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">## Contagion vs. Interdependence {#sec-market-integration-contagion}</span></span>
<span id="cb21-1111"><a href="#cb21-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1112"><a href="#cb21-1112" aria-hidden="true" tabindex="-1"></a>During global crises, correlations between Vietnam and world markets spike. The question is whether this represents *contagion* (a structural change in the transmission mechanism) or simply *interdependence* (normal co-movement amplified by higher volatility). @longin2001extreme show that correlation increases mechanically with volatility even without any change in the underlying dependence structure.</span>
<span id="cb21-1113"><a href="#cb21-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1116"><a href="#cb21-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-1117"><a href="#cb21-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: contagion-test</span></span>
<span id="cb21-1118"><a href="#cb21-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-1119"><a href="#cb21-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Test for contagion during major crisis episodes"</span></span>
<span id="cb21-1120"><a href="#cb21-1120" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forbes_rigobon_test(r_local, r_global, crisis_dates, tranquil_dates):</span>
<span id="cb21-1121"><a href="#cb21-1121" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb21-1122"><a href="#cb21-1122" aria-hidden="true" tabindex="-1"></a><span class="co">    Forbes-Rigobon (2002) contagion test.</span></span>
<span id="cb21-1123"><a href="#cb21-1123" aria-hidden="true" tabindex="-1"></a><span class="co">    Adjusts for heteroskedasticity-induced bias in correlation.</span></span>
<span id="cb21-1124"><a href="#cb21-1124" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb21-1125"><a href="#cb21-1125" aria-hidden="true" tabindex="-1"></a><span class="co">    H0: No contagion (correlation increase is explained by volatility)</span></span>
<span id="cb21-1126"><a href="#cb21-1126" aria-hidden="true" tabindex="-1"></a><span class="co">    H1: Contagion (correlation increase exceeds what volatility explains)</span></span>
<span id="cb21-1127"><a href="#cb21-1127" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-1128"><a href="#cb21-1128" aria-hidden="true" tabindex="-1"></a>    r_l_crisis <span class="op">=</span> r_local[crisis_dates]</span>
<span id="cb21-1129"><a href="#cb21-1129" aria-hidden="true" tabindex="-1"></a>    r_g_crisis <span class="op">=</span> r_global[crisis_dates]</span>
<span id="cb21-1130"><a href="#cb21-1130" aria-hidden="true" tabindex="-1"></a>    r_l_tranquil <span class="op">=</span> r_local[tranquil_dates]</span>
<span id="cb21-1131"><a href="#cb21-1131" aria-hidden="true" tabindex="-1"></a>    r_g_tranquil <span class="op">=</span> r_global[tranquil_dates]</span>
<span id="cb21-1132"><a href="#cb21-1132" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1133"><a href="#cb21-1133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Unadjusted correlations</span></span>
<span id="cb21-1134"><a href="#cb21-1134" aria-hidden="true" tabindex="-1"></a>    rho_crisis <span class="op">=</span> r_l_crisis.corr(r_g_crisis)</span>
<span id="cb21-1135"><a href="#cb21-1135" aria-hidden="true" tabindex="-1"></a>    rho_tranquil <span class="op">=</span> r_l_tranquil.corr(r_g_tranquil)</span>
<span id="cb21-1136"><a href="#cb21-1136" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1137"><a href="#cb21-1137" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Volatility ratio</span></span>
<span id="cb21-1138"><a href="#cb21-1138" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> r_g_crisis.var() <span class="op">/</span> r_g_tranquil.var() <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb21-1139"><a href="#cb21-1139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1140"><a href="#cb21-1140" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjusted correlation</span></span>
<span id="cb21-1141"><a href="#cb21-1141" aria-hidden="true" tabindex="-1"></a>    rho_adj <span class="op">=</span> rho_crisis <span class="op">/</span> np.sqrt(<span class="dv">1</span> <span class="op">+</span> delta <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> rho_crisis <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb21-1142"><a href="#cb21-1142" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1143"><a href="#cb21-1143" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fisher z-test on adjusted vs tranquil</span></span>
<span id="cb21-1144"><a href="#cb21-1144" aria-hidden="true" tabindex="-1"></a>    z_adj <span class="op">=</span> np.arctanh(rho_adj)</span>
<span id="cb21-1145"><a href="#cb21-1145" aria-hidden="true" tabindex="-1"></a>    z_tranquil <span class="op">=</span> np.arctanh(rho_tranquil)</span>
<span id="cb21-1146"><a href="#cb21-1146" aria-hidden="true" tabindex="-1"></a>    se <span class="op">=</span> np.sqrt(<span class="dv">1</span> <span class="op">/</span> (<span class="bu">len</span>(r_l_crisis) <span class="op">-</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">1</span> <span class="op">/</span> (<span class="bu">len</span>(r_l_tranquil) <span class="op">-</span> <span class="dv">3</span>))</span>
<span id="cb21-1147"><a href="#cb21-1147" aria-hidden="true" tabindex="-1"></a>    z_stat <span class="op">=</span> (z_adj <span class="op">-</span> z_tranquil) <span class="op">/</span> se</span>
<span id="cb21-1148"><a href="#cb21-1148" aria-hidden="true" tabindex="-1"></a>    p_val <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.norm.cdf(<span class="bu">abs</span>(z_stat)))</span>
<span id="cb21-1149"><a href="#cb21-1149" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1150"><a href="#cb21-1150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb21-1151"><a href="#cb21-1151" aria-hidden="true" tabindex="-1"></a>        <span class="st">'rho_crisis_raw'</span>: rho_crisis,</span>
<span id="cb21-1152"><a href="#cb21-1152" aria-hidden="true" tabindex="-1"></a>        <span class="st">'rho_crisis_adj'</span>: rho_adj,</span>
<span id="cb21-1153"><a href="#cb21-1153" aria-hidden="true" tabindex="-1"></a>        <span class="st">'rho_tranquil'</span>: rho_tranquil,</span>
<span id="cb21-1154"><a href="#cb21-1154" aria-hidden="true" tabindex="-1"></a>        <span class="st">'delta'</span>: delta,</span>
<span id="cb21-1155"><a href="#cb21-1155" aria-hidden="true" tabindex="-1"></a>        <span class="st">'z_stat'</span>: z_stat,</span>
<span id="cb21-1156"><a href="#cb21-1156" aria-hidden="true" tabindex="-1"></a>        <span class="st">'p_value'</span>: p_val,</span>
<span id="cb21-1157"><a href="#cb21-1157" aria-hidden="true" tabindex="-1"></a>        <span class="st">'contagion'</span>: p_val <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb21-1158"><a href="#cb21-1158" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-1159"><a href="#cb21-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1160"><a href="#cb21-1160" aria-hidden="true" tabindex="-1"></a><span class="co"># Define crisis and tranquil periods</span></span>
<span id="cb21-1161"><a href="#cb21-1161" aria-hidden="true" tabindex="-1"></a>crises <span class="op">=</span> {</span>
<span id="cb21-1162"><a href="#cb21-1162" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GFC (2008-09)'</span>: (pd.Timestamp(<span class="st">'2008-09-01'</span>), pd.Timestamp(<span class="st">'2009-03-31'</span>)),</span>
<span id="cb21-1163"><a href="#cb21-1163" aria-hidden="true" tabindex="-1"></a>    <span class="st">'European Debt (2011-12)'</span>: (pd.Timestamp(<span class="st">'2011-06-01'</span>), pd.Timestamp(<span class="st">'2012-06-30'</span>)),</span>
<span id="cb21-1164"><a href="#cb21-1164" aria-hidden="true" tabindex="-1"></a>    <span class="st">'COVID (2020)'</span>: (pd.Timestamp(<span class="st">'2020-02-01'</span>), pd.Timestamp(<span class="st">'2020-06-30'</span>)),</span>
<span id="cb21-1165"><a href="#cb21-1165" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Fed Tightening (2022)'</span>: (pd.Timestamp(<span class="st">'2022-01-01'</span>), pd.Timestamp(<span class="st">'2022-12-31'</span>)),</span>
<span id="cb21-1166"><a href="#cb21-1166" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-1167"><a href="#cb21-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1168"><a href="#cb21-1168" aria-hidden="true" tabindex="-1"></a><span class="co"># Tranquil = 24 months before each crisis</span></span>
<span id="cb21-1169"><a href="#cb21-1169" aria-hidden="true" tabindex="-1"></a>vn_aligned <span class="op">=</span> indices_aligned[<span class="st">'VIETNAM'</span>]</span>
<span id="cb21-1170"><a href="#cb21-1170" aria-hidden="true" tabindex="-1"></a>world_aligned <span class="op">=</span> indices_aligned[<span class="st">'MSCI_WORLD'</span>]</span>
<span id="cb21-1171"><a href="#cb21-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1172"><a href="#cb21-1172" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Contagion Tests (Forbes-Rigobon):"</span>)</span>
<span id="cb21-1173"><a href="#cb21-1173" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Crisis'</span><span class="sc">:&lt;28}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'ρ(raw)'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'ρ(adj)'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'ρ(calm)'</span><span class="sc">:&gt;8}</span><span class="ss"> "</span></span>
<span id="cb21-1174"><a href="#cb21-1174" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"</span><span class="sc">{</span><span class="st">'z-stat'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'p-val'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Result'</span><span class="sc">:&gt;12}</span><span class="ss">"</span>)</span>
<span id="cb21-1175"><a href="#cb21-1175" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb21-1176"><a href="#cb21-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1177"><a href="#cb21-1177" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, (start, end) <span class="kw">in</span> crises.items():</span>
<span id="cb21-1178"><a href="#cb21-1178" aria-hidden="true" tabindex="-1"></a>    crisis_mask <span class="op">=</span> (vn_aligned.index <span class="op">&gt;=</span> start) <span class="op">&amp;</span> (vn_aligned.index <span class="op">&lt;=</span> end)</span>
<span id="cb21-1179"><a href="#cb21-1179" aria-hidden="true" tabindex="-1"></a>    tranquil_start <span class="op">=</span> start <span class="op">-</span> pd.DateOffset(months<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb21-1180"><a href="#cb21-1180" aria-hidden="true" tabindex="-1"></a>    tranquil_mask <span class="op">=</span> ((vn_aligned.index <span class="op">&gt;=</span> tranquil_start) <span class="op">&amp;</span></span>
<span id="cb21-1181"><a href="#cb21-1181" aria-hidden="true" tabindex="-1"></a>                      (vn_aligned.index <span class="op">&lt;</span> start))</span>
<span id="cb21-1182"><a href="#cb21-1182" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1183"><a href="#cb21-1183" aria-hidden="true" tabindex="-1"></a>    crisis_dates <span class="op">=</span> vn_aligned.index[crisis_mask]</span>
<span id="cb21-1184"><a href="#cb21-1184" aria-hidden="true" tabindex="-1"></a>    tranquil_dates <span class="op">=</span> vn_aligned.index[tranquil_mask]</span>
<span id="cb21-1185"><a href="#cb21-1185" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1186"><a href="#cb21-1186" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(crisis_dates) <span class="op">&lt;</span> <span class="dv">3</span> <span class="kw">or</span> <span class="bu">len</span>(tranquil_dates) <span class="op">&lt;</span> <span class="dv">12</span>:</span>
<span id="cb21-1187"><a href="#cb21-1187" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb21-1188"><a href="#cb21-1188" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1189"><a href="#cb21-1189" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> forbes_rigobon_test(vn_aligned, world_aligned,</span>
<span id="cb21-1190"><a href="#cb21-1190" aria-hidden="true" tabindex="-1"></a>                                  crisis_dates, tranquil_dates)</span>
<span id="cb21-1191"><a href="#cb21-1191" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1192"><a href="#cb21-1192" aria-hidden="true" tabindex="-1"></a>    verdict <span class="op">=</span> <span class="st">'CONTAGION'</span> <span class="cf">if</span> result[<span class="st">'contagion'</span>] <span class="cf">else</span> <span class="st">'Interdependence'</span></span>
<span id="cb21-1193"><a href="#cb21-1193" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">:&lt;28}</span><span class="ss"> </span><span class="sc">{</span>result[<span class="st">'rho_crisis_raw'</span>]<span class="sc">:&gt;8.3f}</span><span class="ss"> "</span></span>
<span id="cb21-1194"><a href="#cb21-1194" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>result[<span class="st">'rho_crisis_adj'</span>]<span class="sc">:&gt;8.3f}</span><span class="ss"> </span><span class="sc">{</span>result[<span class="st">'rho_tranquil'</span>]<span class="sc">:&gt;8.3f}</span><span class="ss"> "</span></span>
<span id="cb21-1195"><a href="#cb21-1195" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>result[<span class="st">'z_stat'</span>]<span class="sc">:&gt;8.2f}</span><span class="ss"> </span><span class="sc">{</span>result[<span class="st">'p_value'</span>]<span class="sc">:&gt;8.3f}</span><span class="ss"> "</span></span>
<span id="cb21-1196"><a href="#cb21-1196" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>verdict<span class="sc">:&gt;12}</span><span class="ss">"</span>)</span>
<span id="cb21-1197"><a href="#cb21-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-1198"><a href="#cb21-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1199"><a href="#cb21-1199" aria-hidden="true" tabindex="-1"></a><span class="fu">## ASEAN Peer Comparison {#sec-market-integration-asean}</span></span>
<span id="cb21-1200"><a href="#cb21-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1201"><a href="#cb21-1201" aria-hidden="true" tabindex="-1"></a>Vietnam's integration trajectory is best understood in the context of its ASEAN peers, which share similar starting conditions but have followed different liberalization paths:</span>
<span id="cb21-1202"><a href="#cb21-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1205"><a href="#cb21-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-1206"><a href="#cb21-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-asean-comparison</span></span>
<span id="cb21-1207"><a href="#cb21-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-1208"><a href="#cb21-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Integration with MSCI World across ASEAN markets, measured by rolling 36-month correlation. Thailand and Malaysia, which liberalized earlier, show higher and more stable correlations. Vietnam's integration has accelerated since 2015, converging toward regional peers but remaining below Thailand and Malaysia. Indonesia and the Philippines occupy an intermediate position."</span></span>
<span id="cb21-1209"><a href="#cb21-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Compare integration trajectories across ASEAN markets"</span></span>
<span id="cb21-1210"><a href="#cb21-1210" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb21-1211"><a href="#cb21-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1212"><a href="#cb21-1212" aria-hidden="true" tabindex="-1"></a>asean_markets <span class="op">=</span> {</span>
<span id="cb21-1213"><a href="#cb21-1213" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VIETNAM'</span>: <span class="st">'#C0392B'</span>,</span>
<span id="cb21-1214"><a href="#cb21-1214" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_THAILAND'</span>: <span class="st">'#2C5F8A'</span>,</span>
<span id="cb21-1215"><a href="#cb21-1215" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_INDONESIA'</span>: <span class="st">'#27AE60'</span>,</span>
<span id="cb21-1216"><a href="#cb21-1216" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_PHILIPPINES'</span>: <span class="st">'#E67E22'</span>,</span>
<span id="cb21-1217"><a href="#cb21-1217" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSCI_MALAYSIA'</span>: <span class="st">'#8E44AD'</span></span>
<span id="cb21-1218"><a href="#cb21-1218" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-1219"><a href="#cb21-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1220"><a href="#cb21-1220" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> market, color <span class="kw">in</span> asean_markets.items():</span>
<span id="cb21-1221"><a href="#cb21-1221" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> market <span class="kw">not</span> <span class="kw">in</span> global_indices.columns:</span>
<span id="cb21-1222"><a href="#cb21-1222" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb21-1223"><a href="#cb21-1223" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1224"><a href="#cb21-1224" aria-hidden="true" tabindex="-1"></a>    corr <span class="op">=</span> (</span>
<span id="cb21-1225"><a href="#cb21-1225" aria-hidden="true" tabindex="-1"></a>        global_indices[[<span class="st">'MSCI_WORLD'</span>, market]]</span>
<span id="cb21-1226"><a href="#cb21-1226" aria-hidden="true" tabindex="-1"></a>        .rolling(<span class="dv">36</span>)</span>
<span id="cb21-1227"><a href="#cb21-1227" aria-hidden="true" tabindex="-1"></a>        .corr()</span>
<span id="cb21-1228"><a href="#cb21-1228" aria-hidden="true" tabindex="-1"></a>        .unstack()[<span class="st">'MSCI_WORLD'</span>][market]</span>
<span id="cb21-1229"><a href="#cb21-1229" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-1230"><a href="#cb21-1230" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-1231"><a href="#cb21-1231" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> market.replace(<span class="st">'MSCI_'</span>, <span class="st">''</span>).replace(<span class="st">'_'</span>, <span class="st">' '</span>).title()</span>
<span id="cb21-1232"><a href="#cb21-1232" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> market <span class="op">==</span> <span class="st">'VIETNAM'</span>:</span>
<span id="cb21-1233"><a href="#cb21-1233" aria-hidden="true" tabindex="-1"></a>        ax.plot(corr.index, corr.values, color<span class="op">=</span>color,</span>
<span id="cb21-1234"><a href="#cb21-1234" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">2.5</span>, label<span class="op">=</span>label, zorder<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb21-1235"><a href="#cb21-1235" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-1236"><a href="#cb21-1236" aria-hidden="true" tabindex="-1"></a>        ax.plot(corr.index, corr.values, color<span class="op">=</span>color,</span>
<span id="cb21-1237"><a href="#cb21-1237" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span>label, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb21-1238"><a href="#cb21-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1239"><a href="#cb21-1239" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Correlation with MSCI World'</span>)</span>
<span id="cb21-1240"><a href="#cb21-1240" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'ASEAN Market Integration: Rolling 36-Month Correlation'</span>)</span>
<span id="cb21-1241"><a href="#cb21-1241" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb21-1242"><a href="#cb21-1242" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.9</span>])</span>
<span id="cb21-1243"><a href="#cb21-1243" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb21-1244"><a href="#cb21-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1245"><a href="#cb21-1245" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-1246"><a href="#cb21-1246" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-1247"><a href="#cb21-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-1248"><a href="#cb21-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1249"><a href="#cb21-1249" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practical Implications {#sec-market-integration-implications}</span></span>
<span id="cb21-1250"><a href="#cb21-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1251"><a href="#cb21-1251" aria-hidden="true" tabindex="-1"></a>The degree of integration determines which asset pricing model is appropriate for Vietnamese equities. The evidence in this chapter supports several practical conclusions:</span>
<span id="cb21-1252"><a href="#cb21-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1253"><a href="#cb21-1253" aria-hidden="true" tabindex="-1"></a>**Vietnam is partially integrated and trending toward integration.** The composite index shows a clear upward trajectory, with the post-2015 period representing the highest sustained integration in the market's history. However, Vietnam remains less integrated than Thailand or Malaysia, and far from fully integrated with global markets.</span>
<span id="cb21-1254"><a href="#cb21-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1255"><a href="#cb21-1255" aria-hidden="true" tabindex="-1"></a>**Local factors dominate global factors for pricing Vietnamese stocks.** The rolling $R^2$ comparison shows that local Vietnamese factors consistently explain more return variation than global factors. This means that researchers studying Vietnamese cross-sectional returns should use local factor models (Vietnamese FF5) rather than global factors. Global factors are useful primarily for international investors assessing co-movement risk.</span>
<span id="cb21-1256"><a href="#cb21-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1257"><a href="#cb21-1257" aria-hidden="true" tabindex="-1"></a>**The segmentation premium is shrinking but not zero.** The Fama-MacBeth evidence shows that stocks with higher foreign ownership earn lower returns, consistent with partial segmentation. The magnitude has declined over time as foreign ownership limits have been relaxed, but a residual premium persists—likely driven by remaining ownership caps in banking and strategic sectors.</span>
<span id="cb21-1258"><a href="#cb21-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1259"><a href="#cb21-1259" aria-hidden="true" tabindex="-1"></a>**Crisis-period co-movement is mostly interdependence, not contagion.** The Forbes-Rigobon adjusted correlations show that the spike in Vietnam-World correlation during crises is largely explained by increased global volatility, not a structural change in the transmission mechanism. This is reassuring for diversification: Vietnam continues to offer meaningful diversification benefits even during global stress.</span>
<span id="cb21-1260"><a href="#cb21-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1261"><a href="#cb21-1261" aria-hidden="true" tabindex="-1"></a>**The FTSE/MSCI upgrade path matters.** Vietnam's potential upgrade from frontier to emerging market status would trigger mandatory index rebalancing by passive funds, increasing foreign flows and likely accelerating integration. Researchers and investors should monitor upgrade criteria and their implications for the cost of capital.</span>
<span id="cb21-1262"><a href="#cb21-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1263"><a href="#cb21-1263" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary {#sec-market-integration-summary}</span></span>
<span id="cb21-1264"><a href="#cb21-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1265"><a href="#cb21-1265" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Measure <span class="pp">|</span> What It Captures <span class="pp">|</span> Vietnam Range <span class="pp">|</span> Current Level <span class="pp">|</span> Trend <span class="pp">|</span></span>
<span id="cb21-1266"><a href="#cb21-1266" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------|---------------|---------------|---------------|---------------|</span></span>
<span id="cb21-1267"><a href="#cb21-1267" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> DCC correlation (World) <span class="pp">|</span> Co-movement <span class="pp">|</span> 0.0–0.5 <span class="pp">|</span> \~0.35–0.45 <span class="pp">|</span> Rising <span class="pp">|</span></span>
<span id="cb21-1268"><a href="#cb21-1268" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> PR R² (global PCs) <span class="pp">|</span> Global factor exposure <span class="pp">|</span> 0.05–0.50 <span class="pp">|</span> \~0.30–0.40 <span class="pp">|</span> Rising <span class="pp">|</span></span>
<span id="cb21-1269"><a href="#cb21-1269" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Global/Local R² ratio <span class="pp">|</span> Relative pricing power <span class="pp">|</span> 0.1–0.8 <span class="pp">|</span> \~0.5–0.6 <span class="pp">|</span> Rising <span class="pp">|</span></span>
<span id="cb21-1270"><a href="#cb21-1270" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Global CAPM α <span class="pp">|</span> Pricing error <span class="pp">|</span> 0–15% ann. <span class="pp">|</span> \~3–5% ann. <span class="pp">|</span> Falling <span class="pp">|</span></span>
<span id="cb21-1271"><a href="#cb21-1271" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> FOL premium (γ) <span class="pp">|</span> Segmentation cost <span class="pp">|</span> -5% to +2% <span class="pp">|</span> \~-1% to 0% <span class="pp">|</span> Shrinking <span class="pp">|</span></span>
<span id="cb21-1272"><a href="#cb21-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1273"><a href="#cb21-1273" aria-hidden="true" tabindex="-1"></a>: Summary of integration measures for the Vietnamese equity market. {#tbl-market-integration-summary}</span>
<span id="cb21-1274"><a href="#cb21-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1275"><a href="#cb21-1275" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## Exercises {#sec-market-integration-exercises}</span></span>
<span id="cb21-1276"><a href="#cb21-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1277"><a href="#cb21-1277" aria-hidden="true" tabindex="-1"></a><span class="co">1.  **Regime-switching model.** Estimate the @bekaert1995time regime-switching model for Vietnam with two states (integrated, segmented). Use Hamilton filtering to extract the smoothed probability of being in the integrated state at each point in time. Does the filtered probability align with the composite index from this chapter?</span></span>
<span id="cb21-1278"><a href="#cb21-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1279"><a href="#cb21-1279" aria-hidden="true" tabindex="-1"></a><span class="co">2.  **Spanning test.** Can a U.S. investor replicate the Vietnamese market return using a portfolio of U.S.-listed ETFs (e.g., VNM ETF, EEM, FXI, EWY)? Regress the VN-Index on these ETFs and examine the alpha. A zero alpha means the Vietnamese market is "spanned" and offers no diversification benefit beyond what is available through U.S.-listed instruments [@errunza1985international].</span></span>
<span id="cb21-1280"><a href="#cb21-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1281"><a href="#cb21-1281" aria-hidden="true" tabindex="-1"></a><span class="co">3.  **Capital flow and integration.** Obtain monthly net foreign capital flow data for Vietnam (from the SSC or central bank). Test whether months of high foreign inflows are followed by higher Vietnam-World correlation. This tests whether integration is driven by capital flows or by other channels (trade, information).</span></span>
<span id="cb21-1282"><a href="#cb21-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1283"><a href="#cb21-1283" aria-hidden="true" tabindex="-1"></a><span class="co">4.  **Sector-level integration.** Estimate DCC correlations separately for Vietnamese banking, real estate, consumer goods, and technology sectors against their global sector counterparts. Which sectors are most integrated? Sectors with heavy state ownership may be more segmented.</span></span>
<span id="cb21-1284"><a href="#cb21-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1285"><a href="#cb21-1285" aria-hidden="true" tabindex="-1"></a><span class="co">5.  **Integration and the cost of capital.** Using the @bekaert2005does framework, estimate the reduction in Vietnam's implied cost of equity capital associated with the measured increase in integration since 2000. Use the local CAPM vs. global CAPM implied risk premia to quantify the "integration dividend."</span></span>
<span id="cb21-1286"><a href="#cb21-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1287"><a href="#cb21-1287" aria-hidden="true" tabindex="-1"></a><span class="co">6.  **Chinn-Ito index.** Download the @chinn2006what capital account openness index (KAOPEN) for Vietnam and its ASEAN peers. Plot KAOPEN against the market-based integration measures from this chapter. Is de jure openness (legal capital account liberalization) a good predictor of de facto integration (market co-movement)?</span></span>
<span id="cb21-1288"><a href="#cb21-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1289"><a href="#cb21-1289" aria-hidden="true" tabindex="-1"></a><span class="co">7.  **Frequency-domain integration.** Decompose Vietnam-World co-movement by frequency band (weekly, monthly, quarterly, annual) using wavelet coherence. Integration may differ at different frequencies: high-frequency co-movement reflects arbitrage and information transmission, while low-frequency co-movement reflects shared business cycles.</span></span>
<span id="cb21-1290"><a href="#cb21-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-1291"><a href="#cb21-1291" aria-hidden="true" tabindex="-1"></a><span class="co">8.  **COVID stress test.** The March 2020 COVID crash was the most severe global synchronized selloff in a decade. Using daily data, estimate hour-by-hour or day-by-day correlation between Vietnam and global markets during the crisis. Did Vietnam's price limits (Chapter on price limits) prevent full contagion transmission, or merely delay it? --&gt;</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span id="copyright"></span> Mike. All rights reserved.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/edit/main/56_market_integration_and_segmentation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>