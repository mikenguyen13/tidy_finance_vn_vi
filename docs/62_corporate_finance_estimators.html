<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>42&nbsp; Corporate Finance Estimators and Identification – Applying Tidy Finance with Python to Vietnam</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./63_structural_models_finance.html" rel="next">
<link href="./61_tail_risk_extreme_events.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-50a4fa9e9ef121803c2355a2deb1af4d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d8431037eefe704a1e7a103aa5b75ea7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-50a4fa9e9ef121803c2355a2deb1af4d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="42&nbsp; Corporate Finance Estimators and Identification – Applying Tidy Finance with Python to Vietnam">
<meta property="og:description" content="">
<meta property="og:site_name" content="Applying Tidy Finance with Python to Vietnam">
<meta name="twitter:title" content="42&nbsp; Corporate Finance Estimators and Identification – Applying Tidy Finance with Python to Vietnam">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./60_event_studies.html">Advanced Financial Modeling</a></li><li class="breadcrumb-item"><a href="./62_corporate_finance_estimators.html"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Corporate Finance Estimators and Identification</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applying Tidy Finance with Python to Vietnam</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/mikenguyen13/tidy_finance_vn" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Vietnam Financial Markets, Institutions, and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_institutional_background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Institutional Background and Market Structure of Vietnam’s Equity Market</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_accessing_and_managing_financial_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Accessing and Managing VN Financial Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_datacore_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Datacore Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_market_microstructure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Market Microstructure in Vietnam</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_risk_free_rate_construction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Risk-Free Rate Construction in Vietnam</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_working_with_stock_returns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Constructing and Analyzing Equity Return Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_compound_return.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Compound Returns</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Portfolio Construction, Risk, and Empirical Mechanics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_modern_portfolio_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modern Portfolio Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_univariate_portfolio_sort.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Univariate Portfolio Sorts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_size_sorts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Size Sorts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_value_bivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Value and Bivariate Sorts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_portfolio_weighting_and_rebalancing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Portfolio Weighting and Rebalancing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_missing_data_and_survivorship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Missing Data and Survivorship Bias</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_liquidity_and_turnover_measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Liquidity and Turnover Measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_beta_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Beta Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Asset Pricing Models and Cross-Sectional Tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_capm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">The Capital Asset Pricing Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_fama_french.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Fama-French Factors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_momentum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Momentum Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23_factor_construction_principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Factor Construction Principles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24_fama_macbeth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Fama-MacBeth Regressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25_factor_zoo_and_multiple_testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Factor Zoo and Multiple Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26_time_series_vs_cross_section.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Time-Series vs.&nbsp;Cross-Sectional Factor Tests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Firm Fundamentals, Valuation, and Corporate Signals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30_financial_statement_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Financial Statement Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31_discounted_cash_flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Discounted Cash Flow Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32_info_earnings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Information Content of Earnings Announcements</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33_accruals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Accruals, Earnings Persistence, and Market Efficiency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34_earning_management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Earnings Management: Detection and Measurement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./35_pe_ratio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">P/E Ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./36_valuation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Firm Valuation, Financial Distress, and Company Maturity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./37_disclosure_quality_and_timing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Disclosure Quality and Timing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./38_sue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Standardized Earnings Surprises (SUE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./39_divop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Measuring Divergence of Investor Opinion</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Ownership, Market Frictions, and International Exposure</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./50_institutional_ownership.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Institutional Ownership Analytics in Vietnam</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./52_institutional_trade_flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Institutional Trades, Flows, and Turnover Ratios</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./53_governance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Corporate Governance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./54_return_gaps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Return Gap: Measuring Unobserved Actions of Fund Managers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./55_price_limits_and_volatility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Price Limits and Volatility</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./56_market_integration_and_segmentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Market Integration and Segmentation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./57_exchange_rate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Exchange Rate Dynamics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Financial Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./60_event_studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Event Studies in Finance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./61_tail_risk_extreme_events.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Tail Risk and Extreme Events</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./62_corporate_finance_estimators.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Corporate Finance Estimators and Identification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./63_structural_models_finance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Structural Models in Finance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Alternative Data and AI for Finance</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./70_textual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Textual Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./71_image.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Image and Visual Data in Finance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./73_networks_graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Networks and Graphs in Finance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./74_multimodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Multimodal Models in Finance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99_conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#investment-q-regressions" id="toc-investment-q-regressions" class="nav-link active" data-scroll-target="#investment-q-regressions"><span class="header-section-number">42.1</span> Investment-<span class="math inline">\(Q\)</span> Regressions</a>
  <ul class="collapse">
  <li><a href="#tobins-q-intuition-and-theory" id="toc-tobins-q-intuition-and-theory" class="nav-link" data-scroll-target="#tobins-q-intuition-and-theory"><span class="header-section-number">42.1.1</span> Tobin’s <span class="math inline">\(Q\)</span>: Intuition and Theory</a></li>
  <li><a href="#measurement-issues" id="toc-measurement-issues" class="nav-link" data-scroll-target="#measurement-issues"><span class="header-section-number">42.1.2</span> Measurement Issues</a></li>
  <li><a href="#interpretation-under-market-frictions" id="toc-interpretation-under-market-frictions" class="nav-link" data-scroll-target="#interpretation-under-market-frictions"><span class="header-section-number">42.1.3</span> Interpretation Under Market Frictions</a></li>
  <li><a href="#limitations-in-emerging-markets" id="toc-limitations-in-emerging-markets" class="nav-link" data-scroll-target="#limitations-in-emerging-markets"><span class="header-section-number">42.1.4</span> Limitations in Emerging Markets</a></li>
  <li><a href="#the-erickson-whited-measurement-error-correction" id="toc-the-erickson-whited-measurement-error-correction" class="nav-link" data-scroll-target="#the-erickson-whited-measurement-error-correction"><span class="header-section-number">42.1.5</span> The Erickson-Whited Measurement Error Correction</a></li>
  </ul></li>
  <li><a href="#cash-flow-sensitivity-of-investment" id="toc-cash-flow-sensitivity-of-investment" class="nav-link" data-scroll-target="#cash-flow-sensitivity-of-investment"><span class="header-section-number">42.2</span> Cash Flow Sensitivity of Investment</a>
  <ul class="collapse">
  <li><a href="#the-financing-constraints-hypothesis" id="toc-the-financing-constraints-hypothesis" class="nav-link" data-scroll-target="#the-financing-constraints-hypothesis"><span class="header-section-number">42.2.1</span> The Financing Constraints Hypothesis</a></li>
  <li><a href="#the-fhp-kz-debate" id="toc-the-fhp-kz-debate" class="nav-link" data-scroll-target="#the-fhp-kz-debate"><span class="header-section-number">42.2.2</span> The FHP-KZ Debate</a></li>
  <li><a href="#constraint-indices" id="toc-constraint-indices" class="nav-link" data-scroll-target="#constraint-indices"><span class="header-section-number">42.2.3</span> Constraint Indices</a></li>
  <li><a href="#split-sample-cfsi-tests" id="toc-split-sample-cfsi-tests" class="nav-link" data-scroll-target="#split-sample-cfsi-tests"><span class="header-section-number">42.2.4</span> Split-Sample CFSI Tests</a></li>
  <li><a href="#alternative-specifications" id="toc-alternative-specifications" class="nav-link" data-scroll-target="#alternative-specifications"><span class="header-section-number">42.2.5</span> Alternative Specifications</a></li>
  </ul></li>
  <li><a href="#financing-choice-models" id="toc-financing-choice-models" class="nav-link" data-scroll-target="#financing-choice-models"><span class="header-section-number">42.3</span> Financing Choice Models</a>
  <ul class="collapse">
  <li><a href="#capital-structure-determinants" id="toc-capital-structure-determinants" class="nav-link" data-scroll-target="#capital-structure-determinants"><span class="header-section-number">42.3.1</span> Capital Structure Determinants</a></li>
  <li><a href="#pecking-order-tests" id="toc-pecking-order-tests" class="nav-link" data-scroll-target="#pecking-order-tests"><span class="header-section-number">42.3.2</span> Pecking Order Tests</a></li>
  <li><a href="#market-timing-measures" id="toc-market-timing-measures" class="nav-link" data-scroll-target="#market-timing-measures"><span class="header-section-number">42.3.3</span> Market Timing Measures</a></li>
  </ul></li>
  <li><a href="#payout-policy-estimators" id="toc-payout-policy-estimators" class="nav-link" data-scroll-target="#payout-policy-estimators"><span class="header-section-number">42.4</span> Payout Policy Estimators</a>
  <ul class="collapse">
  <li><a href="#dividend-smoothing" id="toc-dividend-smoothing" class="nav-link" data-scroll-target="#dividend-smoothing"><span class="header-section-number">42.4.1</span> Dividend Smoothing</a></li>
  <li><a href="#smoothing-heterogeneity-soes-vs.-private-firms" id="toc-smoothing-heterogeneity-soes-vs.-private-firms" class="nav-link" data-scroll-target="#smoothing-heterogeneity-soes-vs.-private-firms"><span class="header-section-number">42.4.2</span> Smoothing Heterogeneity: SOEs vs.&nbsp;Private Firms</a></li>
  <li><a href="#share-repurchases" id="toc-share-repurchases" class="nav-link" data-scroll-target="#share-repurchases"><span class="header-section-number">42.4.3</span> Share Repurchases</a></li>
  <li><a href="#agency-and-signaling-interpretations" id="toc-agency-and-signaling-interpretations" class="nav-link" data-scroll-target="#agency-and-signaling-interpretations"><span class="header-section-number">42.4.4</span> Agency and Signaling Interpretations</a></li>
  </ul></li>
  <li><a href="#agency-cost-proxies" id="toc-agency-cost-proxies" class="nav-link" data-scroll-target="#agency-cost-proxies"><span class="header-section-number">42.5</span> Agency Cost Proxies</a>
  <ul class="collapse">
  <li><a href="#ownership-concentration-and-agency-problems" id="toc-ownership-concentration-and-agency-problems" class="nav-link" data-scroll-target="#ownership-concentration-and-agency-problems"><span class="header-section-number">42.5.1</span> Ownership Concentration and Agency Problems</a></li>
  <li><a href="#free-cash-flow-measures" id="toc-free-cash-flow-measures" class="nav-link" data-scroll-target="#free-cash-flow-measures"><span class="header-section-number">42.5.2</span> Free Cash Flow Measures</a></li>
  <li><a href="#monitoring-mechanisms-and-governance-variables" id="toc-monitoring-mechanisms-and-governance-variables" class="nav-link" data-scroll-target="#monitoring-mechanisms-and-governance-variables"><span class="header-section-number">42.5.3</span> Monitoring Mechanisms and Governance Variables</a></li>
  <li><a href="#agency-costs-and-firm-value" id="toc-agency-costs-and-firm-value" class="nav-link" data-scroll-target="#agency-costs-and-firm-value"><span class="header-section-number">42.5.4</span> Agency Costs and Firm Value</a></li>
  </ul></li>
  <li><a href="#linking-corporate-decisions-to-returns" id="toc-linking-corporate-decisions-to-returns" class="nav-link" data-scroll-target="#linking-corporate-decisions-to-returns"><span class="header-section-number">42.6</span> Linking Corporate Decisions to Returns</a>
  <ul class="collapse">
  <li><a href="#investment-based-anomalies" id="toc-investment-based-anomalies" class="nav-link" data-scroll-target="#investment-based-anomalies"><span class="header-section-number">42.6.1</span> Investment-Based Anomalies</a></li>
  <li><a href="#financing-anomalies" id="toc-financing-anomalies" class="nav-link" data-scroll-target="#financing-anomalies"><span class="header-section-number">42.6.2</span> Financing Anomalies</a></li>
  <li><a href="#valuation-implications-fama-french-factor-regressions" id="toc-valuation-implications-fama-french-factor-regressions" class="nav-link" data-scroll-target="#valuation-implications-fama-french-factor-regressions"><span class="header-section-number">42.6.3</span> Valuation Implications: Fama-French Factor Regressions</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">42.7</span> Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/edit/main/62_corporate_finance_estimators.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./60_event_studies.html">Advanced Financial Modeling</a></li><li class="breadcrumb-item"><a href="./62_corporate_finance_estimators.html"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Corporate Finance Estimators and Identification</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Corporate Finance Estimators and Identification</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Corporate finance is the study of how firms make investment, financing, and payout decisions under real-world frictions (e.g., taxes, asymmetric information, agency conflicts, transaction costs, and financial constraints). Unlike asset pricing, where the primary objects of interest are expected returns and risk premia estimated from market data, corporate finance estimators are tied to firm-level accounting and governance data, and their economic interpretation depends critically on the institutional environment in which the firm operates.</p>
<p>This chapter develops the core econometric toolkit for empirical corporate finance and applies it to Vietnamese listed firms. The estimators we cover (including investment-<span class="math inline">\(Q\)</span> regressions, cash flow sensitivity tests, capital structure determinants, payout smoothing models, and agency cost proxies) form the backbone of the modern corporate finance literature. Each estimator embeds specific theoretical assumptions, and each has been the subject of substantial methodological debate. We pay careful attention to identification challenges: the conditions under which a regression coefficient admits a causal or structural interpretation versus merely a descriptive association.</p>
<p>Vietnamese firms present distinctive features that interact with these estimators in economically meaningful ways. State ownership remains pervasive and creates agency problems qualitatively different from the dispersed-ownership setting of the Anglo-American literature. Concentrated family ownership, pyramidal structures, and cross-holdings generate tunneling incentives documented by <span class="citation" data-cites="johnson2000tunneling">Johnson et al. (<a href="references.html#ref-johnson2000tunneling" role="doc-biblioref">2000</a>)</span> and <span class="citation" data-cites="claessens2002disentangling">Claessens et al. (<a href="references.html#ref-claessens2002disentangling" role="doc-biblioref">2002</a>)</span>. The banking system is dominated by state-owned commercial banks whose lending decisions may reflect political rather than purely economic criteria, complicating the interpretation of financing constraint measures. And dividend policy is shaped by regulatory requirements, including minimum payout ratios for state-owned enterprises, that have no parallel in more developed markets.</p>
<div id="setup" class="cell" data-message="false" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> linearmodels.panel <span class="im">import</span> PanelOLS, PooledOLS</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> p9</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mizani.formatters <span class="im">import</span> percent_format, comma_format</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="load-data" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DataCore.vn API</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datacore <span class="im">import</span> DataCore</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>dc <span class="op">=</span> DataCore()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load annual firm-level financial data</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>firm_annual <span class="op">=</span> dc.get_firm_financials(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">"2008-01-01"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">"2024-12-31"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">"annual"</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ownership data</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>ownership <span class="op">=</span> dc.get_ownership_data(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">"2008-01-01"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">"2024-12-31"</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Load stock returns (monthly)</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>monthly_returns <span class="op">=</span> dc.get_monthly_returns(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">"2008-01-01"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">"2024-12-31"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Load market and factor returns</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>factors <span class="op">=</span> dc.get_factor_returns(</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">"2008-01-01"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">"2024-12-31"</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Firm-year observations: </span><span class="sc">{</span><span class="bu">len</span>(firm_annual)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique firms: </span><span class="sc">{</span>firm_annual[<span class="st">'ticker'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Year range: </span><span class="sc">{</span>firm_annual[<span class="st">'year'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">}</span><span class="ss">–</span><span class="sc">{</span>firm_annual[<span class="st">'year'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="investment-q-regressions" class="level2" data-number="42.1">
<h2 data-number="42.1" class="anchored" data-anchor-id="investment-q-regressions"><span class="header-section-number">42.1</span> Investment-<span class="math inline">\(Q\)</span> Regressions</h2>
<section id="tobins-q-intuition-and-theory" class="level3" data-number="42.1.1">
<h3 data-number="42.1.1" class="anchored" data-anchor-id="tobins-q-intuition-and-theory"><span class="header-section-number">42.1.1</span> Tobin’s <span class="math inline">\(Q\)</span>: Intuition and Theory</h3>
<p>The investment-<span class="math inline">\(Q\)</span> framework is the canonical structural model of corporate investment. The core insight, formalized by <span class="citation" data-cites="hayashi1982tobin">Hayashi (<a href="references.html#ref-hayashi1982tobin" role="doc-biblioref">1982</a>)</span>, is elegant: under perfect capital markets and constant returns to scale in the production and adjustment cost technologies, a firm’s investment rate should be a sufficient statistic of a single observable (i.e., the ratio of the market value of installed capital to its replacement cost).</p>
<p>Let <span class="math inline">\(V_t\)</span> denote the market value of the firm’s assets at time <span class="math inline">\(t\)</span> and <span class="math inline">\(K_t\)</span> the replacement cost of its capital stock. Tobin’s <span class="math inline">\(Q\)</span> is:</p>
<p><span id="eq-tobins-q"><span class="math display">\[
Q_t = \frac{V_t}{K_t}
\tag{42.1}\]</span></span></p>
<p>When <span class="math inline">\(Q &gt; 1\)</span>, the market values a unit of installed capital above its replacement cost, signaling that the firm should invest. When <span class="math inline">\(Q &lt; 1\)</span>, the firm should disinvest. In the frictionless <span class="citation" data-cites="hayashi1982tobin">Hayashi (<a href="references.html#ref-hayashi1982tobin" role="doc-biblioref">1982</a>)</span> environment, the marginal <span class="math inline">\(Q\)</span> (the shadow value of an additional unit of capital) equals the average <span class="math inline">\(Q\)</span> (the ratio of total market value to total replacement cost), and the optimal investment policy is:</p>
<p><span id="eq-investment-q-theory"><span class="math display">\[
\frac{I_{i,t}}{K_{i,t-1}} = \frac{1}{\alpha}\left(Q_{i,t} - 1\right)
\tag{42.2}\]</span></span></p>
<p>where <span class="math inline">\(\alpha\)</span> governs the convexity of adjustment costs. The empirical counterpart is the regression:</p>
<p><span id="eq-investment-q-regression"><span class="math display">\[
\frac{I_{i,t}}{K_{i,t-1}} = \beta_0 + \beta_1 Q_{i,t} + \varepsilon_{i,t}
\tag{42.3}\]</span></span></p>
<p>Under the structural interpretation, <span class="math inline">\(\beta_1 = 1/\alpha &gt; 0\)</span> and <span class="math inline">\(Q\)</span> is the sole explanatory variable. Any additional variable that enters significantly implies a violation of the underlying assumptions (e.g., financial frictions, agency problems, measurement error in <span class="math inline">\(Q\)</span>, or departures from constant returns to scale).</p>
</section>
<section id="measurement-issues" class="level3" data-number="42.1.2">
<h3 data-number="42.1.2" class="anchored" data-anchor-id="measurement-issues"><span class="header-section-number">42.1.2</span> Measurement Issues</h3>
<p>The theoretical object is marginal <span class="math inline">\(Q\)</span> (i.e., the value of the next dollar of investment) which is unobservable. The empirical proxy is average <span class="math inline">\(Q\)</span>, typically constructed as:</p>
<p><span id="eq-average-q"><span class="math display">\[
Q_{i,t}^{\text{avg}} = \frac{\text{Market Value of Equity} + \text{Book Value of Debt}}{\text{Book Value of Total Assets}}
\tag{42.4}\]</span></span></p>
<p>This proxy introduces several problems that are well-documented in the literature.</p>
<p><strong>Problem 1: Marginal</strong> <span class="math inline">\(\neq\)</span> Average. The equality <span class="math inline">\(q^{\text{marginal}} = Q^{\text{average}}\)</span> requires constant returns to scale in both production and adjustment costs <span class="citation" data-cites="hayashi1982tobin">(<a href="references.html#ref-hayashi1982tobin" role="doc-biblioref">Hayashi 1982</a>)</span>. With decreasing returns to scale (empirically relevant for most firms), average <span class="math inline">\(Q\)</span> overstates marginal <span class="math inline">\(Q\)</span> for high-<span class="math inline">\(Q\)</span> firms and understates it for low-<span class="math inline">\(Q\)</span> firms. <span class="citation" data-cites="abel1994unified">Abel and Eberly (<a href="references.html#ref-abel1994unified" role="doc-biblioref">1994</a>)</span> derive the wedge analytically.</p>
<p><strong>Problem 2: Measurement error in numerator.</strong> The market value of equity reflects market sentiment, bubbles, and noise-trader demand in addition to fundamentals. <span class="citation" data-cites="bond2012real">P. Bond, Edmans, and Goldstein (<a href="references.html#ref-bond2012real" role="doc-biblioref">2012</a>)</span> provide a comprehensive treatment. In Vietnamese markets, where retail investors dominate and price limits constrain daily adjustment, market prices may deviate persistently from fundamental value.</p>
<p><strong>Problem 3: Measurement error in denominator.</strong> Book values of assets reflect historical cost, depreciation schedules, and accounting conventions that may poorly approximate replacement cost. This is especially problematic in Vietnam, where revaluation of fixed assets is infrequent and inflation has historically been volatile, creating wedges between historical and replacement cost.</p>
<p><strong>Problem 4: Errors-in-variables bias.</strong> Because the empirical <span class="math inline">\(Q\)</span> is a noisy proxy for the true <span class="math inline">\(Q\)</span>, OLS estimates of <span class="math inline">\(\beta_1\)</span> in <a href="#eq-investment-q-regression" class="quarto-xref">Equation&nbsp;<span>42.3</span></a> suffer from classical attenuation bias (i.e., <span class="math inline">\(hat{\beta}_1\)</span> is biased toward zero). <span class="citation" data-cites="erickson2012treating">Erickson and Whited (<a href="references.html#ref-erickson2012treating" role="doc-biblioref">2012</a>)</span> develop a higher-order cumulant estimator that corrects for this bias without requiring external instruments.</p>
<div id="construct-q" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct Tobin's Q and investment variables</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>panel <span class="op">=</span> firm_annual.copy()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tobin's Q: (Market cap + Book debt) / Total assets</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"tobins_q"</span>] <span class="op">=</span> (</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    (panel[<span class="st">"market_cap"</span>] <span class="op">+</span> panel[<span class="st">"total_debt"</span>]) <span class="op">/</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    panel[<span class="st">"total_assets"</span>]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Investment rate: Capital expenditure / Lagged total assets</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>panel <span class="op">=</span> panel.sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"lag_assets"</span>] <span class="op">=</span> panel.groupby(<span class="st">"ticker"</span>)[<span class="st">"total_assets"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"lag_ppe"</span>] <span class="op">=</span> panel.groupby(<span class="st">"ticker"</span>)[<span class="st">"ppe_net"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"inv_rate"</span>] <span class="op">=</span> panel[<span class="st">"capex"</span>] <span class="op">/</span> panel[<span class="st">"lag_assets"</span>]</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"inv_rate_ppe"</span>] <span class="op">=</span> panel[<span class="st">"capex"</span>] <span class="op">/</span> panel[<span class="st">"lag_ppe"</span>]</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Cash flow / Assets</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"cf_assets"</span>] <span class="op">=</span> panel[<span class="st">"operating_cf"</span>] <span class="op">/</span> panel[<span class="st">"lag_assets"</span>]</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sales growth</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"lag_revenue"</span>] <span class="op">=</span> panel.groupby(<span class="st">"ticker"</span>)[<span class="st">"revenue"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"sales_growth"</span>] <span class="op">=</span> (</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    (panel[<span class="st">"revenue"</span>] <span class="op">-</span> panel[<span class="st">"lag_revenue"</span>]) <span class="op">/</span> panel[<span class="st">"lag_revenue"</span>]</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsorize at 1st and 99th percentiles</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> winsorize(s, lower<span class="op">=</span><span class="fl">0.01</span>, upper<span class="op">=</span><span class="fl">0.99</span>):</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s.clip(s.quantile(lower), s.quantile(upper))</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"tobins_q"</span>, <span class="st">"inv_rate"</span>, <span class="st">"cf_assets"</span>, <span class="st">"sales_growth"</span>]:</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    panel[col] <span class="op">=</span> winsorize(panel[col])</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>panel_clean <span class="op">=</span> panel.dropna(</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"tobins_q"</span>, <span class="st">"inv_rate"</span>, <span class="st">"cf_assets"</span>]</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>).copy()</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Clean panel: </span><span class="sc">{</span><span class="bu">len</span>(panel_clean)<span class="sc">}</span><span class="ss"> firm-years, "</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"</span><span class="sc">{</span>panel_clean[<span class="st">'ticker'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss"> firms"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-investment-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="5">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-investment-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.1: Summary Statistics: Investment and Q Variables
</figcaption>
<div aria-describedby="tbl-investment-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>summary_vars <span class="op">=</span> [<span class="st">"inv_rate"</span>, <span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, <span class="st">"sales_growth"</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> panel_clean[summary_vars].describe(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    percentiles<span class="op">=</span>[<span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>).T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>summary.columns <span class="op">=</span> [<span class="st">"N"</span>, <span class="st">"Mean"</span>, <span class="st">"Std"</span>, <span class="st">"Min"</span>, <span class="st">"5%"</span>, <span class="st">"25%"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Median"</span>, <span class="st">"75%"</span>, <span class="st">"95%"</span>, <span class="st">"Max"</span>]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<div id="baseline-q-regression" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Baseline investment-Q regression with firm and year fixed effects</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>panel_clean <span class="op">=</span> panel_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Q only</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> PanelOLS(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    panel_clean[<span class="st">"inv_rate"</span>],</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    panel_clean[[<span class="st">"tobins_q"</span>]],</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Q + Cash Flow</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> PanelOLS(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    panel_clean[<span class="st">"inv_rate"</span>],</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    panel_clean[[<span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>]],</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3: Q + Cash Flow + Sales Growth</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>model3 <span class="op">=</span> PanelOLS(</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    panel_clean[<span class="st">"inv_rate"</span>],</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    panel_clean[[<span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, <span class="st">"sales_growth"</span>]],</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>panel_clean <span class="op">=</span> panel_clean.reset_index()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-q-regression" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="7">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-q-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.2: Investment-Q Regressions with Firm and Year Fixed Effects
</figcaption>
<div aria-describedby="tbl-q-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>results_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Q Only"</span>: {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tobin's Q"</span>: <span class="ss">f"</span><span class="sc">{</span>model1<span class="sc">.</span>params[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>: <span class="ss">f"(</span><span class="sc">{</span>model1<span class="sc">.</span>std_errors[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cash Flow/Assets"</span>: <span class="st">""</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">" "</span>: <span class="st">""</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sales Growth"</span>: <span class="st">""</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  "</span>: <span class="st">""</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R² (within)"</span>: <span class="ss">f"</span><span class="sc">{</span>model1<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(model1.nobs)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Q + CF"</span>: {</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tobin's Q"</span>: <span class="ss">f"</span><span class="sc">{</span>model2<span class="sc">.</span>params[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>: <span class="ss">f"(</span><span class="sc">{</span>model2<span class="sc">.</span>std_errors[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cash Flow/Assets"</span>: <span class="ss">f"</span><span class="sc">{</span>model2<span class="sc">.</span>params[<span class="st">'cf_assets'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">" "</span>: <span class="ss">f"(</span><span class="sc">{</span>model2<span class="sc">.</span>std_errors[<span class="st">'cf_assets'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sales Growth"</span>: <span class="st">""</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  "</span>: <span class="st">""</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R² (within)"</span>: <span class="ss">f"</span><span class="sc">{</span>model2<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(model2.nobs)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Q + CF + SG"</span>: {</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tobin's Q"</span>: <span class="ss">f"</span><span class="sc">{</span>model3<span class="sc">.</span>params[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>: <span class="ss">f"(</span><span class="sc">{</span>model3<span class="sc">.</span>std_errors[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cash Flow/Assets"</span>: <span class="ss">f"</span><span class="sc">{</span>model3<span class="sc">.</span>params[<span class="st">'cf_assets'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">" "</span>: <span class="ss">f"(</span><span class="sc">{</span>model3<span class="sc">.</span>std_errors[<span class="st">'cf_assets'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sales Growth"</span>: <span class="ss">f"</span><span class="sc">{</span>model3<span class="sc">.</span>params[<span class="st">'sales_growth'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  "</span>: <span class="ss">f"(</span><span class="sc">{</span>model3<span class="sc">.</span>std_errors[<span class="st">'sales_growth'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R² (within)"</span>: <span class="ss">f"</span><span class="sc">{</span>model3<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(model3.nobs)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>results_table</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="interpretation-under-market-frictions" class="level3" data-number="42.1.3">
<h3 data-number="42.1.3" class="anchored" data-anchor-id="interpretation-under-market-frictions"><span class="header-section-number">42.1.3</span> Interpretation Under Market Frictions</h3>
<p>The coefficient on <span class="math inline">\(Q\)</span> in <a href="#tbl-q-regression" class="quarto-xref">Table&nbsp;<span>42.2</span></a> admits multiple interpretations depending on the maintained assumptions:</p>
<p><strong>Structural interpretation.</strong> If the Hayashi conditions hold, <span class="math inline">\(\hat{\beta}_1\)</span> estimates the inverse of the adjustment cost parameter: <span class="math inline">\(\hat{\beta}_1 = 1/\hat{\alpha}\)</span>. A larger coefficient implies lower adjustment costs. However, measurement error in <span class="math inline">\(Q\)</span> biases <span class="math inline">\(\hat{\beta}_1\)</span> downward, so the raw OLS estimate provides a lower bound on <span class="math inline">\(1/\alpha\)</span>.</p>
<p><strong>Reduced-form interpretation.</strong> Without the Hayashi conditions, <span class="math inline">\(\hat{\beta}_1\)</span> captures the association between market valuation and investment intensity. This association reflects a mixture of genuine investment opportunities (the <span class="math inline">\(Q\)</span>-theory channel), market mispricing that managers exploit (the market timing channel of <span class="citation" data-cites="baker2003does">Baker, Stein, and Wurgler (<a href="references.html#ref-baker2003does" role="doc-biblioref">2003</a>)</span>), and reverse causality (investment announcements that move market values).</p>
<p><strong>The cash flow coefficient puzzle.</strong> The significance of <span class="math inline">\(\hat{\beta}_2\)</span> on cash flow has been the subject of a 35-year debate. <span class="citation" data-cites="fazzari1987financing">Fazzari, Hubbard, and Petersen (<a href="references.html#ref-fazzari1987financing" role="doc-biblioref">1987</a>)</span> interpret it as evidence that firms face financing constraints: controlling for investment opportunities (<span class="math inline">\(Q\)</span>), cash flow should be irrelevant in a frictionless world, so its significance implies that internal funds relax binding constraints. <span class="citation" data-cites="kaplan1997investment">Kaplan and Zingales (<a href="references.html#ref-kaplan1997investment" role="doc-biblioref">1997</a>)</span> counter that cash flow proxies for investment opportunities not captured by the noisy <span class="math inline">\(Q\)</span> measure, making the cash flow coefficient an artifact of measurement error rather than evidence of constraints. <span class="citation" data-cites="erickson2012treating">Erickson and Whited (<a href="references.html#ref-erickson2012treating" role="doc-biblioref">2012</a>)</span> show that correcting for measurement error in <span class="math inline">\(Q\)</span> substantially reduces (but does not eliminate) the cash flow coefficient, supporting a middle ground.</p>
</section>
<section id="limitations-in-emerging-markets" class="level3" data-number="42.1.4">
<h3 data-number="42.1.4" class="anchored" data-anchor-id="limitations-in-emerging-markets"><span class="header-section-number">42.1.4</span> Limitations in Emerging Markets</h3>
<p>The investment-<span class="math inline">\(Q\)</span> framework faces amplified challenges in Vietnamese markets.</p>
<p><strong>Thin trading and price limits.</strong> Market prices adjust slowly to information, so <span class="math inline">\(Q\)</span> measured at fiscal year-end may not reflect the firm’s current investment opportunity set. Price limits of <span class="math inline">\(\pm 7\%\)</span> (HOSE) and <span class="math inline">\(\pm 10\%\)</span> (HNX) mechanically compress the numerator of <span class="math inline">\(Q\)</span>, attenuating the investment-<span class="math inline">\(Q\)</span> relationship.</p>
<p><strong>State ownership.</strong> For state-owned enterprises (SOEs), investment decisions may be driven by policy directives rather than <span class="math inline">\(Q\)</span>-theoretic optimality. Including SOEs in the regression without interactions confounds the structural relationship.</p>
<p><strong>Related-party transactions.</strong> Tunneling through related-party transactions means that measured investment may include capital expenditures that benefit controlling shareholders rather than maximizing firm value. The investment-<span class="math inline">\(Q\)</span> coefficient in tunneling firms reflects the relationship between market valuation and expropriation, not efficient capital allocation.</p>
<div id="fig-investment-q-scatter" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="8">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-investment-q-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Q-decile bins for clean visualization</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plot_data <span class="op">=</span> panel_clean.copy()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plot_data[<span class="st">"q_bin"</span>] <span class="op">=</span> pd.qcut(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    plot_data[<span class="st">"tobins_q"</span>], q<span class="op">=</span><span class="dv">20</span>, duplicates<span class="op">=</span><span class="st">"drop"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> (</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    plot_data.groupby(<span class="st">"q_bin"</span>, observed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        mean_q<span class="op">=</span>(<span class="st">"tobins_q"</span>, <span class="st">"mean"</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        mean_inv<span class="op">=</span>(<span class="st">"inv_rate"</span>, <span class="st">"mean"</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        se_inv<span class="op">=</span>(<span class="st">"inv_rate"</span>, <span class="kw">lambda</span> x: x.std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(x)))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(binned, p9.aes(x<span class="op">=</span><span class="st">"mean_q"</span>, y<span class="op">=</span><span class="st">"mean_inv"</span>))</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_pointrange(</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        p9.aes(ymin<span class="op">=</span><span class="st">"mean_inv - 1.96*se_inv"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>               ymax<span class="op">=</span><span class="st">"mean_inv + 1.96*se_inv"</span>),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"#2E5090"</span>, size<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_smooth(method<span class="op">=</span><span class="st">"lm"</span>, color<span class="op">=</span><span class="st">"#C0392B"</span>, se<span class="op">=</span><span class="va">False</span>, size<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Tobin's Q (Vingtile Mean)"</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Investment Rate (I/A)"</span>,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Investment-Q Relationship: Binned Scatter"</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-investment-q-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;42.1
</figcaption>
</figure>
</div>
<div id="q-regression-soe-interaction" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge ownership data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>panel_with_own <span class="op">=</span> panel_clean.merge(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    ownership[[<span class="st">"ticker"</span>, <span class="st">"year"</span>, <span class="st">"state_ownership_pct"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"foreign_ownership_pct"</span>, <span class="st">"insider_ownership_pct"</span>]],</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"year"</span>],</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>panel_with_own[<span class="st">"soe_dummy"</span>] <span class="op">=</span> (</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    panel_with_own[<span class="st">"state_ownership_pct"</span>] <span class="op">&gt;</span> <span class="dv">50</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>).astype(<span class="bu">int</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>panel_with_own[<span class="st">"q_x_soe"</span>] <span class="op">=</span> (</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    panel_with_own[<span class="st">"tobins_q"</span>] <span class="op">*</span> panel_with_own[<span class="st">"soe_dummy"</span>]</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>panel_with_own[<span class="st">"cf_x_soe"</span>] <span class="op">=</span> (</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    panel_with_own[<span class="st">"cf_assets"</span>] <span class="op">*</span> panel_with_own[<span class="st">"soe_dummy"</span>]</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression with SOE interactions</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>panel_soe <span class="op">=</span> panel_with_own.dropna(</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"inv_rate"</span>, <span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, <span class="st">"soe_dummy"</span>]</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>).set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>model_soe <span class="op">=</span> PanelOLS(</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    panel_soe[<span class="st">"inv_rate"</span>],</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    panel_soe[[<span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, <span class="st">"soe_dummy"</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>               <span class="st">"q_x_soe"</span>, <span class="st">"cf_x_soe"</span>]],</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>panel_soe <span class="op">=</span> panel_soe.reset_index()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-soe-interaction" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="10">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-soe-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.3: Investment-Q Regression with State Ownership Interactions
</figcaption>
<div aria-describedby="tbl-soe-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>soe_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_soe.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_soe.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_soe.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_soe.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>soe_results</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<p>A negative coefficient on <span class="math inline">\(Q \times \text{SOE}\)</span> indicates that the investment-<span class="math inline">\(Q\)</span> sensitivity is attenuated for state-owned enterprises, consistent with SOE investment being driven by non-market factors. The interaction of cash flow with SOE status reveals whether state firms face tighter or looser financing constraints. This is a question with direct policy implications for SOE reform.</p>
</section>
<section id="the-erickson-whited-measurement-error-correction" class="level3" data-number="42.1.5">
<h3 data-number="42.1.5" class="anchored" data-anchor-id="the-erickson-whited-measurement-error-correction"><span class="header-section-number">42.1.5</span> The Erickson-Whited Measurement Error Correction</h3>
<p><span class="citation" data-cites="erickson2012treating">Erickson and Whited (<a href="references.html#ref-erickson2012treating" role="doc-biblioref">2012</a>)</span> develop a GMM estimator that uses higher-order moments of the data to identify the investment-<span class="math inline">\(Q\)</span> slope in the presence of measurement error, without requiring external instruments. The key insight is that if the measurement error <span class="math inline">\(\eta\)</span> in <span class="math inline">\(Q\)</span> is independent of the true <span class="math inline">\(Q^*\)</span> and the structural error <span class="math inline">\(\varepsilon\)</span>, then the third-order cumulants identify the signal-to-noise ratio.</p>
<p>The model is:</p>
<p><span id="eq-erickson-whited"><span class="math display">\[
\frac{I_{i,t}}{K_{i,t-1}} = \beta_0 + \beta_1 Q_{i,t}^* + \gamma X_{i,t} + \varepsilon_{i,t}, \qquad Q_{i,t} = Q_{i,t}^* + \eta_{i,t}
\tag{42.5}\]</span></span></p>
<p>where <span class="math inline">\(Q_{i,t}^*\)</span> is unobserved true <span class="math inline">\(Q\)</span> and <span class="math inline">\(\eta_{i,t}\)</span> is measurement error. The OLS estimator <span class="math inline">\(\hat{\beta}_1^{\text{OLS}}\)</span> converges to <span class="math inline">\(\beta_1 \cdot \lambda\)</span> where <span class="math inline">\(\lambda = \text{Var}(Q^*) / (\text{Var}(Q^*) + \text{Var}(\eta)) &lt; 1\)</span> is the signal-to-noise ratio. The Erickson-Whited estimator recovers <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\lambda\)</span> simultaneously.</p>
<div id="erickson-whited" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> erickson_whited_gmm(y, Q_obs, X<span class="op">=</span><span class="va">None</span>, order<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Simplified Erickson-Whited (2012) measurement error correction</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">    using third-order cumulants.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">    y : array</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Dependent variable (investment rate).</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Q_obs : array</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Observed (mismeasured) Q.</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">    X : array or None</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">        Additional controls (partialled out first).</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">    order : int</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">        Cumulant order for identification (3 or 5).</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">    dict : Corrected beta, signal-to-noise ratio, OLS beta.</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> X <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Partial out controls via OLS</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        X_aug <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> y <span class="op">-</span> X_aug <span class="op">@</span> np.linalg.lstsq(X_aug, y, rcond<span class="op">=</span><span class="va">None</span>)[<span class="dv">0</span>]</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        Q_obs <span class="op">=</span> Q_obs <span class="op">-</span> X_aug <span class="op">@</span> np.linalg.lstsq(X_aug, Q_obs, rcond<span class="op">=</span><span class="va">None</span>)[<span class="dv">0</span>]</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Demean</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    y_dm <span class="op">=</span> y <span class="op">-</span> y.mean()</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    q_dm <span class="op">=</span> Q_obs <span class="op">-</span> Q_obs.mean()</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Second moments</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    m_yq <span class="op">=</span> np.mean(y_dm <span class="op">*</span> q_dm)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    m_qq <span class="op">=</span> np.mean(q_dm<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># OLS beta</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    beta_ols <span class="op">=</span> m_yq <span class="op">/</span> m_qq</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Third-order cumulants for identification</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    k3_q <span class="op">=</span> np.mean(q_dm<span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    k2y_q <span class="op">=</span> np.mean(y_dm <span class="op">*</span> q_dm<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(k3_q) <span class="op">&lt;</span> <span class="fl">1e-10</span>:</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">"beta_corrected"</span>: np.nan,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">"lambda_snr"</span>: np.nan,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">"beta_ols"</span>: beta_ols,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">"note"</span>: <span class="st">"Insufficient skewness for identification"</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Corrected beta: beta = kappa_{y,q,q} / kappa_{q,q,q}</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    beta_ew <span class="op">=</span> k2y_q <span class="op">/</span> k3_q</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Signal-to-noise ratio</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lambda = kappa_{q,q,q}^2 / (kappa_{q,q} * kappa_{q,q,q,q,q})</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simplified: lambda = beta_ols / beta_ew</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    lambda_snr <span class="op">=</span> beta_ols <span class="op">/</span> beta_ew <span class="cf">if</span> <span class="bu">abs</span>(beta_ew) <span class="op">&gt;</span> <span class="fl">1e-10</span> <span class="cf">else</span> np.nan</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>        <span class="st">"beta_corrected"</span>: beta_ew,</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">"lambda_snr"</span>: lambda_snr,</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"beta_ols"</span>: beta_ols,</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">"attenuation_pct"</span>: <span class="bu">round</span>((<span class="dv">1</span> <span class="op">-</span> lambda_snr) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">1</span>) <span class="cf">if</span> <span class="kw">not</span> np.isnan(lambda_snr) <span class="cf">else</span> np.nan</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to Vietnamese data</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>ew_data <span class="op">=</span> panel_clean.dropna(subset<span class="op">=</span>[<span class="st">"inv_rate"</span>, <span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>])</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>ew_result <span class="op">=</span> erickson_whited_gmm(</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>ew_data[<span class="st">"inv_rate"</span>].values,</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>    Q_obs<span class="op">=</span>ew_data[<span class="st">"tobins_q"</span>].values,</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>    X<span class="op">=</span>ew_data[<span class="st">"cf_assets"</span>].values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Erickson-Whited Measurement Error Correction:"</span>)</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, v <span class="kw">in</span> ew_result.items():</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(v, <span class="bu">float</span>):</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>v<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>v<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="cash-flow-sensitivity-of-investment" class="level2" data-number="42.2">
<h2 data-number="42.2" class="anchored" data-anchor-id="cash-flow-sensitivity-of-investment"><span class="header-section-number">42.2</span> Cash Flow Sensitivity of Investment</h2>
<section id="the-financing-constraints-hypothesis" class="level3" data-number="42.2.1">
<h3 data-number="42.2.1" class="anchored" data-anchor-id="the-financing-constraints-hypothesis"><span class="header-section-number">42.2.1</span> The Financing Constraints Hypothesis</h3>
<p>The cash flow sensitivity of investment (CFSI) literature tests whether firms’ investment decisions are constrained by the availability of internal funds. In a Modigliani-Miller world, internal and external funds are perfect substitutes, so cash flow should be irrelevant for investment after controlling for investment opportunities. The CFSI approach, pioneered by <span class="citation" data-cites="fazzari1987financing">Fazzari, Hubbard, and Petersen (<a href="references.html#ref-fazzari1987financing" role="doc-biblioref">1987</a>)</span>, classifies firms as financially constrained or unconstrained using observable characteristics and tests whether constrained firms exhibit higher sensitivity of investment to cash flow.</p>
<p>The augmented investment regression is:</p>
<p><span id="eq-cfsi-base"><span class="math display">\[
\frac{I_{i,t}}{K_{i,t-1}} = \beta_0 + \beta_1 Q_{i,t} + \beta_2 \frac{CF_{i,t}}{K_{i,t-1}} + \varepsilon_{i,t}
\tag{42.6}\]</span></span></p>
<p>The CFSI hypothesis predicts <span class="math inline">\(\beta_2^{\text{constrained}} &gt; \beta_2^{\text{unconstrained}} &gt; 0\)</span>: constrained firms rely more heavily on internal cash flow to fund investment because external finance is costly or unavailable.</p>
</section>
<section id="the-fhp-kz-debate" class="level3" data-number="42.2.2">
<h3 data-number="42.2.2" class="anchored" data-anchor-id="the-fhp-kz-debate"><span class="header-section-number">42.2.2</span> The FHP-KZ Debate</h3>
<p><span class="citation" data-cites="fazzari1987financing">Fazzari, Hubbard, and Petersen (<a href="references.html#ref-fazzari1987financing" role="doc-biblioref">1987</a>)</span> (FHP) classify firms by dividend payout ratios and find that low-payout firms (presumed constrained) exhibit significantly higher cash flow sensitivity. <span class="citation" data-cites="kaplan1997investment">Kaplan and Zingales (<a href="references.html#ref-kaplan1997investment" role="doc-biblioref">1997</a>)</span> (KZ) challenge this interpretation on two grounds:</p>
<p><strong>Critique 1:</strong> <span class="math inline">\(Q\)</span> measurement error. If <span class="math inline">\(Q\)</span> is a noisy proxy for true investment opportunities, and cash flow is correlated with the measurement error (because both respond to demand shocks), then the cash flow coefficient captures omitted investment opportunities, not financing constraints.</p>
<p><strong>Critique 2: Monotonicity failure.</strong> KZ show that the firms FHP classify as “most constrained” (low-payout firms) are often rapidly growing firms that choose to retain earnings for investment, not firms that are denied external financing. Using qualitative information from annual reports, KZ reclassify firms and find that the CFSI ranking reverses: firms judged to be truly constrained by their own disclosures exhibit lower CFSI than unconstrained firms.</p>
<p>The resolution, as argued by <span class="citation" data-cites="farre2016measures">Farre-Mensa and Ljungqvist (<a href="references.html#ref-farre2016measures" role="doc-biblioref">2016</a>)</span>, is that no single proxy reliably identifies financially constrained firms. Each proxy (size, age, payout ratio, bond rating, KZ index, WW index, SA index) captures a different dimension of the financing environment, and the CFSI test is not a clean test of any single theory.</p>
</section>
<section id="constraint-indices" class="level3" data-number="42.2.3">
<h3 data-number="42.2.3" class="anchored" data-anchor-id="constraint-indices"><span class="header-section-number">42.2.3</span> Constraint Indices</h3>
<p>We implement the three most widely used composite constraint measures.</p>
<p><strong>KZ Index</strong> <span class="citation" data-cites="kaplan1997investment lamont2001financial">(<a href="references.html#ref-kaplan1997investment" role="doc-biblioref">Kaplan and Zingales 1997</a>; <a href="references.html#ref-lamont2001financial" role="doc-biblioref">Lamont, Polk, and Saaá-Requejo 2001</a>)</span>:</p>
<p><span id="eq-kz-index"><span class="math display">\[
\text{KZ}_{i,t} = -1.002 \cdot \frac{CF_{i,t}}{K_{i,t-1}} + 0.283 \cdot Q_{i,t} + 3.139 \cdot \frac{D_{i,t}}{A_{i,t}} - 39.368 \cdot \frac{\text{Div}_{i,t}}{K_{i,t-1}} - 1.315 \cdot \frac{C_{i,t}}{K_{i,t-1}}
\tag{42.7}\]</span></span></p>
<p><strong>WW Index</strong> <span class="citation" data-cites="whited2006financial">(<a href="references.html#ref-whited2006financial" role="doc-biblioref">Whited and Wu 2006</a>)</span>:</p>
<p><span id="eq-ww-index"><span class="math display">\[
\text{WW}_{i,t} = -0.091 \cdot \frac{CF_{i,t}}{A_{i,t}} - 0.062 \cdot \mathbb{1}(\text{Div} &gt; 0) + 0.021 \cdot \frac{D_{i,t}}{A_{i,t}} - 0.044 \cdot \ln(A_{i,t}) + 0.102 \cdot \text{ISG}_{i,t} - 0.035 \cdot \text{SG}_{i,t}
\tag{42.8}\]</span></span></p>
<p>where ISG is industry sales growth and SG is firm sales growth.</p>
<p><strong>SA Index</strong> <span class="citation" data-cites="hadlock2010new">(<a href="references.html#ref-hadlock2010new" role="doc-biblioref">Hadlock and Pierce 2010</a>)</span>:</p>
<p><span id="eq-sa-index"><span class="math display">\[
\text{SA}_{i,t} = -0.737 \cdot \text{Size}_{i,t} + 0.043 \cdot \text{Size}_{i,t}^2 - 0.040 \cdot \text{Age}_{i,t}
\tag{42.9}\]</span></span></p>
<p>where Size <span class="math inline">\(= \ln(\text{Total Assets})\)</span> and Age is years since listing. <span class="citation" data-cites="hadlock2010new">Hadlock and Pierce (<a href="references.html#ref-hadlock2010new" role="doc-biblioref">2010</a>)</span> argue that the SA index is preferable because it uses only exogenous firm characteristics (size and age), avoiding the endogeneity inherent in cash flow and leverage-based indices.</p>
<div id="constraint-indices" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute financial constraint indices</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>panel_fc <span class="op">=</span> panel_clean.copy()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lagged PPE for KZ scaling</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"lag_ppe"</span>] <span class="op">=</span> panel_fc.groupby(<span class="st">"ticker"</span>)[<span class="st">"ppe_net"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># KZ Index</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"kz_index"</span>] <span class="op">=</span> (</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">1.002</span> <span class="op">*</span> panel_fc[<span class="st">"cf_assets"</span>]</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">0.283</span> <span class="op">*</span> panel_fc[<span class="st">"tobins_q"</span>]</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">3.139</span> <span class="op">*</span> (panel_fc[<span class="st">"total_debt"</span>] <span class="op">/</span> panel_fc[<span class="st">"total_assets"</span>])</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">39.368</span> <span class="op">*</span> (panel_fc[<span class="st">"dividends"</span>] <span class="op">/</span> panel_fc[<span class="st">"lag_assets"</span>])</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">1.315</span> <span class="op">*</span> (panel_fc[<span class="st">"cash"</span>] <span class="op">/</span> panel_fc[<span class="st">"lag_assets"</span>])</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># SA Index</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"log_assets"</span>] <span class="op">=</span> np.log(panel_fc[<span class="st">"total_assets"</span>])</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"listing_age"</span>] <span class="op">=</span> panel_fc[<span class="st">"year"</span>] <span class="op">-</span> panel_fc[<span class="st">"listing_year"</span>]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"sa_index"</span>] <span class="op">=</span> (</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">0.737</span> <span class="op">*</span> panel_fc[<span class="st">"log_assets"</span>]</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">0.043</span> <span class="op">*</span> panel_fc[<span class="st">"log_assets"</span>]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">0.040</span> <span class="op">*</span> panel_fc[<span class="st">"listing_age"</span>]</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co"># WW Index (simplified: using firm-level variables)</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"div_dummy"</span>] <span class="op">=</span> (panel_fc[<span class="st">"dividends"</span>] <span class="op">&gt;</span> <span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"leverage"</span>] <span class="op">=</span> panel_fc[<span class="st">"total_debt"</span>] <span class="op">/</span> panel_fc[<span class="st">"total_assets"</span>]</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Industry sales growth</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"isg"</span>] <span class="op">=</span> panel_fc.groupby(</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"industry"</span>, <span class="st">"year"</span>]</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"sales_growth"</span>].transform(<span class="st">"median"</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"ww_index"</span>] <span class="op">=</span> (</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">0.091</span> <span class="op">*</span> panel_fc[<span class="st">"cf_assets"</span>]</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">0.062</span> <span class="op">*</span> panel_fc[<span class="st">"div_dummy"</span>]</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">0.021</span> <span class="op">*</span> panel_fc[<span class="st">"leverage"</span>]</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">0.044</span> <span class="op">*</span> panel_fc[<span class="st">"log_assets"</span>]</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">0.102</span> <span class="op">*</span> panel_fc[<span class="st">"isg"</span>]</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">0.035</span> <span class="op">*</span> panel_fc[<span class="st">"sales_growth"</span>]</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-constraint-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="13">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-constraint-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.4: Distribution of Financial Constraint Indices
</figcaption>
<div aria-describedby="tbl-constraint-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>constraint_vars <span class="op">=</span> [<span class="st">"kz_index"</span>, <span class="st">"sa_index"</span>, <span class="st">"ww_index"</span>]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>constraint_summary <span class="op">=</span> (</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    panel_fc[constraint_vars]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    .describe(percentiles<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>])</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    .T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>constraint_summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="split-sample-cfsi-tests" class="level3" data-number="42.2.4">
<h3 data-number="42.2.4" class="anchored" data-anchor-id="split-sample-cfsi-tests"><span class="header-section-number">42.2.4</span> Split-Sample CFSI Tests</h3>
<p>We classify firms into constrained and unconstrained groups using each index and compare the cash flow sensitivity of investment across groups.</p>
<div id="cfsi-split-sample" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cfsi_by_group(data, group_var, threshold<span class="op">=</span><span class="st">"median"</span>):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Estimate cash flow sensitivity of investment by constraint group.</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">    data : DataFrame</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Panel data with inv_rate, tobins_q, cf_assets, group_var.</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">    group_var : str</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Variable used for classification.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">    threshold : str</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">        "median" for sample split or "tercile" for top/bottom third.</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">    dict : Coefficient estimates by group.</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> data.dropna(subset<span class="op">=</span>[<span class="st">"inv_rate"</span>, <span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, group_var])</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> threshold <span class="op">==</span> <span class="st">"median"</span>:</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        median_val <span class="op">=</span> df[group_var].median()</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"constrained"</span>] <span class="op">=</span> (df[group_var] <span class="op">&gt;=</span> median_val).astype(<span class="bu">int</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> threshold <span class="op">==</span> <span class="st">"tercile"</span>:</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        t33 <span class="op">=</span> df[group_var].quantile(<span class="fl">0.33</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        t67 <span class="op">=</span> df[group_var].quantile(<span class="fl">0.67</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df[(df[group_var] <span class="op">&lt;=</span> t33) <span class="op">|</span> (df[group_var] <span class="op">&gt;=</span> t67)]</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"constrained"</span>] <span class="op">=</span> (df[group_var] <span class="op">&gt;=</span> t67).astype(<span class="bu">int</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> group_name, group_label <span class="kw">in</span> [(<span class="dv">0</span>, <span class="st">"Unconstrained"</span>), (<span class="dv">1</span>, <span class="st">"Constrained"</span>)]:</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> df[df[<span class="st">"constrained"</span>] <span class="op">==</span> group_name].copy()</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> subset.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> PanelOLS(</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>            subset[<span class="st">"inv_rate"</span>],</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>            subset[[<span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>]],</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>            entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>            time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>            check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        ).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>        results[group_label] <span class="op">=</span> {</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">"beta_Q"</span>: model.params[<span class="st">"tobins_q"</span>],</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">"se_Q"</span>: model.std_errors[<span class="st">"tobins_q"</span>],</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">"beta_CF"</span>: model.params[<span class="st">"cf_assets"</span>],</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">"se_CF"</span>: model.std_errors[<span class="st">"cf_assets"</span>],</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">"R2_within"</span>: model.rsquared_within,</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">"N"</span>: <span class="bu">int</span>(model.nobs)</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(results).T</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Run for each constraint index</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>cfsi_kz <span class="op">=</span> cfsi_by_group(panel_fc, <span class="st">"kz_index"</span>, <span class="st">"median"</span>)</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>cfsi_sa <span class="op">=</span> cfsi_by_group(panel_fc, <span class="st">"sa_index"</span>, <span class="st">"median"</span>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>cfsi_ww <span class="op">=</span> cfsi_by_group(panel_fc, <span class="st">"ww_index"</span>, <span class="st">"median"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-cfsi-comparison" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="15">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cfsi-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.5: Cash Flow Sensitivity by Financial Constraint Classification
</figcaption>
<div aria-describedby="tbl-cfsi-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine results</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cfsi_all <span class="op">=</span> pd.concat({</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"KZ Index"</span>: cfsi_kz,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SA Index"</span>: cfsi_sa,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"WW Index"</span>: cfsi_ww</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>cfsi_display <span class="op">=</span> cfsi_all[[<span class="st">"beta_CF"</span>, <span class="st">"se_CF"</span>, <span class="st">"beta_Q"</span>, <span class="st">"se_Q"</span>, <span class="st">"N"</span>]].<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>cfsi_display</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="alternative-specifications" class="level3" data-number="42.2.5">
<h3 data-number="42.2.5" class="anchored" data-anchor-id="alternative-specifications"><span class="header-section-number">42.2.5</span> Alternative Specifications</h3>
<p>The baseline CFSI test has been augmented in several directions:</p>
<p><strong>Dynamic investment models.</strong> <span class="citation" data-cites="bond2003financial">S. Bond et al. (<a href="references.html#ref-bond2003financial" role="doc-biblioref">2003</a>)</span> argue that the static regression <a href="#eq-cfsi-base" class="quarto-xref">Equation&nbsp;<span>42.6</span></a> omits the autoregressive component of investment. The Euler equation approach, which derives directly from the firm’s dynamic optimization problem, yields:</p>
<p><span id="eq-euler-investment"><span class="math display">\[
\frac{I_{i,t}}{K_{i,t-1}} = \gamma_1 \frac{I_{i,t-1}}{K_{i,t-2}} + \gamma_2 \left(\frac{Y_{i,t}}{K_{i,t-1}}\right) + \gamma_3 \frac{CF_{i,t}}{K_{i,t-1}} + \varepsilon_{i,t}
\tag{42.10}\]</span></span></p>
<p>This specification avoids the need for <span class="math inline">\(Q\)</span> entirely, sidestepping the measurement error problem.</p>
<p><strong>External finance dependence.</strong> <span class="citation" data-cites="rajan1998financial">Rajan and Zingales (<a href="references.html#ref-rajan1998financial" role="doc-biblioref">1998</a>)</span> propose using the industry-level technological demand for external finance as an instrument for financing constraints. Industries that technologically require more external funding should be disproportionately affected by financial development and firm-level constraints.</p>
<div id="euler-equation" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Euler equation investment model (dynamic panel)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>panel_euler <span class="op">=</span> panel_fc.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>panel_euler[<span class="st">"lag_inv_rate"</span>] <span class="op">=</span> panel_euler.groupby(<span class="st">"ticker"</span>)[<span class="st">"inv_rate"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>panel_euler[<span class="st">"revenue_assets"</span>] <span class="op">=</span> panel_euler[<span class="st">"revenue"</span>] <span class="op">/</span> panel_euler[<span class="st">"lag_assets"</span>]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>euler_data <span class="op">=</span> panel_euler.dropna(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"inv_rate"</span>, <span class="st">"lag_inv_rate"</span>, <span class="st">"revenue_assets"</span>, <span class="st">"cf_assets"</span>]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>).set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>model_euler <span class="op">=</span> PanelOLS(</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    euler_data[<span class="st">"inv_rate"</span>],</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    euler_data[[<span class="st">"lag_inv_rate"</span>, <span class="st">"revenue_assets"</span>, <span class="st">"cf_assets"</span>]],</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>euler_data <span class="op">=</span> euler_data.reset_index()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-euler" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="17">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-euler-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.6: Euler Equation Investment Model
</figcaption>
<div aria-describedby="tbl-euler-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>euler_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_euler.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_euler.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_euler.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_euler.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>euler_results</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
</section>
<section id="financing-choice-models" class="level2" data-number="42.3">
<h2 data-number="42.3" class="anchored" data-anchor-id="financing-choice-models"><span class="header-section-number">42.3</span> Financing Choice Models</h2>
<section id="capital-structure-determinants" class="level3" data-number="42.3.1">
<h3 data-number="42.3.1" class="anchored" data-anchor-id="capital-structure-determinants"><span class="header-section-number">42.3.1</span> Capital Structure Determinants</h3>
<p>The two dominant theories of capital structure (i.e., trade-off theory and pecking order theory) generate distinct predictions about the determinants of leverage. <span class="citation" data-cites="frank2009capital">Frank and Goyal (<a href="references.html#ref-frank2009capital" role="doc-biblioref">2009</a>)</span> provide the most comprehensive empirical synthesis, identifying six “core” variables that reliably predict leverage across samples and specifications.</p>
<p>The baseline capital structure regression is:</p>
<p><span id="eq-leverage-regression"><span class="math display">\[
\text{Lev}_{i,t} = \beta_0 + \boldsymbol{\beta}' \mathbf{X}_{i,t} + \alpha_i + \delta_t + \varepsilon_{i,t}
\tag{42.11}\]</span></span></p>
<p>where <span class="math inline">\(\text{Lev}_{i,t}\)</span> is either book leverage (<span class="math inline">\(D / A\)</span>) or market leverage (<span class="math inline">\(D / (D + E^{\text{mkt}})\)</span>), and <span class="math inline">\(\mathbf{X}_{i,t}\)</span> includes the core determinants.</p>
<p><a href="#tbl-cs-predictions" class="quarto-xref">Table&nbsp;<span>42.7</span></a> summarizes the theoretical predictions.</p>
<div id="tbl-cs-predictions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cs-predictions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.7: Capital Structure Predictions by Theory
</figcaption>
<div aria-describedby="tbl-cs-predictions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 26%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Determinant</th>
<th>Trade-Off</th>
<th>Pecking Order</th>
<th>Measurement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Profitability</td>
<td>+ (tax shield)</td>
<td>− (less need for external)</td>
<td>EBITDA / Assets</td>
</tr>
<tr class="even">
<td>Size</td>
<td>+ (lower distress costs)</td>
<td>+ (less information asymmetry)</td>
<td>ln(Total Assets)</td>
</tr>
<tr class="odd">
<td>Tangibility</td>
<td>+ (collateral value)</td>
<td>+ (less adverse selection)</td>
<td>PPE / Assets</td>
</tr>
<tr class="even">
<td>Growth (MTB)</td>
<td>− (underinvestment)</td>
<td>+ (financing needs)</td>
<td>Market-to-Book</td>
</tr>
<tr class="odd">
<td>Industry median leverage</td>
<td>+ (target)</td>
<td>ambiguous</td>
<td>Industry median</td>
</tr>
<tr class="even">
<td>Profitability volatility</td>
<td>− (distress risk)</td>
<td>ambiguous</td>
<td>Rolling σ(EBITDA/A)</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="capital-structure-data" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct capital structure variables</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cs <span class="op">=</span> panel_fc.copy()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Book leverage</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"book_leverage"</span>] <span class="op">=</span> cs[<span class="st">"total_debt"</span>] <span class="op">/</span> cs[<span class="st">"total_assets"</span>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Market leverage</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"market_leverage"</span>] <span class="op">=</span> cs[<span class="st">"total_debt"</span>] <span class="op">/</span> (</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    cs[<span class="st">"total_debt"</span>] <span class="op">+</span> cs[<span class="st">"market_cap"</span>]</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Profitability</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"profitability"</span>] <span class="op">=</span> cs[<span class="st">"ebitda"</span>] <span class="op">/</span> cs[<span class="st">"total_assets"</span>]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Tangibility</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"tangibility"</span>] <span class="op">=</span> cs[<span class="st">"ppe_net"</span>] <span class="op">/</span> cs[<span class="st">"total_assets"</span>]</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Size</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"size"</span>] <span class="op">=</span> np.log(cs[<span class="st">"total_assets"</span>])</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Market-to-Book</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"mtb"</span>] <span class="op">=</span> cs[<span class="st">"market_cap"</span>] <span class="op">/</span> cs[<span class="st">"book_equity"</span>]</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Industry median leverage</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"ind_median_lev"</span>] <span class="op">=</span> cs.groupby(</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"industry"</span>, <span class="st">"year"</span>]</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"book_leverage"</span>].transform(<span class="st">"median"</span>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling profitability volatility (3-year)</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>cs <span class="op">=</span> cs.sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"profit_vol"</span>] <span class="op">=</span> (</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    cs.groupby(<span class="st">"ticker"</span>)[<span class="st">"profitability"</span>]</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    .transform(<span class="kw">lambda</span> x: x.rolling(<span class="dv">3</span>, min_periods<span class="op">=</span><span class="dv">2</span>).std())</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsorize</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"book_leverage"</span>, <span class="st">"market_leverage"</span>, <span class="st">"profitability"</span>,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">"tangibility"</span>, <span class="st">"mtb"</span>, <span class="st">"profit_vol"</span>]:</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    cs[col] <span class="op">=</span> winsorize(cs[col])</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>cs_clean <span class="op">=</span> cs.dropna(</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"book_leverage"</span>, <span class="st">"profitability"</span>, <span class="st">"size"</span>,</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">"tangibility"</span>, <span class="st">"mtb"</span>, <span class="st">"ind_median_lev"</span>]</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="leverage-regressions" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capital structure regressions</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>cs_panel <span class="op">=</span> cs_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>regressors <span class="op">=</span> [<span class="st">"profitability"</span>, <span class="st">"size"</span>, <span class="st">"tangibility"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"mtb"</span>, <span class="st">"ind_median_lev"</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Book leverage</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>model_book <span class="op">=</span> PanelOLS(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    cs_panel[<span class="st">"book_leverage"</span>],</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    cs_panel[regressors],</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Market leverage</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>model_mkt <span class="op">=</span> PanelOLS(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    cs_panel[<span class="st">"market_leverage"</span>],</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    cs_panel[regressors],</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>cs_panel <span class="op">=</span> cs_panel.reset_index()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-capital-structure" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="20">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-capital-structure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.8: Capital Structure Determinants: Book and Market Leverage
</figcaption>
<div aria-describedby="tbl-capital-structure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cs_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Book Leverage"</span>: [</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>model_book<span class="sc">.</span>params[v]<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>model_book<span class="sc">.</span>std_errors[v]<span class="sc">:.4f}</span><span class="ss">)"</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> regressors</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    ] <span class="op">+</span> [<span class="ss">f"</span><span class="sc">{</span>model_book<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>, <span class="bu">str</span>(<span class="bu">int</span>(model_book.nobs))],</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Market Leverage"</span>: [</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>model_mkt<span class="sc">.</span>params[v]<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>model_mkt<span class="sc">.</span>std_errors[v]<span class="sc">:.4f}</span><span class="ss">)"</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> regressors</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    ] <span class="op">+</span> [<span class="ss">f"</span><span class="sc">{</span>model_mkt<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>, <span class="bu">str</span>(<span class="bu">int</span>(model_mkt.nobs))]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>}, index<span class="op">=</span>regressors <span class="op">+</span> [<span class="st">"R² (within)"</span>, <span class="st">"N"</span>])</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>cs_table</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="pecking-order-tests" class="level3" data-number="42.3.2">
<h3 data-number="42.3.2" class="anchored" data-anchor-id="pecking-order-tests"><span class="header-section-number">42.3.2</span> Pecking Order Tests</h3>
<p>The pecking order theory <span class="citation" data-cites="myers1984capital">(<a href="references.html#ref-myers1984capital" role="doc-biblioref">Myers 1984</a>)</span> predicts that firms prefer internal finance, then debt, then equity. <span class="citation" data-cites="shyam1999testing">Shyam-Sunder and Myers (<a href="references.html#ref-shyam1999testing" role="doc-biblioref">1999</a>)</span> propose a direct test: if the pecking order holds strictly, the financing deficit (investment minus internal funds) should be financed dollar-for-dollar by debt:</p>
<p><span id="eq-pecking-order"><span class="math display">\[
\Delta D_{i,t} = \alpha + \beta_{\text{PO}} \cdot \text{DEF}_{i,t} + \varepsilon_{i,t}
\tag{42.12}\]</span></span></p>
<p>where <span class="math inline">\(\text{DEF}_{i,t} = \text{Div}_{i,t} + \text{Capex}_{i,t} + \Delta W_{i,t} - CF_{i,t}\)</span> is the financing deficit and <span class="math inline">\(\Delta D_{i,t}\)</span> is net debt issuance. A strict pecking order implies <span class="math inline">\(\hat{\alpha} = 0\)</span> and <span class="math inline">\(\hat{\beta}_{\text{PO}} = 1\)</span>. <span class="citation" data-cites="frank2003testing">Frank and Goyal (<a href="references.html#ref-frank2003testing" role="doc-biblioref">2003</a>)</span> show that the coefficient is typically well below 1, especially for large firms and equity issuers.</p>
<div id="pecking-order" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct financing deficit</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>po <span class="op">=</span> cs.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>po[<span class="st">"lag_debt"</span>] <span class="op">=</span> po.groupby(<span class="st">"ticker"</span>)[<span class="st">"total_debt"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>po[<span class="st">"net_debt_issuance"</span>] <span class="op">=</span> po[<span class="st">"total_debt"</span>] <span class="op">-</span> po[<span class="st">"lag_debt"</span>]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Financing deficit = Div + Capex + ΔWC - CF</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>po[<span class="st">"delta_wc"</span>] <span class="op">=</span> po[<span class="st">"working_capital"</span>] <span class="op">-</span> po.groupby(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ticker"</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"working_capital"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>po[<span class="st">"fin_deficit"</span>] <span class="op">=</span> (</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    po[<span class="st">"dividends"</span>] <span class="op">+</span> po[<span class="st">"capex"</span>]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> po[<span class="st">"delta_wc"</span>].fillna(<span class="dv">0</span>) <span class="op">-</span> po[<span class="st">"operating_cf"</span>]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale by lagged assets</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"net_debt_issuance"</span>, <span class="st">"fin_deficit"</span>]:</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    po[col] <span class="op">=</span> po[col] <span class="op">/</span> po[<span class="st">"lag_assets"</span>]</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>po_clean <span class="op">=</span> po.dropna(</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"net_debt_issuance"</span>, <span class="st">"fin_deficit"</span>]</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsorize</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"net_debt_issuance"</span>, <span class="st">"fin_deficit"</span>]:</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    po_clean[col] <span class="op">=</span> winsorize(po_clean[col])</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Pecking order regression</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>po_panel <span class="op">=</span> po_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>model_po <span class="op">=</span> PanelOLS(</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    po_panel[<span class="st">"net_debt_issuance"</span>],</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    po_panel[[<span class="st">"fin_deficit"</span>]],</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>po_panel <span class="op">=</span> po_panel.reset_index()</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Pecking order coefficient: </span><span class="sc">{</span>model_po<span class="sc">.</span>params[<span class="st">'fin_deficit'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  (se = </span><span class="sc">{</span>model_po<span class="sc">.</span>std_errors[<span class="st">'fin_deficit'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  H0: β = 1, t = "</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"</span><span class="sc">{</span>(model_po.params[<span class="st">'fin_deficit'</span>] <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> model_po<span class="sc">.</span>std_errors[<span class="st">'fin_deficit'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="market-timing-measures" class="level3" data-number="42.3.3">
<h3 data-number="42.3.3" class="anchored" data-anchor-id="market-timing-measures"><span class="header-section-number">42.3.3</span> Market Timing Measures</h3>
<p><span class="citation" data-cites="baker2002market">Baker and Wurgler (<a href="references.html#ref-baker2002market" role="doc-biblioref">2002</a>)</span> argue that capital structure is largely the cumulative outcome of market timing (i.e., firms issue equity when valuations are high and repurchase when valuations are low). Their key variable is the external-finance-weighted average market-to-book ratio:</p>
<p><span id="eq-efwa-mtb"><span class="math display">\[
\left(\frac{M}{B}\right)_{i,t}^{efwa} = \sum_{s=\text{IPO}}^{t-1} \frac{e_s + d_s}{\sum_{r=\text{IPO}}^{t-1}(e_r + d_r)} \cdot \left(\frac{M}{B}\right)_{i,s}
\tag{42.13}\]</span></span></p>
<p>where <span class="math inline">\(e_s\)</span> and <span class="math inline">\(d_s\)</span> are net equity and net debt issuance in year <span class="math inline">\(s\)</span>. This variable captures the historical valuations at which the firm raised capital. The market timing hypothesis predicts that higher <span class="math inline">\(\left(M/B\right)^{efwa}\)</span> is associated with lower current leverage (i.e., firms that historically issued equity at high valuations have persistently lower leverage).</p>
<div id="market-timing" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># External-Finance-Weighted Average M/B</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_efwa_mtb(group):</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute Baker-Wurgler EFWA M/B for one firm."""</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> group.sort_values(<span class="st">"year"</span>).copy()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Net issuance each year</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    g[<span class="st">"net_equity"</span>] <span class="op">=</span> g[<span class="st">"equity_issuance"</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    g[<span class="st">"net_debt"</span>] <span class="op">=</span> g[<span class="st">"net_debt_issuance"</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    g[<span class="st">"total_issuance"</span>] <span class="op">=</span> (</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        g[<span class="st">"net_equity"</span>].<span class="bu">abs</span>() <span class="op">+</span> g[<span class="st">"net_debt"</span>].<span class="bu">abs</span>()</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    ).replace(<span class="dv">0</span>, np.nan)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    efwa_values <span class="op">=</span> []</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(g)):</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        past <span class="op">=</span> g.iloc[:idx]</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> past[<span class="st">"total_issuance"</span>] <span class="op">/</span> past[<span class="st">"total_issuance"</span>].<span class="bu">sum</span>()</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> weights.fillna(<span class="dv">0</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        efwa <span class="op">=</span> (weights <span class="op">*</span> past[<span class="st">"mtb"</span>]).<span class="bu">sum</span>()</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        efwa_values.append(efwa)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> g.iloc[<span class="dv">1</span>:].copy()</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    g[<span class="st">"efwa_mtb"</span>] <span class="op">=</span> efwa_values</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g[[<span class="st">"ticker"</span>, <span class="st">"year"</span>, <span class="st">"efwa_mtb"</span>]]</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>mt <span class="op">=</span> po_clean.copy()</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>mt[<span class="st">"equity_issuance"</span>] <span class="op">=</span> mt[<span class="st">"market_cap"</span>] <span class="op">-</span> mt.groupby(</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ticker"</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"market_cap"</span>].shift(<span class="dv">1</span>) <span class="op">-</span> mt[<span class="st">"net_income"</span>]</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>efwa_data <span class="op">=</span> (</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    mt.groupby(<span class="st">"ticker"</span>, group_keys<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(compute_efwa_mtb)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge and regress</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>mt_merged <span class="op">=</span> cs_clean.merge(efwa_data, on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"year"</span>], how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>mt_clean <span class="op">=</span> mt_merged.dropna(</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"market_leverage"</span>, <span class="st">"efwa_mtb"</span>, <span class="st">"profitability"</span>,</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">"size"</span>, <span class="st">"tangibility"</span>, <span class="st">"mtb"</span>]</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>mt_panel <span class="op">=</span> mt_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>model_mt <span class="op">=</span> PanelOLS(</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    mt_panel[<span class="st">"market_leverage"</span>],</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    mt_panel[[<span class="st">"efwa_mtb"</span>, <span class="st">"mtb"</span>, <span class="st">"profitability"</span>, <span class="st">"size"</span>, <span class="st">"tangibility"</span>]],</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>mt_panel <span class="op">=</span> mt_panel.reset_index()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-market-timing" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="23">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-market-timing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.9: Market Timing and Capital Structure
</figcaption>
<div aria-describedby="tbl-market-timing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mt_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_mt.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_mt.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_mt.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_mt.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>mt_results</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<p>A negative coefficient on <span class="math inline">\(\text{EFWA}_{M/B}\)</span> after controlling for the current <span class="math inline">\(M/B\)</span> (which captures current investment opportunities) supports the market timing hypothesis: firms that historically raised capital at high valuations maintain persistently lower leverage.</p>
</section>
</section>
<section id="payout-policy-estimators" class="level2" data-number="42.4">
<h2 data-number="42.4" class="anchored" data-anchor-id="payout-policy-estimators"><span class="header-section-number">42.4</span> Payout Policy Estimators</h2>
<section id="dividend-smoothing" class="level3" data-number="42.4.1">
<h3 data-number="42.4.1" class="anchored" data-anchor-id="dividend-smoothing"><span class="header-section-number">42.4.1</span> Dividend Smoothing</h3>
<p><span class="citation" data-cites="lintner1956distribution">Lintner (<a href="references.html#ref-lintner1956distribution" role="doc-biblioref">1956</a>)</span> established the foundational model of dividend behavior: firms target a payout ratio and partially adjust dividends toward the target each year. The partial adjustment model is:</p>
<p><span id="eq-lintner"><span class="math display">\[
\Delta D_{i,t} = \alpha_i + \lambda(\tau \cdot E_{i,t} - D_{i,t-1}) + \varepsilon_{i,t}
\tag{42.14}\]</span></span></p>
<p>where <span class="math inline">\(D_{i,t}\)</span> is the dividend per share, <span class="math inline">\(E_{i,t}\)</span> is earnings per share, <span class="math inline">\(\tau\)</span> is the target payout ratio, and <span class="math inline">\(\lambda \in (0, 1)\)</span> is the speed of adjustment. Low <span class="math inline">\(\lambda\)</span> implies strong smoothing (i.e., firms adjust dividends slowly toward the target). Rearranging:</p>
<p><span id="eq-lintner-regression"><span class="math display">\[
D_{i,t} = \alpha_i + (1 - \lambda) D_{i,t-1} + \lambda \tau \cdot E_{i,t} + \varepsilon_{i,t}
\tag{42.15}\]</span></span></p>
<p>The coefficient on lagged dividends, <span class="math inline">\((1 - \lambda)\)</span>, measures the degree of smoothing. Values close to 1 indicate near-complete smoothing; values close to 0 indicate no smoothing (full adjustment).</p>
<div id="lintner-model" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct dividend and earnings variables</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>div <span class="op">=</span> panel_fc.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>div[<span class="st">"lag_dps"</span>] <span class="op">=</span> div.groupby(<span class="st">"ticker"</span>)[<span class="st">"dividends_per_share"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>div[<span class="st">"delta_dps"</span>] <span class="op">=</span> div[<span class="st">"dividends_per_share"</span>] <span class="op">-</span> div[<span class="st">"lag_dps"</span>]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Only firms with positive dividends in both periods</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>div_clean <span class="op">=</span> div.dropna(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"dividends_per_share"</span>, <span class="st">"lag_dps"</span>, <span class="st">"eps"</span>]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>).query(<span class="st">"lag_dps &gt; 0 and dividends_per_share &gt; 0"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Lintner regression</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>div_panel <span class="op">=</span> div_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>model_lintner <span class="op">=</span> PanelOLS(</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    div_panel[<span class="st">"dividends_per_share"</span>],</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    div_panel[[<span class="st">"lag_dps"</span>, <span class="st">"eps"</span>]],</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>div_panel <span class="op">=</span> div_panel.reset_index()</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract structural parameters</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>lambda_hat <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> model_lintner.params[<span class="st">"lag_dps"</span>]</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>tau_hat <span class="op">=</span> model_lintner.params[<span class="st">"eps"</span>] <span class="op">/</span> lambda_hat</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Lintner Model Estimates:"</span>)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Speed of adjustment (λ): </span><span class="sc">{</span>lambda_hat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Target payout ratio (τ): </span><span class="sc">{</span>tau_hat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Smoothing coefficient (1-λ): </span><span class="sc">{</span>model_lintner<span class="sc">.</span>params[<span class="st">'lag_dps'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-lintner" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="25">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lintner-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.10: Lintner Partial Adjustment Model
</figcaption>
<div aria-describedby="tbl-lintner-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>lintner_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_lintner.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_lintner.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_lintner.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_lintner.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>lintner_table</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<div id="fig-payout-ratio" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="26">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-payout-ratio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>payout <span class="op">=</span> panel_fc.copy()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>payout[<span class="st">"payout_ratio"</span>] <span class="op">=</span> payout[<span class="st">"dividends"</span>] <span class="op">/</span> payout[<span class="st">"net_income"</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>payout <span class="op">=</span> payout[</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    (payout[<span class="st">"net_income"</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    (payout[<span class="st">"payout_ratio"</span>].between(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>payout_ts <span class="op">=</span> (</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    payout.groupby(<span class="st">"year"</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        median_payout<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="st">"median"</span>),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        mean_payout<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="st">"mean"</span>),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        q25<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="kw">lambda</span> x: x.quantile(<span class="fl">0.25</span>)),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        q75<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="kw">lambda</span> x: x.quantile(<span class="fl">0.75</span>)),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        pct_payers<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="kw">lambda</span> x: (x <span class="op">&gt;</span> <span class="dv">0</span>).mean())</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(payout_ts, p9.aes(x<span class="op">=</span><span class="st">"year"</span>))</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_ribbon(</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        p9.aes(ymin<span class="op">=</span><span class="st">"q25"</span>, ymax<span class="op">=</span><span class="st">"q75"</span>),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        fill<span class="op">=</span><span class="st">"#2E5090"</span>, alpha<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line(</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        p9.aes(y<span class="op">=</span><span class="st">"median_payout"</span>),</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"#2E5090"</span>, size<span class="op">=</span><span class="dv">1</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line(</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        p9.aes(y<span class="op">=</span><span class="st">"mean_payout"</span>),</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"#C0392B"</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, size<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Year"</span>,</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Dividend Payout Ratio"</span>,</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Payout Ratio: Median (Solid) and Mean (Dashed)"</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-payout-ratio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;42.2
</figcaption>
</figure>
</div>
</section>
<section id="smoothing-heterogeneity-soes-vs.-private-firms" class="level3" data-number="42.4.2">
<h3 data-number="42.4.2" class="anchored" data-anchor-id="smoothing-heterogeneity-soes-vs.-private-firms"><span class="header-section-number">42.4.2</span> Smoothing Heterogeneity: SOEs vs.&nbsp;Private Firms</h3>
<p>Dividend policy in Vietnam is shaped by regulatory mandates. The State Capital Investment Corporation (SCIC) and line ministries have historically required SOEs to distribute minimum dividend amounts, sometimes at the expense of reinvestment. This creates a fundamental asymmetry: SOE dividends are partially policy-determined rather than the outcome of the Lintner optimization.</p>
<div id="lintner-soe-split" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge SOE indicator</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>div_with_soe <span class="op">=</span> div_clean.merge(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    ownership[[<span class="st">"ticker"</span>, <span class="st">"year"</span>, <span class="st">"state_ownership_pct"</span>]],</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"year"</span>],</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>div_with_soe[<span class="st">"soe"</span>] <span class="op">=</span> (div_with_soe[<span class="st">"state_ownership_pct"</span>] <span class="op">&gt;</span> <span class="dv">50</span>).astype(<span class="bu">int</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate Lintner model separately for SOEs and private firms</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>lintner_results <span class="op">=</span> {}</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label, soe_val <span class="kw">in</span> [(<span class="st">"Private"</span>, <span class="dv">0</span>), (<span class="st">"SOE"</span>, <span class="dv">1</span>)]:</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    subset <span class="op">=</span> div_with_soe[div_with_soe[<span class="st">"soe"</span>] <span class="op">==</span> soe_val].copy()</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    subset_panel <span class="op">=</span> subset.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> PanelOLS(</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        subset_panel[<span class="st">"dividends_per_share"</span>],</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        subset_panel[[<span class="st">"lag_dps"</span>, <span class="st">"eps"</span>]],</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>        entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>        time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    ).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    lam <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> model.params[<span class="st">"lag_dps"</span>]</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    tau <span class="op">=</span> model.params[<span class="st">"eps"</span>] <span class="op">/</span> lam <span class="cf">if</span> <span class="bu">abs</span>(lam) <span class="op">&gt;</span> <span class="fl">0.01</span> <span class="cf">else</span> np.nan</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    lintner_results[label] <span class="op">=</span> {</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Smoothing (1-λ)"</span>: <span class="bu">round</span>(model.params[<span class="st">"lag_dps"</span>], <span class="dv">4</span>),</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Speed of adj (λ)"</span>: <span class="bu">round</span>(lam, <span class="dv">4</span>),</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Target payout (τ)"</span>: <span class="bu">round</span>(tau, <span class="dv">4</span>),</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="bu">int</span>(model.nobs)</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lintner_results).T</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="share-repurchases" class="level3" data-number="42.4.3">
<h3 data-number="42.4.3" class="anchored" data-anchor-id="share-repurchases"><span class="header-section-number">42.4.3</span> Share Repurchases</h3>
<p>Share repurchases are a relatively new phenomenon in Vietnamese markets, gradually gaining traction as regulations have evolved. Unlike dividends, repurchases are more flexible and do not create expectations of future payments. The decision to repurchase can be modeled as:</p>
<p><span id="eq-repurchase-probit"><span class="math display">\[
\text{Repurchase}_{i,t} = \mathbb{1}\left(\beta_0 + \beta_1 \frac{CF_{i,t}}{A_{i,t}} + \beta_2 Q_{i,t} + \beta_3 \text{Lev}_{i,t} + \beta_4 \frac{\text{Cash}_{i,t}}{A_{i,t}} + \boldsymbol{\gamma}' \mathbf{Z}_{i,t} + \varepsilon_{i,t} &gt; 0\right)
\tag{42.16}\]</span></span></p>
<div id="repurchase-model" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify repurchase years</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>repurchase <span class="op">=</span> panel_fc.copy()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>repurchase[<span class="st">"repurchase_dummy"</span>] <span class="op">=</span> (</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    repurchase[<span class="st">"share_repurchases"</span>] <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>).astype(<span class="bu">int</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>repurchase[<span class="st">"cash_assets"</span>] <span class="op">=</span> repurchase[<span class="st">"cash"</span>] <span class="op">/</span> repurchase[<span class="st">"total_assets"</span>]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Probit model for repurchase decision</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>rep_clean <span class="op">=</span> repurchase.dropna(</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"repurchase_dummy"</span>, <span class="st">"cf_assets"</span>, <span class="st">"tobins_q"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"book_leverage"</span>, <span class="st">"cash_assets"</span>, <span class="st">"log_assets"</span>]</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>probit_model <span class="op">=</span> smf.probit(</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"repurchase_dummy ~ cf_assets + tobins_q + book_leverage "</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"+ cash_assets + log_assets + C(year)"</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>rep_clean</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>).fit(disp<span class="op">=</span><span class="va">False</span>, cov_type<span class="op">=</span><span class="st">"cluster"</span>, cov_kwds<span class="op">=</span>{<span class="st">"groups"</span>: rep_clean[<span class="st">"ticker"</span>]})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-repurchase-probit" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="29">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-repurchase-probit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.11: Probit Model: Determinants of Share Repurchase Decision
</figcaption>
<div aria-describedby="tbl-repurchase-probit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract non-year-dummy coefficients</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>main_vars <span class="op">=</span> [<span class="st">"cf_assets"</span>, <span class="st">"tobins_q"</span>, <span class="st">"book_leverage"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">"cash_assets"</span>, <span class="st">"log_assets"</span>]</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>probit_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: probit_model.params[main_vars].<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: probit_model.bse[main_vars].<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"z-stat"</span>: probit_model.tvalues[main_vars].<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: probit_model.pvalues[main_vars].<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Marginal Effect"</span>: (</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        probit_model.get_margeff().margeff[:<span class="bu">len</span>(main_vars)]</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>probit_results</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="agency-and-signaling-interpretations" class="level3" data-number="42.4.4">
<h3 data-number="42.4.4" class="anchored" data-anchor-id="agency-and-signaling-interpretations"><span class="header-section-number">42.4.4</span> Agency and Signaling Interpretations</h3>
<p>Payout policy is interpreted through two competing lenses:</p>
<p><strong>Agency view</strong> <span class="citation" data-cites="jensen1986agency la2000agency">(<a href="references.html#ref-jensen1986agency" role="doc-biblioref">Jensen 1986</a>; <a href="references.html#ref-la2000agency" role="doc-biblioref">La Porta et al. 2000</a>)</span>: Dividends are a mechanism for disgorging free cash flow that managers would otherwise waste on empire-building or perquisite consumption. In this view, firms with weaker governance should face greater pressure to pay dividends as a bonding device. <span class="citation" data-cites="la2000agency">La Porta et al. (<a href="references.html#ref-la2000agency" role="doc-biblioref">2000</a>)</span> distinguish the “outcome” model (dividends are the result of effective minority shareholder pressure) from the “substitute” model (firms with weak governance pay high dividends to build reputation for fair treatment).</p>
<p><strong>Signaling view</strong> <span class="citation" data-cites="bhattacharya1979imperfect miller1985dividend">(<a href="references.html#ref-bhattacharya1979imperfect" role="doc-biblioref">Bhattacharya 1979</a>; <a href="references.html#ref-miller1985dividend" role="doc-biblioref">Miller and Rock 1985</a>)</span>: Dividends convey private information about future earnings. Because dividends are costly to fake (they require actual cash), they serve as a credible signal. The signaling interpretation predicts that dividend changes should predict future earnings changes.</p>
<div id="dividend-signaling" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test dividend signaling: do dividend changes predict future earnings?</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> panel_fc.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"delta_div"</span>] <span class="op">=</span> signal.groupby(<span class="st">"ticker"</span>)[<span class="st">"dividends"</span>].diff()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"div_increase"</span>] <span class="op">=</span> (signal[<span class="st">"delta_div"</span>] <span class="op">&gt;</span> <span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"div_decrease"</span>] <span class="op">=</span> (signal[<span class="st">"delta_div"</span>] <span class="op">&lt;</span> <span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Future earnings change</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"lead_earnings"</span>] <span class="op">=</span> signal.groupby(<span class="st">"ticker"</span>)[<span class="st">"net_income"</span>].shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"delta_earnings_lead"</span>] <span class="op">=</span> (</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    (signal[<span class="st">"lead_earnings"</span>] <span class="op">-</span> signal[<span class="st">"net_income"</span>]) <span class="op">/</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    signal[<span class="st">"total_assets"</span>]</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Current earnings change (control)</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"lag_earnings"</span>] <span class="op">=</span> signal.groupby(<span class="st">"ticker"</span>)[<span class="st">"net_income"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"delta_earnings_curr"</span>] <span class="op">=</span> (</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    (signal[<span class="st">"net_income"</span>] <span class="op">-</span> signal[<span class="st">"lag_earnings"</span>]) <span class="op">/</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    signal[<span class="st">"total_assets"</span>]</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>signal_clean <span class="op">=</span> signal.dropna(</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"delta_earnings_lead"</span>, <span class="st">"div_increase"</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">"div_decrease"</span>, <span class="st">"delta_earnings_curr"</span>]</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression: future earnings change on dividend change indicators</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>signal_model <span class="op">=</span> smf.ols(</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"delta_earnings_lead ~ div_increase + div_decrease "</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"+ delta_earnings_curr + C(year) + C(industry)"</span>,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>signal_clean</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"cluster"</span>, cov_kwds<span class="op">=</span>{<span class="st">"groups"</span>: signal_clean[<span class="st">"ticker"</span>]})</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dividend Signaling Test:"</span>)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> [<span class="st">"div_increase"</span>, <span class="st">"div_decrease"</span>, <span class="st">"delta_earnings_curr"</span>]:</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>signal_model<span class="sc">.</span>params[var]<span class="sc">:.4f}</span><span class="ss"> "</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"(t = </span><span class="sc">{</span>signal_model<span class="sc">.</span>tvalues[var]<span class="sc">:.3f}</span><span class="ss">)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="agency-cost-proxies" class="level2" data-number="42.5">
<h2 data-number="42.5" class="anchored" data-anchor-id="agency-cost-proxies"><span class="header-section-number">42.5</span> Agency Cost Proxies</h2>
<section id="ownership-concentration-and-agency-problems" class="level3" data-number="42.5.1">
<h3 data-number="42.5.1" class="anchored" data-anchor-id="ownership-concentration-and-agency-problems"><span class="header-section-number">42.5.1</span> Ownership Concentration and Agency Problems</h3>
<p>The agency framework of <span class="citation" data-cites="jensen2019theory">Jensen and Meckling (<a href="references.html#ref-jensen2019theory" role="doc-biblioref">2019</a>)</span> identifies the separation of ownership and control as the fundamental source of corporate agency costs. In concentrated-ownership economies like Vietnam, the dominant agency conflict is not between dispersed shareholders and professional managers (Berle-Means agency problem) but between controlling and minority shareholders (principal-principal agency problem, <span class="citation" data-cites="young2008corporate">Young et al. (<a href="references.html#ref-young2008corporate" role="doc-biblioref">2008</a>)</span>).</p>
<p>The key mechanisms through which controlling shareholders extract private benefits include: tunneling via related-party transactions <span class="citation" data-cites="johnson2000tunneling">(<a href="references.html#ref-johnson2000tunneling" role="doc-biblioref">Johnson et al. 2000</a>)</span>, diversion of corporate opportunities, excessive compensation, and dilutive equity issuances. The extent of these costs depends on the ownership structure, legal protections for minorities, and monitoring intensity.</p>
<div id="ownership-structure" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge ownership data comprehensively</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>agency <span class="op">=</span> panel_fc.merge(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    ownership[[<span class="st">"ticker"</span>, <span class="st">"year"</span>, <span class="st">"state_ownership_pct"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"foreign_ownership_pct"</span>, <span class="st">"insider_ownership_pct"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"largest_shareholder_pct"</span>, <span class="st">"top5_shareholder_pct"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"board_size"</span>, <span class="st">"independent_directors_pct"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"ceo_duality"</span>]],</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"year"</span>],</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Ownership concentration measures</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Herfindahl of top-5 shareholdings</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"ownership_hhi"</span>] <span class="op">=</span> agency[<span class="st">"top5_shareholder_pct"</span>]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Excess control rights (proxy: difference between</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># largest shareholder and second largest)</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"control_wedge"</span>] <span class="op">=</span> (</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    agency[<span class="st">"largest_shareholder_pct"</span>] <span class="op">-</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    (agency[<span class="st">"top5_shareholder_pct"</span>] <span class="op">-</span> agency[<span class="st">"largest_shareholder_pct"</span>]) <span class="op">/</span> <span class="dv">4</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="free-cash-flow-measures" class="level3" data-number="42.5.2">
<h3 data-number="42.5.2" class="anchored" data-anchor-id="free-cash-flow-measures"><span class="header-section-number">42.5.2</span> Free Cash Flow Measures</h3>
<p><span class="citation" data-cites="jensen1986agency">Jensen (<a href="references.html#ref-jensen1986agency" role="doc-biblioref">1986</a>)</span> argues that the agency cost of free cash flow is the central problem in firms that generate cash in excess of positive-NPV investment opportunities. The standard measure is:</p>
<p><span id="eq-fcf"><span class="math display">\[
\text{FCF}_{i,t} = \frac{\text{Operating CF}_{i,t} - \text{Depreciation}_{i,t} - \text{Required Capex}_{i,t}}{\text{Total Assets}_{i,t}}
\tag{42.17}\]</span></span></p>
<p>In practice, “required capex” is unobservable, so researchers use operating cash flow minus capital expenditures as a proxy, or add the interaction of cash flow with low <span class="math inline">\(Q\)</span> (which identifies firms with cash flow but without investment opportunities):</p>
<p><span id="eq-fcf-overinvest"><span class="math display">\[
\text{FCF Overinvestment} = \frac{CF_{i,t}}{A_{i,t}} \times \mathbb{1}(Q_{i,t} &lt; 1)
\tag{42.18}\]</span></span></p>
<div id="fcf-agency" class="cell" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Free cash flow measures</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"fcf"</span>] <span class="op">=</span> (agency[<span class="st">"operating_cf"</span>] <span class="op">-</span> agency[<span class="st">"capex"</span>]) <span class="op">/</span> agency[<span class="st">"total_assets"</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"low_q"</span>] <span class="op">=</span> (agency[<span class="st">"tobins_q"</span>] <span class="op">&lt;</span> <span class="dv">1</span>).astype(<span class="bu">int</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"fcf_low_q"</span>] <span class="op">=</span> agency[<span class="st">"fcf"</span>] <span class="op">*</span> agency[<span class="st">"low_q"</span>]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Asset utilization (inverse proxy for agency costs)</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"asset_turnover"</span>] <span class="op">=</span> agency[<span class="st">"revenue"</span>] <span class="op">/</span> agency[<span class="st">"total_assets"</span>]</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># SGA ratio (proxy for discretionary spending / empire building)</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"sga_ratio"</span>] <span class="op">=</span> agency[<span class="st">"sga_expenses"</span>] <span class="op">/</span> agency[<span class="st">"revenue"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="monitoring-mechanisms-and-governance-variables" class="level3" data-number="42.5.3">
<h3 data-number="42.5.3" class="anchored" data-anchor-id="monitoring-mechanisms-and-governance-variables"><span class="header-section-number">42.5.3</span> Monitoring Mechanisms and Governance Variables</h3>
<p>We construct a governance quality composite based on observable monitoring mechanisms:</p>
<div id="governance-variables" class="cell" data-execution_count="33">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Governance quality indicators</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"foreign_monitor"</span>] <span class="op">=</span> (</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    agency[<span class="st">"foreign_ownership_pct"</span>] <span class="op">&gt;</span> <span class="dv">20</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>).astype(<span class="bu">int</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"board_independence"</span>] <span class="op">=</span> agency[<span class="st">"independent_directors_pct"</span>]</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"no_duality"</span>] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> agency[<span class="st">"ceo_duality"</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Related-party transaction intensity (if available)</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># agency["rpt_ratio"] = agency["related_party_transactions"] / agency["revenue"]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-agency-proxies" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="34">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-agency-proxies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.12: Summary Statistics: Agency Cost Proxies and Governance Variables
</figcaption>
<div aria-describedby="tbl-agency-proxies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>agency_vars <span class="op">=</span> [</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"largest_shareholder_pct"</span>, <span class="st">"state_ownership_pct"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"foreign_ownership_pct"</span>, <span class="st">"fcf"</span>, <span class="st">"fcf_low_q"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"asset_turnover"</span>, <span class="st">"board_independence"</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>agency_summary <span class="op">=</span> (</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    agency[agency_vars].dropna()</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    .describe(percentiles<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>])</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    .T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>agency_summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="agency-costs-and-firm-value" class="level3" data-number="42.5.4">
<h3 data-number="42.5.4" class="anchored" data-anchor-id="agency-costs-and-firm-value"><span class="header-section-number">42.5.4</span> Agency Costs and Firm Value</h3>
<p>We test whether agency cost proxies are associated with firm value (Tobin’s <span class="math inline">\(Q\)</span>) and operating performance (ROA), controlling for standard determinants:</p>
<p><span id="eq-agency-valuation"><span class="math display">\[
Q_{i,t} = \beta_0 + \beta_1 \text{Own}_{i,t} + \beta_2 \text{Own}_{i,t}^2 + \boldsymbol{\gamma}'\mathbf{X}_{i,t} + \alpha_i + \delta_t + \varepsilon_{i,t}
\tag{42.19}\]</span></span></p>
<p>The quadratic in ownership captures the <span class="citation" data-cites="morck1988management">Morck, Shleifer, and Vishny (<a href="references.html#ref-morck1988management" role="doc-biblioref">1988</a>)</span> nonlinearity: at low levels, managerial ownership aligns incentives (positive effect on <span class="math inline">\(Q\)</span>); at high levels, entrenchment dominates (negative effect).</p>
<div id="agency-valuation" class="cell" data-execution_count="35">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agency cost and valuation regression</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"largest_sq"</span>] <span class="op">=</span> agency[<span class="st">"largest_shareholder_pct"</span>]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>val_data <span class="op">=</span> agency.dropna(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"tobins_q"</span>, <span class="st">"largest_shareholder_pct"</span>, <span class="st">"foreign_ownership_pct"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"fcf"</span>, <span class="st">"size"</span>, <span class="st">"profitability"</span>, <span class="st">"leverage"</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>).copy()</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>val_panel <span class="op">=</span> val_data.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>model_val <span class="op">=</span> PanelOLS(</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    val_panel[<span class="st">"tobins_q"</span>],</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    val_panel[[<span class="st">"largest_shareholder_pct"</span>, <span class="st">"largest_sq"</span>,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"foreign_ownership_pct"</span>, <span class="st">"fcf"</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">"size"</span>, <span class="st">"profitability"</span>, <span class="st">"leverage"</span>]],</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>val_panel <span class="op">=</span> val_panel.reset_index()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-agency-valuation" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="36">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-agency-valuation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.13: Agency Proxies and Firm Value (Tobin’s Q)
</figcaption>
<div aria-describedby="tbl-agency-valuation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>val_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_val.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_val.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_val.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_val.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>val_results</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<div id="fig-ownership-q" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="37">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ownership-q-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binned scatter: largest shareholder vs Q</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>own_bins <span class="op">=</span> val_data.copy()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>own_bins[<span class="st">"own_bin"</span>] <span class="op">=</span> pd.qcut(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    own_bins[<span class="st">"largest_shareholder_pct"</span>], q<span class="op">=</span><span class="dv">20</span>, duplicates<span class="op">=</span><span class="st">"drop"</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>own_binned <span class="op">=</span> (</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    own_bins.groupby(<span class="st">"own_bin"</span>, observed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        mean_own<span class="op">=</span>(<span class="st">"largest_shareholder_pct"</span>, <span class="st">"mean"</span>),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        mean_q<span class="op">=</span>(<span class="st">"tobins_q"</span>, <span class="st">"mean"</span>),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        se_q<span class="op">=</span>(<span class="st">"tobins_q"</span>, <span class="kw">lambda</span> x: x.std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(x)))</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(own_binned, p9.aes(x<span class="op">=</span><span class="st">"mean_own"</span>, y<span class="op">=</span><span class="st">"mean_q"</span>))</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_pointrange(</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>        p9.aes(ymin<span class="op">=</span><span class="st">"mean_q - 1.96*se_q"</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>               ymax<span class="op">=</span><span class="st">"mean_q + 1.96*se_q"</span>),</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"#2E5090"</span>, size<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_smooth(method<span class="op">=</span><span class="st">"loess"</span>, color<span class="op">=</span><span class="st">"#C0392B"</span>, se<span class="op">=</span><span class="va">False</span>, size<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Largest Shareholder Ownership (%)"</span>,</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Tobin's Q"</span>,</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Ownership Concentration and Firm Value"</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ownership-q-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;42.3
</figcaption>
</figure>
</div>
<p>The inverted-U pattern, if present, would be consistent with the Morck-Shleifer-Vishny incentive-alignment/entrenchment tradeoff. In Vietnamese markets, the pattern may differ because the dominant controlling shareholder is often the state, whose objective function includes non-value-maximizing goals (employment, regional development, strategic sector control).</p>
</section>
</section>
<section id="linking-corporate-decisions-to-returns" class="level2" data-number="42.6">
<h2 data-number="42.6" class="anchored" data-anchor-id="linking-corporate-decisions-to-returns"><span class="header-section-number">42.6</span> Linking Corporate Decisions to Returns</h2>
<section id="investment-based-anomalies" class="level3" data-number="42.6.1">
<h3 data-number="42.6.1" class="anchored" data-anchor-id="investment-based-anomalies"><span class="header-section-number">42.6.1</span> Investment-Based Anomalies</h3>
<p>The asset pricing literature has documented that corporate investment decisions predict cross-sectional return differences (i.e., the “investment anomalies”). The theoretical foundation is the <span class="math inline">\(q\)</span>-theory of investment applied to asset pricing <span class="citation" data-cites="cochrane1991production liu2009investment">(<a href="references.html#ref-cochrane1991production" role="doc-biblioref">Cochrane 1991</a>; <a href="references.html#ref-liu2009investment" role="doc-biblioref">Liu, Whited, and Zhang 2009</a>)</span>: firms invest more when the discount rate on their projects is lower. High investment therefore signals low expected returns.</p>
<p><strong>The investment effect.</strong> <span class="citation" data-cites="titman2004capital">Titman, Wei, and Xie (<a href="references.html#ref-titman2004capital" role="doc-biblioref">2004</a>)</span> and <span class="citation" data-cites="cooper2008asset">Cooper, Gulen, and Schill (<a href="references.html#ref-cooper2008asset" role="doc-biblioref">2008</a>)</span> document that firms with high asset growth earn lower subsequent returns. The asset growth variable is:</p>
<p><span id="eq-asset-growth"><span class="math display">\[
\text{AG}_{i,t} = \frac{A_{i,t} - A_{i,t-1}}{A_{i,t-1}}
\tag{42.20}\]</span></span></p>
<p><strong>The investment-to-assets effect.</strong> <span class="citation" data-cites="fama2006profitability">Fama and French (<a href="references.html#ref-fama2006profitability" role="doc-biblioref">2006</a>)</span> and <span class="citation" data-cites="hou2015digesting">Hou, Xue, and Zhang (<a href="references.html#ref-hou2015digesting" role="doc-biblioref">2015</a>)</span> show that capital expenditure scaled by assets negatively predicts returns.</p>
<p><strong>The profitability effect.</strong> <span class="citation" data-cites="novy2013other">Novy-Marx (<a href="references.html#ref-novy2013other" role="doc-biblioref">2013</a>)</span> shows that gross profitability (revenue minus COGS, scaled by assets) positively predicts returns. This is consistent with <span class="math inline">\(q\)</span>-theory: controlling for investment, more profitable firms must have higher discount rates (otherwise they would invest more).</p>
<div id="investment-anomalies" class="cell" data-execution_count="38">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct anomaly variables</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>anomaly <span class="op">=</span> panel_fc.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Asset growth</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>anomaly[<span class="st">"asset_growth"</span>] <span class="op">=</span> (</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    (anomaly[<span class="st">"total_assets"</span>] <span class="op">-</span> anomaly[<span class="st">"lag_assets"</span>]) <span class="op">/</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    anomaly[<span class="st">"lag_assets"</span>]</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Investment-to-assets</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>anomaly[<span class="st">"inv_to_assets"</span>] <span class="op">=</span> anomaly[<span class="st">"capex"</span>] <span class="op">/</span> anomaly[<span class="st">"lag_assets"</span>]</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Gross profitability</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>anomaly[<span class="st">"gross_profit"</span>] <span class="op">=</span> (</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    (anomaly[<span class="st">"revenue"</span>] <span class="op">-</span> anomaly[<span class="st">"cogs"</span>]) <span class="op">/</span> anomaly[<span class="st">"total_assets"</span>]</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ROE</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>anomaly[<span class="st">"roe"</span>] <span class="op">=</span> anomaly[<span class="st">"net_income"</span>] <span class="op">/</span> anomaly[<span class="st">"book_equity"</span>]</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsorize</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"asset_growth"</span>, <span class="st">"inv_to_assets"</span>, <span class="st">"gross_profit"</span>, <span class="st">"roe"</span>]:</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    anomaly[col] <span class="op">=</span> winsorize(anomaly[col])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="portfolio-sorts-investment" class="cell" data-execution_count="39">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio sorts: quintiles on asset growth</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with monthly returns (using June rebalancing)</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>anomaly_june <span class="op">=</span> anomaly.copy()</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>anomaly_june[<span class="st">"formation_year"</span>] <span class="op">=</span> anomaly_june[<span class="st">"year"</span>]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create quintile assignments</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>anomaly_june[<span class="st">"ag_quintile"</span>] <span class="op">=</span> anomaly_june.groupby(<span class="st">"year"</span>)[</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"asset_growth"</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>].transform(<span class="kw">lambda</span> x: pd.qcut(x, <span class="dv">5</span>, labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                                duplicates<span class="op">=</span><span class="st">"drop"</span>))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with forward returns</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>monthly_with_signal <span class="op">=</span> monthly_returns.copy()</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>monthly_with_signal[<span class="st">"formation_year"</span>] <span class="op">=</span> np.where(</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    monthly_with_signal[<span class="st">"date"</span>].dt.month <span class="op">&gt;=</span> <span class="dv">7</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    monthly_with_signal[<span class="st">"date"</span>].dt.year,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    monthly_with_signal[<span class="st">"date"</span>].dt.year <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>portfolios <span class="op">=</span> monthly_with_signal.merge(</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    anomaly_june[[<span class="st">"ticker"</span>, <span class="st">"formation_year"</span>, <span class="st">"ag_quintile"</span>,</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"asset_growth"</span>, <span class="st">"gross_profit"</span>]],</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"formation_year"</span>],</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute equal-weighted quintile returns</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>ag_returns <span class="op">=</span> (</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    portfolios.groupby([<span class="st">"date"</span>, <span class="st">"ag_quintile"</span>])</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    .agg(port_ret<span class="op">=</span>(<span class="st">"ret"</span>, <span class="st">"mean"</span>))</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Long-short: Q1 (low growth) - Q5 (high growth)</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>ag_wide <span class="op">=</span> ag_returns.pivot(</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"date"</span>, columns<span class="op">=</span><span class="st">"ag_quintile"</span>, values<span class="op">=</span><span class="st">"port_ret"</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>ag_wide[<span class="st">"L-S"</span>] <span class="op">=</span> ag_wide[<span class="dv">1</span>] <span class="op">-</span> ag_wide[<span class="dv">5</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-investment-anomaly" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="40">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-investment-anomaly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.14: Asset Growth Quintile Portfolio Returns
</figcaption>
<div aria-describedby="tbl-investment-anomaly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>quintile_summary <span class="op">=</span> ag_wide.describe().T[[<span class="st">"mean"</span>, <span class="st">"std"</span>]].copy()</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>quintile_summary[<span class="st">"mean_ann"</span>] <span class="op">=</span> quintile_summary[<span class="st">"mean"</span>] <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>quintile_summary[<span class="st">"std_ann"</span>] <span class="op">=</span> quintile_summary[<span class="st">"std"</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>quintile_summary[<span class="st">"sharpe"</span>] <span class="op">=</span> (</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    quintile_summary[<span class="st">"mean_ann"</span>] <span class="op">/</span> quintile_summary[<span class="st">"std_ann"</span>]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># t-statistics</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> ag_wide.columns:</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="op">=</span> ag_wide[col].mean() <span class="op">/</span> (ag_wide[col].std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(ag_wide)))</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    quintile_summary.loc[col, <span class="st">"t_stat"</span>] <span class="op">=</span> t_stat</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>quintile_summary <span class="op">=</span> quintile_summary[</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"mean_ann"</span>, <span class="st">"std_ann"</span>, <span class="st">"sharpe"</span>, <span class="st">"t_stat"</span>]</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>].<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>quintile_summary.columns <span class="op">=</span> [</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ann. Return"</span>, <span class="st">"Ann. Vol"</span>, <span class="st">"Sharpe Ratio"</span>, <span class="st">"t-stat"</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>quintile_summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<div id="fig-ag-cumulative" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="41">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ag-cumulative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>cumret <span class="op">=</span> ag_wide[[<span class="st">"L-S"</span>]].copy()</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>cumret.columns <span class="op">=</span> [<span class="st">"Long-Short"</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>cumret <span class="op">=</span> cumret.dropna()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>cumret[<span class="st">"cumulative"</span>] <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> cumret[<span class="st">"Long-Short"</span>]).cumprod()</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>cumret <span class="op">=</span> cumret.reset_index()</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(cumret, p9.aes(x<span class="op">=</span><span class="st">"date"</span>, y<span class="op">=</span><span class="st">"cumulative"</span>))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line(color<span class="op">=</span><span class="st">"#2E5090"</span>, size<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_hline(yintercept<span class="op">=</span><span class="dv">1</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, color<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Cumulative Return (Growth of $1)"</span>,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Investment Anomaly: Low – High Asset Growth"</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ag-cumulative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;42.4
</figcaption>
</figure>
</div>
</section>
<section id="financing-anomalies" class="level3" data-number="42.6.2">
<h3 data-number="42.6.2" class="anchored" data-anchor-id="financing-anomalies"><span class="header-section-number">42.6.2</span> Financing Anomalies</h3>
<p>Firms’ financing decisions also predict returns. <span class="citation" data-cites="pontiff2008share">Pontiff and Woodgate (<a href="references.html#ref-pontiff2008share" role="doc-biblioref">2008</a>)</span> document that net stock issuance negatively predicts returns: firms that issue equity earn lower future returns, while firms that repurchase shares earn higher returns. This is consistent with both managerial market timing and an issuance-based risk factor.</p>
<p>The net stock issuance variable is typically measured as:</p>
<p><span id="eq-nsi"><span class="math display">\[
\text{NSI}_{i,t} = \ln\left(\frac{\text{Split-Adjusted Shares}_{i,t}}{\text{Split-Adjusted Shares}_{i,t-1}}\right)
\tag{42.21}\]</span></span></p>
<p>Positive NSI indicates net equity issuance; negative NSI indicates net repurchases.</p>
<div id="financing-anomaly" class="cell" data-execution_count="42">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Net Stock Issuance</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>fin_anomaly <span class="op">=</span> anomaly.copy()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"lag_shares"</span>] <span class="op">=</span> fin_anomaly.groupby(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ticker"</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"shares_outstanding"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"nsi"</span>] <span class="op">=</span> np.log(</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    fin_anomaly[<span class="st">"shares_outstanding"</span>] <span class="op">/</span> fin_anomaly[<span class="st">"lag_shares"</span>]</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"nsi"</span>] <span class="op">=</span> winsorize(fin_anomaly[<span class="st">"nsi"</span>])</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Net debt issuance (change in total debt / assets)</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"ndi"</span>] <span class="op">=</span> (</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    (fin_anomaly[<span class="st">"total_debt"</span>] <span class="op">-</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>     fin_anomaly.groupby(<span class="st">"ticker"</span>)[<span class="st">"total_debt"</span>].shift(<span class="dv">1</span>)) <span class="op">/</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    fin_anomaly[<span class="st">"lag_assets"</span>]</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"ndi"</span>] <span class="op">=</span> winsorize(fin_anomaly[<span class="st">"ndi"</span>])</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio sorts on NSI</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"nsi_quintile"</span>] <span class="op">=</span> fin_anomaly.groupby(<span class="st">"year"</span>)[</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nsi"</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>].transform(<span class="kw">lambda</span> x: pd.qcut(x, <span class="dv">5</span>, labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>                                duplicates<span class="op">=</span><span class="st">"drop"</span>))</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>port_nsi <span class="op">=</span> monthly_with_signal.merge(</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    fin_anomaly[[<span class="st">"ticker"</span>, <span class="st">"formation_year"</span>, <span class="st">"nsi_quintile"</span>]],</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"formation_year"</span>],</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>nsi_returns <span class="op">=</span> (</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    port_nsi.groupby([<span class="st">"date"</span>, <span class="st">"nsi_quintile"</span>])</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    .agg(port_ret<span class="op">=</span>(<span class="st">"ret"</span>, <span class="st">"mean"</span>))</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>nsi_wide <span class="op">=</span> nsi_returns.pivot(</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"date"</span>, columns<span class="op">=</span><span class="st">"nsi_quintile"</span>, values<span class="op">=</span><span class="st">"port_ret"</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>nsi_wide[<span class="st">"L-S"</span>] <span class="op">=</span> nsi_wide[<span class="dv">1</span>] <span class="op">-</span> nsi_wide[<span class="dv">5</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-nsi-anomaly" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="43">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nsi-anomaly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.15: Net Stock Issuance Quintile Portfolio Returns
</figcaption>
<div aria-describedby="tbl-nsi-anomaly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>nsi_summary <span class="op">=</span> nsi_wide.describe().T[[<span class="st">"mean"</span>, <span class="st">"std"</span>]].copy()</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>nsi_summary[<span class="st">"mean_ann"</span>] <span class="op">=</span> nsi_summary[<span class="st">"mean"</span>] <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>nsi_summary[<span class="st">"sharpe"</span>] <span class="op">=</span> (</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    nsi_summary[<span class="st">"mean_ann"</span>] <span class="op">/</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    (nsi_summary[<span class="st">"std"</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> nsi_wide.columns:</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="op">=</span> nsi_wide[col].mean() <span class="op">/</span> (</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        nsi_wide[col].std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(nsi_wide))</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    nsi_summary.loc[col, <span class="st">"t_stat"</span>] <span class="op">=</span> t_stat</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>nsi_summary <span class="op">=</span> nsi_summary[[<span class="st">"mean_ann"</span>, <span class="st">"sharpe"</span>, <span class="st">"t_stat"</span>]].<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>nsi_summary.columns <span class="op">=</span> [<span class="st">"Ann. Return"</span>, <span class="st">"Sharpe"</span>, <span class="st">"t-stat"</span>]</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>nsi_summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</section>
<section id="valuation-implications-fama-french-factor-regressions" class="level3" data-number="42.6.3">
<h3 data-number="42.6.3" class="anchored" data-anchor-id="valuation-implications-fama-french-factor-regressions"><span class="header-section-number">42.6.3</span> Valuation Implications: Fama-French Factor Regressions</h3>
<p>We evaluate whether the investment and financing anomalies represent compensation for systematic risk by regressing the long-short portfolios on standard factor models:</p>
<p><span id="eq-factor-regression"><span class="math display">\[
R_{p,t} - R_{f,t} = \alpha + \beta_{\text{MKT}} \text{MKT}_t + \beta_{\text{SMB}} \text{SMB}_t + \beta_{\text{HML}} \text{HML}_t + \varepsilon_t
\tag{42.22}\]</span></span></p>
<p>Significant positive <span class="math inline">\(\alpha\)</span> after controlling for known risk factors would indicate that the anomaly is not explained by size and value exposures.</p>
<div id="factor-regressions" class="cell" data-execution_count="44">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge long-short returns with factor data</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>factor_data <span class="op">=</span> factors.set_index(<span class="st">"date"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Asset growth anomaly alpha</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ag_ls <span class="op">=</span> ag_wide[[<span class="st">"L-S"</span>]].dropna().rename(columns<span class="op">=</span>{<span class="st">"L-S"</span>: <span class="st">"excess_ret"</span>})</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>ag_merged <span class="op">=</span> ag_ls.join(factor_data[[<span class="st">"mkt_rf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]], how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>model_ag_ff3 <span class="op">=</span> sm.OLS(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    ag_merged[<span class="st">"excess_ret"</span>],</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    sm.add_constant(ag_merged[[<span class="st">"mkt_rf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]])</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># NSI anomaly alpha</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>nsi_ls <span class="op">=</span> nsi_wide[[<span class="st">"L-S"</span>]].dropna().rename(columns<span class="op">=</span>{<span class="st">"L-S"</span>: <span class="st">"excess_ret"</span>})</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>nsi_merged <span class="op">=</span> nsi_ls.join(factor_data[[<span class="st">"mkt_rf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]], how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>model_nsi_ff3 <span class="op">=</span> sm.OLS(</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    nsi_merged[<span class="st">"excess_ret"</span>],</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    sm.add_constant(nsi_merged[[<span class="st">"mkt_rf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]])</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-factor-alphas" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="45">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-factor-alphas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;42.16: Fama-French Three-Factor Alphas for Corporate Decision Anomalies
</figcaption>
<div aria-describedby="tbl-factor-alphas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>alpha_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Asset Growth L-S"</span>: {</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (monthly)"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>params[<span class="st">'const'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  t-stat"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>tvalues[<span class="st">'const'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKT"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>params[<span class="st">'mkt_rf'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>params[<span class="st">'smb'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>params[<span class="st">'hml'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R²"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>rsquared<span class="sc">:.4f}</span><span class="ss">"</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Net Issuance L-S"</span>: {</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (monthly)"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>params[<span class="st">'const'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  t-stat"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>tvalues[<span class="st">'const'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKT"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>params[<span class="st">'mkt_rf'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>params[<span class="st">'smb'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>params[<span class="st">'hml'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R²"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>rsquared<span class="sc">:.4f}</span><span class="ss">"</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>alpha_table</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
<div id="fig-anomaly-comparison" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="46">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anomaly-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine asset growth and NSI long-short for comparison</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>combined <span class="op">=</span> pd.DataFrame({</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Asset Growth"</span>: ag_wide[<span class="st">"L-S"</span>],</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Net Issuance"</span>: nsi_wide[<span class="st">"L-S"</span>]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>}).dropna()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>combined_cum <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> combined).cumprod().reset_index()</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>combined_long <span class="op">=</span> combined_cum.melt(</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    id_vars<span class="op">=</span><span class="st">"date"</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    var_name<span class="op">=</span><span class="st">"Anomaly"</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">"Cumulative Return"</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(combined_long, p9.aes(</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"date"</span>, y<span class="op">=</span><span class="st">"Cumulative Return"</span>, color<span class="op">=</span><span class="st">"Anomaly"</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line(size<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_hline(yintercept<span class="op">=</span><span class="dv">1</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, color<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.scale_color_manual(values<span class="op">=</span>[<span class="st">"#2E5090"</span>, <span class="st">"#C0392B"</span>])</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Cumulative Return (Growth of $1)"</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Investment vs. Financing Anomalies: Long-Short Portfolios"</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>), legend_position<span class="op">=</span><span class="st">"top"</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-anomaly-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;42.5
</figcaption>
</figure>
</div>
<!-- ## Exercises

1.  **Measurement Error Quantification.** Implement the full @erickson2012treating fifth-order cumulant estimator (using both third and fifth moments) for the investment-$Q$ regression. Compare the corrected $\beta_1$ with the OLS estimate. What fraction of the OLS attenuation is attributable to measurement error in $Q$? Does the correction change the significance of the cash flow coefficient?

2.  **Financial Constraints and Investment Efficiency.** Construct the @hadlock2010new SA index for all Vietnamese firms. Sort firms into SA quintiles and estimate separate investment-$Q$ regressions for each quintile. Plot the $Q$ coefficient across quintiles. Is the investment-$Q$ sensitivity monotonically increasing in the SA index (as the constraint hypothesis predicts), or does the Kaplan-Zingales monotonicity failure replicate?

3.  **Speed of Leverage Adjustment.** Estimate the target adjustment model: $\text{Lev}_{i,t} - \text{Lev}_{i,t-1} = \lambda(\text{Lev}_{i,t}^* - \text{Lev}_{i,t-1}) + \varepsilon_{i,t}$, where $\text{Lev}^*$ is the target leverage predicted by the Frank-Goyal determinants. Estimate $\lambda$ for the full sample and separately for SOEs versus private firms. Does state ownership accelerate or retard adjustment to target leverage? Use a system GMM estimator to address the Nickell bias from the lagged dependent variable in short panels.

4.  **Tunneling and Related-Party Transactions.** If DataCore.vn provides related-party transaction (RPT) data, estimate the effect of RPT intensity on firm value (Tobin's $Q$) and operating performance (ROA), controlling for ownership concentration, governance variables, and firm fundamentals. Use the @jiang2010tunneling methodology to distinguish potentially expropriative RPTs from benign ones. Does the RPT-value relationship depend on the identity of the controlling shareholder (state vs. family vs. foreign)?

5.  **Dividend Tax Clientele.** Vietnam implemented a 5% dividend tax in 2014. Using a difference-in-differences design around this regulatory change, test whether the tax altered payout composition (dividends vs. share repurchases vs. retained earnings). Control for firm characteristics and use a matched sample of high- vs. low-dividend firms to estimate the treatment effect on total payout and payout mix.

6.  **Investment Factor Construction.** Construct a Vietnamese investment factor (CMA, "Conservative Minus Aggressive") following the @FamaFrench2015 methodology. Sort firms into 2×3 portfolios on size and asset growth, compute value-weighted returns, and form the long-short factor. Test whether the factor is priced in the cross-section using Fama-MacBeth regressions and whether it subsumes the asset growth anomaly documented in this chapter. Compare the factor's performance with the profitability factor (RMW). -->
</section>
</section>
<section id="summary" class="level2" data-number="42.7">
<h2 data-number="42.7" class="anchored" data-anchor-id="summary"><span class="header-section-number">42.7</span> Summary</h2>
<p>This chapter implemented the core econometric toolkit of empirical corporate finance for Vietnamese listed firms. The estimators span four interconnected domains: investment decisions (investment-<span class="math inline">\(Q\)</span> regressions and their measurement-error-corrected variants), financing decisions (capital structure determinants, pecking order tests, and market timing measures), payout policy (Lintner smoothing, repurchase models, and dividend signaling tests), and agency costs (ownership-value relationships, free cash flow measures, and governance variables).</p>
<p>Several findings deserve emphasis. The investment-<span class="math inline">\(Q\)</span> relationship in Vietnam is attenuated relative to developed-market benchmarks, reflecting both the severity of measurement error in <span class="math inline">\(Q\)</span> (thin trading, price limits, volatile inflation) and the prevalence of non-market-driven investment by SOEs. Cash flow remains a significant predictor of investment across constraint classifications, though the FHP-KZ debate about interpretation applies with full force. Capital structure is strongly predicted by profitability (negatively, consistent with the pecking order) and tangibility (positively, consistent with trade-off theory). Dividend smoothing is pronounced, but the smoothing parameter differs systematically between SOEs and private firms, reflecting the distinct institutional forces governing each group’s payout policy.</p>
<p>The chapter also linked corporate decisions to asset returns through portfolio sorts on asset growth and net stock issuance. Whether these anomalies survive risk adjustment and persist out of sample in Vietnamese markets is an important open question for future research.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-abel1994unified" class="csl-entry" role="listitem">
Abel, Andrew B, and Janice C Eberly. 1994. <span>“A Unified Model of Investment Under Uncertainty.”</span> <em>American Economic Review</em> 84 (5).
</div>
<div id="ref-baker2003does" class="csl-entry" role="listitem">
Baker, Malcolm, Jeremy C Stein, and Jeffrey Wurgler. 2003. <span>“When Does the Market Matter? Stock Prices and the Investment of Equity-Dependent Firms.”</span> <em>The Quarterly Journal of Economics</em> 118 (3): 969–1005.
</div>
<div id="ref-baker2002market" class="csl-entry" role="listitem">
Baker, Malcolm, and Jeffrey Wurgler. 2002. <span>“Market Timing and Capital Structure.”</span> <em>The Journal of Finance</em> 57 (1): 1–32.
</div>
<div id="ref-bhattacharya1979imperfect" class="csl-entry" role="listitem">
Bhattacharya, Sudipto. 1979. <span>“Imperfect Information, Dividend Policy, and" the Bird in the Hand" Fallacy.”</span> <em>The Bell Journal of Economics</em>, 259–70.
</div>
<div id="ref-bond2012real" class="csl-entry" role="listitem">
Bond, Philip, Alex Edmans, and Itay Goldstein. 2012. <span>“The Real Effects of Financial Markets.”</span> <em>Annu. Rev. Financ. Econ.</em> 4 (1): 339–60.
</div>
<div id="ref-bond2003financial" class="csl-entry" role="listitem">
Bond, Stephen, Julie Ann Elston, Jacques Mairesse, and Benoı̂t Mulkay. 2003. <span>“Financial Factors and Investment in Belgium, France, Germany, and the United Kingdom: A Comparison Using Company Panel Data.”</span> <em>Review of Economics and Statistics</em> 85 (1): 153–65.
</div>
<div id="ref-claessens2002disentangling" class="csl-entry" role="listitem">
Claessens, Stijn, Simeon Djankov, Joseph PH Fan, and Larry HP Lang. 2002. <span>“Disentangling the Incentive and Entrenchment Effects of Large Shareholdings.”</span> <em>The Journal of Finance</em> 57 (6): 2741–71.
</div>
<div id="ref-cochrane1991production" class="csl-entry" role="listitem">
Cochrane, John H. 1991. <span>“Production-Based Asset Pricing and the Link Between Stock Returns and Economic Fluctuations.”</span> <em>The Journal of Finance</em> 46 (1): 209–37.
</div>
<div id="ref-cooper2008asset" class="csl-entry" role="listitem">
Cooper, Michael J, Huseyin Gulen, and Michael J Schill. 2008. <span>“Asset Growth and the Cross-Section of Stock Returns.”</span> <em>The Journal of Finance</em> 63 (4): 1609–51.
</div>
<div id="ref-erickson2012treating" class="csl-entry" role="listitem">
Erickson, Timothy, and Toni M Whited. 2012. <span>“Treating Measurement Error in Tobin’s q.”</span> <em>The Review of Financial Studies</em> 25 (4): 1286–1329.
</div>
<div id="ref-fama2006profitability" class="csl-entry" role="listitem">
Fama, Eugene F, and Kenneth R French. 2006. <span>“Profitability, Investment and Average Returns.”</span> <em>Journal of Financial Economics</em> 82 (3): 491–518.
</div>
<div id="ref-farre2016measures" class="csl-entry" role="listitem">
Farre-Mensa, Joan, and Alexander Ljungqvist. 2016. <span>“Do Measures of Financial Constraints Measure Financial Constraints?”</span> <em>The Review of Financial Studies</em> 29 (2): 271–308.
</div>
<div id="ref-fazzari1987financing" class="csl-entry" role="listitem">
Fazzari, Steven, R Glenn Hubbard, and Bruce C Petersen. 1987. <span>“Financing Constraints and Corporate Investment.”</span> National Bureau of Economic Research Cambridge, Mass., USA.
</div>
<div id="ref-frank2003testing" class="csl-entry" role="listitem">
Frank, Murray Z, and Vidhan K Goyal. 2003. <span>“Testing the Pecking Order Theory of Capital Structure.”</span> <em>Journal of Financial Economics</em> 67 (2): 217–48.
</div>
<div id="ref-frank2009capital" class="csl-entry" role="listitem">
———. 2009. <span>“Capital Structure Decisions: Which Factors Are Reliably Important?”</span> <em>Financial Management</em> 38 (1): 1–37.
</div>
<div id="ref-hadlock2010new" class="csl-entry" role="listitem">
Hadlock, Charles J, and Joshua R Pierce. 2010. <span>“New Evidence on Measuring Financial Constraints: Moving Beyond the KZ Index.”</span> <em>The Review of Financial Studies</em> 23 (5): 1909–40.
</div>
<div id="ref-hayashi1982tobin" class="csl-entry" role="listitem">
Hayashi, Fumio. 1982. <span>“Tobin’s Marginal q and Average q: A Neoclassical Interpretation.”</span> <em>Econometrica: Journal of the Econometric Society</em>, 213–24.
</div>
<div id="ref-hou2015digesting" class="csl-entry" role="listitem">
Hou, Kewei, Chen Xue, and Lu Zhang. 2015. <span>“Digesting Anomalies: An Investment Approach.”</span> <em>The Review of Financial Studies</em> 28 (3): 650–705.
</div>
<div id="ref-jensen1986agency" class="csl-entry" role="listitem">
Jensen, Michael C. 1986. <span>“Agency Costs of Free Cash Flow, Corporate Finance, and Takeovers.”</span> <em>The American Economic Review</em> 76 (2): 323–29.
</div>
<div id="ref-jensen2019theory" class="csl-entry" role="listitem">
Jensen, Michael C, and William H Meckling. 2019. <span>“Theory of the Firm: Managerial Behavior, Agency Costs and Ownership Structure.”</span> In <em>Corporate Governance</em>, 77–132. Gower.
</div>
<div id="ref-johnson2000tunneling" class="csl-entry" role="listitem">
Johnson, Simon, Rafael La Porta, Florencio Lopez-de-Silanes, and Andrei Shleifer. 2000. <span>“Tunneling.”</span> <em>American Economic Review</em> 90 (2): 22–27.
</div>
<div id="ref-kaplan1997investment" class="csl-entry" role="listitem">
Kaplan, Steven N, and Luigi Zingales. 1997. <span>“Do Investment-Cash Flow Sensitivities Provide Useful Measures of Financing Constraints?”</span> <em>The Quarterly Journal of Economics</em> 112 (1): 169–215.
</div>
<div id="ref-la2000agency" class="csl-entry" role="listitem">
La Porta, Rafael, Florencio Lopez-de-Silanes, Andrei Shleifer, and Robert W Vishny. 2000. <span>“Agency Problems and Dividend Policies Around the World.”</span> <em>The Journal of Finance</em> 55 (1): 1–33.
</div>
<div id="ref-lamont2001financial" class="csl-entry" role="listitem">
Lamont, Owen, Christopher Polk, and Jesús Saaá-Requejo. 2001. <span>“Financial Constraints and Stock Returns.”</span> <em>The Review of Financial Studies</em> 14 (2): 529–54.
</div>
<div id="ref-lintner1956distribution" class="csl-entry" role="listitem">
Lintner, John. 1956. <span>“Distribution of Incomes of Corporations Among Dividends, Retained Earnings, and Taxes.”</span> <em>The American Economic Review</em> 46 (2): 97–113.
</div>
<div id="ref-liu2009investment" class="csl-entry" role="listitem">
Liu, Laura Xiaolei, Toni M Whited, and Lu Zhang. 2009. <span>“Investment-Based Expected Stock Returns.”</span> <em>Journal of Political Economy</em> 117 (6): 1105–39.
</div>
<div id="ref-miller1985dividend" class="csl-entry" role="listitem">
Miller, Merton H, and Kevin Rock. 1985. <span>“Dividend Policy Under Asymmetric Information.”</span> <em>The Journal of Finance</em> 40 (4): 1031–51.
</div>
<div id="ref-morck1988management" class="csl-entry" role="listitem">
Morck, Randall, Andrei Shleifer, and Robert W Vishny. 1988. <span>“Management Ownership and Market Valuation: An Empirical Analysis.”</span> <em>Journal of Financial Economics</em> 20: 293–315.
</div>
<div id="ref-myers1984capital" class="csl-entry" role="listitem">
Myers, Stewart C. 1984. <span>“The Capital Structure Puzzle.”</span> <em>Journal of Finance</em> 39 (3): 575–92.
</div>
<div id="ref-novy2013other" class="csl-entry" role="listitem">
Novy-Marx, Robert. 2013. <span>“The Other Side of Value: The Gross Profitability Premium.”</span> <em>Journal of Financial Economics</em> 108 (1): 1–28.
</div>
<div id="ref-pontiff2008share" class="csl-entry" role="listitem">
Pontiff, Jeffrey, and Artemiza Woodgate. 2008. <span>“Share Issuance and Cross-Sectional Returns.”</span> <em>The Journal of Finance</em> 63 (2): 921–45.
</div>
<div id="ref-rajan1998financial" class="csl-entry" role="listitem">
Rajan, Raghuram G, and Luigi Zingales. 1998. <span>“Financial Dependence and Growth.”</span> <em>American Economic Review</em>, 559–86.
</div>
<div id="ref-shyam1999testing" class="csl-entry" role="listitem">
Shyam-Sunder, Lakshmi, and Stewart C Myers. 1999. <span>“Testing Static Tradeoff Against Pecking Order Models of Capital Structure.”</span> <em>Journal of Financial Economics</em> 51 (2): 219–44.
</div>
<div id="ref-titman2004capital" class="csl-entry" role="listitem">
Titman, Sheridan, KC John Wei, and Feixue Xie. 2004. <span>“Capital Investments and Stock Returns.”</span> <em>Journal of Financial and Quantitative Analysis</em> 39 (4): 677–700.
</div>
<div id="ref-whited2006financial" class="csl-entry" role="listitem">
Whited, Toni M, and Guojun Wu. 2006. <span>“Financial Constraints Risk.”</span> <em>The Review of Financial Studies</em> 19 (2): 531–59.
</div>
<div id="ref-young2008corporate" class="csl-entry" role="listitem">
Young, Michael N, Mike W Peng, David Ahlstrom, Garry D Bruton, and Yi Jiang. 2008. <span>“Corporate Governance in Emerging Economies: A Review of the Principal–Principal Perspective.”</span> <em>Journal of Management Studies</em> 45 (1): 196–220.
</div>
</div>
</section>

</main> <!-- /main -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const year = new Date().getFullYear();
  document.getElementById("copyright").textContent = "© " + year;
});
</script>
<script>
(function () {
  const GA_ID = "G-LMDLDJXXSC";   // your real GA4 ID
  const CONSENT_KEY = "cookie_consent_v1";

  function log(msg) {
    console.log("[GA Loader]", msg);
  }

  function loadGtag() {
    if (window.__gtag_loaded__) {
      log("GA already loaded, skipping");
      return;
    }

    log("Loading Google Analytics...");

    window.__gtag_loaded__ = true;

    const script = document.createElement("script");
    script.async = true;
    script.src = "https://www.googletagmanager.com/gtag/js?id=" + encodeURIComponent(GA_ID);

    script.onload = function () {
      log("gtag.js loaded");

      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      window.gtag = gtag;

      gtag("js", new Date());
      gtag("config", GA_ID, {
        anonymize_ip: true,
        transport_type: "beacon"
      });

      log("GA initialized successfully");
    };

    script.onerror = function () {
      log("FAILED to load gtag.js. Likely blocked by ad blocker or network.");
    };

    document.head.appendChild(script);
  }

  function checkConsentAndLoad() {
    const consent = localStorage.getItem(CONSENT_KEY);
    log("Stored consent value = " + consent);

    if (consent === "accepted") {
      loadGtag();
    } else {
      log("Analytics blocked due to missing or declined consent");
    }
  }

  // Run on page load
  checkConsentAndLoad();

  // Listen for cookie banner decisions
  window.addEventListener("cookie-consent-changed", function (e) {
    log("Consent event received: " + e.detail);
    if (e.detail === "accepted") {
      loadGtag();
    }
  });

})();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/github\.com\/mikenguyen13\/tidy_finance_vn");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./61_tail_risk_extreme_events.html" class="pagination-link" aria-label="Tail Risk and Extreme Events">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Tail Risk and Extreme Events</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./63_structural_models_finance.html" class="pagination-link" aria-label="Structural Models in Finance">
        <span class="nav-page-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Structural Models in Finance</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Corporate Finance Estimators and Identification</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>Corporate finance is the study of how firms make investment, financing, and payout decisions under real-world frictions (e.g., taxes, asymmetric information, agency conflicts, transaction costs, and financial constraints). Unlike asset pricing, where the primary objects of interest are expected returns and risk premia estimated from market data, corporate finance estimators are tied to firm-level accounting and governance data, and their economic interpretation depends critically on the institutional environment in which the firm operates.</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>This chapter develops the core econometric toolkit for empirical corporate finance and applies it to Vietnamese listed firms. The estimators we cover (including investment-$Q$ regressions, cash flow sensitivity tests, capital structure determinants, payout smoothing models, and agency cost proxies) form the backbone of the modern corporate finance literature. Each estimator embeds specific theoretical assumptions, and each has been the subject of substantial methodological debate. We pay careful attention to identification challenges: the conditions under which a regression coefficient admits a causal or structural interpretation versus merely a descriptive association.</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>Vietnamese firms present distinctive features that interact with these estimators in economically meaningful ways. State ownership remains pervasive and creates agency problems qualitatively different from the dispersed-ownership setting of the Anglo-American literature. Concentrated family ownership, pyramidal structures, and cross-holdings generate tunneling incentives documented by @johnson2000tunneling and @claessens2002disentangling. The banking system is dominated by state-owned commercial banks whose lending decisions may reflect political rather than purely economic criteria, complicating the interpretation of financing constraint measures. And dividend policy is shaped by regulatory requirements, including minimum payout ratios for state-owned enterprises, that have no parallel in more developed markets.</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> linearmodels.panel <span class="im">import</span> PanelOLS, PooledOLS</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> p9</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mizani.formatters <span class="im">import</span> percent_format, comma_format</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-data</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="co"># DataCore.vn API</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datacore <span class="im">import</span> DataCore</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>dc <span class="op">=</span> DataCore()</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Load annual firm-level financial data</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>firm_annual <span class="op">=</span> dc.get_firm_financials(</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">"2008-01-01"</span>,</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">"2024-12-31"</span>,</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    frequency<span class="op">=</span><span class="st">"annual"</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ownership data</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>ownership <span class="op">=</span> dc.get_ownership_data(</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">"2008-01-01"</span>,</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">"2024-12-31"</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Load stock returns (monthly)</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>monthly_returns <span class="op">=</span> dc.get_monthly_returns(</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">"2008-01-01"</span>,</span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">"2024-12-31"</span></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Load market and factor returns</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>factors <span class="op">=</span> dc.get_factor_returns(</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>    start_date<span class="op">=</span><span class="st">"2008-01-01"</span>,</span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>    end_date<span class="op">=</span><span class="st">"2024-12-31"</span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Firm-year observations: </span><span class="sc">{</span><span class="bu">len</span>(firm_annual)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique firms: </span><span class="sc">{</span>firm_annual[<span class="st">'ticker'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Year range: </span><span class="sc">{</span>firm_annual[<span class="st">'year'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">}</span><span class="ss">–</span><span class="sc">{</span>firm_annual[<span class="st">'year'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Investment-$Q$ Regressions</span></span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tobin's $Q$: Intuition and Theory</span></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>The investment-$Q$ framework is the canonical structural model of corporate investment. The core insight, formalized by @hayashi1982tobin, is elegant: under perfect capital markets and constant returns to scale in the production and adjustment cost technologies, a firm's investment rate should be a sufficient statistic of a single observable (i.e., the ratio of the market value of installed capital to its replacement cost).</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>Let $V_t$ denote the market value of the firm's assets at time $t$ and $K_t$ the replacement cost of its capital stock. Tobin's $Q$ is:</span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>Q_t = \frac{V_t}{K_t}</span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>$$ {#eq-tobins-q}</span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>When $Q &gt; 1$, the market values a unit of installed capital above its replacement cost, signaling that the firm should invest. When $Q &lt; 1$, the firm should disinvest. In the frictionless @hayashi1982tobin environment, the marginal $Q$ (the shadow value of an additional unit of capital) equals the average $Q$ (the ratio of total market value to total replacement cost), and the optimal investment policy is:</span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a>\frac{I_{i,t}}{K_{i,t-1}} = \frac{1}{\alpha}\left(Q_{i,t} - 1\right)</span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>$$ {#eq-investment-q-theory}</span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>where $\alpha$ governs the convexity of adjustment costs. The empirical counterpart is the regression:</span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>\frac{I_{i,t}}{K_{i,t-1}} = \beta_0 + \beta_1 Q_{i,t} + \varepsilon_{i,t}</span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>$$ {#eq-investment-q-regression}</span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>Under the structural interpretation, $\beta_1 = 1/\alpha &gt; 0$ and $Q$ is the sole explanatory variable. Any additional variable that enters significantly implies a violation of the underlying assumptions (e.g., financial frictions, agency problems, measurement error in $Q$, or departures from constant returns to scale).</span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a><span class="fu">### Measurement Issues</span></span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>The theoretical object is marginal $Q$ (i.e., the value of the next dollar of investment) which is unobservable. The empirical proxy is average $Q$, typically constructed as:</span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a>Q_{i,t}^{\text{avg}} = \frac{\text{Market Value of Equity} + \text{Book Value of Debt}}{\text{Book Value of Total Assets}}</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a>$$ {#eq-average-q}</span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a>This proxy introduces several problems that are well-documented in the literature.</span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a>**Problem 1: Marginal** $\neq$ Average. The equality $q^{\text{marginal}} = Q^{\text{average}}$ requires constant returns to scale in both production and adjustment costs <span class="co">[</span><span class="ot">@hayashi1982tobin</span><span class="co">]</span>. With decreasing returns to scale (empirically relevant for most firms), average $Q$ overstates marginal $Q$ for high-$Q$ firms and understates it for low-$Q$ firms. @abel1994unified derive the wedge analytically.</span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a>**Problem 2: Measurement error in numerator.** The market value of equity reflects market sentiment, bubbles, and noise-trader demand in addition to fundamentals. @bond2012real provide a comprehensive treatment. In Vietnamese markets, where retail investors dominate and price limits constrain daily adjustment, market prices may deviate persistently from fundamental value.</span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a>**Problem 3: Measurement error in denominator.** Book values of assets reflect historical cost, depreciation schedules, and accounting conventions that may poorly approximate replacement cost. This is especially problematic in Vietnam, where revaluation of fixed assets is infrequent and inflation has historically been volatile, creating wedges between historical and replacement cost.</span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a>**Problem 4: Errors-in-variables bias.** Because the empirical $Q$ is a noisy proxy for the true $Q$, OLS estimates of $\beta_1$ in @eq-investment-q-regression suffer from classical attenuation bias (i.e., $hat{\beta}_1$ is biased toward zero). @erickson2012treating develop a higher-order cumulant estimator that corrects for this bias without requiring external instruments.</span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: construct-q</span></span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct Tobin's Q and investment variables</span></span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a>panel <span class="op">=</span> firm_annual.copy()</span>
<span id="cb46-121"><a href="#cb46-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Tobin's Q: (Market cap + Book debt) / Total assets</span></span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"tobins_q"</span>] <span class="op">=</span> (</span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a>    (panel[<span class="st">"market_cap"</span>] <span class="op">+</span> panel[<span class="st">"total_debt"</span>]) <span class="op">/</span></span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a>    panel[<span class="st">"total_assets"</span>]</span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-127"><a href="#cb46-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Investment rate: Capital expenditure / Lagged total assets</span></span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a>panel <span class="op">=</span> panel.sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"lag_assets"</span>] <span class="op">=</span> panel.groupby(<span class="st">"ticker"</span>)[<span class="st">"total_assets"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"lag_ppe"</span>] <span class="op">=</span> panel.groupby(<span class="st">"ticker"</span>)[<span class="st">"ppe_net"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-132"><a href="#cb46-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-133"><a href="#cb46-133" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"inv_rate"</span>] <span class="op">=</span> panel[<span class="st">"capex"</span>] <span class="op">/</span> panel[<span class="st">"lag_assets"</span>]</span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"inv_rate_ppe"</span>] <span class="op">=</span> panel[<span class="st">"capex"</span>] <span class="op">/</span> panel[<span class="st">"lag_ppe"</span>]</span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Cash flow / Assets</span></span>
<span id="cb46-137"><a href="#cb46-137" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"cf_assets"</span>] <span class="op">=</span> panel[<span class="st">"operating_cf"</span>] <span class="op">/</span> panel[<span class="st">"lag_assets"</span>]</span>
<span id="cb46-138"><a href="#cb46-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Sales growth</span></span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"lag_revenue"</span>] <span class="op">=</span> panel.groupby(<span class="st">"ticker"</span>)[<span class="st">"revenue"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-141"><a href="#cb46-141" aria-hidden="true" tabindex="-1"></a>panel[<span class="st">"sales_growth"</span>] <span class="op">=</span> (</span>
<span id="cb46-142"><a href="#cb46-142" aria-hidden="true" tabindex="-1"></a>    (panel[<span class="st">"revenue"</span>] <span class="op">-</span> panel[<span class="st">"lag_revenue"</span>]) <span class="op">/</span> panel[<span class="st">"lag_revenue"</span>]</span>
<span id="cb46-143"><a href="#cb46-143" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-144"><a href="#cb46-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-145"><a href="#cb46-145" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsorize at 1st and 99th percentiles</span></span>
<span id="cb46-146"><a href="#cb46-146" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> winsorize(s, lower<span class="op">=</span><span class="fl">0.01</span>, upper<span class="op">=</span><span class="fl">0.99</span>):</span>
<span id="cb46-147"><a href="#cb46-147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s.clip(s.quantile(lower), s.quantile(upper))</span>
<span id="cb46-148"><a href="#cb46-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-149"><a href="#cb46-149" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"tobins_q"</span>, <span class="st">"inv_rate"</span>, <span class="st">"cf_assets"</span>, <span class="st">"sales_growth"</span>]:</span>
<span id="cb46-150"><a href="#cb46-150" aria-hidden="true" tabindex="-1"></a>    panel[col] <span class="op">=</span> winsorize(panel[col])</span>
<span id="cb46-151"><a href="#cb46-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-152"><a href="#cb46-152" aria-hidden="true" tabindex="-1"></a>panel_clean <span class="op">=</span> panel.dropna(</span>
<span id="cb46-153"><a href="#cb46-153" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"tobins_q"</span>, <span class="st">"inv_rate"</span>, <span class="st">"cf_assets"</span>]</span>
<span id="cb46-154"><a href="#cb46-154" aria-hidden="true" tabindex="-1"></a>).copy()</span>
<span id="cb46-155"><a href="#cb46-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-156"><a href="#cb46-156" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Clean panel: </span><span class="sc">{</span><span class="bu">len</span>(panel_clean)<span class="sc">}</span><span class="ss"> firm-years, "</span></span>
<span id="cb46-157"><a href="#cb46-157" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"</span><span class="sc">{</span>panel_clean[<span class="st">'ticker'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss"> firms"</span>)</span>
<span id="cb46-158"><a href="#cb46-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-159"><a href="#cb46-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-162"><a href="#cb46-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-163"><a href="#cb46-163" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-investment-summary</span></span>
<span id="cb46-164"><a href="#cb46-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-165"><a href="#cb46-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Summary Statistics: Investment and Q Variables"</span></span>
<span id="cb46-166"><a href="#cb46-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-167"><a href="#cb46-167" aria-hidden="true" tabindex="-1"></a>summary_vars <span class="op">=</span> [<span class="st">"inv_rate"</span>, <span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, <span class="st">"sales_growth"</span>]</span>
<span id="cb46-168"><a href="#cb46-168" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> panel_clean[summary_vars].describe(</span>
<span id="cb46-169"><a href="#cb46-169" aria-hidden="true" tabindex="-1"></a>    percentiles<span class="op">=</span>[<span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span>]</span>
<span id="cb46-170"><a href="#cb46-170" aria-hidden="true" tabindex="-1"></a>).T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-171"><a href="#cb46-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-172"><a href="#cb46-172" aria-hidden="true" tabindex="-1"></a>summary.columns <span class="op">=</span> [<span class="st">"N"</span>, <span class="st">"Mean"</span>, <span class="st">"Std"</span>, <span class="st">"Min"</span>, <span class="st">"5%"</span>, <span class="st">"25%"</span>,</span>
<span id="cb46-173"><a href="#cb46-173" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Median"</span>, <span class="st">"75%"</span>, <span class="st">"95%"</span>, <span class="st">"Max"</span>]</span>
<span id="cb46-174"><a href="#cb46-174" aria-hidden="true" tabindex="-1"></a>summary</span>
<span id="cb46-175"><a href="#cb46-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-176"><a href="#cb46-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-179"><a href="#cb46-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-180"><a href="#cb46-180" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: baseline-q-regression</span></span>
<span id="cb46-181"><a href="#cb46-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-182"><a href="#cb46-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-183"><a href="#cb46-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Baseline investment-Q regression with firm and year fixed effects</span></span>
<span id="cb46-184"><a href="#cb46-184" aria-hidden="true" tabindex="-1"></a>panel_clean <span class="op">=</span> panel_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-185"><a href="#cb46-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-186"><a href="#cb46-186" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Q only</span></span>
<span id="cb46-187"><a href="#cb46-187" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> PanelOLS(</span>
<span id="cb46-188"><a href="#cb46-188" aria-hidden="true" tabindex="-1"></a>    panel_clean[<span class="st">"inv_rate"</span>],</span>
<span id="cb46-189"><a href="#cb46-189" aria-hidden="true" tabindex="-1"></a>    panel_clean[[<span class="st">"tobins_q"</span>]],</span>
<span id="cb46-190"><a href="#cb46-190" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-191"><a href="#cb46-191" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-192"><a href="#cb46-192" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-193"><a href="#cb46-193" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-194"><a href="#cb46-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-195"><a href="#cb46-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Q + Cash Flow</span></span>
<span id="cb46-196"><a href="#cb46-196" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> PanelOLS(</span>
<span id="cb46-197"><a href="#cb46-197" aria-hidden="true" tabindex="-1"></a>    panel_clean[<span class="st">"inv_rate"</span>],</span>
<span id="cb46-198"><a href="#cb46-198" aria-hidden="true" tabindex="-1"></a>    panel_clean[[<span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>]],</span>
<span id="cb46-199"><a href="#cb46-199" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-200"><a href="#cb46-200" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-201"><a href="#cb46-201" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-202"><a href="#cb46-202" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-203"><a href="#cb46-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-204"><a href="#cb46-204" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3: Q + Cash Flow + Sales Growth</span></span>
<span id="cb46-205"><a href="#cb46-205" aria-hidden="true" tabindex="-1"></a>model3 <span class="op">=</span> PanelOLS(</span>
<span id="cb46-206"><a href="#cb46-206" aria-hidden="true" tabindex="-1"></a>    panel_clean[<span class="st">"inv_rate"</span>],</span>
<span id="cb46-207"><a href="#cb46-207" aria-hidden="true" tabindex="-1"></a>    panel_clean[[<span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, <span class="st">"sales_growth"</span>]],</span>
<span id="cb46-208"><a href="#cb46-208" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-209"><a href="#cb46-209" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-210"><a href="#cb46-210" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-211"><a href="#cb46-211" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-212"><a href="#cb46-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-213"><a href="#cb46-213" aria-hidden="true" tabindex="-1"></a>panel_clean <span class="op">=</span> panel_clean.reset_index()</span>
<span id="cb46-214"><a href="#cb46-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-215"><a href="#cb46-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-218"><a href="#cb46-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-219"><a href="#cb46-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-q-regression</span></span>
<span id="cb46-220"><a href="#cb46-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-221"><a href="#cb46-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Investment-Q Regressions with Firm and Year Fixed Effects"</span></span>
<span id="cb46-222"><a href="#cb46-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-223"><a href="#cb46-223" aria-hidden="true" tabindex="-1"></a>results_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-224"><a href="#cb46-224" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Q Only"</span>: {</span>
<span id="cb46-225"><a href="#cb46-225" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tobin's Q"</span>: <span class="ss">f"</span><span class="sc">{</span>model1<span class="sc">.</span>params[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-226"><a href="#cb46-226" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>: <span class="ss">f"(</span><span class="sc">{</span>model1<span class="sc">.</span>std_errors[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb46-227"><a href="#cb46-227" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cash Flow/Assets"</span>: <span class="st">""</span>,</span>
<span id="cb46-228"><a href="#cb46-228" aria-hidden="true" tabindex="-1"></a>        <span class="st">" "</span>: <span class="st">""</span>,</span>
<span id="cb46-229"><a href="#cb46-229" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sales Growth"</span>: <span class="st">""</span>,</span>
<span id="cb46-230"><a href="#cb46-230" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  "</span>: <span class="st">""</span>,</span>
<span id="cb46-231"><a href="#cb46-231" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R² (within)"</span>: <span class="ss">f"</span><span class="sc">{</span>model1<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-232"><a href="#cb46-232" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(model1.nobs)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb46-233"><a href="#cb46-233" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb46-234"><a href="#cb46-234" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Q + CF"</span>: {</span>
<span id="cb46-235"><a href="#cb46-235" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tobin's Q"</span>: <span class="ss">f"</span><span class="sc">{</span>model2<span class="sc">.</span>params[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-236"><a href="#cb46-236" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>: <span class="ss">f"(</span><span class="sc">{</span>model2<span class="sc">.</span>std_errors[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb46-237"><a href="#cb46-237" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cash Flow/Assets"</span>: <span class="ss">f"</span><span class="sc">{</span>model2<span class="sc">.</span>params[<span class="st">'cf_assets'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-238"><a href="#cb46-238" aria-hidden="true" tabindex="-1"></a>        <span class="st">" "</span>: <span class="ss">f"(</span><span class="sc">{</span>model2<span class="sc">.</span>std_errors[<span class="st">'cf_assets'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb46-239"><a href="#cb46-239" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sales Growth"</span>: <span class="st">""</span>,</span>
<span id="cb46-240"><a href="#cb46-240" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  "</span>: <span class="st">""</span>,</span>
<span id="cb46-241"><a href="#cb46-241" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R² (within)"</span>: <span class="ss">f"</span><span class="sc">{</span>model2<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-242"><a href="#cb46-242" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(model2.nobs)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb46-243"><a href="#cb46-243" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb46-244"><a href="#cb46-244" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Q + CF + SG"</span>: {</span>
<span id="cb46-245"><a href="#cb46-245" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tobin's Q"</span>: <span class="ss">f"</span><span class="sc">{</span>model3<span class="sc">.</span>params[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-246"><a href="#cb46-246" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>: <span class="ss">f"(</span><span class="sc">{</span>model3<span class="sc">.</span>std_errors[<span class="st">'tobins_q'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb46-247"><a href="#cb46-247" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cash Flow/Assets"</span>: <span class="ss">f"</span><span class="sc">{</span>model3<span class="sc">.</span>params[<span class="st">'cf_assets'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-248"><a href="#cb46-248" aria-hidden="true" tabindex="-1"></a>        <span class="st">" "</span>: <span class="ss">f"(</span><span class="sc">{</span>model3<span class="sc">.</span>std_errors[<span class="st">'cf_assets'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb46-249"><a href="#cb46-249" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sales Growth"</span>: <span class="ss">f"</span><span class="sc">{</span>model3<span class="sc">.</span>params[<span class="st">'sales_growth'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-250"><a href="#cb46-250" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  "</span>: <span class="ss">f"(</span><span class="sc">{</span>model3<span class="sc">.</span>std_errors[<span class="st">'sales_growth'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>,</span>
<span id="cb46-251"><a href="#cb46-251" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R² (within)"</span>: <span class="ss">f"</span><span class="sc">{</span>model3<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-252"><a href="#cb46-252" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(model3.nobs)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb46-253"><a href="#cb46-253" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-254"><a href="#cb46-254" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-255"><a href="#cb46-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-256"><a href="#cb46-256" aria-hidden="true" tabindex="-1"></a>results_table</span>
<span id="cb46-257"><a href="#cb46-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-258"><a href="#cb46-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-259"><a href="#cb46-259" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation Under Market Frictions</span></span>
<span id="cb46-260"><a href="#cb46-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-261"><a href="#cb46-261" aria-hidden="true" tabindex="-1"></a>The coefficient on $Q$ in @tbl-q-regression admits multiple interpretations depending on the maintained assumptions:</span>
<span id="cb46-262"><a href="#cb46-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-263"><a href="#cb46-263" aria-hidden="true" tabindex="-1"></a>**Structural interpretation.** If the Hayashi conditions hold, $\hat{\beta}_1$ estimates the inverse of the adjustment cost parameter: $\hat{\beta}_1 = 1/\hat{\alpha}$. A larger coefficient implies lower adjustment costs. However, measurement error in $Q$ biases $\hat{\beta}_1$ downward, so the raw OLS estimate provides a lower bound on $1/\alpha$.</span>
<span id="cb46-264"><a href="#cb46-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-265"><a href="#cb46-265" aria-hidden="true" tabindex="-1"></a>**Reduced-form interpretation.** Without the Hayashi conditions, $\hat{\beta}_1$ captures the association between market valuation and investment intensity. This association reflects a mixture of genuine investment opportunities (the $Q$-theory channel), market mispricing that managers exploit (the market timing channel of @baker2003does), and reverse causality (investment announcements that move market values).</span>
<span id="cb46-266"><a href="#cb46-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-267"><a href="#cb46-267" aria-hidden="true" tabindex="-1"></a>**The cash flow coefficient puzzle.** The significance of $\hat{\beta}_2$ on cash flow has been the subject of a 35-year debate. @fazzari1987financing interpret it as evidence that firms face financing constraints: controlling for investment opportunities ($Q$), cash flow should be irrelevant in a frictionless world, so its significance implies that internal funds relax binding constraints. @kaplan1997investment counter that cash flow proxies for investment opportunities not captured by the noisy $Q$ measure, making the cash flow coefficient an artifact of measurement error rather than evidence of constraints. @erickson2012treating show that correcting for measurement error in $Q$ substantially reduces (but does not eliminate) the cash flow coefficient, supporting a middle ground.</span>
<span id="cb46-268"><a href="#cb46-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-269"><a href="#cb46-269" aria-hidden="true" tabindex="-1"></a><span class="fu">### Limitations in Emerging Markets</span></span>
<span id="cb46-270"><a href="#cb46-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-271"><a href="#cb46-271" aria-hidden="true" tabindex="-1"></a>The investment-$Q$ framework faces amplified challenges in Vietnamese markets.</span>
<span id="cb46-272"><a href="#cb46-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-273"><a href="#cb46-273" aria-hidden="true" tabindex="-1"></a>**Thin trading and price limits.** Market prices adjust slowly to information, so $Q$ measured at fiscal year-end may not reflect the firm's current investment opportunity set. Price limits of $\pm 7\%$ (HOSE) and $\pm 10\%$ (HNX) mechanically compress the numerator of $Q$, attenuating the investment-$Q$ relationship.</span>
<span id="cb46-274"><a href="#cb46-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-275"><a href="#cb46-275" aria-hidden="true" tabindex="-1"></a>**State ownership.** For state-owned enterprises (SOEs), investment decisions may be driven by policy directives rather than $Q$-theoretic optimality. Including SOEs in the regression without interactions confounds the structural relationship.</span>
<span id="cb46-276"><a href="#cb46-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-277"><a href="#cb46-277" aria-hidden="true" tabindex="-1"></a>**Related-party transactions.** Tunneling through related-party transactions means that measured investment may include capital expenditures that benefit controlling shareholders rather than maximizing firm value. The investment-$Q$ coefficient in tunneling firms reflects the relationship between market valuation and expropriation, not efficient capital allocation.</span>
<span id="cb46-278"><a href="#cb46-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-281"><a href="#cb46-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-282"><a href="#cb46-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-investment-q-scatter</span></span>
<span id="cb46-283"><a href="#cb46-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-284"><a href="#cb46-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Investment Rate vs. Tobin's Q: Binned Scatter Plot"</span></span>
<span id="cb46-285"><a href="#cb46-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-286"><a href="#cb46-286" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Q-decile bins for clean visualization</span></span>
<span id="cb46-287"><a href="#cb46-287" aria-hidden="true" tabindex="-1"></a>plot_data <span class="op">=</span> panel_clean.copy()</span>
<span id="cb46-288"><a href="#cb46-288" aria-hidden="true" tabindex="-1"></a>plot_data[<span class="st">"q_bin"</span>] <span class="op">=</span> pd.qcut(</span>
<span id="cb46-289"><a href="#cb46-289" aria-hidden="true" tabindex="-1"></a>    plot_data[<span class="st">"tobins_q"</span>], q<span class="op">=</span><span class="dv">20</span>, duplicates<span class="op">=</span><span class="st">"drop"</span></span>
<span id="cb46-290"><a href="#cb46-290" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-291"><a href="#cb46-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-292"><a href="#cb46-292" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> (</span>
<span id="cb46-293"><a href="#cb46-293" aria-hidden="true" tabindex="-1"></a>    plot_data.groupby(<span class="st">"q_bin"</span>, observed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-294"><a href="#cb46-294" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb46-295"><a href="#cb46-295" aria-hidden="true" tabindex="-1"></a>        mean_q<span class="op">=</span>(<span class="st">"tobins_q"</span>, <span class="st">"mean"</span>),</span>
<span id="cb46-296"><a href="#cb46-296" aria-hidden="true" tabindex="-1"></a>        mean_inv<span class="op">=</span>(<span class="st">"inv_rate"</span>, <span class="st">"mean"</span>),</span>
<span id="cb46-297"><a href="#cb46-297" aria-hidden="true" tabindex="-1"></a>        se_inv<span class="op">=</span>(<span class="st">"inv_rate"</span>, <span class="kw">lambda</span> x: x.std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(x)))</span>
<span id="cb46-298"><a href="#cb46-298" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-299"><a href="#cb46-299" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb46-300"><a href="#cb46-300" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-301"><a href="#cb46-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-302"><a href="#cb46-302" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb46-303"><a href="#cb46-303" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(binned, p9.aes(x<span class="op">=</span><span class="st">"mean_q"</span>, y<span class="op">=</span><span class="st">"mean_inv"</span>))</span>
<span id="cb46-304"><a href="#cb46-304" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_pointrange(</span>
<span id="cb46-305"><a href="#cb46-305" aria-hidden="true" tabindex="-1"></a>        p9.aes(ymin<span class="op">=</span><span class="st">"mean_inv - 1.96*se_inv"</span>,</span>
<span id="cb46-306"><a href="#cb46-306" aria-hidden="true" tabindex="-1"></a>               ymax<span class="op">=</span><span class="st">"mean_inv + 1.96*se_inv"</span>),</span>
<span id="cb46-307"><a href="#cb46-307" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"#2E5090"</span>, size<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb46-308"><a href="#cb46-308" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-309"><a href="#cb46-309" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_smooth(method<span class="op">=</span><span class="st">"lm"</span>, color<span class="op">=</span><span class="st">"#C0392B"</span>, se<span class="op">=</span><span class="va">False</span>, size<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb46-310"><a href="#cb46-310" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb46-311"><a href="#cb46-311" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Tobin's Q (Vingtile Mean)"</span>,</span>
<span id="cb46-312"><a href="#cb46-312" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Investment Rate (I/A)"</span>,</span>
<span id="cb46-313"><a href="#cb46-313" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Investment-Q Relationship: Binned Scatter"</span></span>
<span id="cb46-314"><a href="#cb46-314" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-315"><a href="#cb46-315" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb46-316"><a href="#cb46-316" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb46-317"><a href="#cb46-317" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-318"><a href="#cb46-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-319"><a href="#cb46-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-322"><a href="#cb46-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-323"><a href="#cb46-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: q-regression-soe-interaction</span></span>
<span id="cb46-324"><a href="#cb46-324" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-325"><a href="#cb46-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-326"><a href="#cb46-326" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge ownership data</span></span>
<span id="cb46-327"><a href="#cb46-327" aria-hidden="true" tabindex="-1"></a>panel_with_own <span class="op">=</span> panel_clean.merge(</span>
<span id="cb46-328"><a href="#cb46-328" aria-hidden="true" tabindex="-1"></a>    ownership[[<span class="st">"ticker"</span>, <span class="st">"year"</span>, <span class="st">"state_ownership_pct"</span>,</span>
<span id="cb46-329"><a href="#cb46-329" aria-hidden="true" tabindex="-1"></a>               <span class="st">"foreign_ownership_pct"</span>, <span class="st">"insider_ownership_pct"</span>]],</span>
<span id="cb46-330"><a href="#cb46-330" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"year"</span>],</span>
<span id="cb46-331"><a href="#cb46-331" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb46-332"><a href="#cb46-332" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-333"><a href="#cb46-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-334"><a href="#cb46-334" aria-hidden="true" tabindex="-1"></a>panel_with_own[<span class="st">"soe_dummy"</span>] <span class="op">=</span> (</span>
<span id="cb46-335"><a href="#cb46-335" aria-hidden="true" tabindex="-1"></a>    panel_with_own[<span class="st">"state_ownership_pct"</span>] <span class="op">&gt;</span> <span class="dv">50</span></span>
<span id="cb46-336"><a href="#cb46-336" aria-hidden="true" tabindex="-1"></a>).astype(<span class="bu">int</span>)</span>
<span id="cb46-337"><a href="#cb46-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-338"><a href="#cb46-338" aria-hidden="true" tabindex="-1"></a>panel_with_own[<span class="st">"q_x_soe"</span>] <span class="op">=</span> (</span>
<span id="cb46-339"><a href="#cb46-339" aria-hidden="true" tabindex="-1"></a>    panel_with_own[<span class="st">"tobins_q"</span>] <span class="op">*</span> panel_with_own[<span class="st">"soe_dummy"</span>]</span>
<span id="cb46-340"><a href="#cb46-340" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-341"><a href="#cb46-341" aria-hidden="true" tabindex="-1"></a>panel_with_own[<span class="st">"cf_x_soe"</span>] <span class="op">=</span> (</span>
<span id="cb46-342"><a href="#cb46-342" aria-hidden="true" tabindex="-1"></a>    panel_with_own[<span class="st">"cf_assets"</span>] <span class="op">*</span> panel_with_own[<span class="st">"soe_dummy"</span>]</span>
<span id="cb46-343"><a href="#cb46-343" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-344"><a href="#cb46-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-345"><a href="#cb46-345" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression with SOE interactions</span></span>
<span id="cb46-346"><a href="#cb46-346" aria-hidden="true" tabindex="-1"></a>panel_soe <span class="op">=</span> panel_with_own.dropna(</span>
<span id="cb46-347"><a href="#cb46-347" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"inv_rate"</span>, <span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, <span class="st">"soe_dummy"</span>]</span>
<span id="cb46-348"><a href="#cb46-348" aria-hidden="true" tabindex="-1"></a>).set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-349"><a href="#cb46-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-350"><a href="#cb46-350" aria-hidden="true" tabindex="-1"></a>model_soe <span class="op">=</span> PanelOLS(</span>
<span id="cb46-351"><a href="#cb46-351" aria-hidden="true" tabindex="-1"></a>    panel_soe[<span class="st">"inv_rate"</span>],</span>
<span id="cb46-352"><a href="#cb46-352" aria-hidden="true" tabindex="-1"></a>    panel_soe[[<span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, <span class="st">"soe_dummy"</span>,</span>
<span id="cb46-353"><a href="#cb46-353" aria-hidden="true" tabindex="-1"></a>               <span class="st">"q_x_soe"</span>, <span class="st">"cf_x_soe"</span>]],</span>
<span id="cb46-354"><a href="#cb46-354" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-355"><a href="#cb46-355" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-356"><a href="#cb46-356" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-357"><a href="#cb46-357" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-358"><a href="#cb46-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-359"><a href="#cb46-359" aria-hidden="true" tabindex="-1"></a>panel_soe <span class="op">=</span> panel_soe.reset_index()</span>
<span id="cb46-360"><a href="#cb46-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-361"><a href="#cb46-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-364"><a href="#cb46-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-365"><a href="#cb46-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-soe-interaction</span></span>
<span id="cb46-366"><a href="#cb46-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-367"><a href="#cb46-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Investment-Q Regression with State Ownership Interactions"</span></span>
<span id="cb46-368"><a href="#cb46-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-369"><a href="#cb46-369" aria-hidden="true" tabindex="-1"></a>soe_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-370"><a href="#cb46-370" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_soe.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-371"><a href="#cb46-371" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_soe.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-372"><a href="#cb46-372" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_soe.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb46-373"><a href="#cb46-373" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_soe.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-374"><a href="#cb46-374" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-375"><a href="#cb46-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-376"><a href="#cb46-376" aria-hidden="true" tabindex="-1"></a>soe_results</span>
<span id="cb46-377"><a href="#cb46-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-378"><a href="#cb46-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-379"><a href="#cb46-379" aria-hidden="true" tabindex="-1"></a>A negative coefficient on $Q \times \text{SOE}$ indicates that the investment-$Q$ sensitivity is attenuated for state-owned enterprises, consistent with SOE investment being driven by non-market factors. The interaction of cash flow with SOE status reveals whether state firms face tighter or looser financing constraints. This is a question with direct policy implications for SOE reform.</span>
<span id="cb46-380"><a href="#cb46-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-381"><a href="#cb46-381" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Erickson-Whited Measurement Error Correction</span></span>
<span id="cb46-382"><a href="#cb46-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-383"><a href="#cb46-383" aria-hidden="true" tabindex="-1"></a>@erickson2012treating develop a GMM estimator that uses higher-order moments of the data to identify the investment-$Q$ slope in the presence of measurement error, without requiring external instruments. The key insight is that if the measurement error $\eta$ in $Q$ is independent of the true $Q^*$ and the structural error $\varepsilon$, then the third-order cumulants identify the signal-to-noise ratio.</span>
<span id="cb46-384"><a href="#cb46-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-385"><a href="#cb46-385" aria-hidden="true" tabindex="-1"></a>The model is:</span>
<span id="cb46-386"><a href="#cb46-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-387"><a href="#cb46-387" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-388"><a href="#cb46-388" aria-hidden="true" tabindex="-1"></a>\frac{I_{i,t}}{K_{i,t-1}} = \beta_0 + \beta_1 Q_{i,t}^* + \gamma X_{i,t} + \varepsilon_{i,t}, \qquad Q_{i,t} = Q_{i,t}^* + \eta_{i,t}</span>
<span id="cb46-389"><a href="#cb46-389" aria-hidden="true" tabindex="-1"></a>$$ {#eq-erickson-whited}</span>
<span id="cb46-390"><a href="#cb46-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-391"><a href="#cb46-391" aria-hidden="true" tabindex="-1"></a>where $Q_{i,t}^*$ is unobserved true $Q$ and $\eta_{i,t}$ is measurement error. The OLS estimator $\hat{\beta}_1^{\text{OLS}}$ converges to $\beta_1 \cdot \lambda$ where $\lambda = \text{Var}(Q^*) / (\text{Var}(Q^*) + \text{Var}(\eta)) &lt; 1$ is the signal-to-noise ratio. The Erickson-Whited estimator recovers $\beta_1$ and $\lambda$ simultaneously.</span>
<span id="cb46-392"><a href="#cb46-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-395"><a href="#cb46-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-396"><a href="#cb46-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: erickson-whited</span></span>
<span id="cb46-397"><a href="#cb46-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-398"><a href="#cb46-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-399"><a href="#cb46-399" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> erickson_whited_gmm(y, Q_obs, X<span class="op">=</span><span class="va">None</span>, order<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb46-400"><a href="#cb46-400" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb46-401"><a href="#cb46-401" aria-hidden="true" tabindex="-1"></a><span class="co">    Simplified Erickson-Whited (2012) measurement error correction</span></span>
<span id="cb46-402"><a href="#cb46-402" aria-hidden="true" tabindex="-1"></a><span class="co">    using third-order cumulants.</span></span>
<span id="cb46-403"><a href="#cb46-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-404"><a href="#cb46-404" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb46-405"><a href="#cb46-405" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb46-406"><a href="#cb46-406" aria-hidden="true" tabindex="-1"></a><span class="co">    y : array</span></span>
<span id="cb46-407"><a href="#cb46-407" aria-hidden="true" tabindex="-1"></a><span class="co">        Dependent variable (investment rate).</span></span>
<span id="cb46-408"><a href="#cb46-408" aria-hidden="true" tabindex="-1"></a><span class="co">    Q_obs : array</span></span>
<span id="cb46-409"><a href="#cb46-409" aria-hidden="true" tabindex="-1"></a><span class="co">        Observed (mismeasured) Q.</span></span>
<span id="cb46-410"><a href="#cb46-410" aria-hidden="true" tabindex="-1"></a><span class="co">    X : array or None</span></span>
<span id="cb46-411"><a href="#cb46-411" aria-hidden="true" tabindex="-1"></a><span class="co">        Additional controls (partialled out first).</span></span>
<span id="cb46-412"><a href="#cb46-412" aria-hidden="true" tabindex="-1"></a><span class="co">    order : int</span></span>
<span id="cb46-413"><a href="#cb46-413" aria-hidden="true" tabindex="-1"></a><span class="co">        Cumulant order for identification (3 or 5).</span></span>
<span id="cb46-414"><a href="#cb46-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-415"><a href="#cb46-415" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb46-416"><a href="#cb46-416" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb46-417"><a href="#cb46-417" aria-hidden="true" tabindex="-1"></a><span class="co">    dict : Corrected beta, signal-to-noise ratio, OLS beta.</span></span>
<span id="cb46-418"><a href="#cb46-418" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb46-419"><a href="#cb46-419" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> X <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb46-420"><a href="#cb46-420" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Partial out controls via OLS</span></span>
<span id="cb46-421"><a href="#cb46-421" aria-hidden="true" tabindex="-1"></a>        X_aug <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb46-422"><a href="#cb46-422" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> y <span class="op">-</span> X_aug <span class="op">@</span> np.linalg.lstsq(X_aug, y, rcond<span class="op">=</span><span class="va">None</span>)[<span class="dv">0</span>]</span>
<span id="cb46-423"><a href="#cb46-423" aria-hidden="true" tabindex="-1"></a>        Q_obs <span class="op">=</span> Q_obs <span class="op">-</span> X_aug <span class="op">@</span> np.linalg.lstsq(X_aug, Q_obs, rcond<span class="op">=</span><span class="va">None</span>)[<span class="dv">0</span>]</span>
<span id="cb46-424"><a href="#cb46-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-425"><a href="#cb46-425" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Demean</span></span>
<span id="cb46-426"><a href="#cb46-426" aria-hidden="true" tabindex="-1"></a>    y_dm <span class="op">=</span> y <span class="op">-</span> y.mean()</span>
<span id="cb46-427"><a href="#cb46-427" aria-hidden="true" tabindex="-1"></a>    q_dm <span class="op">=</span> Q_obs <span class="op">-</span> Q_obs.mean()</span>
<span id="cb46-428"><a href="#cb46-428" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb46-429"><a href="#cb46-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-430"><a href="#cb46-430" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Second moments</span></span>
<span id="cb46-431"><a href="#cb46-431" aria-hidden="true" tabindex="-1"></a>    m_yq <span class="op">=</span> np.mean(y_dm <span class="op">*</span> q_dm)</span>
<span id="cb46-432"><a href="#cb46-432" aria-hidden="true" tabindex="-1"></a>    m_qq <span class="op">=</span> np.mean(q_dm<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb46-433"><a href="#cb46-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-434"><a href="#cb46-434" aria-hidden="true" tabindex="-1"></a>    <span class="co"># OLS beta</span></span>
<span id="cb46-435"><a href="#cb46-435" aria-hidden="true" tabindex="-1"></a>    beta_ols <span class="op">=</span> m_yq <span class="op">/</span> m_qq</span>
<span id="cb46-436"><a href="#cb46-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-437"><a href="#cb46-437" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Third-order cumulants for identification</span></span>
<span id="cb46-438"><a href="#cb46-438" aria-hidden="true" tabindex="-1"></a>    k3_q <span class="op">=</span> np.mean(q_dm<span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb46-439"><a href="#cb46-439" aria-hidden="true" tabindex="-1"></a>    k2y_q <span class="op">=</span> np.mean(y_dm <span class="op">*</span> q_dm<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb46-440"><a href="#cb46-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-441"><a href="#cb46-441" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(k3_q) <span class="op">&lt;</span> <span class="fl">1e-10</span>:</span>
<span id="cb46-442"><a href="#cb46-442" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb46-443"><a href="#cb46-443" aria-hidden="true" tabindex="-1"></a>            <span class="st">"beta_corrected"</span>: np.nan,</span>
<span id="cb46-444"><a href="#cb46-444" aria-hidden="true" tabindex="-1"></a>            <span class="st">"lambda_snr"</span>: np.nan,</span>
<span id="cb46-445"><a href="#cb46-445" aria-hidden="true" tabindex="-1"></a>            <span class="st">"beta_ols"</span>: beta_ols,</span>
<span id="cb46-446"><a href="#cb46-446" aria-hidden="true" tabindex="-1"></a>            <span class="st">"note"</span>: <span class="st">"Insufficient skewness for identification"</span></span>
<span id="cb46-447"><a href="#cb46-447" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb46-448"><a href="#cb46-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-449"><a href="#cb46-449" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Corrected beta: beta = kappa_{y,q,q} / kappa_{q,q,q}</span></span>
<span id="cb46-450"><a href="#cb46-450" aria-hidden="true" tabindex="-1"></a>    beta_ew <span class="op">=</span> k2y_q <span class="op">/</span> k3_q</span>
<span id="cb46-451"><a href="#cb46-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-452"><a href="#cb46-452" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Signal-to-noise ratio</span></span>
<span id="cb46-453"><a href="#cb46-453" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lambda = kappa_{q,q,q}^2 / (kappa_{q,q} * kappa_{q,q,q,q,q})</span></span>
<span id="cb46-454"><a href="#cb46-454" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simplified: lambda = beta_ols / beta_ew</span></span>
<span id="cb46-455"><a href="#cb46-455" aria-hidden="true" tabindex="-1"></a>    lambda_snr <span class="op">=</span> beta_ols <span class="op">/</span> beta_ew <span class="cf">if</span> <span class="bu">abs</span>(beta_ew) <span class="op">&gt;</span> <span class="fl">1e-10</span> <span class="cf">else</span> np.nan</span>
<span id="cb46-456"><a href="#cb46-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-457"><a href="#cb46-457" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb46-458"><a href="#cb46-458" aria-hidden="true" tabindex="-1"></a>        <span class="st">"beta_corrected"</span>: beta_ew,</span>
<span id="cb46-459"><a href="#cb46-459" aria-hidden="true" tabindex="-1"></a>        <span class="st">"lambda_snr"</span>: lambda_snr,</span>
<span id="cb46-460"><a href="#cb46-460" aria-hidden="true" tabindex="-1"></a>        <span class="st">"beta_ols"</span>: beta_ols,</span>
<span id="cb46-461"><a href="#cb46-461" aria-hidden="true" tabindex="-1"></a>        <span class="st">"attenuation_pct"</span>: <span class="bu">round</span>((<span class="dv">1</span> <span class="op">-</span> lambda_snr) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">1</span>) <span class="cf">if</span> <span class="kw">not</span> np.isnan(lambda_snr) <span class="cf">else</span> np.nan</span>
<span id="cb46-462"><a href="#cb46-462" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-463"><a href="#cb46-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-464"><a href="#cb46-464" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to Vietnamese data</span></span>
<span id="cb46-465"><a href="#cb46-465" aria-hidden="true" tabindex="-1"></a>ew_data <span class="op">=</span> panel_clean.dropna(subset<span class="op">=</span>[<span class="st">"inv_rate"</span>, <span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>])</span>
<span id="cb46-466"><a href="#cb46-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-467"><a href="#cb46-467" aria-hidden="true" tabindex="-1"></a>ew_result <span class="op">=</span> erickson_whited_gmm(</span>
<span id="cb46-468"><a href="#cb46-468" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>ew_data[<span class="st">"inv_rate"</span>].values,</span>
<span id="cb46-469"><a href="#cb46-469" aria-hidden="true" tabindex="-1"></a>    Q_obs<span class="op">=</span>ew_data[<span class="st">"tobins_q"</span>].values,</span>
<span id="cb46-470"><a href="#cb46-470" aria-hidden="true" tabindex="-1"></a>    X<span class="op">=</span>ew_data[<span class="st">"cf_assets"</span>].values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb46-471"><a href="#cb46-471" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-472"><a href="#cb46-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-473"><a href="#cb46-473" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Erickson-Whited Measurement Error Correction:"</span>)</span>
<span id="cb46-474"><a href="#cb46-474" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, v <span class="kw">in</span> ew_result.items():</span>
<span id="cb46-475"><a href="#cb46-475" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(v, <span class="bu">float</span>):</span>
<span id="cb46-476"><a href="#cb46-476" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>v<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb46-477"><a href="#cb46-477" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb46-478"><a href="#cb46-478" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>v<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-479"><a href="#cb46-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-480"><a href="#cb46-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-481"><a href="#cb46-481" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cash Flow Sensitivity of Investment</span></span>
<span id="cb46-482"><a href="#cb46-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-483"><a href="#cb46-483" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Financing Constraints Hypothesis</span></span>
<span id="cb46-484"><a href="#cb46-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-485"><a href="#cb46-485" aria-hidden="true" tabindex="-1"></a>The cash flow sensitivity of investment (CFSI) literature tests whether firms' investment decisions are constrained by the availability of internal funds. In a Modigliani-Miller world, internal and external funds are perfect substitutes, so cash flow should be irrelevant for investment after controlling for investment opportunities. The CFSI approach, pioneered by @fazzari1987financing, classifies firms as financially constrained or unconstrained using observable characteristics and tests whether constrained firms exhibit higher sensitivity of investment to cash flow.</span>
<span id="cb46-486"><a href="#cb46-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-487"><a href="#cb46-487" aria-hidden="true" tabindex="-1"></a>The augmented investment regression is:</span>
<span id="cb46-488"><a href="#cb46-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-489"><a href="#cb46-489" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-490"><a href="#cb46-490" aria-hidden="true" tabindex="-1"></a>\frac{I_{i,t}}{K_{i,t-1}} = \beta_0 + \beta_1 Q_{i,t} + \beta_2 \frac{CF_{i,t}}{K_{i,t-1}} + \varepsilon_{i,t}</span>
<span id="cb46-491"><a href="#cb46-491" aria-hidden="true" tabindex="-1"></a>$$ {#eq-cfsi-base}</span>
<span id="cb46-492"><a href="#cb46-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-493"><a href="#cb46-493" aria-hidden="true" tabindex="-1"></a>The CFSI hypothesis predicts $\beta_2^{\text{constrained}} &gt; \beta_2^{\text{unconstrained}} &gt; 0$: constrained firms rely more heavily on internal cash flow to fund investment because external finance is costly or unavailable.</span>
<span id="cb46-494"><a href="#cb46-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-495"><a href="#cb46-495" aria-hidden="true" tabindex="-1"></a><span class="fu">### The FHP-KZ Debate</span></span>
<span id="cb46-496"><a href="#cb46-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-497"><a href="#cb46-497" aria-hidden="true" tabindex="-1"></a>@fazzari1987financing (FHP) classify firms by dividend payout ratios and find that low-payout firms (presumed constrained) exhibit significantly higher cash flow sensitivity. @kaplan1997investment (KZ) challenge this interpretation on two grounds:</span>
<span id="cb46-498"><a href="#cb46-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-499"><a href="#cb46-499" aria-hidden="true" tabindex="-1"></a>**Critique 1:** $Q$ measurement error. If $Q$ is a noisy proxy for true investment opportunities, and cash flow is correlated with the measurement error (because both respond to demand shocks), then the cash flow coefficient captures omitted investment opportunities, not financing constraints.</span>
<span id="cb46-500"><a href="#cb46-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-501"><a href="#cb46-501" aria-hidden="true" tabindex="-1"></a>**Critique 2: Monotonicity failure.** KZ show that the firms FHP classify as "most constrained" (low-payout firms) are often rapidly growing firms that choose to retain earnings for investment, not firms that are denied external financing. Using qualitative information from annual reports, KZ reclassify firms and find that the CFSI ranking reverses: firms judged to be truly constrained by their own disclosures exhibit lower CFSI than unconstrained firms.</span>
<span id="cb46-502"><a href="#cb46-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-503"><a href="#cb46-503" aria-hidden="true" tabindex="-1"></a>The resolution, as argued by @farre2016measures, is that no single proxy reliably identifies financially constrained firms. Each proxy (size, age, payout ratio, bond rating, KZ index, WW index, SA index) captures a different dimension of the financing environment, and the CFSI test is not a clean test of any single theory.</span>
<span id="cb46-504"><a href="#cb46-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-505"><a href="#cb46-505" aria-hidden="true" tabindex="-1"></a><span class="fu">### Constraint Indices</span></span>
<span id="cb46-506"><a href="#cb46-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-507"><a href="#cb46-507" aria-hidden="true" tabindex="-1"></a>We implement the three most widely used composite constraint measures.</span>
<span id="cb46-508"><a href="#cb46-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-509"><a href="#cb46-509" aria-hidden="true" tabindex="-1"></a>**KZ Index** <span class="co">[</span><span class="ot">@kaplan1997investment; @lamont2001financial</span><span class="co">]</span>:</span>
<span id="cb46-510"><a href="#cb46-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-511"><a href="#cb46-511" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-512"><a href="#cb46-512" aria-hidden="true" tabindex="-1"></a>\text{KZ}_{i,t} = -1.002 \cdot \frac{CF_{i,t}}{K_{i,t-1}} + 0.283 \cdot Q_{i,t} + 3.139 \cdot \frac{D_{i,t}}{A_{i,t}} - 39.368 \cdot \frac{\text{Div}_{i,t}}{K_{i,t-1}} - 1.315 \cdot \frac{C_{i,t}}{K_{i,t-1}}</span>
<span id="cb46-513"><a href="#cb46-513" aria-hidden="true" tabindex="-1"></a>$$ {#eq-kz-index}</span>
<span id="cb46-514"><a href="#cb46-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-515"><a href="#cb46-515" aria-hidden="true" tabindex="-1"></a>**WW Index** <span class="co">[</span><span class="ot">@whited2006financial</span><span class="co">]</span>:</span>
<span id="cb46-516"><a href="#cb46-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-517"><a href="#cb46-517" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-518"><a href="#cb46-518" aria-hidden="true" tabindex="-1"></a>\text{WW}_{i,t} = -0.091 \cdot \frac{CF_{i,t}}{A_{i,t}} - 0.062 \cdot \mathbb{1}(\text{Div} &gt; 0) + 0.021 \cdot \frac{D_{i,t}}{A_{i,t}} - 0.044 \cdot \ln(A_{i,t}) + 0.102 \cdot \text{ISG}_{i,t} - 0.035 \cdot \text{SG}_{i,t}</span>
<span id="cb46-519"><a href="#cb46-519" aria-hidden="true" tabindex="-1"></a>$$ {#eq-ww-index}</span>
<span id="cb46-520"><a href="#cb46-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-521"><a href="#cb46-521" aria-hidden="true" tabindex="-1"></a>where ISG is industry sales growth and SG is firm sales growth.</span>
<span id="cb46-522"><a href="#cb46-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-523"><a href="#cb46-523" aria-hidden="true" tabindex="-1"></a>**SA Index** <span class="co">[</span><span class="ot">@hadlock2010new</span><span class="co">]</span>:</span>
<span id="cb46-524"><a href="#cb46-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-525"><a href="#cb46-525" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-526"><a href="#cb46-526" aria-hidden="true" tabindex="-1"></a>\text{SA}_{i,t} = -0.737 \cdot \text{Size}_{i,t} + 0.043 \cdot \text{Size}_{i,t}^2 - 0.040 \cdot \text{Age}_{i,t}</span>
<span id="cb46-527"><a href="#cb46-527" aria-hidden="true" tabindex="-1"></a>$$ {#eq-sa-index}</span>
<span id="cb46-528"><a href="#cb46-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-529"><a href="#cb46-529" aria-hidden="true" tabindex="-1"></a>where Size $= \ln(\text{Total Assets})$ and Age is years since listing. @hadlock2010new argue that the SA index is preferable because it uses only exogenous firm characteristics (size and age), avoiding the endogeneity inherent in cash flow and leverage-based indices.</span>
<span id="cb46-530"><a href="#cb46-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-533"><a href="#cb46-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-534"><a href="#cb46-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: constraint-indices</span></span>
<span id="cb46-535"><a href="#cb46-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-536"><a href="#cb46-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-537"><a href="#cb46-537" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute financial constraint indices</span></span>
<span id="cb46-538"><a href="#cb46-538" aria-hidden="true" tabindex="-1"></a>panel_fc <span class="op">=</span> panel_clean.copy()</span>
<span id="cb46-539"><a href="#cb46-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-540"><a href="#cb46-540" aria-hidden="true" tabindex="-1"></a><span class="co"># Lagged PPE for KZ scaling</span></span>
<span id="cb46-541"><a href="#cb46-541" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"lag_ppe"</span>] <span class="op">=</span> panel_fc.groupby(<span class="st">"ticker"</span>)[<span class="st">"ppe_net"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-542"><a href="#cb46-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-543"><a href="#cb46-543" aria-hidden="true" tabindex="-1"></a><span class="co"># KZ Index</span></span>
<span id="cb46-544"><a href="#cb46-544" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"kz_index"</span>] <span class="op">=</span> (</span>
<span id="cb46-545"><a href="#cb46-545" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">1.002</span> <span class="op">*</span> panel_fc[<span class="st">"cf_assets"</span>]</span>
<span id="cb46-546"><a href="#cb46-546" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">0.283</span> <span class="op">*</span> panel_fc[<span class="st">"tobins_q"</span>]</span>
<span id="cb46-547"><a href="#cb46-547" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">3.139</span> <span class="op">*</span> (panel_fc[<span class="st">"total_debt"</span>] <span class="op">/</span> panel_fc[<span class="st">"total_assets"</span>])</span>
<span id="cb46-548"><a href="#cb46-548" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">39.368</span> <span class="op">*</span> (panel_fc[<span class="st">"dividends"</span>] <span class="op">/</span> panel_fc[<span class="st">"lag_assets"</span>])</span>
<span id="cb46-549"><a href="#cb46-549" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">1.315</span> <span class="op">*</span> (panel_fc[<span class="st">"cash"</span>] <span class="op">/</span> panel_fc[<span class="st">"lag_assets"</span>])</span>
<span id="cb46-550"><a href="#cb46-550" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-551"><a href="#cb46-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-552"><a href="#cb46-552" aria-hidden="true" tabindex="-1"></a><span class="co"># SA Index</span></span>
<span id="cb46-553"><a href="#cb46-553" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"log_assets"</span>] <span class="op">=</span> np.log(panel_fc[<span class="st">"total_assets"</span>])</span>
<span id="cb46-554"><a href="#cb46-554" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"listing_age"</span>] <span class="op">=</span> panel_fc[<span class="st">"year"</span>] <span class="op">-</span> panel_fc[<span class="st">"listing_year"</span>]</span>
<span id="cb46-555"><a href="#cb46-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-556"><a href="#cb46-556" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"sa_index"</span>] <span class="op">=</span> (</span>
<span id="cb46-557"><a href="#cb46-557" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">0.737</span> <span class="op">*</span> panel_fc[<span class="st">"log_assets"</span>]</span>
<span id="cb46-558"><a href="#cb46-558" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">0.043</span> <span class="op">*</span> panel_fc[<span class="st">"log_assets"</span>]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb46-559"><a href="#cb46-559" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">0.040</span> <span class="op">*</span> panel_fc[<span class="st">"listing_age"</span>]</span>
<span id="cb46-560"><a href="#cb46-560" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-561"><a href="#cb46-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-562"><a href="#cb46-562" aria-hidden="true" tabindex="-1"></a><span class="co"># WW Index (simplified: using firm-level variables)</span></span>
<span id="cb46-563"><a href="#cb46-563" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"div_dummy"</span>] <span class="op">=</span> (panel_fc[<span class="st">"dividends"</span>] <span class="op">&gt;</span> <span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb46-564"><a href="#cb46-564" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"leverage"</span>] <span class="op">=</span> panel_fc[<span class="st">"total_debt"</span>] <span class="op">/</span> panel_fc[<span class="st">"total_assets"</span>]</span>
<span id="cb46-565"><a href="#cb46-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-566"><a href="#cb46-566" aria-hidden="true" tabindex="-1"></a><span class="co"># Industry sales growth</span></span>
<span id="cb46-567"><a href="#cb46-567" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"isg"</span>] <span class="op">=</span> panel_fc.groupby(</span>
<span id="cb46-568"><a href="#cb46-568" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"industry"</span>, <span class="st">"year"</span>]</span>
<span id="cb46-569"><a href="#cb46-569" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"sales_growth"</span>].transform(<span class="st">"median"</span>)</span>
<span id="cb46-570"><a href="#cb46-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-571"><a href="#cb46-571" aria-hidden="true" tabindex="-1"></a>panel_fc[<span class="st">"ww_index"</span>] <span class="op">=</span> (</span>
<span id="cb46-572"><a href="#cb46-572" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">0.091</span> <span class="op">*</span> panel_fc[<span class="st">"cf_assets"</span>]</span>
<span id="cb46-573"><a href="#cb46-573" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">0.062</span> <span class="op">*</span> panel_fc[<span class="st">"div_dummy"</span>]</span>
<span id="cb46-574"><a href="#cb46-574" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">0.021</span> <span class="op">*</span> panel_fc[<span class="st">"leverage"</span>]</span>
<span id="cb46-575"><a href="#cb46-575" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">0.044</span> <span class="op">*</span> panel_fc[<span class="st">"log_assets"</span>]</span>
<span id="cb46-576"><a href="#cb46-576" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="fl">0.102</span> <span class="op">*</span> panel_fc[<span class="st">"isg"</span>]</span>
<span id="cb46-577"><a href="#cb46-577" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="fl">0.035</span> <span class="op">*</span> panel_fc[<span class="st">"sales_growth"</span>]</span>
<span id="cb46-578"><a href="#cb46-578" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-579"><a href="#cb46-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-580"><a href="#cb46-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-583"><a href="#cb46-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-584"><a href="#cb46-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-constraint-summary</span></span>
<span id="cb46-585"><a href="#cb46-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-586"><a href="#cb46-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Distribution of Financial Constraint Indices"</span></span>
<span id="cb46-587"><a href="#cb46-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-588"><a href="#cb46-588" aria-hidden="true" tabindex="-1"></a>constraint_vars <span class="op">=</span> [<span class="st">"kz_index"</span>, <span class="st">"sa_index"</span>, <span class="st">"ww_index"</span>]</span>
<span id="cb46-589"><a href="#cb46-589" aria-hidden="true" tabindex="-1"></a>constraint_summary <span class="op">=</span> (</span>
<span id="cb46-590"><a href="#cb46-590" aria-hidden="true" tabindex="-1"></a>    panel_fc[constraint_vars]</span>
<span id="cb46-591"><a href="#cb46-591" aria-hidden="true" tabindex="-1"></a>    .describe(percentiles<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>])</span>
<span id="cb46-592"><a href="#cb46-592" aria-hidden="true" tabindex="-1"></a>    .T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-593"><a href="#cb46-593" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-594"><a href="#cb46-594" aria-hidden="true" tabindex="-1"></a>constraint_summary</span>
<span id="cb46-595"><a href="#cb46-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-596"><a href="#cb46-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-597"><a href="#cb46-597" aria-hidden="true" tabindex="-1"></a><span class="fu">### Split-Sample CFSI Tests</span></span>
<span id="cb46-598"><a href="#cb46-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-599"><a href="#cb46-599" aria-hidden="true" tabindex="-1"></a>We classify firms into constrained and unconstrained groups using each index and compare the cash flow sensitivity of investment across groups.</span>
<span id="cb46-600"><a href="#cb46-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-603"><a href="#cb46-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-604"><a href="#cb46-604" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cfsi-split-sample</span></span>
<span id="cb46-605"><a href="#cb46-605" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-606"><a href="#cb46-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-607"><a href="#cb46-607" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cfsi_by_group(data, group_var, threshold<span class="op">=</span><span class="st">"median"</span>):</span>
<span id="cb46-608"><a href="#cb46-608" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb46-609"><a href="#cb46-609" aria-hidden="true" tabindex="-1"></a><span class="co">    Estimate cash flow sensitivity of investment by constraint group.</span></span>
<span id="cb46-610"><a href="#cb46-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-611"><a href="#cb46-611" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb46-612"><a href="#cb46-612" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb46-613"><a href="#cb46-613" aria-hidden="true" tabindex="-1"></a><span class="co">    data : DataFrame</span></span>
<span id="cb46-614"><a href="#cb46-614" aria-hidden="true" tabindex="-1"></a><span class="co">        Panel data with inv_rate, tobins_q, cf_assets, group_var.</span></span>
<span id="cb46-615"><a href="#cb46-615" aria-hidden="true" tabindex="-1"></a><span class="co">    group_var : str</span></span>
<span id="cb46-616"><a href="#cb46-616" aria-hidden="true" tabindex="-1"></a><span class="co">        Variable used for classification.</span></span>
<span id="cb46-617"><a href="#cb46-617" aria-hidden="true" tabindex="-1"></a><span class="co">    threshold : str</span></span>
<span id="cb46-618"><a href="#cb46-618" aria-hidden="true" tabindex="-1"></a><span class="co">        "median" for sample split or "tercile" for top/bottom third.</span></span>
<span id="cb46-619"><a href="#cb46-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-620"><a href="#cb46-620" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb46-621"><a href="#cb46-621" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb46-622"><a href="#cb46-622" aria-hidden="true" tabindex="-1"></a><span class="co">    dict : Coefficient estimates by group.</span></span>
<span id="cb46-623"><a href="#cb46-623" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb46-624"><a href="#cb46-624" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> data.dropna(subset<span class="op">=</span>[<span class="st">"inv_rate"</span>, <span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>, group_var])</span>
<span id="cb46-625"><a href="#cb46-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-626"><a href="#cb46-626" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> threshold <span class="op">==</span> <span class="st">"median"</span>:</span>
<span id="cb46-627"><a href="#cb46-627" aria-hidden="true" tabindex="-1"></a>        median_val <span class="op">=</span> df[group_var].median()</span>
<span id="cb46-628"><a href="#cb46-628" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"constrained"</span>] <span class="op">=</span> (df[group_var] <span class="op">&gt;=</span> median_val).astype(<span class="bu">int</span>)</span>
<span id="cb46-629"><a href="#cb46-629" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> threshold <span class="op">==</span> <span class="st">"tercile"</span>:</span>
<span id="cb46-630"><a href="#cb46-630" aria-hidden="true" tabindex="-1"></a>        t33 <span class="op">=</span> df[group_var].quantile(<span class="fl">0.33</span>)</span>
<span id="cb46-631"><a href="#cb46-631" aria-hidden="true" tabindex="-1"></a>        t67 <span class="op">=</span> df[group_var].quantile(<span class="fl">0.67</span>)</span>
<span id="cb46-632"><a href="#cb46-632" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df[(df[group_var] <span class="op">&lt;=</span> t33) <span class="op">|</span> (df[group_var] <span class="op">&gt;=</span> t67)]</span>
<span id="cb46-633"><a href="#cb46-633" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"constrained"</span>] <span class="op">=</span> (df[group_var] <span class="op">&gt;=</span> t67).astype(<span class="bu">int</span>)</span>
<span id="cb46-634"><a href="#cb46-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-635"><a href="#cb46-635" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb46-636"><a href="#cb46-636" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> group_name, group_label <span class="kw">in</span> [(<span class="dv">0</span>, <span class="st">"Unconstrained"</span>), (<span class="dv">1</span>, <span class="st">"Constrained"</span>)]:</span>
<span id="cb46-637"><a href="#cb46-637" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> df[df[<span class="st">"constrained"</span>] <span class="op">==</span> group_name].copy()</span>
<span id="cb46-638"><a href="#cb46-638" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb46-639"><a href="#cb46-639" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb46-640"><a href="#cb46-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-641"><a href="#cb46-641" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> subset.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-642"><a href="#cb46-642" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> PanelOLS(</span>
<span id="cb46-643"><a href="#cb46-643" aria-hidden="true" tabindex="-1"></a>            subset[<span class="st">"inv_rate"</span>],</span>
<span id="cb46-644"><a href="#cb46-644" aria-hidden="true" tabindex="-1"></a>            subset[[<span class="st">"tobins_q"</span>, <span class="st">"cf_assets"</span>]],</span>
<span id="cb46-645"><a href="#cb46-645" aria-hidden="true" tabindex="-1"></a>            entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-646"><a href="#cb46-646" aria-hidden="true" tabindex="-1"></a>            time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-647"><a href="#cb46-647" aria-hidden="true" tabindex="-1"></a>            check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-648"><a href="#cb46-648" aria-hidden="true" tabindex="-1"></a>        ).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-649"><a href="#cb46-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-650"><a href="#cb46-650" aria-hidden="true" tabindex="-1"></a>        results[group_label] <span class="op">=</span> {</span>
<span id="cb46-651"><a href="#cb46-651" aria-hidden="true" tabindex="-1"></a>            <span class="st">"beta_Q"</span>: model.params[<span class="st">"tobins_q"</span>],</span>
<span id="cb46-652"><a href="#cb46-652" aria-hidden="true" tabindex="-1"></a>            <span class="st">"se_Q"</span>: model.std_errors[<span class="st">"tobins_q"</span>],</span>
<span id="cb46-653"><a href="#cb46-653" aria-hidden="true" tabindex="-1"></a>            <span class="st">"beta_CF"</span>: model.params[<span class="st">"cf_assets"</span>],</span>
<span id="cb46-654"><a href="#cb46-654" aria-hidden="true" tabindex="-1"></a>            <span class="st">"se_CF"</span>: model.std_errors[<span class="st">"cf_assets"</span>],</span>
<span id="cb46-655"><a href="#cb46-655" aria-hidden="true" tabindex="-1"></a>            <span class="st">"R2_within"</span>: model.rsquared_within,</span>
<span id="cb46-656"><a href="#cb46-656" aria-hidden="true" tabindex="-1"></a>            <span class="st">"N"</span>: <span class="bu">int</span>(model.nobs)</span>
<span id="cb46-657"><a href="#cb46-657" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb46-658"><a href="#cb46-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-659"><a href="#cb46-659" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(results).T</span>
<span id="cb46-660"><a href="#cb46-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-661"><a href="#cb46-661" aria-hidden="true" tabindex="-1"></a><span class="co"># Run for each constraint index</span></span>
<span id="cb46-662"><a href="#cb46-662" aria-hidden="true" tabindex="-1"></a>cfsi_kz <span class="op">=</span> cfsi_by_group(panel_fc, <span class="st">"kz_index"</span>, <span class="st">"median"</span>)</span>
<span id="cb46-663"><a href="#cb46-663" aria-hidden="true" tabindex="-1"></a>cfsi_sa <span class="op">=</span> cfsi_by_group(panel_fc, <span class="st">"sa_index"</span>, <span class="st">"median"</span>)</span>
<span id="cb46-664"><a href="#cb46-664" aria-hidden="true" tabindex="-1"></a>cfsi_ww <span class="op">=</span> cfsi_by_group(panel_fc, <span class="st">"ww_index"</span>, <span class="st">"median"</span>)</span>
<span id="cb46-665"><a href="#cb46-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-666"><a href="#cb46-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-669"><a href="#cb46-669" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-670"><a href="#cb46-670" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-cfsi-comparison</span></span>
<span id="cb46-671"><a href="#cb46-671" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-672"><a href="#cb46-672" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Cash Flow Sensitivity by Financial Constraint Classification"</span></span>
<span id="cb46-673"><a href="#cb46-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-674"><a href="#cb46-674" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine results</span></span>
<span id="cb46-675"><a href="#cb46-675" aria-hidden="true" tabindex="-1"></a>cfsi_all <span class="op">=</span> pd.concat({</span>
<span id="cb46-676"><a href="#cb46-676" aria-hidden="true" tabindex="-1"></a>    <span class="st">"KZ Index"</span>: cfsi_kz,</span>
<span id="cb46-677"><a href="#cb46-677" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SA Index"</span>: cfsi_sa,</span>
<span id="cb46-678"><a href="#cb46-678" aria-hidden="true" tabindex="-1"></a>    <span class="st">"WW Index"</span>: cfsi_ww</span>
<span id="cb46-679"><a href="#cb46-679" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-680"><a href="#cb46-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-681"><a href="#cb46-681" aria-hidden="true" tabindex="-1"></a>cfsi_display <span class="op">=</span> cfsi_all[[<span class="st">"beta_CF"</span>, <span class="st">"se_CF"</span>, <span class="st">"beta_Q"</span>, <span class="st">"se_Q"</span>, <span class="st">"N"</span>]].<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-682"><a href="#cb46-682" aria-hidden="true" tabindex="-1"></a>cfsi_display</span>
<span id="cb46-683"><a href="#cb46-683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-684"><a href="#cb46-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-685"><a href="#cb46-685" aria-hidden="true" tabindex="-1"></a><span class="fu">### Alternative Specifications</span></span>
<span id="cb46-686"><a href="#cb46-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-687"><a href="#cb46-687" aria-hidden="true" tabindex="-1"></a>The baseline CFSI test has been augmented in several directions:</span>
<span id="cb46-688"><a href="#cb46-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-689"><a href="#cb46-689" aria-hidden="true" tabindex="-1"></a>**Dynamic investment models.** @bond2003financial argue that the static regression @eq-cfsi-base omits the autoregressive component of investment. The Euler equation approach, which derives directly from the firm's dynamic optimization problem, yields:</span>
<span id="cb46-690"><a href="#cb46-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-691"><a href="#cb46-691" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-692"><a href="#cb46-692" aria-hidden="true" tabindex="-1"></a>\frac{I_{i,t}}{K_{i,t-1}} = \gamma_1 \frac{I_{i,t-1}}{K_{i,t-2}} + \gamma_2 \left(\frac{Y_{i,t}}{K_{i,t-1}}\right) + \gamma_3 \frac{CF_{i,t}}{K_{i,t-1}} + \varepsilon_{i,t}</span>
<span id="cb46-693"><a href="#cb46-693" aria-hidden="true" tabindex="-1"></a>$$ {#eq-euler-investment}</span>
<span id="cb46-694"><a href="#cb46-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-695"><a href="#cb46-695" aria-hidden="true" tabindex="-1"></a>This specification avoids the need for $Q$ entirely, sidestepping the measurement error problem.</span>
<span id="cb46-696"><a href="#cb46-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-697"><a href="#cb46-697" aria-hidden="true" tabindex="-1"></a>**External finance dependence.** @rajan1998financial propose using the industry-level technological demand for external finance as an instrument for financing constraints. Industries that technologically require more external funding should be disproportionately affected by financial development and firm-level constraints.</span>
<span id="cb46-698"><a href="#cb46-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-701"><a href="#cb46-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-702"><a href="#cb46-702" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: euler-equation</span></span>
<span id="cb46-703"><a href="#cb46-703" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-704"><a href="#cb46-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-705"><a href="#cb46-705" aria-hidden="true" tabindex="-1"></a><span class="co"># Euler equation investment model (dynamic panel)</span></span>
<span id="cb46-706"><a href="#cb46-706" aria-hidden="true" tabindex="-1"></a>panel_euler <span class="op">=</span> panel_fc.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-707"><a href="#cb46-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-708"><a href="#cb46-708" aria-hidden="true" tabindex="-1"></a>panel_euler[<span class="st">"lag_inv_rate"</span>] <span class="op">=</span> panel_euler.groupby(<span class="st">"ticker"</span>)[<span class="st">"inv_rate"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-709"><a href="#cb46-709" aria-hidden="true" tabindex="-1"></a>panel_euler[<span class="st">"revenue_assets"</span>] <span class="op">=</span> panel_euler[<span class="st">"revenue"</span>] <span class="op">/</span> panel_euler[<span class="st">"lag_assets"</span>]</span>
<span id="cb46-710"><a href="#cb46-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-711"><a href="#cb46-711" aria-hidden="true" tabindex="-1"></a>euler_data <span class="op">=</span> panel_euler.dropna(</span>
<span id="cb46-712"><a href="#cb46-712" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"inv_rate"</span>, <span class="st">"lag_inv_rate"</span>, <span class="st">"revenue_assets"</span>, <span class="st">"cf_assets"</span>]</span>
<span id="cb46-713"><a href="#cb46-713" aria-hidden="true" tabindex="-1"></a>).set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-714"><a href="#cb46-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-715"><a href="#cb46-715" aria-hidden="true" tabindex="-1"></a>model_euler <span class="op">=</span> PanelOLS(</span>
<span id="cb46-716"><a href="#cb46-716" aria-hidden="true" tabindex="-1"></a>    euler_data[<span class="st">"inv_rate"</span>],</span>
<span id="cb46-717"><a href="#cb46-717" aria-hidden="true" tabindex="-1"></a>    euler_data[[<span class="st">"lag_inv_rate"</span>, <span class="st">"revenue_assets"</span>, <span class="st">"cf_assets"</span>]],</span>
<span id="cb46-718"><a href="#cb46-718" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-719"><a href="#cb46-719" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-720"><a href="#cb46-720" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-721"><a href="#cb46-721" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-722"><a href="#cb46-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-723"><a href="#cb46-723" aria-hidden="true" tabindex="-1"></a>euler_data <span class="op">=</span> euler_data.reset_index()</span>
<span id="cb46-724"><a href="#cb46-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-725"><a href="#cb46-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-728"><a href="#cb46-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-729"><a href="#cb46-729" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-euler</span></span>
<span id="cb46-730"><a href="#cb46-730" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-731"><a href="#cb46-731" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Euler Equation Investment Model"</span></span>
<span id="cb46-732"><a href="#cb46-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-733"><a href="#cb46-733" aria-hidden="true" tabindex="-1"></a>euler_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-734"><a href="#cb46-734" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_euler.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-735"><a href="#cb46-735" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_euler.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-736"><a href="#cb46-736" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_euler.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb46-737"><a href="#cb46-737" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_euler.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-738"><a href="#cb46-738" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-739"><a href="#cb46-739" aria-hidden="true" tabindex="-1"></a>euler_results</span>
<span id="cb46-740"><a href="#cb46-740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-741"><a href="#cb46-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-742"><a href="#cb46-742" aria-hidden="true" tabindex="-1"></a><span class="fu">## Financing Choice Models</span></span>
<span id="cb46-743"><a href="#cb46-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-744"><a href="#cb46-744" aria-hidden="true" tabindex="-1"></a><span class="fu">### Capital Structure Determinants</span></span>
<span id="cb46-745"><a href="#cb46-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-746"><a href="#cb46-746" aria-hidden="true" tabindex="-1"></a>The two dominant theories of capital structure (i.e., trade-off theory and pecking order theory) generate distinct predictions about the determinants of leverage. @frank2009capital provide the most comprehensive empirical synthesis, identifying six "core" variables that reliably predict leverage across samples and specifications.</span>
<span id="cb46-747"><a href="#cb46-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-748"><a href="#cb46-748" aria-hidden="true" tabindex="-1"></a>The baseline capital structure regression is:</span>
<span id="cb46-749"><a href="#cb46-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-750"><a href="#cb46-750" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-751"><a href="#cb46-751" aria-hidden="true" tabindex="-1"></a>\text{Lev}_{i,t} = \beta_0 + \boldsymbol{\beta}' \mathbf{X}_{i,t} + \alpha_i + \delta_t + \varepsilon_{i,t}</span>
<span id="cb46-752"><a href="#cb46-752" aria-hidden="true" tabindex="-1"></a>$$ {#eq-leverage-regression}</span>
<span id="cb46-753"><a href="#cb46-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-754"><a href="#cb46-754" aria-hidden="true" tabindex="-1"></a>where $\text{Lev}_{i,t}$ is either book leverage ($D / A$) or market leverage ($D / (D + E^{\text{mkt}})$), and $\mathbf{X}_{i,t}$ includes the core determinants.</span>
<span id="cb46-755"><a href="#cb46-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-756"><a href="#cb46-756" aria-hidden="true" tabindex="-1"></a>@tbl-cs-predictions summarizes the theoretical predictions.</span>
<span id="cb46-757"><a href="#cb46-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-758"><a href="#cb46-758" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Determinant <span class="pp">|</span> Trade-Off <span class="pp">|</span> Pecking Order <span class="pp">|</span> Measurement <span class="pp">|</span></span>
<span id="cb46-759"><a href="#cb46-759" aria-hidden="true" tabindex="-1"></a><span class="pp">|------------------|------------------|-------------------|------------------|</span></span>
<span id="cb46-760"><a href="#cb46-760" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Profitability <span class="pp">|</span> <span class="sc">\+</span> (tax shield) <span class="pp">|</span> − (less need for external) <span class="pp">|</span> EBITDA / Assets <span class="pp">|</span></span>
<span id="cb46-761"><a href="#cb46-761" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Size <span class="pp">|</span> <span class="sc">\+</span> (lower distress costs) <span class="pp">|</span> <span class="sc">\+</span> (less information asymmetry) <span class="pp">|</span> ln(Total Assets) <span class="pp">|</span></span>
<span id="cb46-762"><a href="#cb46-762" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Tangibility <span class="pp">|</span> <span class="sc">\+</span> (collateral value) <span class="pp">|</span> <span class="sc">\+</span> (less adverse selection) <span class="pp">|</span> PPE / Assets <span class="pp">|</span></span>
<span id="cb46-763"><a href="#cb46-763" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Growth (MTB) <span class="pp">|</span> − (underinvestment) <span class="pp">|</span> <span class="sc">\+</span> (financing needs) <span class="pp">|</span> Market-to-Book <span class="pp">|</span></span>
<span id="cb46-764"><a href="#cb46-764" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Industry median leverage <span class="pp">|</span> <span class="sc">\+</span> (target) <span class="pp">|</span> ambiguous <span class="pp">|</span> Industry median <span class="pp">|</span></span>
<span id="cb46-765"><a href="#cb46-765" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Profitability volatility <span class="pp">|</span> − (distress risk) <span class="pp">|</span> ambiguous <span class="pp">|</span> Rolling σ(EBITDA/A) <span class="pp">|</span></span>
<span id="cb46-766"><a href="#cb46-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-767"><a href="#cb46-767" aria-hidden="true" tabindex="-1"></a>: Capital Structure Predictions by Theory {#tbl-cs-predictions}</span>
<span id="cb46-768"><a href="#cb46-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-771"><a href="#cb46-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-772"><a href="#cb46-772" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: capital-structure-data</span></span>
<span id="cb46-773"><a href="#cb46-773" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-774"><a href="#cb46-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-775"><a href="#cb46-775" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct capital structure variables</span></span>
<span id="cb46-776"><a href="#cb46-776" aria-hidden="true" tabindex="-1"></a>cs <span class="op">=</span> panel_fc.copy()</span>
<span id="cb46-777"><a href="#cb46-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-778"><a href="#cb46-778" aria-hidden="true" tabindex="-1"></a><span class="co"># Book leverage</span></span>
<span id="cb46-779"><a href="#cb46-779" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"book_leverage"</span>] <span class="op">=</span> cs[<span class="st">"total_debt"</span>] <span class="op">/</span> cs[<span class="st">"total_assets"</span>]</span>
<span id="cb46-780"><a href="#cb46-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-781"><a href="#cb46-781" aria-hidden="true" tabindex="-1"></a><span class="co"># Market leverage</span></span>
<span id="cb46-782"><a href="#cb46-782" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"market_leverage"</span>] <span class="op">=</span> cs[<span class="st">"total_debt"</span>] <span class="op">/</span> (</span>
<span id="cb46-783"><a href="#cb46-783" aria-hidden="true" tabindex="-1"></a>    cs[<span class="st">"total_debt"</span>] <span class="op">+</span> cs[<span class="st">"market_cap"</span>]</span>
<span id="cb46-784"><a href="#cb46-784" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-785"><a href="#cb46-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-786"><a href="#cb46-786" aria-hidden="true" tabindex="-1"></a><span class="co"># Profitability</span></span>
<span id="cb46-787"><a href="#cb46-787" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"profitability"</span>] <span class="op">=</span> cs[<span class="st">"ebitda"</span>] <span class="op">/</span> cs[<span class="st">"total_assets"</span>]</span>
<span id="cb46-788"><a href="#cb46-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-789"><a href="#cb46-789" aria-hidden="true" tabindex="-1"></a><span class="co"># Tangibility</span></span>
<span id="cb46-790"><a href="#cb46-790" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"tangibility"</span>] <span class="op">=</span> cs[<span class="st">"ppe_net"</span>] <span class="op">/</span> cs[<span class="st">"total_assets"</span>]</span>
<span id="cb46-791"><a href="#cb46-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-792"><a href="#cb46-792" aria-hidden="true" tabindex="-1"></a><span class="co"># Size</span></span>
<span id="cb46-793"><a href="#cb46-793" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"size"</span>] <span class="op">=</span> np.log(cs[<span class="st">"total_assets"</span>])</span>
<span id="cb46-794"><a href="#cb46-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-795"><a href="#cb46-795" aria-hidden="true" tabindex="-1"></a><span class="co"># Market-to-Book</span></span>
<span id="cb46-796"><a href="#cb46-796" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"mtb"</span>] <span class="op">=</span> cs[<span class="st">"market_cap"</span>] <span class="op">/</span> cs[<span class="st">"book_equity"</span>]</span>
<span id="cb46-797"><a href="#cb46-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-798"><a href="#cb46-798" aria-hidden="true" tabindex="-1"></a><span class="co"># Industry median leverage</span></span>
<span id="cb46-799"><a href="#cb46-799" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"ind_median_lev"</span>] <span class="op">=</span> cs.groupby(</span>
<span id="cb46-800"><a href="#cb46-800" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"industry"</span>, <span class="st">"year"</span>]</span>
<span id="cb46-801"><a href="#cb46-801" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"book_leverage"</span>].transform(<span class="st">"median"</span>)</span>
<span id="cb46-802"><a href="#cb46-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-803"><a href="#cb46-803" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling profitability volatility (3-year)</span></span>
<span id="cb46-804"><a href="#cb46-804" aria-hidden="true" tabindex="-1"></a>cs <span class="op">=</span> cs.sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-805"><a href="#cb46-805" aria-hidden="true" tabindex="-1"></a>cs[<span class="st">"profit_vol"</span>] <span class="op">=</span> (</span>
<span id="cb46-806"><a href="#cb46-806" aria-hidden="true" tabindex="-1"></a>    cs.groupby(<span class="st">"ticker"</span>)[<span class="st">"profitability"</span>]</span>
<span id="cb46-807"><a href="#cb46-807" aria-hidden="true" tabindex="-1"></a>    .transform(<span class="kw">lambda</span> x: x.rolling(<span class="dv">3</span>, min_periods<span class="op">=</span><span class="dv">2</span>).std())</span>
<span id="cb46-808"><a href="#cb46-808" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-809"><a href="#cb46-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-810"><a href="#cb46-810" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsorize</span></span>
<span id="cb46-811"><a href="#cb46-811" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"book_leverage"</span>, <span class="st">"market_leverage"</span>, <span class="st">"profitability"</span>,</span>
<span id="cb46-812"><a href="#cb46-812" aria-hidden="true" tabindex="-1"></a>            <span class="st">"tangibility"</span>, <span class="st">"mtb"</span>, <span class="st">"profit_vol"</span>]:</span>
<span id="cb46-813"><a href="#cb46-813" aria-hidden="true" tabindex="-1"></a>    cs[col] <span class="op">=</span> winsorize(cs[col])</span>
<span id="cb46-814"><a href="#cb46-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-815"><a href="#cb46-815" aria-hidden="true" tabindex="-1"></a>cs_clean <span class="op">=</span> cs.dropna(</span>
<span id="cb46-816"><a href="#cb46-816" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"book_leverage"</span>, <span class="st">"profitability"</span>, <span class="st">"size"</span>,</span>
<span id="cb46-817"><a href="#cb46-817" aria-hidden="true" tabindex="-1"></a>            <span class="st">"tangibility"</span>, <span class="st">"mtb"</span>, <span class="st">"ind_median_lev"</span>]</span>
<span id="cb46-818"><a href="#cb46-818" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-819"><a href="#cb46-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-820"><a href="#cb46-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-823"><a href="#cb46-823" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-824"><a href="#cb46-824" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: leverage-regressions</span></span>
<span id="cb46-825"><a href="#cb46-825" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-826"><a href="#cb46-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-827"><a href="#cb46-827" aria-hidden="true" tabindex="-1"></a><span class="co"># Capital structure regressions</span></span>
<span id="cb46-828"><a href="#cb46-828" aria-hidden="true" tabindex="-1"></a>cs_panel <span class="op">=</span> cs_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-829"><a href="#cb46-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-830"><a href="#cb46-830" aria-hidden="true" tabindex="-1"></a>regressors <span class="op">=</span> [<span class="st">"profitability"</span>, <span class="st">"size"</span>, <span class="st">"tangibility"</span>,</span>
<span id="cb46-831"><a href="#cb46-831" aria-hidden="true" tabindex="-1"></a>              <span class="st">"mtb"</span>, <span class="st">"ind_median_lev"</span>]</span>
<span id="cb46-832"><a href="#cb46-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-833"><a href="#cb46-833" aria-hidden="true" tabindex="-1"></a><span class="co"># Book leverage</span></span>
<span id="cb46-834"><a href="#cb46-834" aria-hidden="true" tabindex="-1"></a>model_book <span class="op">=</span> PanelOLS(</span>
<span id="cb46-835"><a href="#cb46-835" aria-hidden="true" tabindex="-1"></a>    cs_panel[<span class="st">"book_leverage"</span>],</span>
<span id="cb46-836"><a href="#cb46-836" aria-hidden="true" tabindex="-1"></a>    cs_panel[regressors],</span>
<span id="cb46-837"><a href="#cb46-837" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-838"><a href="#cb46-838" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-839"><a href="#cb46-839" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-840"><a href="#cb46-840" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-841"><a href="#cb46-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-842"><a href="#cb46-842" aria-hidden="true" tabindex="-1"></a><span class="co"># Market leverage</span></span>
<span id="cb46-843"><a href="#cb46-843" aria-hidden="true" tabindex="-1"></a>model_mkt <span class="op">=</span> PanelOLS(</span>
<span id="cb46-844"><a href="#cb46-844" aria-hidden="true" tabindex="-1"></a>    cs_panel[<span class="st">"market_leverage"</span>],</span>
<span id="cb46-845"><a href="#cb46-845" aria-hidden="true" tabindex="-1"></a>    cs_panel[regressors],</span>
<span id="cb46-846"><a href="#cb46-846" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-847"><a href="#cb46-847" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-848"><a href="#cb46-848" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-849"><a href="#cb46-849" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-850"><a href="#cb46-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-851"><a href="#cb46-851" aria-hidden="true" tabindex="-1"></a>cs_panel <span class="op">=</span> cs_panel.reset_index()</span>
<span id="cb46-852"><a href="#cb46-852" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-853"><a href="#cb46-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-856"><a href="#cb46-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-857"><a href="#cb46-857" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-capital-structure</span></span>
<span id="cb46-858"><a href="#cb46-858" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-859"><a href="#cb46-859" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Capital Structure Determinants: Book and Market Leverage"</span></span>
<span id="cb46-860"><a href="#cb46-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-861"><a href="#cb46-861" aria-hidden="true" tabindex="-1"></a>cs_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-862"><a href="#cb46-862" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Book Leverage"</span>: [</span>
<span id="cb46-863"><a href="#cb46-863" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>model_book<span class="sc">.</span>params[v]<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>model_book<span class="sc">.</span>std_errors[v]<span class="sc">:.4f}</span><span class="ss">)"</span></span>
<span id="cb46-864"><a href="#cb46-864" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> regressors</span>
<span id="cb46-865"><a href="#cb46-865" aria-hidden="true" tabindex="-1"></a>    ] <span class="op">+</span> [<span class="ss">f"</span><span class="sc">{</span>model_book<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>, <span class="bu">str</span>(<span class="bu">int</span>(model_book.nobs))],</span>
<span id="cb46-866"><a href="#cb46-866" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Market Leverage"</span>: [</span>
<span id="cb46-867"><a href="#cb46-867" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>model_mkt<span class="sc">.</span>params[v]<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>model_mkt<span class="sc">.</span>std_errors[v]<span class="sc">:.4f}</span><span class="ss">)"</span></span>
<span id="cb46-868"><a href="#cb46-868" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> regressors</span>
<span id="cb46-869"><a href="#cb46-869" aria-hidden="true" tabindex="-1"></a>    ] <span class="op">+</span> [<span class="ss">f"</span><span class="sc">{</span>model_mkt<span class="sc">.</span>rsquared_within<span class="sc">:.4f}</span><span class="ss">"</span>, <span class="bu">str</span>(<span class="bu">int</span>(model_mkt.nobs))]</span>
<span id="cb46-870"><a href="#cb46-870" aria-hidden="true" tabindex="-1"></a>}, index<span class="op">=</span>regressors <span class="op">+</span> [<span class="st">"R² (within)"</span>, <span class="st">"N"</span>])</span>
<span id="cb46-871"><a href="#cb46-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-872"><a href="#cb46-872" aria-hidden="true" tabindex="-1"></a>cs_table</span>
<span id="cb46-873"><a href="#cb46-873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-874"><a href="#cb46-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-875"><a href="#cb46-875" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pecking Order Tests</span></span>
<span id="cb46-876"><a href="#cb46-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-877"><a href="#cb46-877" aria-hidden="true" tabindex="-1"></a>The pecking order theory <span class="co">[</span><span class="ot">@myers1984capital</span><span class="co">]</span> predicts that firms prefer internal finance, then debt, then equity. @shyam1999testing propose a direct test: if the pecking order holds strictly, the financing deficit (investment minus internal funds) should be financed dollar-for-dollar by debt:</span>
<span id="cb46-878"><a href="#cb46-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-879"><a href="#cb46-879" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-880"><a href="#cb46-880" aria-hidden="true" tabindex="-1"></a>\Delta D_{i,t} = \alpha + \beta_{\text{PO}} \cdot \text{DEF}_{i,t} + \varepsilon_{i,t}</span>
<span id="cb46-881"><a href="#cb46-881" aria-hidden="true" tabindex="-1"></a>$$ {#eq-pecking-order}</span>
<span id="cb46-882"><a href="#cb46-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-883"><a href="#cb46-883" aria-hidden="true" tabindex="-1"></a>where $\text{DEF}_{i,t} = \text{Div}_{i,t} + \text{Capex}_{i,t} + \Delta W_{i,t} - CF_{i,t}$ is the financing deficit and $\Delta D_{i,t}$ is net debt issuance. A strict pecking order implies $\hat{\alpha} = 0$ and $\hat{\beta}_{\text{PO}} = 1$. @frank2003testing show that the coefficient is typically well below 1, especially for large firms and equity issuers.</span>
<span id="cb46-884"><a href="#cb46-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-887"><a href="#cb46-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-888"><a href="#cb46-888" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pecking-order</span></span>
<span id="cb46-889"><a href="#cb46-889" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-890"><a href="#cb46-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-891"><a href="#cb46-891" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct financing deficit</span></span>
<span id="cb46-892"><a href="#cb46-892" aria-hidden="true" tabindex="-1"></a>po <span class="op">=</span> cs.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-893"><a href="#cb46-893" aria-hidden="true" tabindex="-1"></a>po[<span class="st">"lag_debt"</span>] <span class="op">=</span> po.groupby(<span class="st">"ticker"</span>)[<span class="st">"total_debt"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-894"><a href="#cb46-894" aria-hidden="true" tabindex="-1"></a>po[<span class="st">"net_debt_issuance"</span>] <span class="op">=</span> po[<span class="st">"total_debt"</span>] <span class="op">-</span> po[<span class="st">"lag_debt"</span>]</span>
<span id="cb46-895"><a href="#cb46-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-896"><a href="#cb46-896" aria-hidden="true" tabindex="-1"></a><span class="co"># Financing deficit = Div + Capex + ΔWC - CF</span></span>
<span id="cb46-897"><a href="#cb46-897" aria-hidden="true" tabindex="-1"></a>po[<span class="st">"delta_wc"</span>] <span class="op">=</span> po[<span class="st">"working_capital"</span>] <span class="op">-</span> po.groupby(</span>
<span id="cb46-898"><a href="#cb46-898" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ticker"</span></span>
<span id="cb46-899"><a href="#cb46-899" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"working_capital"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-900"><a href="#cb46-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-901"><a href="#cb46-901" aria-hidden="true" tabindex="-1"></a>po[<span class="st">"fin_deficit"</span>] <span class="op">=</span> (</span>
<span id="cb46-902"><a href="#cb46-902" aria-hidden="true" tabindex="-1"></a>    po[<span class="st">"dividends"</span>] <span class="op">+</span> po[<span class="st">"capex"</span>]</span>
<span id="cb46-903"><a href="#cb46-903" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> po[<span class="st">"delta_wc"</span>].fillna(<span class="dv">0</span>) <span class="op">-</span> po[<span class="st">"operating_cf"</span>]</span>
<span id="cb46-904"><a href="#cb46-904" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-905"><a href="#cb46-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-906"><a href="#cb46-906" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale by lagged assets</span></span>
<span id="cb46-907"><a href="#cb46-907" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"net_debt_issuance"</span>, <span class="st">"fin_deficit"</span>]:</span>
<span id="cb46-908"><a href="#cb46-908" aria-hidden="true" tabindex="-1"></a>    po[col] <span class="op">=</span> po[col] <span class="op">/</span> po[<span class="st">"lag_assets"</span>]</span>
<span id="cb46-909"><a href="#cb46-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-910"><a href="#cb46-910" aria-hidden="true" tabindex="-1"></a>po_clean <span class="op">=</span> po.dropna(</span>
<span id="cb46-911"><a href="#cb46-911" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"net_debt_issuance"</span>, <span class="st">"fin_deficit"</span>]</span>
<span id="cb46-912"><a href="#cb46-912" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-913"><a href="#cb46-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-914"><a href="#cb46-914" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsorize</span></span>
<span id="cb46-915"><a href="#cb46-915" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"net_debt_issuance"</span>, <span class="st">"fin_deficit"</span>]:</span>
<span id="cb46-916"><a href="#cb46-916" aria-hidden="true" tabindex="-1"></a>    po_clean[col] <span class="op">=</span> winsorize(po_clean[col])</span>
<span id="cb46-917"><a href="#cb46-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-918"><a href="#cb46-918" aria-hidden="true" tabindex="-1"></a><span class="co"># Pecking order regression</span></span>
<span id="cb46-919"><a href="#cb46-919" aria-hidden="true" tabindex="-1"></a>po_panel <span class="op">=</span> po_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-920"><a href="#cb46-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-921"><a href="#cb46-921" aria-hidden="true" tabindex="-1"></a>model_po <span class="op">=</span> PanelOLS(</span>
<span id="cb46-922"><a href="#cb46-922" aria-hidden="true" tabindex="-1"></a>    po_panel[<span class="st">"net_debt_issuance"</span>],</span>
<span id="cb46-923"><a href="#cb46-923" aria-hidden="true" tabindex="-1"></a>    po_panel[[<span class="st">"fin_deficit"</span>]],</span>
<span id="cb46-924"><a href="#cb46-924" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-925"><a href="#cb46-925" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-926"><a href="#cb46-926" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-927"><a href="#cb46-927" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-928"><a href="#cb46-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-929"><a href="#cb46-929" aria-hidden="true" tabindex="-1"></a>po_panel <span class="op">=</span> po_panel.reset_index()</span>
<span id="cb46-930"><a href="#cb46-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-931"><a href="#cb46-931" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Pecking order coefficient: </span><span class="sc">{</span>model_po<span class="sc">.</span>params[<span class="st">'fin_deficit'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb46-932"><a href="#cb46-932" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  (se = </span><span class="sc">{</span>model_po<span class="sc">.</span>std_errors[<span class="st">'fin_deficit'</span>]<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb46-933"><a href="#cb46-933" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  H0: β = 1, t = "</span></span>
<span id="cb46-934"><a href="#cb46-934" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"</span><span class="sc">{</span>(model_po.params[<span class="st">'fin_deficit'</span>] <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> model_po<span class="sc">.</span>std_errors[<span class="st">'fin_deficit'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb46-935"><a href="#cb46-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-936"><a href="#cb46-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-937"><a href="#cb46-937" aria-hidden="true" tabindex="-1"></a><span class="fu">### Market Timing Measures</span></span>
<span id="cb46-938"><a href="#cb46-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-939"><a href="#cb46-939" aria-hidden="true" tabindex="-1"></a>@baker2002market argue that capital structure is largely the cumulative outcome of market timing (i.e., firms issue equity when valuations are high and repurchase when valuations are low). Their key variable is the external-finance-weighted average market-to-book ratio:</span>
<span id="cb46-940"><a href="#cb46-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-941"><a href="#cb46-941" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-942"><a href="#cb46-942" aria-hidden="true" tabindex="-1"></a>\left(\frac{M}{B}\right)_{i,t}^{efwa} = \sum_{s=\text{IPO}}^{t-1} \frac{e_s + d_s}{\sum_{r=\text{IPO}}^{t-1}(e_r + d_r)} \cdot \left(\frac{M}{B}\right)_{i,s}</span>
<span id="cb46-943"><a href="#cb46-943" aria-hidden="true" tabindex="-1"></a>$$ {#eq-efwa-mtb}</span>
<span id="cb46-944"><a href="#cb46-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-945"><a href="#cb46-945" aria-hidden="true" tabindex="-1"></a>where $e_s$ and $d_s$ are net equity and net debt issuance in year $s$. This variable captures the historical valuations at which the firm raised capital. The market timing hypothesis predicts that higher $\left(M/B\right)^{efwa}$ is associated with lower current leverage (i.e., firms that historically issued equity at high valuations have persistently lower leverage).</span>
<span id="cb46-946"><a href="#cb46-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-949"><a href="#cb46-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-950"><a href="#cb46-950" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: market-timing</span></span>
<span id="cb46-951"><a href="#cb46-951" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-952"><a href="#cb46-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-953"><a href="#cb46-953" aria-hidden="true" tabindex="-1"></a><span class="co"># External-Finance-Weighted Average M/B</span></span>
<span id="cb46-954"><a href="#cb46-954" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_efwa_mtb(group):</span>
<span id="cb46-955"><a href="#cb46-955" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute Baker-Wurgler EFWA M/B for one firm."""</span></span>
<span id="cb46-956"><a href="#cb46-956" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> group.sort_values(<span class="st">"year"</span>).copy()</span>
<span id="cb46-957"><a href="#cb46-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-958"><a href="#cb46-958" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Net issuance each year</span></span>
<span id="cb46-959"><a href="#cb46-959" aria-hidden="true" tabindex="-1"></a>    g[<span class="st">"net_equity"</span>] <span class="op">=</span> g[<span class="st">"equity_issuance"</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb46-960"><a href="#cb46-960" aria-hidden="true" tabindex="-1"></a>    g[<span class="st">"net_debt"</span>] <span class="op">=</span> g[<span class="st">"net_debt_issuance"</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb46-961"><a href="#cb46-961" aria-hidden="true" tabindex="-1"></a>    g[<span class="st">"total_issuance"</span>] <span class="op">=</span> (</span>
<span id="cb46-962"><a href="#cb46-962" aria-hidden="true" tabindex="-1"></a>        g[<span class="st">"net_equity"</span>].<span class="bu">abs</span>() <span class="op">+</span> g[<span class="st">"net_debt"</span>].<span class="bu">abs</span>()</span>
<span id="cb46-963"><a href="#cb46-963" aria-hidden="true" tabindex="-1"></a>    ).replace(<span class="dv">0</span>, np.nan)</span>
<span id="cb46-964"><a href="#cb46-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-965"><a href="#cb46-965" aria-hidden="true" tabindex="-1"></a>    efwa_values <span class="op">=</span> []</span>
<span id="cb46-966"><a href="#cb46-966" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(g)):</span>
<span id="cb46-967"><a href="#cb46-967" aria-hidden="true" tabindex="-1"></a>        past <span class="op">=</span> g.iloc[:idx]</span>
<span id="cb46-968"><a href="#cb46-968" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> past[<span class="st">"total_issuance"</span>] <span class="op">/</span> past[<span class="st">"total_issuance"</span>].<span class="bu">sum</span>()</span>
<span id="cb46-969"><a href="#cb46-969" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> weights.fillna(<span class="dv">0</span>)</span>
<span id="cb46-970"><a href="#cb46-970" aria-hidden="true" tabindex="-1"></a>        efwa <span class="op">=</span> (weights <span class="op">*</span> past[<span class="st">"mtb"</span>]).<span class="bu">sum</span>()</span>
<span id="cb46-971"><a href="#cb46-971" aria-hidden="true" tabindex="-1"></a>        efwa_values.append(efwa)</span>
<span id="cb46-972"><a href="#cb46-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-973"><a href="#cb46-973" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> g.iloc[<span class="dv">1</span>:].copy()</span>
<span id="cb46-974"><a href="#cb46-974" aria-hidden="true" tabindex="-1"></a>    g[<span class="st">"efwa_mtb"</span>] <span class="op">=</span> efwa_values</span>
<span id="cb46-975"><a href="#cb46-975" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g[[<span class="st">"ticker"</span>, <span class="st">"year"</span>, <span class="st">"efwa_mtb"</span>]]</span>
<span id="cb46-976"><a href="#cb46-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-977"><a href="#cb46-977" aria-hidden="true" tabindex="-1"></a>mt <span class="op">=</span> po_clean.copy()</span>
<span id="cb46-978"><a href="#cb46-978" aria-hidden="true" tabindex="-1"></a>mt[<span class="st">"equity_issuance"</span>] <span class="op">=</span> mt[<span class="st">"market_cap"</span>] <span class="op">-</span> mt.groupby(</span>
<span id="cb46-979"><a href="#cb46-979" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ticker"</span></span>
<span id="cb46-980"><a href="#cb46-980" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"market_cap"</span>].shift(<span class="dv">1</span>) <span class="op">-</span> mt[<span class="st">"net_income"</span>]</span>
<span id="cb46-981"><a href="#cb46-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-982"><a href="#cb46-982" aria-hidden="true" tabindex="-1"></a>efwa_data <span class="op">=</span> (</span>
<span id="cb46-983"><a href="#cb46-983" aria-hidden="true" tabindex="-1"></a>    mt.groupby(<span class="st">"ticker"</span>, group_keys<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb46-984"><a href="#cb46-984" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(compute_efwa_mtb)</span>
<span id="cb46-985"><a href="#cb46-985" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-986"><a href="#cb46-986" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-987"><a href="#cb46-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-988"><a href="#cb46-988" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge and regress</span></span>
<span id="cb46-989"><a href="#cb46-989" aria-hidden="true" tabindex="-1"></a>mt_merged <span class="op">=</span> cs_clean.merge(efwa_data, on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"year"</span>], how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb46-990"><a href="#cb46-990" aria-hidden="true" tabindex="-1"></a>mt_clean <span class="op">=</span> mt_merged.dropna(</span>
<span id="cb46-991"><a href="#cb46-991" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"market_leverage"</span>, <span class="st">"efwa_mtb"</span>, <span class="st">"profitability"</span>,</span>
<span id="cb46-992"><a href="#cb46-992" aria-hidden="true" tabindex="-1"></a>            <span class="st">"size"</span>, <span class="st">"tangibility"</span>, <span class="st">"mtb"</span>]</span>
<span id="cb46-993"><a href="#cb46-993" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-994"><a href="#cb46-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-995"><a href="#cb46-995" aria-hidden="true" tabindex="-1"></a>mt_panel <span class="op">=</span> mt_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-996"><a href="#cb46-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-997"><a href="#cb46-997" aria-hidden="true" tabindex="-1"></a>model_mt <span class="op">=</span> PanelOLS(</span>
<span id="cb46-998"><a href="#cb46-998" aria-hidden="true" tabindex="-1"></a>    mt_panel[<span class="st">"market_leverage"</span>],</span>
<span id="cb46-999"><a href="#cb46-999" aria-hidden="true" tabindex="-1"></a>    mt_panel[[<span class="st">"efwa_mtb"</span>, <span class="st">"mtb"</span>, <span class="st">"profitability"</span>, <span class="st">"size"</span>, <span class="st">"tangibility"</span>]],</span>
<span id="cb46-1000"><a href="#cb46-1000" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-1001"><a href="#cb46-1001" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-1002"><a href="#cb46-1002" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-1003"><a href="#cb46-1003" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-1004"><a href="#cb46-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1005"><a href="#cb46-1005" aria-hidden="true" tabindex="-1"></a>mt_panel <span class="op">=</span> mt_panel.reset_index()</span>
<span id="cb46-1006"><a href="#cb46-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1007"><a href="#cb46-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1010"><a href="#cb46-1010" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1011"><a href="#cb46-1011" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-market-timing</span></span>
<span id="cb46-1012"><a href="#cb46-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1013"><a href="#cb46-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Market Timing and Capital Structure"</span></span>
<span id="cb46-1014"><a href="#cb46-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1015"><a href="#cb46-1015" aria-hidden="true" tabindex="-1"></a>mt_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-1016"><a href="#cb46-1016" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_mt.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-1017"><a href="#cb46-1017" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_mt.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-1018"><a href="#cb46-1018" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_mt.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb46-1019"><a href="#cb46-1019" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_mt.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-1020"><a href="#cb46-1020" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-1021"><a href="#cb46-1021" aria-hidden="true" tabindex="-1"></a>mt_results</span>
<span id="cb46-1022"><a href="#cb46-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1023"><a href="#cb46-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1024"><a href="#cb46-1024" aria-hidden="true" tabindex="-1"></a>A negative coefficient on $\text{EFWA}_{M/B}$ after controlling for the current $M/B$ (which captures current investment opportunities) supports the market timing hypothesis: firms that historically raised capital at high valuations maintain persistently lower leverage.</span>
<span id="cb46-1025"><a href="#cb46-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1026"><a href="#cb46-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">## Payout Policy Estimators</span></span>
<span id="cb46-1027"><a href="#cb46-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1028"><a href="#cb46-1028" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dividend Smoothing</span></span>
<span id="cb46-1029"><a href="#cb46-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1030"><a href="#cb46-1030" aria-hidden="true" tabindex="-1"></a>@lintner1956distribution established the foundational model of dividend behavior: firms target a payout ratio and partially adjust dividends toward the target each year. The partial adjustment model is:</span>
<span id="cb46-1031"><a href="#cb46-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1032"><a href="#cb46-1032" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-1033"><a href="#cb46-1033" aria-hidden="true" tabindex="-1"></a>\Delta D_{i,t} = \alpha_i + \lambda(\tau \cdot E_{i,t} - D_{i,t-1}) + \varepsilon_{i,t}</span>
<span id="cb46-1034"><a href="#cb46-1034" aria-hidden="true" tabindex="-1"></a>$$ {#eq-lintner}</span>
<span id="cb46-1035"><a href="#cb46-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1036"><a href="#cb46-1036" aria-hidden="true" tabindex="-1"></a>where $D_{i,t}$ is the dividend per share, $E_{i,t}$ is earnings per share, $\tau$ is the target payout ratio, and $\lambda \in (0, 1)$ is the speed of adjustment. Low $\lambda$ implies strong smoothing (i.e., firms adjust dividends slowly toward the target). Rearranging:</span>
<span id="cb46-1037"><a href="#cb46-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1038"><a href="#cb46-1038" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-1039"><a href="#cb46-1039" aria-hidden="true" tabindex="-1"></a>D_{i,t} = \alpha_i + (1 - \lambda) D_{i,t-1} + \lambda \tau \cdot E_{i,t} + \varepsilon_{i,t}</span>
<span id="cb46-1040"><a href="#cb46-1040" aria-hidden="true" tabindex="-1"></a>$$ {#eq-lintner-regression}</span>
<span id="cb46-1041"><a href="#cb46-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1042"><a href="#cb46-1042" aria-hidden="true" tabindex="-1"></a>The coefficient on lagged dividends, $(1 - \lambda)$, measures the degree of smoothing. Values close to 1 indicate near-complete smoothing; values close to 0 indicate no smoothing (full adjustment).</span>
<span id="cb46-1043"><a href="#cb46-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1046"><a href="#cb46-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1047"><a href="#cb46-1047" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lintner-model</span></span>
<span id="cb46-1048"><a href="#cb46-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1049"><a href="#cb46-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1050"><a href="#cb46-1050" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct dividend and earnings variables</span></span>
<span id="cb46-1051"><a href="#cb46-1051" aria-hidden="true" tabindex="-1"></a>div <span class="op">=</span> panel_fc.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-1052"><a href="#cb46-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1053"><a href="#cb46-1053" aria-hidden="true" tabindex="-1"></a>div[<span class="st">"lag_dps"</span>] <span class="op">=</span> div.groupby(<span class="st">"ticker"</span>)[<span class="st">"dividends_per_share"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-1054"><a href="#cb46-1054" aria-hidden="true" tabindex="-1"></a>div[<span class="st">"delta_dps"</span>] <span class="op">=</span> div[<span class="st">"dividends_per_share"</span>] <span class="op">-</span> div[<span class="st">"lag_dps"</span>]</span>
<span id="cb46-1055"><a href="#cb46-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1056"><a href="#cb46-1056" aria-hidden="true" tabindex="-1"></a><span class="co"># Only firms with positive dividends in both periods</span></span>
<span id="cb46-1057"><a href="#cb46-1057" aria-hidden="true" tabindex="-1"></a>div_clean <span class="op">=</span> div.dropna(</span>
<span id="cb46-1058"><a href="#cb46-1058" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"dividends_per_share"</span>, <span class="st">"lag_dps"</span>, <span class="st">"eps"</span>]</span>
<span id="cb46-1059"><a href="#cb46-1059" aria-hidden="true" tabindex="-1"></a>).query(<span class="st">"lag_dps &gt; 0 and dividends_per_share &gt; 0"</span>)</span>
<span id="cb46-1060"><a href="#cb46-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1061"><a href="#cb46-1061" aria-hidden="true" tabindex="-1"></a><span class="co"># Lintner regression</span></span>
<span id="cb46-1062"><a href="#cb46-1062" aria-hidden="true" tabindex="-1"></a>div_panel <span class="op">=</span> div_clean.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-1063"><a href="#cb46-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1064"><a href="#cb46-1064" aria-hidden="true" tabindex="-1"></a>model_lintner <span class="op">=</span> PanelOLS(</span>
<span id="cb46-1065"><a href="#cb46-1065" aria-hidden="true" tabindex="-1"></a>    div_panel[<span class="st">"dividends_per_share"</span>],</span>
<span id="cb46-1066"><a href="#cb46-1066" aria-hidden="true" tabindex="-1"></a>    div_panel[[<span class="st">"lag_dps"</span>, <span class="st">"eps"</span>]],</span>
<span id="cb46-1067"><a href="#cb46-1067" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-1068"><a href="#cb46-1068" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-1069"><a href="#cb46-1069" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-1070"><a href="#cb46-1070" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-1071"><a href="#cb46-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1072"><a href="#cb46-1072" aria-hidden="true" tabindex="-1"></a>div_panel <span class="op">=</span> div_panel.reset_index()</span>
<span id="cb46-1073"><a href="#cb46-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1074"><a href="#cb46-1074" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract structural parameters</span></span>
<span id="cb46-1075"><a href="#cb46-1075" aria-hidden="true" tabindex="-1"></a>lambda_hat <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> model_lintner.params[<span class="st">"lag_dps"</span>]</span>
<span id="cb46-1076"><a href="#cb46-1076" aria-hidden="true" tabindex="-1"></a>tau_hat <span class="op">=</span> model_lintner.params[<span class="st">"eps"</span>] <span class="op">/</span> lambda_hat</span>
<span id="cb46-1077"><a href="#cb46-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1078"><a href="#cb46-1078" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Lintner Model Estimates:"</span>)</span>
<span id="cb46-1079"><a href="#cb46-1079" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Speed of adjustment (λ): </span><span class="sc">{</span>lambda_hat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb46-1080"><a href="#cb46-1080" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Target payout ratio (τ): </span><span class="sc">{</span>tau_hat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb46-1081"><a href="#cb46-1081" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Smoothing coefficient (1-λ): </span><span class="sc">{</span>model_lintner<span class="sc">.</span>params[<span class="st">'lag_dps'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb46-1082"><a href="#cb46-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1083"><a href="#cb46-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1086"><a href="#cb46-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1087"><a href="#cb46-1087" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-lintner</span></span>
<span id="cb46-1088"><a href="#cb46-1088" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1089"><a href="#cb46-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Lintner Partial Adjustment Model"</span></span>
<span id="cb46-1090"><a href="#cb46-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1091"><a href="#cb46-1091" aria-hidden="true" tabindex="-1"></a>lintner_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-1092"><a href="#cb46-1092" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_lintner.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-1093"><a href="#cb46-1093" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_lintner.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-1094"><a href="#cb46-1094" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_lintner.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb46-1095"><a href="#cb46-1095" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_lintner.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-1096"><a href="#cb46-1096" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-1097"><a href="#cb46-1097" aria-hidden="true" tabindex="-1"></a>lintner_table</span>
<span id="cb46-1098"><a href="#cb46-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1099"><a href="#cb46-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1102"><a href="#cb46-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1103"><a href="#cb46-1103" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-payout-ratio</span></span>
<span id="cb46-1104"><a href="#cb46-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1105"><a href="#cb46-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Cross-Sectional Distribution of Dividend Payout Ratios Over Time"</span></span>
<span id="cb46-1106"><a href="#cb46-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1107"><a href="#cb46-1107" aria-hidden="true" tabindex="-1"></a>payout <span class="op">=</span> panel_fc.copy()</span>
<span id="cb46-1108"><a href="#cb46-1108" aria-hidden="true" tabindex="-1"></a>payout[<span class="st">"payout_ratio"</span>] <span class="op">=</span> payout[<span class="st">"dividends"</span>] <span class="op">/</span> payout[<span class="st">"net_income"</span>]</span>
<span id="cb46-1109"><a href="#cb46-1109" aria-hidden="true" tabindex="-1"></a>payout <span class="op">=</span> payout[</span>
<span id="cb46-1110"><a href="#cb46-1110" aria-hidden="true" tabindex="-1"></a>    (payout[<span class="st">"net_income"</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span></span>
<span id="cb46-1111"><a href="#cb46-1111" aria-hidden="true" tabindex="-1"></a>    (payout[<span class="st">"payout_ratio"</span>].between(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb46-1112"><a href="#cb46-1112" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb46-1113"><a href="#cb46-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1114"><a href="#cb46-1114" aria-hidden="true" tabindex="-1"></a>payout_ts <span class="op">=</span> (</span>
<span id="cb46-1115"><a href="#cb46-1115" aria-hidden="true" tabindex="-1"></a>    payout.groupby(<span class="st">"year"</span>)</span>
<span id="cb46-1116"><a href="#cb46-1116" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb46-1117"><a href="#cb46-1117" aria-hidden="true" tabindex="-1"></a>        median_payout<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="st">"median"</span>),</span>
<span id="cb46-1118"><a href="#cb46-1118" aria-hidden="true" tabindex="-1"></a>        mean_payout<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="st">"mean"</span>),</span>
<span id="cb46-1119"><a href="#cb46-1119" aria-hidden="true" tabindex="-1"></a>        q25<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="kw">lambda</span> x: x.quantile(<span class="fl">0.25</span>)),</span>
<span id="cb46-1120"><a href="#cb46-1120" aria-hidden="true" tabindex="-1"></a>        q75<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="kw">lambda</span> x: x.quantile(<span class="fl">0.75</span>)),</span>
<span id="cb46-1121"><a href="#cb46-1121" aria-hidden="true" tabindex="-1"></a>        pct_payers<span class="op">=</span>(<span class="st">"payout_ratio"</span>, <span class="kw">lambda</span> x: (x <span class="op">&gt;</span> <span class="dv">0</span>).mean())</span>
<span id="cb46-1122"><a href="#cb46-1122" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1123"><a href="#cb46-1123" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb46-1124"><a href="#cb46-1124" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1125"><a href="#cb46-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1126"><a href="#cb46-1126" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb46-1127"><a href="#cb46-1127" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(payout_ts, p9.aes(x<span class="op">=</span><span class="st">"year"</span>))</span>
<span id="cb46-1128"><a href="#cb46-1128" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_ribbon(</span>
<span id="cb46-1129"><a href="#cb46-1129" aria-hidden="true" tabindex="-1"></a>        p9.aes(ymin<span class="op">=</span><span class="st">"q25"</span>, ymax<span class="op">=</span><span class="st">"q75"</span>),</span>
<span id="cb46-1130"><a href="#cb46-1130" aria-hidden="true" tabindex="-1"></a>        fill<span class="op">=</span><span class="st">"#2E5090"</span>, alpha<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb46-1131"><a href="#cb46-1131" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1132"><a href="#cb46-1132" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line(</span>
<span id="cb46-1133"><a href="#cb46-1133" aria-hidden="true" tabindex="-1"></a>        p9.aes(y<span class="op">=</span><span class="st">"median_payout"</span>),</span>
<span id="cb46-1134"><a href="#cb46-1134" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"#2E5090"</span>, size<span class="op">=</span><span class="dv">1</span></span>
<span id="cb46-1135"><a href="#cb46-1135" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1136"><a href="#cb46-1136" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line(</span>
<span id="cb46-1137"><a href="#cb46-1137" aria-hidden="true" tabindex="-1"></a>        p9.aes(y<span class="op">=</span><span class="st">"mean_payout"</span>),</span>
<span id="cb46-1138"><a href="#cb46-1138" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"#C0392B"</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, size<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb46-1139"><a href="#cb46-1139" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1140"><a href="#cb46-1140" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb46-1141"><a href="#cb46-1141" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Year"</span>,</span>
<span id="cb46-1142"><a href="#cb46-1142" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Dividend Payout Ratio"</span>,</span>
<span id="cb46-1143"><a href="#cb46-1143" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Payout Ratio: Median (Solid) and Mean (Dashed)"</span></span>
<span id="cb46-1144"><a href="#cb46-1144" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1145"><a href="#cb46-1145" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb46-1146"><a href="#cb46-1146" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb46-1147"><a href="#cb46-1147" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1148"><a href="#cb46-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1149"><a href="#cb46-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1150"><a href="#cb46-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">### Smoothing Heterogeneity: SOEs vs. Private Firms</span></span>
<span id="cb46-1151"><a href="#cb46-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1152"><a href="#cb46-1152" aria-hidden="true" tabindex="-1"></a>Dividend policy in Vietnam is shaped by regulatory mandates. The State Capital Investment Corporation (SCIC) and line ministries have historically required SOEs to distribute minimum dividend amounts, sometimes at the expense of reinvestment. This creates a fundamental asymmetry: SOE dividends are partially policy-determined rather than the outcome of the Lintner optimization.</span>
<span id="cb46-1153"><a href="#cb46-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1156"><a href="#cb46-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1157"><a href="#cb46-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lintner-soe-split</span></span>
<span id="cb46-1158"><a href="#cb46-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1159"><a href="#cb46-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1160"><a href="#cb46-1160" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge SOE indicator</span></span>
<span id="cb46-1161"><a href="#cb46-1161" aria-hidden="true" tabindex="-1"></a>div_with_soe <span class="op">=</span> div_clean.merge(</span>
<span id="cb46-1162"><a href="#cb46-1162" aria-hidden="true" tabindex="-1"></a>    ownership[[<span class="st">"ticker"</span>, <span class="st">"year"</span>, <span class="st">"state_ownership_pct"</span>]],</span>
<span id="cb46-1163"><a href="#cb46-1163" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"year"</span>],</span>
<span id="cb46-1164"><a href="#cb46-1164" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb46-1165"><a href="#cb46-1165" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1166"><a href="#cb46-1166" aria-hidden="true" tabindex="-1"></a>div_with_soe[<span class="st">"soe"</span>] <span class="op">=</span> (div_with_soe[<span class="st">"state_ownership_pct"</span>] <span class="op">&gt;</span> <span class="dv">50</span>).astype(<span class="bu">int</span>)</span>
<span id="cb46-1167"><a href="#cb46-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1168"><a href="#cb46-1168" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate Lintner model separately for SOEs and private firms</span></span>
<span id="cb46-1169"><a href="#cb46-1169" aria-hidden="true" tabindex="-1"></a>lintner_results <span class="op">=</span> {}</span>
<span id="cb46-1170"><a href="#cb46-1170" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label, soe_val <span class="kw">in</span> [(<span class="st">"Private"</span>, <span class="dv">0</span>), (<span class="st">"SOE"</span>, <span class="dv">1</span>)]:</span>
<span id="cb46-1171"><a href="#cb46-1171" aria-hidden="true" tabindex="-1"></a>    subset <span class="op">=</span> div_with_soe[div_with_soe[<span class="st">"soe"</span>] <span class="op">==</span> soe_val].copy()</span>
<span id="cb46-1172"><a href="#cb46-1172" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb46-1173"><a href="#cb46-1173" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb46-1174"><a href="#cb46-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1175"><a href="#cb46-1175" aria-hidden="true" tabindex="-1"></a>    subset_panel <span class="op">=</span> subset.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-1176"><a href="#cb46-1176" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> PanelOLS(</span>
<span id="cb46-1177"><a href="#cb46-1177" aria-hidden="true" tabindex="-1"></a>        subset_panel[<span class="st">"dividends_per_share"</span>],</span>
<span id="cb46-1178"><a href="#cb46-1178" aria-hidden="true" tabindex="-1"></a>        subset_panel[[<span class="st">"lag_dps"</span>, <span class="st">"eps"</span>]],</span>
<span id="cb46-1179"><a href="#cb46-1179" aria-hidden="true" tabindex="-1"></a>        entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-1180"><a href="#cb46-1180" aria-hidden="true" tabindex="-1"></a>        time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-1181"><a href="#cb46-1181" aria-hidden="true" tabindex="-1"></a>        check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-1182"><a href="#cb46-1182" aria-hidden="true" tabindex="-1"></a>    ).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-1183"><a href="#cb46-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1184"><a href="#cb46-1184" aria-hidden="true" tabindex="-1"></a>    lam <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> model.params[<span class="st">"lag_dps"</span>]</span>
<span id="cb46-1185"><a href="#cb46-1185" aria-hidden="true" tabindex="-1"></a>    tau <span class="op">=</span> model.params[<span class="st">"eps"</span>] <span class="op">/</span> lam <span class="cf">if</span> <span class="bu">abs</span>(lam) <span class="op">&gt;</span> <span class="fl">0.01</span> <span class="cf">else</span> np.nan</span>
<span id="cb46-1186"><a href="#cb46-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1187"><a href="#cb46-1187" aria-hidden="true" tabindex="-1"></a>    lintner_results[label] <span class="op">=</span> {</span>
<span id="cb46-1188"><a href="#cb46-1188" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Smoothing (1-λ)"</span>: <span class="bu">round</span>(model.params[<span class="st">"lag_dps"</span>], <span class="dv">4</span>),</span>
<span id="cb46-1189"><a href="#cb46-1189" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Speed of adj (λ)"</span>: <span class="bu">round</span>(lam, <span class="dv">4</span>),</span>
<span id="cb46-1190"><a href="#cb46-1190" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Target payout (τ)"</span>: <span class="bu">round</span>(tau, <span class="dv">4</span>),</span>
<span id="cb46-1191"><a href="#cb46-1191" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N"</span>: <span class="bu">int</span>(model.nobs)</span>
<span id="cb46-1192"><a href="#cb46-1192" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-1193"><a href="#cb46-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1194"><a href="#cb46-1194" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lintner_results).T</span>
<span id="cb46-1195"><a href="#cb46-1195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1196"><a href="#cb46-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1197"><a href="#cb46-1197" aria-hidden="true" tabindex="-1"></a><span class="fu">### Share Repurchases</span></span>
<span id="cb46-1198"><a href="#cb46-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1199"><a href="#cb46-1199" aria-hidden="true" tabindex="-1"></a>Share repurchases are a relatively new phenomenon in Vietnamese markets, gradually gaining traction as regulations have evolved. Unlike dividends, repurchases are more flexible and do not create expectations of future payments. The decision to repurchase can be modeled as:</span>
<span id="cb46-1200"><a href="#cb46-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1201"><a href="#cb46-1201" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-1202"><a href="#cb46-1202" aria-hidden="true" tabindex="-1"></a>\text{Repurchase}_{i,t} = \mathbb{1}\left(\beta_0 + \beta_1 \frac{CF_{i,t}}{A_{i,t}} + \beta_2 Q_{i,t} + \beta_3 \text{Lev}_{i,t} + \beta_4 \frac{\text{Cash}_{i,t}}{A_{i,t}} + \boldsymbol{\gamma}' \mathbf{Z}_{i,t} + \varepsilon_{i,t} &gt; 0\right)</span>
<span id="cb46-1203"><a href="#cb46-1203" aria-hidden="true" tabindex="-1"></a>$$ {#eq-repurchase-probit}</span>
<span id="cb46-1204"><a href="#cb46-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1207"><a href="#cb46-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1208"><a href="#cb46-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: repurchase-model</span></span>
<span id="cb46-1209"><a href="#cb46-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1210"><a href="#cb46-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1211"><a href="#cb46-1211" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify repurchase years</span></span>
<span id="cb46-1212"><a href="#cb46-1212" aria-hidden="true" tabindex="-1"></a>repurchase <span class="op">=</span> panel_fc.copy()</span>
<span id="cb46-1213"><a href="#cb46-1213" aria-hidden="true" tabindex="-1"></a>repurchase[<span class="st">"repurchase_dummy"</span>] <span class="op">=</span> (</span>
<span id="cb46-1214"><a href="#cb46-1214" aria-hidden="true" tabindex="-1"></a>    repurchase[<span class="st">"share_repurchases"</span>] <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb46-1215"><a href="#cb46-1215" aria-hidden="true" tabindex="-1"></a>).astype(<span class="bu">int</span>)</span>
<span id="cb46-1216"><a href="#cb46-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1217"><a href="#cb46-1217" aria-hidden="true" tabindex="-1"></a>repurchase[<span class="st">"cash_assets"</span>] <span class="op">=</span> repurchase[<span class="st">"cash"</span>] <span class="op">/</span> repurchase[<span class="st">"total_assets"</span>]</span>
<span id="cb46-1218"><a href="#cb46-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1219"><a href="#cb46-1219" aria-hidden="true" tabindex="-1"></a><span class="co"># Probit model for repurchase decision</span></span>
<span id="cb46-1220"><a href="#cb46-1220" aria-hidden="true" tabindex="-1"></a>rep_clean <span class="op">=</span> repurchase.dropna(</span>
<span id="cb46-1221"><a href="#cb46-1221" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"repurchase_dummy"</span>, <span class="st">"cf_assets"</span>, <span class="st">"tobins_q"</span>,</span>
<span id="cb46-1222"><a href="#cb46-1222" aria-hidden="true" tabindex="-1"></a>            <span class="st">"book_leverage"</span>, <span class="st">"cash_assets"</span>, <span class="st">"log_assets"</span>]</span>
<span id="cb46-1223"><a href="#cb46-1223" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1224"><a href="#cb46-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1225"><a href="#cb46-1225" aria-hidden="true" tabindex="-1"></a>probit_model <span class="op">=</span> smf.probit(</span>
<span id="cb46-1226"><a href="#cb46-1226" aria-hidden="true" tabindex="-1"></a>    <span class="st">"repurchase_dummy ~ cf_assets + tobins_q + book_leverage "</span></span>
<span id="cb46-1227"><a href="#cb46-1227" aria-hidden="true" tabindex="-1"></a>    <span class="st">"+ cash_assets + log_assets + C(year)"</span>,</span>
<span id="cb46-1228"><a href="#cb46-1228" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>rep_clean</span>
<span id="cb46-1229"><a href="#cb46-1229" aria-hidden="true" tabindex="-1"></a>).fit(disp<span class="op">=</span><span class="va">False</span>, cov_type<span class="op">=</span><span class="st">"cluster"</span>, cov_kwds<span class="op">=</span>{<span class="st">"groups"</span>: rep_clean[<span class="st">"ticker"</span>]})</span>
<span id="cb46-1230"><a href="#cb46-1230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1231"><a href="#cb46-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1234"><a href="#cb46-1234" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1235"><a href="#cb46-1235" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-repurchase-probit</span></span>
<span id="cb46-1236"><a href="#cb46-1236" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1237"><a href="#cb46-1237" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Probit Model: Determinants of Share Repurchase Decision"</span></span>
<span id="cb46-1238"><a href="#cb46-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1239"><a href="#cb46-1239" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract non-year-dummy coefficients</span></span>
<span id="cb46-1240"><a href="#cb46-1240" aria-hidden="true" tabindex="-1"></a>main_vars <span class="op">=</span> [<span class="st">"cf_assets"</span>, <span class="st">"tobins_q"</span>, <span class="st">"book_leverage"</span>,</span>
<span id="cb46-1241"><a href="#cb46-1241" aria-hidden="true" tabindex="-1"></a>             <span class="st">"cash_assets"</span>, <span class="st">"log_assets"</span>]</span>
<span id="cb46-1242"><a href="#cb46-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1243"><a href="#cb46-1243" aria-hidden="true" tabindex="-1"></a>probit_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-1244"><a href="#cb46-1244" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: probit_model.params[main_vars].<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-1245"><a href="#cb46-1245" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: probit_model.bse[main_vars].<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-1246"><a href="#cb46-1246" aria-hidden="true" tabindex="-1"></a>    <span class="st">"z-stat"</span>: probit_model.tvalues[main_vars].<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb46-1247"><a href="#cb46-1247" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: probit_model.pvalues[main_vars].<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-1248"><a href="#cb46-1248" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Marginal Effect"</span>: (</span>
<span id="cb46-1249"><a href="#cb46-1249" aria-hidden="true" tabindex="-1"></a>        probit_model.get_margeff().margeff[:<span class="bu">len</span>(main_vars)]</span>
<span id="cb46-1250"><a href="#cb46-1250" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-1251"><a href="#cb46-1251" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-1252"><a href="#cb46-1252" aria-hidden="true" tabindex="-1"></a>probit_results</span>
<span id="cb46-1253"><a href="#cb46-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1254"><a href="#cb46-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1255"><a href="#cb46-1255" aria-hidden="true" tabindex="-1"></a><span class="fu">### Agency and Signaling Interpretations</span></span>
<span id="cb46-1256"><a href="#cb46-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1257"><a href="#cb46-1257" aria-hidden="true" tabindex="-1"></a>Payout policy is interpreted through two competing lenses:</span>
<span id="cb46-1258"><a href="#cb46-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1259"><a href="#cb46-1259" aria-hidden="true" tabindex="-1"></a>**Agency view** <span class="co">[</span><span class="ot">@jensen1986agency; @la2000agency</span><span class="co">]</span>: Dividends are a mechanism for disgorging free cash flow that managers would otherwise waste on empire-building or perquisite consumption. In this view, firms with weaker governance should face greater pressure to pay dividends as a bonding device. @la2000agency distinguish the "outcome" model (dividends are the result of effective minority shareholder pressure) from the "substitute" model (firms with weak governance pay high dividends to build reputation for fair treatment).</span>
<span id="cb46-1260"><a href="#cb46-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1261"><a href="#cb46-1261" aria-hidden="true" tabindex="-1"></a>**Signaling view** <span class="co">[</span><span class="ot">@bhattacharya1979imperfect; @miller1985dividend</span><span class="co">]</span>: Dividends convey private information about future earnings. Because dividends are costly to fake (they require actual cash), they serve as a credible signal. The signaling interpretation predicts that dividend changes should predict future earnings changes.</span>
<span id="cb46-1262"><a href="#cb46-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1265"><a href="#cb46-1265" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1266"><a href="#cb46-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dividend-signaling</span></span>
<span id="cb46-1267"><a href="#cb46-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1268"><a href="#cb46-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1269"><a href="#cb46-1269" aria-hidden="true" tabindex="-1"></a><span class="co"># Test dividend signaling: do dividend changes predict future earnings?</span></span>
<span id="cb46-1270"><a href="#cb46-1270" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> panel_fc.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-1271"><a href="#cb46-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1272"><a href="#cb46-1272" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"delta_div"</span>] <span class="op">=</span> signal.groupby(<span class="st">"ticker"</span>)[<span class="st">"dividends"</span>].diff()</span>
<span id="cb46-1273"><a href="#cb46-1273" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"div_increase"</span>] <span class="op">=</span> (signal[<span class="st">"delta_div"</span>] <span class="op">&gt;</span> <span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb46-1274"><a href="#cb46-1274" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"div_decrease"</span>] <span class="op">=</span> (signal[<span class="st">"delta_div"</span>] <span class="op">&lt;</span> <span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb46-1275"><a href="#cb46-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1276"><a href="#cb46-1276" aria-hidden="true" tabindex="-1"></a><span class="co"># Future earnings change</span></span>
<span id="cb46-1277"><a href="#cb46-1277" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"lead_earnings"</span>] <span class="op">=</span> signal.groupby(<span class="st">"ticker"</span>)[<span class="st">"net_income"</span>].shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb46-1278"><a href="#cb46-1278" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"delta_earnings_lead"</span>] <span class="op">=</span> (</span>
<span id="cb46-1279"><a href="#cb46-1279" aria-hidden="true" tabindex="-1"></a>    (signal[<span class="st">"lead_earnings"</span>] <span class="op">-</span> signal[<span class="st">"net_income"</span>]) <span class="op">/</span></span>
<span id="cb46-1280"><a href="#cb46-1280" aria-hidden="true" tabindex="-1"></a>    signal[<span class="st">"total_assets"</span>]</span>
<span id="cb46-1281"><a href="#cb46-1281" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1282"><a href="#cb46-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1283"><a href="#cb46-1283" aria-hidden="true" tabindex="-1"></a><span class="co"># Current earnings change (control)</span></span>
<span id="cb46-1284"><a href="#cb46-1284" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"lag_earnings"</span>] <span class="op">=</span> signal.groupby(<span class="st">"ticker"</span>)[<span class="st">"net_income"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-1285"><a href="#cb46-1285" aria-hidden="true" tabindex="-1"></a>signal[<span class="st">"delta_earnings_curr"</span>] <span class="op">=</span> (</span>
<span id="cb46-1286"><a href="#cb46-1286" aria-hidden="true" tabindex="-1"></a>    (signal[<span class="st">"net_income"</span>] <span class="op">-</span> signal[<span class="st">"lag_earnings"</span>]) <span class="op">/</span></span>
<span id="cb46-1287"><a href="#cb46-1287" aria-hidden="true" tabindex="-1"></a>    signal[<span class="st">"total_assets"</span>]</span>
<span id="cb46-1288"><a href="#cb46-1288" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1289"><a href="#cb46-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1290"><a href="#cb46-1290" aria-hidden="true" tabindex="-1"></a>signal_clean <span class="op">=</span> signal.dropna(</span>
<span id="cb46-1291"><a href="#cb46-1291" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"delta_earnings_lead"</span>, <span class="st">"div_increase"</span>,</span>
<span id="cb46-1292"><a href="#cb46-1292" aria-hidden="true" tabindex="-1"></a>            <span class="st">"div_decrease"</span>, <span class="st">"delta_earnings_curr"</span>]</span>
<span id="cb46-1293"><a href="#cb46-1293" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1294"><a href="#cb46-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1295"><a href="#cb46-1295" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression: future earnings change on dividend change indicators</span></span>
<span id="cb46-1296"><a href="#cb46-1296" aria-hidden="true" tabindex="-1"></a>signal_model <span class="op">=</span> smf.ols(</span>
<span id="cb46-1297"><a href="#cb46-1297" aria-hidden="true" tabindex="-1"></a>    <span class="st">"delta_earnings_lead ~ div_increase + div_decrease "</span></span>
<span id="cb46-1298"><a href="#cb46-1298" aria-hidden="true" tabindex="-1"></a>    <span class="st">"+ delta_earnings_curr + C(year) + C(industry)"</span>,</span>
<span id="cb46-1299"><a href="#cb46-1299" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>signal_clean</span>
<span id="cb46-1300"><a href="#cb46-1300" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"cluster"</span>, cov_kwds<span class="op">=</span>{<span class="st">"groups"</span>: signal_clean[<span class="st">"ticker"</span>]})</span>
<span id="cb46-1301"><a href="#cb46-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1302"><a href="#cb46-1302" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dividend Signaling Test:"</span>)</span>
<span id="cb46-1303"><a href="#cb46-1303" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> [<span class="st">"div_increase"</span>, <span class="st">"div_decrease"</span>, <span class="st">"delta_earnings_curr"</span>]:</span>
<span id="cb46-1304"><a href="#cb46-1304" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>signal_model<span class="sc">.</span>params[var]<span class="sc">:.4f}</span><span class="ss"> "</span></span>
<span id="cb46-1305"><a href="#cb46-1305" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"(t = </span><span class="sc">{</span>signal_model<span class="sc">.</span>tvalues[var]<span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb46-1306"><a href="#cb46-1306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1307"><a href="#cb46-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1308"><a href="#cb46-1308" aria-hidden="true" tabindex="-1"></a><span class="fu">## Agency Cost Proxies</span></span>
<span id="cb46-1309"><a href="#cb46-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1310"><a href="#cb46-1310" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ownership Concentration and Agency Problems</span></span>
<span id="cb46-1311"><a href="#cb46-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1312"><a href="#cb46-1312" aria-hidden="true" tabindex="-1"></a>The agency framework of @jensen2019theory identifies the separation of ownership and control as the fundamental source of corporate agency costs. In concentrated-ownership economies like Vietnam, the dominant agency conflict is not between dispersed shareholders and professional managers (Berle-Means agency problem) but between controlling and minority shareholders (principal-principal agency problem, @young2008corporate).</span>
<span id="cb46-1313"><a href="#cb46-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1314"><a href="#cb46-1314" aria-hidden="true" tabindex="-1"></a>The key mechanisms through which controlling shareholders extract private benefits include: tunneling via related-party transactions <span class="co">[</span><span class="ot">@johnson2000tunneling</span><span class="co">]</span>, diversion of corporate opportunities, excessive compensation, and dilutive equity issuances. The extent of these costs depends on the ownership structure, legal protections for minorities, and monitoring intensity.</span>
<span id="cb46-1315"><a href="#cb46-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1318"><a href="#cb46-1318" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1319"><a href="#cb46-1319" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ownership-structure</span></span>
<span id="cb46-1320"><a href="#cb46-1320" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1321"><a href="#cb46-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1322"><a href="#cb46-1322" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge ownership data comprehensively</span></span>
<span id="cb46-1323"><a href="#cb46-1323" aria-hidden="true" tabindex="-1"></a>agency <span class="op">=</span> panel_fc.merge(</span>
<span id="cb46-1324"><a href="#cb46-1324" aria-hidden="true" tabindex="-1"></a>    ownership[[<span class="st">"ticker"</span>, <span class="st">"year"</span>, <span class="st">"state_ownership_pct"</span>,</span>
<span id="cb46-1325"><a href="#cb46-1325" aria-hidden="true" tabindex="-1"></a>               <span class="st">"foreign_ownership_pct"</span>, <span class="st">"insider_ownership_pct"</span>,</span>
<span id="cb46-1326"><a href="#cb46-1326" aria-hidden="true" tabindex="-1"></a>               <span class="st">"largest_shareholder_pct"</span>, <span class="st">"top5_shareholder_pct"</span>,</span>
<span id="cb46-1327"><a href="#cb46-1327" aria-hidden="true" tabindex="-1"></a>               <span class="st">"board_size"</span>, <span class="st">"independent_directors_pct"</span>,</span>
<span id="cb46-1328"><a href="#cb46-1328" aria-hidden="true" tabindex="-1"></a>               <span class="st">"ceo_duality"</span>]],</span>
<span id="cb46-1329"><a href="#cb46-1329" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"year"</span>],</span>
<span id="cb46-1330"><a href="#cb46-1330" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb46-1331"><a href="#cb46-1331" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1332"><a href="#cb46-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1333"><a href="#cb46-1333" aria-hidden="true" tabindex="-1"></a><span class="co"># Ownership concentration measures</span></span>
<span id="cb46-1334"><a href="#cb46-1334" aria-hidden="true" tabindex="-1"></a><span class="co"># Herfindahl of top-5 shareholdings</span></span>
<span id="cb46-1335"><a href="#cb46-1335" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"ownership_hhi"</span>] <span class="op">=</span> agency[<span class="st">"top5_shareholder_pct"</span>]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb46-1336"><a href="#cb46-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1337"><a href="#cb46-1337" aria-hidden="true" tabindex="-1"></a><span class="co"># Excess control rights (proxy: difference between</span></span>
<span id="cb46-1338"><a href="#cb46-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># largest shareholder and second largest)</span></span>
<span id="cb46-1339"><a href="#cb46-1339" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"control_wedge"</span>] <span class="op">=</span> (</span>
<span id="cb46-1340"><a href="#cb46-1340" aria-hidden="true" tabindex="-1"></a>    agency[<span class="st">"largest_shareholder_pct"</span>] <span class="op">-</span></span>
<span id="cb46-1341"><a href="#cb46-1341" aria-hidden="true" tabindex="-1"></a>    (agency[<span class="st">"top5_shareholder_pct"</span>] <span class="op">-</span> agency[<span class="st">"largest_shareholder_pct"</span>]) <span class="op">/</span> <span class="dv">4</span></span>
<span id="cb46-1342"><a href="#cb46-1342" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1343"><a href="#cb46-1343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1344"><a href="#cb46-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1345"><a href="#cb46-1345" aria-hidden="true" tabindex="-1"></a><span class="fu">### Free Cash Flow Measures</span></span>
<span id="cb46-1346"><a href="#cb46-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1347"><a href="#cb46-1347" aria-hidden="true" tabindex="-1"></a>@jensen1986agency argues that the agency cost of free cash flow is the central problem in firms that generate cash in excess of positive-NPV investment opportunities. The standard measure is:</span>
<span id="cb46-1348"><a href="#cb46-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1349"><a href="#cb46-1349" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-1350"><a href="#cb46-1350" aria-hidden="true" tabindex="-1"></a>\text{FCF}_{i,t} = \frac{\text{Operating CF}_{i,t} - \text{Depreciation}_{i,t} - \text{Required Capex}_{i,t}}{\text{Total Assets}_{i,t}}</span>
<span id="cb46-1351"><a href="#cb46-1351" aria-hidden="true" tabindex="-1"></a>$$ {#eq-fcf}</span>
<span id="cb46-1352"><a href="#cb46-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1353"><a href="#cb46-1353" aria-hidden="true" tabindex="-1"></a>In practice, "required capex" is unobservable, so researchers use operating cash flow minus capital expenditures as a proxy, or add the interaction of cash flow with low $Q$ (which identifies firms with cash flow but without investment opportunities):</span>
<span id="cb46-1354"><a href="#cb46-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1355"><a href="#cb46-1355" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-1356"><a href="#cb46-1356" aria-hidden="true" tabindex="-1"></a>\text{FCF Overinvestment} = \frac{CF_{i,t}}{A_{i,t}} \times \mathbb{1}(Q_{i,t} &lt; 1)</span>
<span id="cb46-1357"><a href="#cb46-1357" aria-hidden="true" tabindex="-1"></a>$$ {#eq-fcf-overinvest}</span>
<span id="cb46-1358"><a href="#cb46-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1361"><a href="#cb46-1361" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1362"><a href="#cb46-1362" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fcf-agency</span></span>
<span id="cb46-1363"><a href="#cb46-1363" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1364"><a href="#cb46-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1365"><a href="#cb46-1365" aria-hidden="true" tabindex="-1"></a><span class="co"># Free cash flow measures</span></span>
<span id="cb46-1366"><a href="#cb46-1366" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"fcf"</span>] <span class="op">=</span> (agency[<span class="st">"operating_cf"</span>] <span class="op">-</span> agency[<span class="st">"capex"</span>]) <span class="op">/</span> agency[<span class="st">"total_assets"</span>]</span>
<span id="cb46-1367"><a href="#cb46-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1368"><a href="#cb46-1368" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"low_q"</span>] <span class="op">=</span> (agency[<span class="st">"tobins_q"</span>] <span class="op">&lt;</span> <span class="dv">1</span>).astype(<span class="bu">int</span>)</span>
<span id="cb46-1369"><a href="#cb46-1369" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"fcf_low_q"</span>] <span class="op">=</span> agency[<span class="st">"fcf"</span>] <span class="op">*</span> agency[<span class="st">"low_q"</span>]</span>
<span id="cb46-1370"><a href="#cb46-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1371"><a href="#cb46-1371" aria-hidden="true" tabindex="-1"></a><span class="co"># Asset utilization (inverse proxy for agency costs)</span></span>
<span id="cb46-1372"><a href="#cb46-1372" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"asset_turnover"</span>] <span class="op">=</span> agency[<span class="st">"revenue"</span>] <span class="op">/</span> agency[<span class="st">"total_assets"</span>]</span>
<span id="cb46-1373"><a href="#cb46-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1374"><a href="#cb46-1374" aria-hidden="true" tabindex="-1"></a><span class="co"># SGA ratio (proxy for discretionary spending / empire building)</span></span>
<span id="cb46-1375"><a href="#cb46-1375" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"sga_ratio"</span>] <span class="op">=</span> agency[<span class="st">"sga_expenses"</span>] <span class="op">/</span> agency[<span class="st">"revenue"</span>]</span>
<span id="cb46-1376"><a href="#cb46-1376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1377"><a href="#cb46-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1378"><a href="#cb46-1378" aria-hidden="true" tabindex="-1"></a><span class="fu">### Monitoring Mechanisms and Governance Variables</span></span>
<span id="cb46-1379"><a href="#cb46-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1380"><a href="#cb46-1380" aria-hidden="true" tabindex="-1"></a>We construct a governance quality composite based on observable monitoring mechanisms:</span>
<span id="cb46-1381"><a href="#cb46-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1384"><a href="#cb46-1384" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1385"><a href="#cb46-1385" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: governance-variables</span></span>
<span id="cb46-1386"><a href="#cb46-1386" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1387"><a href="#cb46-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1388"><a href="#cb46-1388" aria-hidden="true" tabindex="-1"></a><span class="co"># Governance quality indicators</span></span>
<span id="cb46-1389"><a href="#cb46-1389" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"foreign_monitor"</span>] <span class="op">=</span> (</span>
<span id="cb46-1390"><a href="#cb46-1390" aria-hidden="true" tabindex="-1"></a>    agency[<span class="st">"foreign_ownership_pct"</span>] <span class="op">&gt;</span> <span class="dv">20</span></span>
<span id="cb46-1391"><a href="#cb46-1391" aria-hidden="true" tabindex="-1"></a>).astype(<span class="bu">int</span>)</span>
<span id="cb46-1392"><a href="#cb46-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1393"><a href="#cb46-1393" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"board_independence"</span>] <span class="op">=</span> agency[<span class="st">"independent_directors_pct"</span>]</span>
<span id="cb46-1394"><a href="#cb46-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1395"><a href="#cb46-1395" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"no_duality"</span>] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> agency[<span class="st">"ceo_duality"</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb46-1396"><a href="#cb46-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1397"><a href="#cb46-1397" aria-hidden="true" tabindex="-1"></a><span class="co"># Related-party transaction intensity (if available)</span></span>
<span id="cb46-1398"><a href="#cb46-1398" aria-hidden="true" tabindex="-1"></a><span class="co"># agency["rpt_ratio"] = agency["related_party_transactions"] / agency["revenue"]</span></span>
<span id="cb46-1399"><a href="#cb46-1399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1400"><a href="#cb46-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1403"><a href="#cb46-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1404"><a href="#cb46-1404" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-agency-proxies</span></span>
<span id="cb46-1405"><a href="#cb46-1405" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1406"><a href="#cb46-1406" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Summary Statistics: Agency Cost Proxies and Governance Variables"</span></span>
<span id="cb46-1407"><a href="#cb46-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1408"><a href="#cb46-1408" aria-hidden="true" tabindex="-1"></a>agency_vars <span class="op">=</span> [</span>
<span id="cb46-1409"><a href="#cb46-1409" aria-hidden="true" tabindex="-1"></a>    <span class="st">"largest_shareholder_pct"</span>, <span class="st">"state_ownership_pct"</span>,</span>
<span id="cb46-1410"><a href="#cb46-1410" aria-hidden="true" tabindex="-1"></a>    <span class="st">"foreign_ownership_pct"</span>, <span class="st">"fcf"</span>, <span class="st">"fcf_low_q"</span>,</span>
<span id="cb46-1411"><a href="#cb46-1411" aria-hidden="true" tabindex="-1"></a>    <span class="st">"asset_turnover"</span>, <span class="st">"board_independence"</span></span>
<span id="cb46-1412"><a href="#cb46-1412" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb46-1413"><a href="#cb46-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1414"><a href="#cb46-1414" aria-hidden="true" tabindex="-1"></a>agency_summary <span class="op">=</span> (</span>
<span id="cb46-1415"><a href="#cb46-1415" aria-hidden="true" tabindex="-1"></a>    agency[agency_vars].dropna()</span>
<span id="cb46-1416"><a href="#cb46-1416" aria-hidden="true" tabindex="-1"></a>    .describe(percentiles<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>])</span>
<span id="cb46-1417"><a href="#cb46-1417" aria-hidden="true" tabindex="-1"></a>    .T.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-1418"><a href="#cb46-1418" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1419"><a href="#cb46-1419" aria-hidden="true" tabindex="-1"></a>agency_summary</span>
<span id="cb46-1420"><a href="#cb46-1420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1421"><a href="#cb46-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1422"><a href="#cb46-1422" aria-hidden="true" tabindex="-1"></a><span class="fu">### Agency Costs and Firm Value</span></span>
<span id="cb46-1423"><a href="#cb46-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1424"><a href="#cb46-1424" aria-hidden="true" tabindex="-1"></a>We test whether agency cost proxies are associated with firm value (Tobin's $Q$) and operating performance (ROA), controlling for standard determinants:</span>
<span id="cb46-1425"><a href="#cb46-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1426"><a href="#cb46-1426" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-1427"><a href="#cb46-1427" aria-hidden="true" tabindex="-1"></a>Q_{i,t} = \beta_0 + \beta_1 \text{Own}_{i,t} + \beta_2 \text{Own}_{i,t}^2 + \boldsymbol{\gamma}'\mathbf{X}_{i,t} + \alpha_i + \delta_t + \varepsilon_{i,t}</span>
<span id="cb46-1428"><a href="#cb46-1428" aria-hidden="true" tabindex="-1"></a>$$ {#eq-agency-valuation}</span>
<span id="cb46-1429"><a href="#cb46-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1430"><a href="#cb46-1430" aria-hidden="true" tabindex="-1"></a>The quadratic in ownership captures the @morck1988management nonlinearity: at low levels, managerial ownership aligns incentives (positive effect on $Q$); at high levels, entrenchment dominates (negative effect).</span>
<span id="cb46-1431"><a href="#cb46-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1434"><a href="#cb46-1434" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1435"><a href="#cb46-1435" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: agency-valuation</span></span>
<span id="cb46-1436"><a href="#cb46-1436" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1437"><a href="#cb46-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1438"><a href="#cb46-1438" aria-hidden="true" tabindex="-1"></a><span class="co"># Agency cost and valuation regression</span></span>
<span id="cb46-1439"><a href="#cb46-1439" aria-hidden="true" tabindex="-1"></a>agency[<span class="st">"largest_sq"</span>] <span class="op">=</span> agency[<span class="st">"largest_shareholder_pct"</span>]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb46-1440"><a href="#cb46-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1441"><a href="#cb46-1441" aria-hidden="true" tabindex="-1"></a>val_data <span class="op">=</span> agency.dropna(</span>
<span id="cb46-1442"><a href="#cb46-1442" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"tobins_q"</span>, <span class="st">"largest_shareholder_pct"</span>, <span class="st">"foreign_ownership_pct"</span>,</span>
<span id="cb46-1443"><a href="#cb46-1443" aria-hidden="true" tabindex="-1"></a>            <span class="st">"fcf"</span>, <span class="st">"size"</span>, <span class="st">"profitability"</span>, <span class="st">"leverage"</span>]</span>
<span id="cb46-1444"><a href="#cb46-1444" aria-hidden="true" tabindex="-1"></a>).copy()</span>
<span id="cb46-1445"><a href="#cb46-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1446"><a href="#cb46-1446" aria-hidden="true" tabindex="-1"></a>val_panel <span class="op">=</span> val_data.set_index([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-1447"><a href="#cb46-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1448"><a href="#cb46-1448" aria-hidden="true" tabindex="-1"></a>model_val <span class="op">=</span> PanelOLS(</span>
<span id="cb46-1449"><a href="#cb46-1449" aria-hidden="true" tabindex="-1"></a>    val_panel[<span class="st">"tobins_q"</span>],</span>
<span id="cb46-1450"><a href="#cb46-1450" aria-hidden="true" tabindex="-1"></a>    val_panel[[<span class="st">"largest_shareholder_pct"</span>, <span class="st">"largest_sq"</span>,</span>
<span id="cb46-1451"><a href="#cb46-1451" aria-hidden="true" tabindex="-1"></a>               <span class="st">"foreign_ownership_pct"</span>, <span class="st">"fcf"</span>,</span>
<span id="cb46-1452"><a href="#cb46-1452" aria-hidden="true" tabindex="-1"></a>               <span class="st">"size"</span>, <span class="st">"profitability"</span>, <span class="st">"leverage"</span>]],</span>
<span id="cb46-1453"><a href="#cb46-1453" aria-hidden="true" tabindex="-1"></a>    entity_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-1454"><a href="#cb46-1454" aria-hidden="true" tabindex="-1"></a>    time_effects<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-1455"><a href="#cb46-1455" aria-hidden="true" tabindex="-1"></a>    check_rank<span class="op">=</span><span class="va">False</span></span>
<span id="cb46-1456"><a href="#cb46-1456" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"clustered"</span>, cluster_entity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-1457"><a href="#cb46-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1458"><a href="#cb46-1458" aria-hidden="true" tabindex="-1"></a>val_panel <span class="op">=</span> val_panel.reset_index()</span>
<span id="cb46-1459"><a href="#cb46-1459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1460"><a href="#cb46-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1463"><a href="#cb46-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1464"><a href="#cb46-1464" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-agency-valuation</span></span>
<span id="cb46-1465"><a href="#cb46-1465" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Agency Proxies and Firm Value (Tobin's Q)"</span></span>
<span id="cb46-1466"><a href="#cb46-1466" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1467"><a href="#cb46-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1468"><a href="#cb46-1468" aria-hidden="true" tabindex="-1"></a>val_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-1469"><a href="#cb46-1469" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Coefficient"</span>: model_val.params.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-1470"><a href="#cb46-1470" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Std Error"</span>: model_val.std_errors.<span class="bu">round</span>(<span class="dv">4</span>),</span>
<span id="cb46-1471"><a href="#cb46-1471" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t-stat"</span>: model_val.tstats.<span class="bu">round</span>(<span class="dv">3</span>),</span>
<span id="cb46-1472"><a href="#cb46-1472" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p-value"</span>: model_val.pvalues.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-1473"><a href="#cb46-1473" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-1474"><a href="#cb46-1474" aria-hidden="true" tabindex="-1"></a>val_results</span>
<span id="cb46-1475"><a href="#cb46-1475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1476"><a href="#cb46-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1479"><a href="#cb46-1479" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1480"><a href="#cb46-1480" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ownership-q</span></span>
<span id="cb46-1481"><a href="#cb46-1481" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1482"><a href="#cb46-1482" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Nonlinear Relationship Between Ownership Concentration and Firm Value"</span></span>
<span id="cb46-1483"><a href="#cb46-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1484"><a href="#cb46-1484" aria-hidden="true" tabindex="-1"></a><span class="co"># Binned scatter: largest shareholder vs Q</span></span>
<span id="cb46-1485"><a href="#cb46-1485" aria-hidden="true" tabindex="-1"></a>own_bins <span class="op">=</span> val_data.copy()</span>
<span id="cb46-1486"><a href="#cb46-1486" aria-hidden="true" tabindex="-1"></a>own_bins[<span class="st">"own_bin"</span>] <span class="op">=</span> pd.qcut(</span>
<span id="cb46-1487"><a href="#cb46-1487" aria-hidden="true" tabindex="-1"></a>    own_bins[<span class="st">"largest_shareholder_pct"</span>], q<span class="op">=</span><span class="dv">20</span>, duplicates<span class="op">=</span><span class="st">"drop"</span></span>
<span id="cb46-1488"><a href="#cb46-1488" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1489"><a href="#cb46-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1490"><a href="#cb46-1490" aria-hidden="true" tabindex="-1"></a>own_binned <span class="op">=</span> (</span>
<span id="cb46-1491"><a href="#cb46-1491" aria-hidden="true" tabindex="-1"></a>    own_bins.groupby(<span class="st">"own_bin"</span>, observed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-1492"><a href="#cb46-1492" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb46-1493"><a href="#cb46-1493" aria-hidden="true" tabindex="-1"></a>        mean_own<span class="op">=</span>(<span class="st">"largest_shareholder_pct"</span>, <span class="st">"mean"</span>),</span>
<span id="cb46-1494"><a href="#cb46-1494" aria-hidden="true" tabindex="-1"></a>        mean_q<span class="op">=</span>(<span class="st">"tobins_q"</span>, <span class="st">"mean"</span>),</span>
<span id="cb46-1495"><a href="#cb46-1495" aria-hidden="true" tabindex="-1"></a>        se_q<span class="op">=</span>(<span class="st">"tobins_q"</span>, <span class="kw">lambda</span> x: x.std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(x)))</span>
<span id="cb46-1496"><a href="#cb46-1496" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1497"><a href="#cb46-1497" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb46-1498"><a href="#cb46-1498" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1499"><a href="#cb46-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1500"><a href="#cb46-1500" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb46-1501"><a href="#cb46-1501" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(own_binned, p9.aes(x<span class="op">=</span><span class="st">"mean_own"</span>, y<span class="op">=</span><span class="st">"mean_q"</span>))</span>
<span id="cb46-1502"><a href="#cb46-1502" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_pointrange(</span>
<span id="cb46-1503"><a href="#cb46-1503" aria-hidden="true" tabindex="-1"></a>        p9.aes(ymin<span class="op">=</span><span class="st">"mean_q - 1.96*se_q"</span>,</span>
<span id="cb46-1504"><a href="#cb46-1504" aria-hidden="true" tabindex="-1"></a>               ymax<span class="op">=</span><span class="st">"mean_q + 1.96*se_q"</span>),</span>
<span id="cb46-1505"><a href="#cb46-1505" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"#2E5090"</span>, size<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb46-1506"><a href="#cb46-1506" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1507"><a href="#cb46-1507" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_smooth(method<span class="op">=</span><span class="st">"loess"</span>, color<span class="op">=</span><span class="st">"#C0392B"</span>, se<span class="op">=</span><span class="va">False</span>, size<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb46-1508"><a href="#cb46-1508" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb46-1509"><a href="#cb46-1509" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Largest Shareholder Ownership (%)"</span>,</span>
<span id="cb46-1510"><a href="#cb46-1510" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Tobin's Q"</span>,</span>
<span id="cb46-1511"><a href="#cb46-1511" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Ownership Concentration and Firm Value"</span></span>
<span id="cb46-1512"><a href="#cb46-1512" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1513"><a href="#cb46-1513" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb46-1514"><a href="#cb46-1514" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb46-1515"><a href="#cb46-1515" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1516"><a href="#cb46-1516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1517"><a href="#cb46-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1518"><a href="#cb46-1518" aria-hidden="true" tabindex="-1"></a>The inverted-U pattern, if present, would be consistent with the Morck-Shleifer-Vishny incentive-alignment/entrenchment tradeoff. In Vietnamese markets, the pattern may differ because the dominant controlling shareholder is often the state, whose objective function includes non-value-maximizing goals (employment, regional development, strategic sector control).</span>
<span id="cb46-1519"><a href="#cb46-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1520"><a href="#cb46-1520" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linking Corporate Decisions to Returns</span></span>
<span id="cb46-1521"><a href="#cb46-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1522"><a href="#cb46-1522" aria-hidden="true" tabindex="-1"></a><span class="fu">### Investment-Based Anomalies</span></span>
<span id="cb46-1523"><a href="#cb46-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1524"><a href="#cb46-1524" aria-hidden="true" tabindex="-1"></a>The asset pricing literature has documented that corporate investment decisions predict cross-sectional return differences (i.e., the "investment anomalies"). The theoretical foundation is the $q$-theory of investment applied to asset pricing <span class="co">[</span><span class="ot">@cochrane1991production; @liu2009investment</span><span class="co">]</span>: firms invest more when the discount rate on their projects is lower. High investment therefore signals low expected returns.</span>
<span id="cb46-1525"><a href="#cb46-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1526"><a href="#cb46-1526" aria-hidden="true" tabindex="-1"></a>**The investment effect.** @titman2004capital and @cooper2008asset document that firms with high asset growth earn lower subsequent returns. The asset growth variable is:</span>
<span id="cb46-1527"><a href="#cb46-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1528"><a href="#cb46-1528" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-1529"><a href="#cb46-1529" aria-hidden="true" tabindex="-1"></a>\text{AG}_{i,t} = \frac{A_{i,t} - A_{i,t-1}}{A_{i,t-1}}</span>
<span id="cb46-1530"><a href="#cb46-1530" aria-hidden="true" tabindex="-1"></a>$$ {#eq-asset-growth}</span>
<span id="cb46-1531"><a href="#cb46-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1532"><a href="#cb46-1532" aria-hidden="true" tabindex="-1"></a>**The investment-to-assets effect.** @fama2006profitability and @hou2015digesting show that capital expenditure scaled by assets negatively predicts returns.</span>
<span id="cb46-1533"><a href="#cb46-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1534"><a href="#cb46-1534" aria-hidden="true" tabindex="-1"></a>**The profitability effect.** @novy2013other shows that gross profitability (revenue minus COGS, scaled by assets) positively predicts returns. This is consistent with $q$-theory: controlling for investment, more profitable firms must have higher discount rates (otherwise they would invest more).</span>
<span id="cb46-1535"><a href="#cb46-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1538"><a href="#cb46-1538" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1539"><a href="#cb46-1539" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: investment-anomalies</span></span>
<span id="cb46-1540"><a href="#cb46-1540" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1541"><a href="#cb46-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1542"><a href="#cb46-1542" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct anomaly variables</span></span>
<span id="cb46-1543"><a href="#cb46-1543" aria-hidden="true" tabindex="-1"></a>anomaly <span class="op">=</span> panel_fc.copy().sort_values([<span class="st">"ticker"</span>, <span class="st">"year"</span>])</span>
<span id="cb46-1544"><a href="#cb46-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1545"><a href="#cb46-1545" aria-hidden="true" tabindex="-1"></a><span class="co"># Asset growth</span></span>
<span id="cb46-1546"><a href="#cb46-1546" aria-hidden="true" tabindex="-1"></a>anomaly[<span class="st">"asset_growth"</span>] <span class="op">=</span> (</span>
<span id="cb46-1547"><a href="#cb46-1547" aria-hidden="true" tabindex="-1"></a>    (anomaly[<span class="st">"total_assets"</span>] <span class="op">-</span> anomaly[<span class="st">"lag_assets"</span>]) <span class="op">/</span></span>
<span id="cb46-1548"><a href="#cb46-1548" aria-hidden="true" tabindex="-1"></a>    anomaly[<span class="st">"lag_assets"</span>]</span>
<span id="cb46-1549"><a href="#cb46-1549" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1550"><a href="#cb46-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1551"><a href="#cb46-1551" aria-hidden="true" tabindex="-1"></a><span class="co"># Investment-to-assets</span></span>
<span id="cb46-1552"><a href="#cb46-1552" aria-hidden="true" tabindex="-1"></a>anomaly[<span class="st">"inv_to_assets"</span>] <span class="op">=</span> anomaly[<span class="st">"capex"</span>] <span class="op">/</span> anomaly[<span class="st">"lag_assets"</span>]</span>
<span id="cb46-1553"><a href="#cb46-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1554"><a href="#cb46-1554" aria-hidden="true" tabindex="-1"></a><span class="co"># Gross profitability</span></span>
<span id="cb46-1555"><a href="#cb46-1555" aria-hidden="true" tabindex="-1"></a>anomaly[<span class="st">"gross_profit"</span>] <span class="op">=</span> (</span>
<span id="cb46-1556"><a href="#cb46-1556" aria-hidden="true" tabindex="-1"></a>    (anomaly[<span class="st">"revenue"</span>] <span class="op">-</span> anomaly[<span class="st">"cogs"</span>]) <span class="op">/</span> anomaly[<span class="st">"total_assets"</span>]</span>
<span id="cb46-1557"><a href="#cb46-1557" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1558"><a href="#cb46-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1559"><a href="#cb46-1559" aria-hidden="true" tabindex="-1"></a><span class="co"># ROE</span></span>
<span id="cb46-1560"><a href="#cb46-1560" aria-hidden="true" tabindex="-1"></a>anomaly[<span class="st">"roe"</span>] <span class="op">=</span> anomaly[<span class="st">"net_income"</span>] <span class="op">/</span> anomaly[<span class="st">"book_equity"</span>]</span>
<span id="cb46-1561"><a href="#cb46-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1562"><a href="#cb46-1562" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsorize</span></span>
<span id="cb46-1563"><a href="#cb46-1563" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"asset_growth"</span>, <span class="st">"inv_to_assets"</span>, <span class="st">"gross_profit"</span>, <span class="st">"roe"</span>]:</span>
<span id="cb46-1564"><a href="#cb46-1564" aria-hidden="true" tabindex="-1"></a>    anomaly[col] <span class="op">=</span> winsorize(anomaly[col])</span>
<span id="cb46-1565"><a href="#cb46-1565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1566"><a href="#cb46-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1569"><a href="#cb46-1569" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1570"><a href="#cb46-1570" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: portfolio-sorts-investment</span></span>
<span id="cb46-1571"><a href="#cb46-1571" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1572"><a href="#cb46-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1573"><a href="#cb46-1573" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio sorts: quintiles on asset growth</span></span>
<span id="cb46-1574"><a href="#cb46-1574" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with monthly returns (using June rebalancing)</span></span>
<span id="cb46-1575"><a href="#cb46-1575" aria-hidden="true" tabindex="-1"></a>anomaly_june <span class="op">=</span> anomaly.copy()</span>
<span id="cb46-1576"><a href="#cb46-1576" aria-hidden="true" tabindex="-1"></a>anomaly_june[<span class="st">"formation_year"</span>] <span class="op">=</span> anomaly_june[<span class="st">"year"</span>]</span>
<span id="cb46-1577"><a href="#cb46-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1578"><a href="#cb46-1578" aria-hidden="true" tabindex="-1"></a><span class="co"># Create quintile assignments</span></span>
<span id="cb46-1579"><a href="#cb46-1579" aria-hidden="true" tabindex="-1"></a>anomaly_june[<span class="st">"ag_quintile"</span>] <span class="op">=</span> anomaly_june.groupby(<span class="st">"year"</span>)[</span>
<span id="cb46-1580"><a href="#cb46-1580" aria-hidden="true" tabindex="-1"></a>    <span class="st">"asset_growth"</span></span>
<span id="cb46-1581"><a href="#cb46-1581" aria-hidden="true" tabindex="-1"></a>].transform(<span class="kw">lambda</span> x: pd.qcut(x, <span class="dv">5</span>, labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb46-1582"><a href="#cb46-1582" aria-hidden="true" tabindex="-1"></a>                                duplicates<span class="op">=</span><span class="st">"drop"</span>))</span>
<span id="cb46-1583"><a href="#cb46-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1584"><a href="#cb46-1584" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with forward returns</span></span>
<span id="cb46-1585"><a href="#cb46-1585" aria-hidden="true" tabindex="-1"></a>monthly_with_signal <span class="op">=</span> monthly_returns.copy()</span>
<span id="cb46-1586"><a href="#cb46-1586" aria-hidden="true" tabindex="-1"></a>monthly_with_signal[<span class="st">"formation_year"</span>] <span class="op">=</span> np.where(</span>
<span id="cb46-1587"><a href="#cb46-1587" aria-hidden="true" tabindex="-1"></a>    monthly_with_signal[<span class="st">"date"</span>].dt.month <span class="op">&gt;=</span> <span class="dv">7</span>,</span>
<span id="cb46-1588"><a href="#cb46-1588" aria-hidden="true" tabindex="-1"></a>    monthly_with_signal[<span class="st">"date"</span>].dt.year,</span>
<span id="cb46-1589"><a href="#cb46-1589" aria-hidden="true" tabindex="-1"></a>    monthly_with_signal[<span class="st">"date"</span>].dt.year <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb46-1590"><a href="#cb46-1590" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1591"><a href="#cb46-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1592"><a href="#cb46-1592" aria-hidden="true" tabindex="-1"></a>portfolios <span class="op">=</span> monthly_with_signal.merge(</span>
<span id="cb46-1593"><a href="#cb46-1593" aria-hidden="true" tabindex="-1"></a>    anomaly_june[[<span class="st">"ticker"</span>, <span class="st">"formation_year"</span>, <span class="st">"ag_quintile"</span>,</span>
<span id="cb46-1594"><a href="#cb46-1594" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"asset_growth"</span>, <span class="st">"gross_profit"</span>]],</span>
<span id="cb46-1595"><a href="#cb46-1595" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"formation_year"</span>],</span>
<span id="cb46-1596"><a href="#cb46-1596" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb46-1597"><a href="#cb46-1597" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1598"><a href="#cb46-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1599"><a href="#cb46-1599" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute equal-weighted quintile returns</span></span>
<span id="cb46-1600"><a href="#cb46-1600" aria-hidden="true" tabindex="-1"></a>ag_returns <span class="op">=</span> (</span>
<span id="cb46-1601"><a href="#cb46-1601" aria-hidden="true" tabindex="-1"></a>    portfolios.groupby([<span class="st">"date"</span>, <span class="st">"ag_quintile"</span>])</span>
<span id="cb46-1602"><a href="#cb46-1602" aria-hidden="true" tabindex="-1"></a>    .agg(port_ret<span class="op">=</span>(<span class="st">"ret"</span>, <span class="st">"mean"</span>))</span>
<span id="cb46-1603"><a href="#cb46-1603" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb46-1604"><a href="#cb46-1604" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1605"><a href="#cb46-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1606"><a href="#cb46-1606" aria-hidden="true" tabindex="-1"></a><span class="co"># Long-short: Q1 (low growth) - Q5 (high growth)</span></span>
<span id="cb46-1607"><a href="#cb46-1607" aria-hidden="true" tabindex="-1"></a>ag_wide <span class="op">=</span> ag_returns.pivot(</span>
<span id="cb46-1608"><a href="#cb46-1608" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"date"</span>, columns<span class="op">=</span><span class="st">"ag_quintile"</span>, values<span class="op">=</span><span class="st">"port_ret"</span></span>
<span id="cb46-1609"><a href="#cb46-1609" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1610"><a href="#cb46-1610" aria-hidden="true" tabindex="-1"></a>ag_wide[<span class="st">"L-S"</span>] <span class="op">=</span> ag_wide[<span class="dv">1</span>] <span class="op">-</span> ag_wide[<span class="dv">5</span>]</span>
<span id="cb46-1611"><a href="#cb46-1611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1612"><a href="#cb46-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1615"><a href="#cb46-1615" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1616"><a href="#cb46-1616" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-investment-anomaly</span></span>
<span id="cb46-1617"><a href="#cb46-1617" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1618"><a href="#cb46-1618" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Asset Growth Quintile Portfolio Returns"</span></span>
<span id="cb46-1619"><a href="#cb46-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1620"><a href="#cb46-1620" aria-hidden="true" tabindex="-1"></a>quintile_summary <span class="op">=</span> ag_wide.describe().T[[<span class="st">"mean"</span>, <span class="st">"std"</span>]].copy()</span>
<span id="cb46-1621"><a href="#cb46-1621" aria-hidden="true" tabindex="-1"></a>quintile_summary[<span class="st">"mean_ann"</span>] <span class="op">=</span> quintile_summary[<span class="st">"mean"</span>] <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb46-1622"><a href="#cb46-1622" aria-hidden="true" tabindex="-1"></a>quintile_summary[<span class="st">"std_ann"</span>] <span class="op">=</span> quintile_summary[<span class="st">"std"</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>)</span>
<span id="cb46-1623"><a href="#cb46-1623" aria-hidden="true" tabindex="-1"></a>quintile_summary[<span class="st">"sharpe"</span>] <span class="op">=</span> (</span>
<span id="cb46-1624"><a href="#cb46-1624" aria-hidden="true" tabindex="-1"></a>    quintile_summary[<span class="st">"mean_ann"</span>] <span class="op">/</span> quintile_summary[<span class="st">"std_ann"</span>]</span>
<span id="cb46-1625"><a href="#cb46-1625" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1626"><a href="#cb46-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1627"><a href="#cb46-1627" aria-hidden="true" tabindex="-1"></a><span class="co"># t-statistics</span></span>
<span id="cb46-1628"><a href="#cb46-1628" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> ag_wide.columns:</span>
<span id="cb46-1629"><a href="#cb46-1629" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="op">=</span> ag_wide[col].mean() <span class="op">/</span> (ag_wide[col].std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(ag_wide)))</span>
<span id="cb46-1630"><a href="#cb46-1630" aria-hidden="true" tabindex="-1"></a>    quintile_summary.loc[col, <span class="st">"t_stat"</span>] <span class="op">=</span> t_stat</span>
<span id="cb46-1631"><a href="#cb46-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1632"><a href="#cb46-1632" aria-hidden="true" tabindex="-1"></a>quintile_summary <span class="op">=</span> quintile_summary[</span>
<span id="cb46-1633"><a href="#cb46-1633" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"mean_ann"</span>, <span class="st">"std_ann"</span>, <span class="st">"sharpe"</span>, <span class="st">"t_stat"</span>]</span>
<span id="cb46-1634"><a href="#cb46-1634" aria-hidden="true" tabindex="-1"></a>].<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-1635"><a href="#cb46-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1636"><a href="#cb46-1636" aria-hidden="true" tabindex="-1"></a>quintile_summary.columns <span class="op">=</span> [</span>
<span id="cb46-1637"><a href="#cb46-1637" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ann. Return"</span>, <span class="st">"Ann. Vol"</span>, <span class="st">"Sharpe Ratio"</span>, <span class="st">"t-stat"</span></span>
<span id="cb46-1638"><a href="#cb46-1638" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb46-1639"><a href="#cb46-1639" aria-hidden="true" tabindex="-1"></a>quintile_summary</span>
<span id="cb46-1640"><a href="#cb46-1640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1641"><a href="#cb46-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1644"><a href="#cb46-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1645"><a href="#cb46-1645" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ag-cumulative</span></span>
<span id="cb46-1646"><a href="#cb46-1646" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1647"><a href="#cb46-1647" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Cumulative Returns: Low vs. High Asset Growth Quintiles"</span></span>
<span id="cb46-1648"><a href="#cb46-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1649"><a href="#cb46-1649" aria-hidden="true" tabindex="-1"></a>cumret <span class="op">=</span> ag_wide[[<span class="st">"L-S"</span>]].copy()</span>
<span id="cb46-1650"><a href="#cb46-1650" aria-hidden="true" tabindex="-1"></a>cumret.columns <span class="op">=</span> [<span class="st">"Long-Short"</span>]</span>
<span id="cb46-1651"><a href="#cb46-1651" aria-hidden="true" tabindex="-1"></a>cumret <span class="op">=</span> cumret.dropna()</span>
<span id="cb46-1652"><a href="#cb46-1652" aria-hidden="true" tabindex="-1"></a>cumret[<span class="st">"cumulative"</span>] <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> cumret[<span class="st">"Long-Short"</span>]).cumprod()</span>
<span id="cb46-1653"><a href="#cb46-1653" aria-hidden="true" tabindex="-1"></a>cumret <span class="op">=</span> cumret.reset_index()</span>
<span id="cb46-1654"><a href="#cb46-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1655"><a href="#cb46-1655" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb46-1656"><a href="#cb46-1656" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(cumret, p9.aes(x<span class="op">=</span><span class="st">"date"</span>, y<span class="op">=</span><span class="st">"cumulative"</span>))</span>
<span id="cb46-1657"><a href="#cb46-1657" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line(color<span class="op">=</span><span class="st">"#2E5090"</span>, size<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb46-1658"><a href="#cb46-1658" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_hline(yintercept<span class="op">=</span><span class="dv">1</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, color<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb46-1659"><a href="#cb46-1659" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb46-1660"><a href="#cb46-1660" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb46-1661"><a href="#cb46-1661" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Cumulative Return (Growth of $1)"</span>,</span>
<span id="cb46-1662"><a href="#cb46-1662" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Investment Anomaly: Low – High Asset Growth"</span></span>
<span id="cb46-1663"><a href="#cb46-1663" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1664"><a href="#cb46-1664" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb46-1665"><a href="#cb46-1665" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb46-1666"><a href="#cb46-1666" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1667"><a href="#cb46-1667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1668"><a href="#cb46-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1669"><a href="#cb46-1669" aria-hidden="true" tabindex="-1"></a><span class="fu">### Financing Anomalies</span></span>
<span id="cb46-1670"><a href="#cb46-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1671"><a href="#cb46-1671" aria-hidden="true" tabindex="-1"></a>Firms' financing decisions also predict returns. @pontiff2008share document that net stock issuance negatively predicts returns: firms that issue equity earn lower future returns, while firms that repurchase shares earn higher returns. This is consistent with both managerial market timing and an issuance-based risk factor.</span>
<span id="cb46-1672"><a href="#cb46-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1673"><a href="#cb46-1673" aria-hidden="true" tabindex="-1"></a>The net stock issuance variable is typically measured as:</span>
<span id="cb46-1674"><a href="#cb46-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1675"><a href="#cb46-1675" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-1676"><a href="#cb46-1676" aria-hidden="true" tabindex="-1"></a>\text{NSI}_{i,t} = \ln\left(\frac{\text{Split-Adjusted Shares}_{i,t}}{\text{Split-Adjusted Shares}_{i,t-1}}\right)</span>
<span id="cb46-1677"><a href="#cb46-1677" aria-hidden="true" tabindex="-1"></a>$$ {#eq-nsi}</span>
<span id="cb46-1678"><a href="#cb46-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1679"><a href="#cb46-1679" aria-hidden="true" tabindex="-1"></a>Positive NSI indicates net equity issuance; negative NSI indicates net repurchases.</span>
<span id="cb46-1680"><a href="#cb46-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1683"><a href="#cb46-1683" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1684"><a href="#cb46-1684" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: financing-anomaly</span></span>
<span id="cb46-1685"><a href="#cb46-1685" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1686"><a href="#cb46-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1687"><a href="#cb46-1687" aria-hidden="true" tabindex="-1"></a><span class="co"># Net Stock Issuance</span></span>
<span id="cb46-1688"><a href="#cb46-1688" aria-hidden="true" tabindex="-1"></a>fin_anomaly <span class="op">=</span> anomaly.copy()</span>
<span id="cb46-1689"><a href="#cb46-1689" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"lag_shares"</span>] <span class="op">=</span> fin_anomaly.groupby(</span>
<span id="cb46-1690"><a href="#cb46-1690" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ticker"</span></span>
<span id="cb46-1691"><a href="#cb46-1691" aria-hidden="true" tabindex="-1"></a>)[<span class="st">"shares_outstanding"</span>].shift(<span class="dv">1</span>)</span>
<span id="cb46-1692"><a href="#cb46-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1693"><a href="#cb46-1693" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"nsi"</span>] <span class="op">=</span> np.log(</span>
<span id="cb46-1694"><a href="#cb46-1694" aria-hidden="true" tabindex="-1"></a>    fin_anomaly[<span class="st">"shares_outstanding"</span>] <span class="op">/</span> fin_anomaly[<span class="st">"lag_shares"</span>]</span>
<span id="cb46-1695"><a href="#cb46-1695" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1696"><a href="#cb46-1696" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"nsi"</span>] <span class="op">=</span> winsorize(fin_anomaly[<span class="st">"nsi"</span>])</span>
<span id="cb46-1697"><a href="#cb46-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1698"><a href="#cb46-1698" aria-hidden="true" tabindex="-1"></a><span class="co"># Net debt issuance (change in total debt / assets)</span></span>
<span id="cb46-1699"><a href="#cb46-1699" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"ndi"</span>] <span class="op">=</span> (</span>
<span id="cb46-1700"><a href="#cb46-1700" aria-hidden="true" tabindex="-1"></a>    (fin_anomaly[<span class="st">"total_debt"</span>] <span class="op">-</span></span>
<span id="cb46-1701"><a href="#cb46-1701" aria-hidden="true" tabindex="-1"></a>     fin_anomaly.groupby(<span class="st">"ticker"</span>)[<span class="st">"total_debt"</span>].shift(<span class="dv">1</span>)) <span class="op">/</span></span>
<span id="cb46-1702"><a href="#cb46-1702" aria-hidden="true" tabindex="-1"></a>    fin_anomaly[<span class="st">"lag_assets"</span>]</span>
<span id="cb46-1703"><a href="#cb46-1703" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1704"><a href="#cb46-1704" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"ndi"</span>] <span class="op">=</span> winsorize(fin_anomaly[<span class="st">"ndi"</span>])</span>
<span id="cb46-1705"><a href="#cb46-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1706"><a href="#cb46-1706" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio sorts on NSI</span></span>
<span id="cb46-1707"><a href="#cb46-1707" aria-hidden="true" tabindex="-1"></a>fin_anomaly[<span class="st">"nsi_quintile"</span>] <span class="op">=</span> fin_anomaly.groupby(<span class="st">"year"</span>)[</span>
<span id="cb46-1708"><a href="#cb46-1708" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nsi"</span></span>
<span id="cb46-1709"><a href="#cb46-1709" aria-hidden="true" tabindex="-1"></a>].transform(<span class="kw">lambda</span> x: pd.qcut(x, <span class="dv">5</span>, labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb46-1710"><a href="#cb46-1710" aria-hidden="true" tabindex="-1"></a>                                duplicates<span class="op">=</span><span class="st">"drop"</span>))</span>
<span id="cb46-1711"><a href="#cb46-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1712"><a href="#cb46-1712" aria-hidden="true" tabindex="-1"></a>port_nsi <span class="op">=</span> monthly_with_signal.merge(</span>
<span id="cb46-1713"><a href="#cb46-1713" aria-hidden="true" tabindex="-1"></a>    fin_anomaly[[<span class="st">"ticker"</span>, <span class="st">"formation_year"</span>, <span class="st">"nsi_quintile"</span>]],</span>
<span id="cb46-1714"><a href="#cb46-1714" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"ticker"</span>, <span class="st">"formation_year"</span>],</span>
<span id="cb46-1715"><a href="#cb46-1715" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb46-1716"><a href="#cb46-1716" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1717"><a href="#cb46-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1718"><a href="#cb46-1718" aria-hidden="true" tabindex="-1"></a>nsi_returns <span class="op">=</span> (</span>
<span id="cb46-1719"><a href="#cb46-1719" aria-hidden="true" tabindex="-1"></a>    port_nsi.groupby([<span class="st">"date"</span>, <span class="st">"nsi_quintile"</span>])</span>
<span id="cb46-1720"><a href="#cb46-1720" aria-hidden="true" tabindex="-1"></a>    .agg(port_ret<span class="op">=</span>(<span class="st">"ret"</span>, <span class="st">"mean"</span>))</span>
<span id="cb46-1721"><a href="#cb46-1721" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb46-1722"><a href="#cb46-1722" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1723"><a href="#cb46-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1724"><a href="#cb46-1724" aria-hidden="true" tabindex="-1"></a>nsi_wide <span class="op">=</span> nsi_returns.pivot(</span>
<span id="cb46-1725"><a href="#cb46-1725" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"date"</span>, columns<span class="op">=</span><span class="st">"nsi_quintile"</span>, values<span class="op">=</span><span class="st">"port_ret"</span></span>
<span id="cb46-1726"><a href="#cb46-1726" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1727"><a href="#cb46-1727" aria-hidden="true" tabindex="-1"></a>nsi_wide[<span class="st">"L-S"</span>] <span class="op">=</span> nsi_wide[<span class="dv">1</span>] <span class="op">-</span> nsi_wide[<span class="dv">5</span>]</span>
<span id="cb46-1728"><a href="#cb46-1728" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1729"><a href="#cb46-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1732"><a href="#cb46-1732" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1733"><a href="#cb46-1733" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-nsi-anomaly</span></span>
<span id="cb46-1734"><a href="#cb46-1734" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1735"><a href="#cb46-1735" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Net Stock Issuance Quintile Portfolio Returns"</span></span>
<span id="cb46-1736"><a href="#cb46-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1737"><a href="#cb46-1737" aria-hidden="true" tabindex="-1"></a>nsi_summary <span class="op">=</span> nsi_wide.describe().T[[<span class="st">"mean"</span>, <span class="st">"std"</span>]].copy()</span>
<span id="cb46-1738"><a href="#cb46-1738" aria-hidden="true" tabindex="-1"></a>nsi_summary[<span class="st">"mean_ann"</span>] <span class="op">=</span> nsi_summary[<span class="st">"mean"</span>] <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb46-1739"><a href="#cb46-1739" aria-hidden="true" tabindex="-1"></a>nsi_summary[<span class="st">"sharpe"</span>] <span class="op">=</span> (</span>
<span id="cb46-1740"><a href="#cb46-1740" aria-hidden="true" tabindex="-1"></a>    nsi_summary[<span class="st">"mean_ann"</span>] <span class="op">/</span></span>
<span id="cb46-1741"><a href="#cb46-1741" aria-hidden="true" tabindex="-1"></a>    (nsi_summary[<span class="st">"std"</span>] <span class="op">*</span> np.sqrt(<span class="dv">12</span>))</span>
<span id="cb46-1742"><a href="#cb46-1742" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1743"><a href="#cb46-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1744"><a href="#cb46-1744" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> nsi_wide.columns:</span>
<span id="cb46-1745"><a href="#cb46-1745" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="op">=</span> nsi_wide[col].mean() <span class="op">/</span> (</span>
<span id="cb46-1746"><a href="#cb46-1746" aria-hidden="true" tabindex="-1"></a>        nsi_wide[col].std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(nsi_wide))</span>
<span id="cb46-1747"><a href="#cb46-1747" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1748"><a href="#cb46-1748" aria-hidden="true" tabindex="-1"></a>    nsi_summary.loc[col, <span class="st">"t_stat"</span>] <span class="op">=</span> t_stat</span>
<span id="cb46-1749"><a href="#cb46-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1750"><a href="#cb46-1750" aria-hidden="true" tabindex="-1"></a>nsi_summary <span class="op">=</span> nsi_summary[[<span class="st">"mean_ann"</span>, <span class="st">"sharpe"</span>, <span class="st">"t_stat"</span>]].<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb46-1751"><a href="#cb46-1751" aria-hidden="true" tabindex="-1"></a>nsi_summary.columns <span class="op">=</span> [<span class="st">"Ann. Return"</span>, <span class="st">"Sharpe"</span>, <span class="st">"t-stat"</span>]</span>
<span id="cb46-1752"><a href="#cb46-1752" aria-hidden="true" tabindex="-1"></a>nsi_summary</span>
<span id="cb46-1753"><a href="#cb46-1753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1754"><a href="#cb46-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1755"><a href="#cb46-1755" aria-hidden="true" tabindex="-1"></a><span class="fu">### Valuation Implications: Fama-French Factor Regressions</span></span>
<span id="cb46-1756"><a href="#cb46-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1757"><a href="#cb46-1757" aria-hidden="true" tabindex="-1"></a>We evaluate whether the investment and financing anomalies represent compensation for systematic risk by regressing the long-short portfolios on standard factor models:</span>
<span id="cb46-1758"><a href="#cb46-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1759"><a href="#cb46-1759" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-1760"><a href="#cb46-1760" aria-hidden="true" tabindex="-1"></a>R_{p,t} - R_{f,t} = \alpha + \beta_{\text{MKT}} \text{MKT}_t + \beta_{\text{SMB}} \text{SMB}_t + \beta_{\text{HML}} \text{HML}_t + \varepsilon_t</span>
<span id="cb46-1761"><a href="#cb46-1761" aria-hidden="true" tabindex="-1"></a>$$ {#eq-factor-regression}</span>
<span id="cb46-1762"><a href="#cb46-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1763"><a href="#cb46-1763" aria-hidden="true" tabindex="-1"></a>Significant positive $\alpha$ after controlling for known risk factors would indicate that the anomaly is not explained by size and value exposures.</span>
<span id="cb46-1764"><a href="#cb46-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1767"><a href="#cb46-1767" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1768"><a href="#cb46-1768" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: factor-regressions</span></span>
<span id="cb46-1769"><a href="#cb46-1769" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1770"><a href="#cb46-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1771"><a href="#cb46-1771" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge long-short returns with factor data</span></span>
<span id="cb46-1772"><a href="#cb46-1772" aria-hidden="true" tabindex="-1"></a>factor_data <span class="op">=</span> factors.set_index(<span class="st">"date"</span>)</span>
<span id="cb46-1773"><a href="#cb46-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1774"><a href="#cb46-1774" aria-hidden="true" tabindex="-1"></a><span class="co"># Asset growth anomaly alpha</span></span>
<span id="cb46-1775"><a href="#cb46-1775" aria-hidden="true" tabindex="-1"></a>ag_ls <span class="op">=</span> ag_wide[[<span class="st">"L-S"</span>]].dropna().rename(columns<span class="op">=</span>{<span class="st">"L-S"</span>: <span class="st">"excess_ret"</span>})</span>
<span id="cb46-1776"><a href="#cb46-1776" aria-hidden="true" tabindex="-1"></a>ag_merged <span class="op">=</span> ag_ls.join(factor_data[[<span class="st">"mkt_rf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]], how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb46-1777"><a href="#cb46-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1778"><a href="#cb46-1778" aria-hidden="true" tabindex="-1"></a>model_ag_ff3 <span class="op">=</span> sm.OLS(</span>
<span id="cb46-1779"><a href="#cb46-1779" aria-hidden="true" tabindex="-1"></a>    ag_merged[<span class="st">"excess_ret"</span>],</span>
<span id="cb46-1780"><a href="#cb46-1780" aria-hidden="true" tabindex="-1"></a>    sm.add_constant(ag_merged[[<span class="st">"mkt_rf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]])</span>
<span id="cb46-1781"><a href="#cb46-1781" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span>
<span id="cb46-1782"><a href="#cb46-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1783"><a href="#cb46-1783" aria-hidden="true" tabindex="-1"></a><span class="co"># NSI anomaly alpha</span></span>
<span id="cb46-1784"><a href="#cb46-1784" aria-hidden="true" tabindex="-1"></a>nsi_ls <span class="op">=</span> nsi_wide[[<span class="st">"L-S"</span>]].dropna().rename(columns<span class="op">=</span>{<span class="st">"L-S"</span>: <span class="st">"excess_ret"</span>})</span>
<span id="cb46-1785"><a href="#cb46-1785" aria-hidden="true" tabindex="-1"></a>nsi_merged <span class="op">=</span> nsi_ls.join(factor_data[[<span class="st">"mkt_rf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]], how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb46-1786"><a href="#cb46-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1787"><a href="#cb46-1787" aria-hidden="true" tabindex="-1"></a>model_nsi_ff3 <span class="op">=</span> sm.OLS(</span>
<span id="cb46-1788"><a href="#cb46-1788" aria-hidden="true" tabindex="-1"></a>    nsi_merged[<span class="st">"excess_ret"</span>],</span>
<span id="cb46-1789"><a href="#cb46-1789" aria-hidden="true" tabindex="-1"></a>    sm.add_constant(nsi_merged[[<span class="st">"mkt_rf"</span>, <span class="st">"smb"</span>, <span class="st">"hml"</span>]])</span>
<span id="cb46-1790"><a href="#cb46-1790" aria-hidden="true" tabindex="-1"></a>).fit(cov_type<span class="op">=</span><span class="st">"HAC"</span>, cov_kwds<span class="op">=</span>{<span class="st">"maxlags"</span>: <span class="dv">6</span>})</span>
<span id="cb46-1791"><a href="#cb46-1791" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1792"><a href="#cb46-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1795"><a href="#cb46-1795" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1796"><a href="#cb46-1796" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-factor-alphas</span></span>
<span id="cb46-1797"><a href="#cb46-1797" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1798"><a href="#cb46-1798" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Fama-French Three-Factor Alphas for Corporate Decision Anomalies"</span></span>
<span id="cb46-1799"><a href="#cb46-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1800"><a href="#cb46-1800" aria-hidden="true" tabindex="-1"></a>alpha_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-1801"><a href="#cb46-1801" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Asset Growth L-S"</span>: {</span>
<span id="cb46-1802"><a href="#cb46-1802" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (monthly)"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>params[<span class="st">'const'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-1803"><a href="#cb46-1803" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  t-stat"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>tvalues[<span class="st">'const'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>,</span>
<span id="cb46-1804"><a href="#cb46-1804" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKT"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>params[<span class="st">'mkt_rf'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-1805"><a href="#cb46-1805" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>params[<span class="st">'smb'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-1806"><a href="#cb46-1806" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>params[<span class="st">'hml'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-1807"><a href="#cb46-1807" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R²"</span>: <span class="ss">f"</span><span class="sc">{</span>model_ag_ff3<span class="sc">.</span>rsquared<span class="sc">:.4f}</span><span class="ss">"</span></span>
<span id="cb46-1808"><a href="#cb46-1808" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb46-1809"><a href="#cb46-1809" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Net Issuance L-S"</span>: {</span>
<span id="cb46-1810"><a href="#cb46-1810" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alpha (monthly)"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>params[<span class="st">'const'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-1811"><a href="#cb46-1811" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  t-stat"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>tvalues[<span class="st">'const'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>,</span>
<span id="cb46-1812"><a href="#cb46-1812" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MKT"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>params[<span class="st">'mkt_rf'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-1813"><a href="#cb46-1813" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SMB"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>params[<span class="st">'smb'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-1814"><a href="#cb46-1814" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HML"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>params[<span class="st">'hml'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb46-1815"><a href="#cb46-1815" aria-hidden="true" tabindex="-1"></a>        <span class="st">"R²"</span>: <span class="ss">f"</span><span class="sc">{</span>model_nsi_ff3<span class="sc">.</span>rsquared<span class="sc">:.4f}</span><span class="ss">"</span></span>
<span id="cb46-1816"><a href="#cb46-1816" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-1817"><a href="#cb46-1817" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-1818"><a href="#cb46-1818" aria-hidden="true" tabindex="-1"></a>alpha_table</span>
<span id="cb46-1819"><a href="#cb46-1819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1820"><a href="#cb46-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1823"><a href="#cb46-1823" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-1824"><a href="#cb46-1824" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-anomaly-comparison</span></span>
<span id="cb46-1825"><a href="#cb46-1825" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-1826"><a href="#cb46-1826" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Corporate Decision Anomalies: Cumulative Long-Short Returns"</span></span>
<span id="cb46-1827"><a href="#cb46-1827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1828"><a href="#cb46-1828" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine asset growth and NSI long-short for comparison</span></span>
<span id="cb46-1829"><a href="#cb46-1829" aria-hidden="true" tabindex="-1"></a>combined <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-1830"><a href="#cb46-1830" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Asset Growth"</span>: ag_wide[<span class="st">"L-S"</span>],</span>
<span id="cb46-1831"><a href="#cb46-1831" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Net Issuance"</span>: nsi_wide[<span class="st">"L-S"</span>]</span>
<span id="cb46-1832"><a href="#cb46-1832" aria-hidden="true" tabindex="-1"></a>}).dropna()</span>
<span id="cb46-1833"><a href="#cb46-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1834"><a href="#cb46-1834" aria-hidden="true" tabindex="-1"></a>combined_cum <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> combined).cumprod().reset_index()</span>
<span id="cb46-1835"><a href="#cb46-1835" aria-hidden="true" tabindex="-1"></a>combined_long <span class="op">=</span> combined_cum.melt(</span>
<span id="cb46-1836"><a href="#cb46-1836" aria-hidden="true" tabindex="-1"></a>    id_vars<span class="op">=</span><span class="st">"date"</span>,</span>
<span id="cb46-1837"><a href="#cb46-1837" aria-hidden="true" tabindex="-1"></a>    var_name<span class="op">=</span><span class="st">"Anomaly"</span>,</span>
<span id="cb46-1838"><a href="#cb46-1838" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">"Cumulative Return"</span></span>
<span id="cb46-1839"><a href="#cb46-1839" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1840"><a href="#cb46-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1841"><a href="#cb46-1841" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb46-1842"><a href="#cb46-1842" aria-hidden="true" tabindex="-1"></a>    p9.ggplot(combined_long, p9.aes(</span>
<span id="cb46-1843"><a href="#cb46-1843" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"date"</span>, y<span class="op">=</span><span class="st">"Cumulative Return"</span>, color<span class="op">=</span><span class="st">"Anomaly"</span></span>
<span id="cb46-1844"><a href="#cb46-1844" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb46-1845"><a href="#cb46-1845" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line(size<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb46-1846"><a href="#cb46-1846" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.geom_hline(yintercept<span class="op">=</span><span class="dv">1</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, color<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb46-1847"><a href="#cb46-1847" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.scale_color_manual(values<span class="op">=</span>[<span class="st">"#2E5090"</span>, <span class="st">"#C0392B"</span>])</span>
<span id="cb46-1848"><a href="#cb46-1848" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.labs(</span>
<span id="cb46-1849"><a href="#cb46-1849" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb46-1850"><a href="#cb46-1850" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Cumulative Return (Growth of $1)"</span>,</span>
<span id="cb46-1851"><a href="#cb46-1851" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Investment vs. Financing Anomalies: Long-Short Portfolios"</span></span>
<span id="cb46-1852"><a href="#cb46-1852" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1853"><a href="#cb46-1853" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme_minimal()</span>
<span id="cb46-1854"><a href="#cb46-1854" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> p9.theme(figure_size<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>), legend_position<span class="op">=</span><span class="st">"top"</span>)</span>
<span id="cb46-1855"><a href="#cb46-1855" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1856"><a href="#cb46-1856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1857"><a href="#cb46-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1858"><a href="#cb46-1858" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## Exercises</span></span>
<span id="cb46-1859"><a href="#cb46-1859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1860"><a href="#cb46-1860" aria-hidden="true" tabindex="-1"></a><span class="co">1.  **Measurement Error Quantification.** Implement the full @erickson2012treating fifth-order cumulant estimator (using both third and fifth moments) for the investment-$Q$ regression. Compare the corrected $\beta_1$ with the OLS estimate. What fraction of the OLS attenuation is attributable to measurement error in $Q$? Does the correction change the significance of the cash flow coefficient?</span></span>
<span id="cb46-1861"><a href="#cb46-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1862"><a href="#cb46-1862" aria-hidden="true" tabindex="-1"></a><span class="co">2.  **Financial Constraints and Investment Efficiency.** Construct the @hadlock2010new SA index for all Vietnamese firms. Sort firms into SA quintiles and estimate separate investment-$Q$ regressions for each quintile. Plot the $Q$ coefficient across quintiles. Is the investment-$Q$ sensitivity monotonically increasing in the SA index (as the constraint hypothesis predicts), or does the Kaplan-Zingales monotonicity failure replicate?</span></span>
<span id="cb46-1863"><a href="#cb46-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1864"><a href="#cb46-1864" aria-hidden="true" tabindex="-1"></a><span class="co">3.  **Speed of Leverage Adjustment.** Estimate the target adjustment model: $\text{Lev}_{i,t} - \text{Lev}_{i,t-1} = \lambda(\text{Lev}_{i,t}^* - \text{Lev}_{i,t-1}) + \varepsilon_{i,t}$, where $\text{Lev}^*$ is the target leverage predicted by the Frank-Goyal determinants. Estimate $\lambda$ for the full sample and separately for SOEs versus private firms. Does state ownership accelerate or retard adjustment to target leverage? Use a system GMM estimator to address the Nickell bias from the lagged dependent variable in short panels.</span></span>
<span id="cb46-1865"><a href="#cb46-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1866"><a href="#cb46-1866" aria-hidden="true" tabindex="-1"></a><span class="co">4.  **Tunneling and Related-Party Transactions.** If DataCore.vn provides related-party transaction (RPT) data, estimate the effect of RPT intensity on firm value (Tobin's $Q$) and operating performance (ROA), controlling for ownership concentration, governance variables, and firm fundamentals. Use the @jiang2010tunneling methodology to distinguish potentially expropriative RPTs from benign ones. Does the RPT-value relationship depend on the identity of the controlling shareholder (state vs. family vs. foreign)?</span></span>
<span id="cb46-1867"><a href="#cb46-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1868"><a href="#cb46-1868" aria-hidden="true" tabindex="-1"></a><span class="co">5.  **Dividend Tax Clientele.** Vietnam implemented a 5% dividend tax in 2014. Using a difference-in-differences design around this regulatory change, test whether the tax altered payout composition (dividends vs. share repurchases vs. retained earnings). Control for firm characteristics and use a matched sample of high- vs. low-dividend firms to estimate the treatment effect on total payout and payout mix.</span></span>
<span id="cb46-1869"><a href="#cb46-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1870"><a href="#cb46-1870" aria-hidden="true" tabindex="-1"></a><span class="co">6.  **Investment Factor Construction.** Construct a Vietnamese investment factor (CMA, "Conservative Minus Aggressive") following the @FamaFrench2015 methodology. Sort firms into 2×3 portfolios on size and asset growth, compute value-weighted returns, and form the long-short factor. Test whether the factor is priced in the cross-section using Fama-MacBeth regressions and whether it subsumes the asset growth anomaly documented in this chapter. Compare the factor's performance with the profitability factor (RMW). --&gt;</span></span>
<span id="cb46-1871"><a href="#cb46-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1872"><a href="#cb46-1872" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb46-1873"><a href="#cb46-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1874"><a href="#cb46-1874" aria-hidden="true" tabindex="-1"></a>This chapter implemented the core econometric toolkit of empirical corporate finance for Vietnamese listed firms. The estimators span four interconnected domains: investment decisions (investment-$Q$ regressions and their measurement-error-corrected variants), financing decisions (capital structure determinants, pecking order tests, and market timing measures), payout policy (Lintner smoothing, repurchase models, and dividend signaling tests), and agency costs (ownership-value relationships, free cash flow measures, and governance variables).</span>
<span id="cb46-1875"><a href="#cb46-1875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1876"><a href="#cb46-1876" aria-hidden="true" tabindex="-1"></a>Several findings deserve emphasis. The investment-$Q$ relationship in Vietnam is attenuated relative to developed-market benchmarks, reflecting both the severity of measurement error in $Q$ (thin trading, price limits, volatile inflation) and the prevalence of non-market-driven investment by SOEs. Cash flow remains a significant predictor of investment across constraint classifications, though the FHP-KZ debate about interpretation applies with full force. Capital structure is strongly predicted by profitability (negatively, consistent with the pecking order) and tangibility (positively, consistent with trade-off theory). Dividend smoothing is pronounced, but the smoothing parameter differs systematically between SOEs and private firms, reflecting the distinct institutional forces governing each group's payout policy.</span>
<span id="cb46-1877"><a href="#cb46-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1878"><a href="#cb46-1878" aria-hidden="true" tabindex="-1"></a>The chapter also linked corporate decisions to asset returns through portfolio sorts on asset growth and net stock issuance. Whether these anomalies survive risk adjustment and persist out of sample in Vietnamese markets is an important open question for future research.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span id="copyright"></span> Mike. All rights reserved.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/edit/main/62_corporate_finance_estimators.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mikenguyen13/tidy_finance_vn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>